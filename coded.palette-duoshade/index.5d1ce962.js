var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e,r,i){Object.defineProperty(t,e,{get:r,set:i,enumerable:!0,configurable:!0})}function r(t){return t&&t.__esModule?t.default:t}var i={},n={},s=t.parcelRequire94c2;null==s&&((s=function(t){if(t in i)return i[t].exports;if(t in n){var e=n[t];delete n[t];var r={id:t,exports:{}};return i[t]=r,e.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){n[t]=e},t.parcelRequire94c2=s),s.register("iuZoh",(function(e,r){!function(i){var n=r&&!r.nodeType&&r,s=e&&!e.nodeType&&e,a="object"==typeof t&&t;a.global!==a&&a.window!==a&&a.self!==a||(i=a);var o,h,u=2147483647,l=36,c=/^xn--/,f=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,g=String.fromCharCode;function v(t){throw new RangeError(p[t])}function _(t,e){for(var r=t.length,i=[];r--;)i[r]=e(t[r]);return i}function b(t,e){var r=t.split("@"),i="";return r.length>1&&(i=r[0]+"@",t=r[1]),i+_((t=t.replace(d,".")).split("."),e).join(".")}function y(t){for(var e,r,i=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function x(t){return _(t,(function(t){var e="";return t>65535&&(e+=g((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=g(t)})).join("")}function w(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function E(t,e,r){var i=0;for(t=r?m(t/700):t>>1,t+=m(t/e);t>455;i+=l)t=m(t/35);return m(i+36*t/(t+38))}function M(t){var e,r,i,n,s,a,o,h,c,f,d,p=[],g=t.length,_=0,b=128,y=72;for((r=t.lastIndexOf("-"))<0&&(r=0),i=0;i<r;++i)t.charCodeAt(i)>=128&&v("not-basic"),p.push(t.charCodeAt(i));for(n=r>0?r+1:0;n<g;){for(s=_,a=1,o=l;n>=g&&v("invalid-input"),((h=(d=t.charCodeAt(n++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:l)>=l||h>m((u-_)/a))&&v("overflow"),_+=h*a,!(h<(c=o<=y?1:o>=y+26?26:o-y));o+=l)a>m(u/(f=l-c))&&v("overflow"),a*=f;y=E(_-s,e=p.length+1,0==s),m(_/e)>u-b&&v("overflow"),b+=m(_/e),_%=e,p.splice(_++,0,b)}return x(p)}function S(t){var e,r,i,n,s,a,o,h,c,f,d,p,_,b,x,M=[];for(p=(t=y(t)).length,e=128,r=0,s=72,a=0;a<p;++a)(d=t[a])<128&&M.push(g(d));for(i=n=M.length,n&&M.push("-");i<p;){for(o=u,a=0;a<p;++a)(d=t[a])>=e&&d<o&&(o=d);for(o-e>m((u-r)/(_=i+1))&&v("overflow"),r+=(o-e)*_,e=o,a=0;a<p;++a)if((d=t[a])<e&&++r>u&&v("overflow"),d==e){for(h=r,c=l;!(h<(f=c<=s?1:c>=s+26?26:c-s));c+=l)x=h-f,b=l-f,M.push(g(w(f+x%b,0))),h=m(x/b);M.push(g(w(h,0))),s=E(r,_,i==n),r=0,++i}++r,++e}return M.join("")}if(o={version:"1.4.1",ucs2:{decode:y,encode:x},decode:M,encode:S,toASCII:function(t){return b(t,(function(t){return f.test(t)?"xn--"+S(t):t}))},toUnicode:function(t){return b(t,(function(t){return c.test(t)?M(t.slice(4).toLowerCase()):t}))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return o}));else if(n&&s)if(e.exports==n)s.exports=o;else for(h in o)o.hasOwnProperty(h)&&(n[h]=o[h]);else i.punycode=o}(this)})),s.register("bu5IZ",(function(t,e){function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,s){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var o=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var l=0;l<u;++l){var c,f,d,p,m=t[l].replace(o,"%20"),g=m.indexOf(n);g>=0?(c=m.substr(0,g),f=m.substr(g+1)):(c=m,f=""),d=decodeURIComponent(c),p=decodeURIComponent(f),r(a,d)?i(a[d])?a[d].push(p):a[d]=[a[d],p]:a[d]=p}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}})),s.register("4gCs1",(function(t,e){var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,a,o){return e=e||"&",a=a||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),(function(s){var o=encodeURIComponent(r(s))+a;return i(t[s])?n(t[s],(function(t){return o+encodeURIComponent(r(t))})).join(e):o+encodeURIComponent(r(t[s]))})).join(e):o?encodeURIComponent(r(o))+a+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function n(t,e){if(t.map)return t.map(e);for(var r=[],i=0;i<t.length;i++)r.push(e(t[i],i));return r}var s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}})),s.register("lSM16",(function(t,e){!function(t,e,r){function i(t){var e=this,r=function(){var t=4022871197,e=function(e){e=String(e);for(var r=0;r<e.length;r++){var i=.02519603282416938*(t+=e.charCodeAt(r));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}function n(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var r=new i(t),s=e&&e.state,a=r.next;return a.int32=function(){return 4294967296*r.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,s&&("object"==typeof s&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.alea=s}(0,t,"function"==typeof define&&define)})),s.register("cEvOy",(function(t,e){!function(t,e,r){function i(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),e.next()}function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var r=new i(t),s=e&&e.state,a=function(){return(r.next()>>>0)/4294967296};return a.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152}while(0===t);return t},a.int32=r.next,a.quick=a,s&&("object"==typeof s&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xor128=s}(0,t,"function"==typeof define&&define)})),s.register("4Pyy4",(function(t,e){!function(t,e,r){function i(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),i==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var r=new i(t),s=e&&e.state,a=function(){return(r.next()>>>0)/4294967296};return a.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152}while(0===t);return t},a.int32=r.next,a.quick=a,s&&("object"==typeof s&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xorwow=s}(0,t,"function"==typeof define&&define)})),s.register("d83i5",(function(t,e){!function(t,e,r){function i(t){var e=this;e.next=function(){var t,r,i=e.x,n=e.i;return t=i[n],r=(t^=t>>>7)^t<<24,r^=(t=i[n+1&7])^t>>>10,r^=(t=i[n+3&7])^t>>>3,r^=(t=i[n+4&7])^t<<7,t=i[n+7&7],r^=(t^=t<<13)^t<<9,i[n]=r,e.i=n+1&7,r},function(t,e){var r,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,r=0;r<e.length;++r)i[7&r]=i[7&r]<<15^e.charCodeAt(r)+i[r+1&7]<<13;for(;i.length<8;)i.push(0);for(r=0;r<8&&0===i[r];++r);for(8==r?i[7]=-1:i[r],t.x=i,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function n(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var r=new i(t),s=e&&e.state,a=function(){return(r.next()>>>0)/4294967296};return a.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152}while(0===t);return t},a.int32=r.next,a.quick=a,s&&(s.x&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xorshift7=s}(0,t,"function"==typeof define&&define)})),s.register("bqVCQ",(function(t,e){!function(t,e,r){function i(t){var e=this;e.next=function(){var t,r,i=e.w,n=e.X,s=e.i;return e.w=i=i+1640531527|0,r=n[s+34&127],t=n[s=s+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=n[s]=r^t,e.i=s,r+(i^i>>>16)|0},function(t,e){var r,i,n,s,a,o=[],h=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,h=Math.max(h,e.length)),n=0,s=-32;s<h;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(a=a+1640531527|0,n=0==(r=o[127&s]^=i+a)?n+1:0);for(n>=128&&(o[127&(e&&e.length||0)]=-1),n=127,s=512;s>0;--s)i=o[n+34&127],r=o[n=n+1&127],i^=i<<13,r^=r<<17,i^=i>>>15,r^=r>>>12,o[n]=i^r;t.w=a,t.X=o,t.i=n}(e,t)}function n(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var r=new i(t),s=e&&e.state,a=function(){return(r.next()>>>0)/4294967296};return a.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152}while(0===t);return t},a.int32=r.next,a.quick=a,s&&(s.X&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xor4096=s}(0,t,"function"==typeof define&&define)})),s.register("71IaV",(function(t,e){!function(t,e,r){function i(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,i=e.d,n=e.a;return t=t<<25^t>>>7^r,r=r-i|0,i=i<<24^i>>>8^n,n=n-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-i|0,e.d=i<<16^r>>>16^n,e.a=n-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var i=0;i<r.length+20;i++)e.b^=0|r.charCodeAt(i),e.next()}function n(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var r=new i(t),s=e&&e.state,a=function(){return(r.next()>>>0)/4294967296};return a.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152}while(0===t);return t},a.int32=r.next,a.quick=a,s&&("object"==typeof s&&n(s,r),a.state=function(){return n(r,{})}),a}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.tychei=s}(0,t,"function"==typeof define&&define)})),s.register("4AFFV",(function(t,e){})),s.register("kLMlV",(function(t,e){
/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */
(function(e,r){var i=(e=e||s("4AFFV")).window,n=e.document,a=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],i=e.slice,n=Object.create,s=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=e.forEach||function(t,e){for(var r=0,i=this.length;r<i;r++)t.call(e,this[r],r,this)},h=function(t,e){for(var r in this)this.hasOwnProperty(r)&&t.call(e,this[r],r,this)},u=Object.assign||function(t){for(var e=1,r=arguments.length;e<r;e++){var i=arguments[e];for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t},l=function(t,e,r){if(t){var i=s(t,"length");(i&&"number"==typeof i.value?o:h).call(t,e,r=r||t)}return r};function c(e,r,i,n,o){var h={};function u(t,u){"string"==typeof(u=u||(u=s(r,t))&&(u.get?u:u.value))&&"#"===u[0]&&(u=e[u.substring(1)]||u);var l,c="function"==typeof u,d=u,p=o||c&&!u.base?u&&u.get?t in e:e[t]:null;o&&p||(c&&p&&(u.base=p),c&&!1!==n&&(l=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(h[l[3].toLowerCase()+l[4]]=l[2]),d&&!c&&d.get&&"function"==typeof d.get&&f.isPlainObject(d)||(d={value:d,writable:!0}),(s(e,t)||{configurable:!0}).configurable&&(d.configurable=!0,d.enumerable=null!=i?i:!l),a(e,t,d))}if(r){for(var l in r)r.hasOwnProperty(l)&&!t.test(l)&&u(l);for(var l in h){var c=h[l],d=e["set"+c],p=e["get"+c]||d&&e["is"+c];!p||!0!==n&&0!==p.length||u(l,{get:p,set:d})}}return e}function f(){for(var t=0,e=arguments.length;t<e;t++){var r=arguments[t];r&&u(this,r)}return this}return c(f,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,r=t.beans,i=t.preserve;e!==t&&c(this.prototype,t,t.enumerable,r,i),c(this,e,null,r,i)}for(var n=1,s=arguments.length;n<s;n++)this.inject(arguments[n]);return this},extend:function(){for(var t,e,r,i=this,s=0,o=arguments.length;s<o&&(!t||!e);s++)r=arguments[s],t=t||r.initialize,e=e||r.prototype;return t=t||function(){i.apply(this,arguments)},e=t.prototype=e||n(this.prototype),a(e,"constructor",{value:t,writable:!0,configurable:!0}),c(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=i,t}}).inject({enumerable:!1,initialize:f,set:f,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var r=arguments[t];r&&c(this,r,r.enumerable,r.beans,r.preserve)}return this},extend:function(){var t=n(this);return t.inject.apply(t,arguments)},each:function(t,e){return l(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:u,each:l,create:n,define:a,describe:s,clone:function(t){return u(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===f||"Object"===e.name)},pick:function(t,e){return t!==r?t:e},slice:function(t,e,r){return i.call(t,e,r)}}})};t.exports=a,a.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+a.each(this,(function(t,e){if(!/^_/.test(e)){var r=typeof t;this.push(e+": "+("number"===r?c.instance.number(t):"string"===r?"'"+t+"'":t))}}),[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return a.importJSON(t,this)},exportJSON:function(t){return a.exportJSON(this,t)},toJSON:function(){return a.serialize(this)},set:function(t,e){return t&&a.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),r=e.prototype._class;return r&&!a.exports[r]&&(a.exports[r]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){if((r=t.length)!==e.length)return!1;for(;r--;)if(!a.equals(t[r],e[r]))return!1}else{var r,i=Object.keys(t);if((r=i.length)!==Object.keys(e).length)return!1;for(;r--;){var n=i[r];if(!e.hasOwnProperty(n)||!a.equals(t[n],e[n]))return!1}}return!0}return!1},read:function(t,e,i,n){if(this===a){var s=this.peek(t,e);return t.__index++,s}var o=this.prototype,h=o._readIndex,u=e||h&&t.__index||0,l=t.length,c=t[u];if(n=n||l-u,c instanceof this||i&&i.readNull&&null==c&&n<=1)return h&&(t.__index=u+1),c&&i&&i.clone?c.clone():c;if(c=a.create(o),h&&(c.__read=!0),c=c.initialize.apply(c,u>0||u+n<l?a.slice(t,u,u+n):t)||c,h){t.__index=u+c.__read;var f=c.__filtered;f&&(t.__filtered=f,c.__filtered=r),c.__read=r}return c},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,r,i){for(var n,s=[],a=e||0,o=i?a+i:t.length,h=a;h<o;h++)s.push(Array.isArray(n=t[h])?this.read(n,0,r):this.read(t,h,r,1));return s},readNamed:function(t,e,i,n,s){var o=this.getNamed(t,e),h=o!==r;if(h){var u=t.__filtered;if(!u){var l=this.getSource(t);(u=t.__filtered=a.create(l)).__unfiltered=l}u[e]=r}return this.read(h?[o]:t,i,n,s)},readSupported:function(t,e){var i=this.getSource(t),n=this,s=!1;return i&&Object.keys(i).forEach((function(i){if(i in e){var a=n.readNamed(t,i);a!==r&&(e[i]=a),s=!0}})),s},getSource:function(t){var e=t.__source;if(e===r){var i=1===t.length&&t[0];e=t.__source=i&&a.isPlainObject(i)?i:null}return e},getNamed:function(t,e){var r=this.getSource(t);if(r)return e?r[e]:t.__filtered||r},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,i,n){var s;function a(n){if(!(i&&n in i||s&&n in s)){var a=e[n];a!==r&&(t[n]=a)}}if(n){for(var o,h={},u=0,l=n.length;u<l;u++)(o=n[u])in e&&(a(o),h[o]=!0);s=h}return Object.keys(e.__unfiltered||e).forEach(a),t},isPlainValue:function(t,e){return a.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,r,i){e=e||{};var n,s=!i;if(s&&(e.formatter=new c(e.precision),i={length:0,definitions:{},references:{},add:function(t,e){var r="#"+t._id,i=this.references[r];if(!i){this.length++;var n=e.call(t),s=t._class;s&&n[0]!==s&&n.unshift(s),this.definitions[r]=n,i=this.references[r]=[r]}return i}}),t&&t._serialize){n=t._serialize(e,i);var o=t._class;!o||t._compactSerialize||!s&&r||n[0]===o||n.unshift(o)}else if(Array.isArray(t)){n=[];for(var h=0,u=t.length;h<u;h++)n[h]=a.serialize(t[h],e,r,i)}else if(a.isPlainObject(t)){n={};var l=Object.keys(t);for(h=0,u=l.length;h<u;h++){var f=l[h];n[f]=a.serialize(t[f],e,r,i)}}else n="number"==typeof t?e.formatter.number(t,e.precision):t;return s&&i.length>0?[["dictionary",i.definitions],n]:n},deserialize:function(t,e,r,i,n){var s=t,o=!r,h=o&&t&&t.length&&"dictionary"===t[0][0];if(r=r||{},Array.isArray(t)){var u=t[0],l="dictionary"===u;if(1==t.length&&/^#/.test(u))return r.dictionary[u];s=[];for(var c=(u=a.exports[u])?1:0,f=t.length;c<f;c++)s.push(a.deserialize(t[c],e,r,l,h));if(u){var d=s;s=e?e(u,d,o||n):new u(d)}}else if(a.isPlainObject(t))for(var p in s={},i&&(r.dictionary=s),t)s[p]=a.deserialize(t[p],e,r);return h?s[1]:s},exportJSON:function(t,e){var r=a.serialize(t,e);return e&&0==e.asString?r:JSON.stringify(r)},importJSON:function(t,e){return a.deserialize("string"==typeof t?JSON.parse(t):t,(function(t,r,i){var n=i&&e&&e.constructor===t,s=n?e:a.create(t.prototype);if(1===r.length&&s instanceof E&&(n||!(s instanceof S))){var o=r[0];a.isPlainObject(o)&&(o.insert=!1,n&&(r=r.concat([E.INSERT])))}return(n?s.set:t).apply(s,r),n&&(e=null),s}))},push:function(t,e){var r=e.length;if(r<4096)t.push.apply(t,e);else{var i=t.length;t.length+=r;for(var n=0;n<r;n++)t[i+n]=e[n]}return t},splice:function(t,e,i,n){var s=e&&e.length,o=i===r;(i=o?t.length:i)>t.length&&(i=t.length);for(var h=0;h<s;h++)e[h]._index=i+h;if(o)return a.push(t,e),[];var u=[i,n];e&&a.push(u,e);for(var l=t.splice.apply(t,u),c=(h=0,l.length);h<c;h++)l[h]._index=r;for(h=i+s,c=t.length;h<c;h++)t[h]._index=h;return l},capitalize:function(t){return t.replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}))},camelize:function(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var o={on:function(t,e){if("string"!=typeof t)a.each(t,(function(t,e){this.on(e,t)}),this);else{var r=this._eventTypes,i=r&&r[t],n=this._callbacks=this._callbacks||{};-1===(n=n[t]=n[t]||[]).indexOf(e)&&(n.push(e),i&&i.install&&1===n.length&&i.install.call(this,t))}return this},off:function(t,e){if("string"==typeof t){var r,i=this._eventTypes,n=i&&i[t],s=this._callbacks&&this._callbacks[t];return s&&(!e||-1!==(r=s.indexOf(e))&&1===s.length?(n&&n.uninstall&&n.uninstall.call(this,t),delete this._callbacks[t]):-1!==r&&s.splice(r,1)),this}a.each(t,(function(t,e){this.off(e,t)}),this)},once:function(t,e){return this.on(t,(function r(){e.apply(this,arguments),this.off(t,r)}))},emit:function(t,e){var r=this._callbacks&&this._callbacks[t];if(!r)return!1;var i=a.slice(arguments,1),n=e&&e.target&&!e.currentTarget;r=r.slice(),n&&(e.currentTarget=this);for(var s=0,o=r.length;s<o;s++)if(0==r[s].apply(this,i)){e&&e.stop&&e.stop();break}return n&&delete e.currentTarget,!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,r=this._callbacks,i=t?"install":"uninstall";if(e)for(var n in r)if(r[n].length>0){var s=e[n],a=s&&s[i];a&&a.call(this,n)}},statics:{inject:function t(e){var r=e._events;if(r){var i={};a.each(r,(function(t,r){var n="string"==typeof t,s=n?t:r,o=a.capitalize(s),h=s.substring(2).toLowerCase();i[h]=n?{}:t,s="_"+s,e["get"+o]=function(){return this[s]},e["set"+o]=function(t){var e=this[s];e&&this.off(h,e),t&&this.on(h,t),this[s]=t}})),e._eventTypes=i}return t.base.apply(this,arguments)}}},h=a.extend({_class:"PaperScope",initialize:function t(){ot=this,this.settings=new a({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var r=t.prototype;if(!this.support){var i=it.getContext(1,1)||{};r.support={nativeDash:"setLineDash"in i||"mozDash"in i,nativeBlendModes:nt.nativeModes},it.release(i)}if(!this.agent){var n=e.navigator.userAgent.toLowerCase(),s=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(n)||[])[0],o="darwin"===s?"mac":s,h=r.agent=r.browser={platform:o};o&&(h[o]=!0),n.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,(function(t,e,r,i,n){if(!h.chrome){var s="opera"===e?i:/^(node|trident)$/.test(e)?n:r;h.version=s,h.versionNumber=parseFloat(s),e={trident:"msie",jsdom:"node"}[e]||e,h.name=e,h[e]=!0}})),h.chrome&&delete h.webkit,h.atom&&delete h.chrome}},version:"0.12.17",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){},install:function(t){var e=this;for(var r in a.each(["project","view","tool"],(function(r){a.define(t,r,{configurable:!0,get:function(){return e[r]}})})),this)!/^_/.test(r)&&this[r]&&(t[r]=this[r])},setup:function(t){return ot=this,this.project=new w(t),this},createCanvas:function(t,e){return it.getCanvas(t,e)},activate:function(){ot=this},clear:function(){for(var t=this.projects,e=this.tools,r=t.length-1;r>=0;r--)t[r].remove();for(r=e.length-1;r>=0;r--)e[r].remove()},remove:function(){this.clear(),delete h._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,r){return e[t](r)||e[t]("data-paper-"+r)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),u=a.extend(o,{initialize:function(t){this._scope=ot,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(a.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),l={findItemBoundsCollisions:function(t,e,r){function i(t){for(var e=new Array(t.length),r=0;r<t.length;r++){var i=t[r].getBounds();e[r]=[i.left,i.top,i.right,i.bottom]}return e}var n=i(t),s=e&&e!==t?i(e):n;return this.findBoundsCollisions(n,s,r||0)},findCurveBoundsCollisions:function(t,e,r,i){function n(t){for(var e=Math.min,r=Math.max,i=new Array(t.length),n=0;n<t.length;n++){var s=t[n];i[n]=[e(s[0],s[2],s[4],s[6]),e(s[1],s[3],s[5],s[7]),r(s[0],s[2],s[4],s[6]),r(s[1],s[3],s[5],s[7])]}return i}var s=n(t),a=e&&e!==t?n(e):s;if(i){for(var o=this.findBoundsCollisions(s,a,r||0,!1,!0),h=this.findBoundsCollisions(s,a,r||0,!0,!0),u=[],l=0,c=o.length;l<c;l++)u[l]={hor:o[l],ver:h[l]};return u}return this.findBoundsCollisions(s,a,r||0)},findBoundsCollisions:function(t,e,r,i,n){var s=!e||t===e,a=s?t:t.concat(e),o=t.length,h=a.length;function u(t,e,r){for(var i=0,n=t.length;i<n;){var s=n+i>>>1;a[t[s]][e]<r?i=s+1:n=s}return i-1}for(var l=i?1:0,c=l+2,f=i?0:1,d=f+2,p=new Array(h),m=0;m<h;m++)p[m]=m;p.sort((function(t,e){return a[t][l]-a[e][l]}));var g=[],v=new Array(o);for(m=0;m<h;m++){var _=p[m],b=a[_],y=s?_:_-o,x=_<o,w=s||!x,E=x?[]:null;if(g.length){var M=u(g,c,b[l]-r)+1;if(g.splice(0,M),s&&n){E=E.concat(g);for(var S=0;S<g.length;S++){v[C=g[S]].push(y)}}else{var A=b[d],T=b[f];for(S=0;S<g.length;S++){var C=g[S],D=a[C],R=C<o,I=s||C>=o;(n||(x&&I||w&&R)&&A>=D[f]-r&&T<=D[d]+r)&&(x&&I&&E.push(s?C:C-o),w&&R&&v[C].push(y))}}}if(x&&(t===e&&E.push(_),v[_]=E),g.length){var P=u(g,c,b[c]);g.splice(P+1,0,_)}else g.push(_)}for(m=0;m<v.length;m++){var N=v[m];N&&N.sort((function(t,e){return t-e}))}return v}},c=a.extend({initialize:function(t){this.precision=a.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,r){return this.number(t)+(r||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});c.instance=new c;var f=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],r=Math.abs,i=Math.sqrt,n=Math.pow,s=Math.log2||function(t){return Math.log(t)*Math.LOG2E},a=1e-12,o=112e-18;function h(t,e,r){return t<e?e:t>r?r:t}function u(t,e,i){function n(t){var e=134217729*t,r=t-e+e;return[r,t-r]}var s=e*e-t*i,a=e*e+t*i;if(3*r(s)<a){var o=n(t),h=n(e),u=n(i),l=e*e,c=t*i;s=l-c+(h[0]*h[0]-l+2*h[0]*h[1]+h[1]*h[1]-(o[0]*u[0]-c+o[0]*u[1]+o[1]*u[0]+o[1]*u[1]))}return s}function l(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?n(2,-Math.round(s(t))):0}return{EPSILON:a,MACHINE_EPSILON:o,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(i(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=a},isMachineZero:function(t){return t>=-112e-18&&t<=o},clamp:h,integrate:function(r,i,n,s){for(var a=t[s-2],o=e[s-2],h=.5*(n-i),u=h+i,l=0,c=s+1>>1,f=1&s?o[l++]*r(u):0;l<c;){var d=h*a[l];f+=o[l++]*(r(u+d)+r(u-d))}return h*f},findRoot:function(t,e,i,n,s,a,o){for(var u=0;u<a;u++){var l=t(i),c=l/e(i),f=i-c;if(r(c)<o){i=f;break}l>0?(s=i,i=f<=n?.5*(n+s):f):(n=i,i=f>=s?.5*(n+s):f)}return h(i,n,s)},solveQuadratic:function(t,e,n,s,c,f){var d,p=1/0;if(r(t)<a){if(r(e)<a)return r(n)<a?-1:0;d=-n/e}else{var m=u(t,e*=-.5,n);if(m&&r(m)<o){var g=l(r(t),r(e),r(n));g&&(m=u(t*=g,e*=g,n*=g))}if(m>=-112e-18){var v=m<0?0:i(m),_=e+(e<0?-v:v);0===_?p=-(d=n/t):(d=_/t,p=n/_)}}var b=0,y=null==c,x=c-a,w=f+a;return isFinite(d)&&(y||d>x&&d<w)&&(s[b++]=y?d:h(d,c,f)),p!==d&&isFinite(p)&&(y||p>x&&p<w)&&(s[b++]=y?p:h(p,c,f)),b},solveCubic:function(t,e,s,u,c,d,p){var m,g,v,_,b,y=l(r(t),r(e),r(s),r(u));function x(r){var i=t*(m=r);_=(i+(g=i+e))*m+(v=g*m+s),b=v*m+u}if(y&&(t*=y,e*=y,s*=y,u*=y),r(t)<a)t=e,g=s,v=u,m=1/0;else if(r(u)<a)g=e,v=s,m=0;else{x(-e/t/3);var w=b/t,E=n(r(w),1/3),M=w<0?-1:1,S=-_/t,A=S>0?1.324717957244746*Math.max(E,i(S)):E,T=m-M*A;if(T!==m){do{x(T),T=0===_?m:m-b/_/(1+o)}while(M*T>M*m);r(t)*m*m>r(u/m)&&(g=((v=-u/m)-s)/m)}}var C=f.solveQuadratic(t,g,v,c,d,p),D=null==d;return isFinite(m)&&(0===C||C>0&&m!==c[0]&&m!==c[1])&&(D||m>d-a&&m<p+a)&&(c[C++]=D?m:h(m,d,p)),C}}},d={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}return this._id++}},p=a.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var r=typeof t,i=this.__read,n=0;if("number"===r){var s="number"==typeof e;this._set(t,s?e:t),i&&(n=s?2:1)}else if("undefined"===r||null===t)this._set(0,0),i&&(n=null===t?1:0);else{var a="string"===r?t.split(/[\s,]+/)||[]:t;n=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"x"in a?this._set(a.x||0,a.y||0):"width"in a?this._set(a.width||0,a.height||0):"angle"in a?(this._set(a.length||0,0),this.setAngle(a.angle||0)):(this._set(0,0),n=0)}return i&&(this.__read=n),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new p(this.x,this.y)},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var r=t/this.getLength();f.isZero(r)&&this.getAngle(),this._set(this.x*r,this.y*r)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=p.read(arguments),e=this.getLength()*t.getLength();if(f.isZero(e))return NaN;var r=this.dot(t)/e;return Math.acos(r<-1?-1:r>1?1:r)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=p.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=p.read(t),r=e.x-this.x,i=e.y-this.y,n=r*r+i*i,s=a.read(t);return s?n:Math.sqrt(n)},normalize:function(t){t===r&&(t=1);var e=this.getLength(),i=0!==e?t/e:0,n=new p(this.x*i,this.y*i);return i>=0&&(n._angle=this._angle),n},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var r=e?this.subtract(e):this,i=Math.sin(t),n=Math.cos(t);return r=new p(r.x*n-r.y*i,r.x*i+r.y*n),e?r.add(e):r},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=p.read(arguments);return new p(this.x+t.x,this.y+t.y)},subtract:function(){var t=p.read(arguments);return new p(this.x-t.x,this.y-t.y)},multiply:function(){var t=p.read(arguments);return new p(this.x*t.x,this.y*t.y)},divide:function(){var t=p.read(arguments);return new p(this.x/t.x,this.y/t.y)},modulo:function(){var t=p.read(arguments);return new p(this.x%t.x,this.y%t.y)},negate:function(){return new p(-this.x,-this.y)},isInside:function(){return _.read(arguments).contains(this)},isClose:function(){var t=arguments,e=p.read(t),r=a.read(t);return this.getDistance(e)<=r},isCollinear:function(){var t=p.read(arguments);return p.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=p.read(arguments);return p.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=f.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=p.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=p.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=p.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new p(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=p.read(t),r=p.read(t);return new p(Math.min(e.x,r.x),Math.min(e.y,r.y))},max:function(){var t=arguments,e=p.read(t),r=p.read(t);return new p(Math.max(e.x,r.x),Math.max(e.y,r.y))},random:function(){return new p(Math.random(),Math.random())},isCollinear:function(t,e,r,i){return Math.abs(t*i-e*r)<=1e-8*Math.sqrt((t*t+e*e)*(r*r+i*i))},isOrthogonal:function(t,e,r,i){return Math.abs(t*r+e*i)<=1e-8*Math.sqrt((t*t+e*e)*(r*r+i*i))}}},a.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new p(e(this.x),e(this.y))}}),{})),m=p.extend({initialize:function(t,e,r,i){this._x=t,this._y=e,this._owner=r,this._setter=i},_set:function(t,e,r){return this._x=t,this._y=e,r||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),g=a.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var r=typeof t,i=this.__read,n=0;if("number"===r){var s="number"==typeof e;this._set(t,s?e:t),i&&(n=s?2:1)}else if("undefined"===r||null===t)this._set(0,0),i&&(n=null===t?1:0);else{var a="string"===r?t.split(/[\s,]+/)||[]:t;n=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"width"in a?this._set(a.width||0,a.height||0):"x"in a?this._set(a.x||0,a.y||0):(this._set(0,0),n=0)}return i&&(this.__read=n),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new g(this.width,this.height)},toString:function(){var t=c.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=g.read(arguments);return new g(this.width+t.width,this.height+t.height)},subtract:function(){var t=g.read(arguments);return new g(this.width-t.width,this.height-t.height)},multiply:function(){var t=g.read(arguments);return new g(this.width*t.width,this.height*t.height)},divide:function(){var t=g.read(arguments);return new g(this.width/t.width,this.height/t.height)},modulo:function(){var t=g.read(arguments);return new g(this.width%t.width,this.height%t.height)},negate:function(){return new g(-this.width,-this.height)},isZero:function(){var t=f.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new g(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new g(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new g(Math.random(),Math.random())}}},a.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new g(e(this.width),e(this.height))}}),{})),v=g.extend({initialize:function(t,e,r,i){this._width=t,this._height=e,this._owner=r,this._setter=i},_set:function(t,e,r){return this._width=t,this._height=e,r||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),_=a.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,e,i,n){var s,o=arguments,h=typeof t;if("number"===h?(this._set(t,e,i,n),s=4):"undefined"===h||null===t?(this._set(0,0,0,0),s=null===t?1:0):1===o.length&&(Array.isArray(t)?(this._set.apply(this,t),s=1):t.x!==r||t.width!==r?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),s=1):t.from===r&&t.to===r&&(this._set(0,0,0,0),a.readSupported(o,this)&&(s=1))),s===r){var u,l,c=p.readNamed(o,"from"),f=a.peek(o),d=c.x,m=c.y;if(f&&f.x!==r||a.hasNamed(o,"to")){var v=p.readNamed(o,"to");u=v.x-d,l=v.y-m,u<0&&(d=v.x,u=-u),l<0&&(m=v.y,l=-l)}else{var _=g.read(o);u=_.width,l=_.height}this._set(d,m,u,l),s=o.__index}var b=o.__filtered;return b&&(this.__filtered=b),this.__read&&(this.__read=s),this},set:"#initialize",_set:function(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this},clone:function(){return new _(this.x,this.y,this.width,this.height)},equals:function(t){var e=a.isPlainValue(t)?_.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?p:m)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?g:v)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=g.read(arguments),e=this._sx,r=this._sy,i=t.width,n=t.height;e&&(this.x+=(this.width-i)*e),r&&(this.y+=(this.height-n)*r),this.width=i,this.height=n,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=2*(t-this.x)*this._sx),this.width=2*(t-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=2*(t-this.y)*this._sy),this.height=2*(t-this.y)),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?p:m)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=p.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==r||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(_.read(arguments)):this._containsPoint(p.read(arguments))},_containsPoint:function(t){var e=t.x,r=t.y;return e>=this.x&&r>=this.y&&e<=this.x+this.width&&r<=this.y+this.height},_containsRectangle:function(t){var e=t.x,r=t.y;return e>=this.x&&r>=this.y&&e+t.width<=this.x+this.width&&r+t.height<=this.y+this.height},intersects:function(){var t=_.read(arguments),e=a.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=_.read(arguments),e=Math.max(this.x,t.x),r=Math.max(this.y,t.y),i=Math.min(this.x+this.width,t.x+t.width),n=Math.min(this.y+this.height,t.y+t.height);return new _(e,r,i-e,n-r)},unite:function(){var t=_.read(arguments),e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width),n=Math.max(this.y+this.height,t.y+t.height);return new _(e,r,i-e,n-r)},include:function(){var t=p.read(arguments),e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x),n=Math.max(this.y+this.height,t.y);return new _(e,r,i-e,n-r)},expand:function(){var t=g.read(arguments),e=t.width,r=t.height;return new _(this.x-e/2,this.y-r/2,this.width+e,this.height+r)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===r?t:e)-this.height)}},a.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],(function(t,e){var r=t.join(""),i=/^[RL]/.test(r);e>=4&&(t[1]+=i?"Y":"X");var n=t[i?0:1],s=t[i?1:0],a="get"+n,o="get"+s,h="set"+n,u="set"+s,l="set"+r;this["get"+r]=function(t){return new(t?p:m)(this[a](),this[o](),this,l)},this[l]=function(){var t=p.read(arguments);this[h](t.x),this[u](t.y)}}),{beans:!0})),b=_.extend({initialize:function(t,e,r,i,n,s){this._set(t,e,r,i,!0),this._owner=n,this._setter=s},_set:function(t,e,r,i,n){return this._x=t,this._y=e,this._width=r,this._height=i,n||this._owner[this._setter](this),this}},new function(){var t=_.prototype;return a.each(["x","y","width","height"],(function(t){var e=a.capitalize(t),r="_"+t;this["get"+e]=function(){return this[r]},this["set"+e]=function(t){this[r]=t,this._dontNotify||this._owner[this._setter](this)}}),a.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],(function(e){var r="set"+e;this[r]=function(){this._dontNotify=!0,t[r].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}}),{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),y=a.extend({_class:"Matrix",initialize:function t(e,r){var i=arguments,n=i.length,s=!0;if(n>=6?this._set.apply(this,i):1===n||2===n?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,r):Array.isArray(e)?this._set.apply(this,r?e.concat([r]):e):s=!1:n?s=!1:this.reset(),!s)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,r,i,n,s,a){return this._a=t,this._b=e,this._c=r,this._d=i,this._tx=n,this._ty=s,a||this._changed(),this},_serialize:function(t,e){return a.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new y(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=c.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var r=this._owner;return!!r&&(r.transform(null,a.pick(t,!0),e),this.isIdentity())},translate:function(){var t=p.read(arguments),e=t.x,r=t.y;return this._tx+=e*this._a+r*this._c,this._ty+=e*this._b+r*this._d,this._changed(),this},scale:function(){var t=arguments,e=p.read(t),r=p.read(t,0,{readNull:!0});return r&&this.translate(r),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,r&&this.translate(r.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=p.read(arguments,1),r=e.x,i=e.y,n=Math.cos(t),s=Math.sin(t),a=r-r*n+i*s,o=i-r*s-i*n,h=this._a,u=this._b,l=this._c,c=this._d;return this._a=n*h+s*l,this._b=n*u+s*c,this._c=-s*h+n*l,this._d=-s*u+n*c,this._tx+=a*h+o*l,this._ty+=a*u+o*c,this._changed(),this},shear:function(){var t=arguments,e=p.read(t),r=p.read(t,0,{readNull:!0});r&&this.translate(r);var i=this._a,n=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*i,this._d+=e.x*n,r&&this.translate(r.negate()),this._changed(),this},skew:function(){var t=arguments,e=p.read(t),r=p.read(t,0,{readNull:!0}),i=Math.PI/180,n=new p(Math.tan(e.x*i),Math.tan(e.y*i));return this.shear(n,r)},append:function(t,e){if(t){var r=this._a,i=this._b,n=this._c,s=this._d,a=t._a,o=t._c,h=t._b,u=t._d,l=t._tx,c=t._ty;this._a=a*r+h*n,this._c=o*r+u*n,this._b=a*i+h*s,this._d=o*i+u*s,this._tx+=l*r+c*n,this._ty+=l*i+c*s,e||this._changed()}return this},prepend:function(t,e){if(t){var r=this._a,i=this._b,n=this._c,s=this._d,a=this._tx,o=this._ty,h=t._a,u=t._c,l=t._b,c=t._d,f=t._tx,d=t._ty;this._a=h*r+u*i,this._c=h*n+u*s,this._b=l*r+c*i,this._d=l*n+c*s,this._tx=h*a+u*o+f,this._ty=l*a+c*o+d,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,r=this._c,i=this._d,n=this._tx,s=this._ty,a=t*i-e*r,o=null;return a&&!isNaN(a)&&isFinite(n)&&isFinite(s)&&(this._a=i/a,this._b=-e/a,this._c=-r/a,this._d=t/a,this._tx=(r*s-i*n)/a,this._ty=(e*n-t*s)/a,o=this),o},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new y(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,r){return arguments.length<3?this._transformPoint(p.read(arguments)):this._transformCoordinates(t,e,r)},_transformPoint:function(t,e,r){var i=t.x,n=t.y;return e||(e=new p),e._set(i*this._a+n*this._c+this._tx,i*this._b+n*this._d+this._ty,r)},_transformCoordinates:function(t,e,r){for(var i=0,n=2*r;i<n;i+=2){var s=t[i],a=t[i+1];e[i]=s*this._a+a*this._c+this._tx,e[i+1]=s*this._b+a*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,r=t.y,i=e+t.width,n=r+t.height,s=[e,r,i,r,i,n,e,n];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,r){for(var i=this._transformCorners(t),n=i.slice(0,2),s=n.slice(),a=2;a<8;a++){var o=i[a],h=1&a;o<n[h]?n[h]=o:o>s[h]&&(s[h]=o)}return e||(e=new _),e._set(n[0],n[1],s[0]-n[0],s[1]-n[1],r)},inverseTransform:function(){return this._inverseTransform(p.read(arguments))},_inverseTransform:function(t,e,r){var i=this._a,n=this._b,s=this._c,a=this._d,o=this._tx,h=this._ty,u=i*a-n*s,l=null;if(u&&!isNaN(u)&&isFinite(o)&&isFinite(h)){var c=t.x-this._tx,f=t.y-this._ty;e||(e=new p),l=e._set((c*a-f*s)/u,(f*i-c*n)/u,r)}return l},decompose:function(){var t,e,r,i=this._a,n=this._b,s=this._c,a=this._d,o=i*a-n*s,h=Math.sqrt,u=Math.atan2,l=180/Math.PI;if(0!==i||0!==n){var c=h(i*i+n*n);t=Math.acos(i/c)*(n>0?1:-1),e=[c,o/c],r=[u(i*s+n*a,c*c),0]}else if(0!==s||0!==a){var f=h(s*s+a*a);t=Math.asin(s/f)*(a>0?1:-1),e=[o/f,f],r=[0,u(i*s+n*a,f*f)]}else t=0,r=e=[0,0];return{translation:this.getTranslation(),rotation:t*l,scaling:new p(e),skewing:new p(r[0]*l,r[1]*l)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new p(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},a.each(["a","b","c","d","tx","ty"],(function(t){var e=a.capitalize(t),r="_"+t;this["get"+e]=function(){return this[r]},this["set"+e]=function(t){this[r]=t,this._changed()}}),{})),x=a.extend({_class:"Line",initialize:function(t,e,r,i,n){var s=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=r,this._vy=i,s=n):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,s=r),s||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new p(this._px,this._py)},getVector:function(){return new p(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return x.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return x.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return x.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return p.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return p.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,r,i,n,s,a,o,h,u){h||(r-=t,i-=e,a-=n,o-=s);var l=r*o-i*a;if(!f.isMachineZero(l)){var c=t-n,d=e-s,m=(a*d-o*c)/l,g=(r*d-i*c)/l,v=-1e-12,_=1+1e-12;if(u||v<m&&m<_&&v<g&&g<_)return u||(m=m<=0?0:m>=1?1:m),new p(t+m*r,e+m*i)}},getSide:function(t,e,r,i,n,s,a,o){a||(r-=t,i-=e);var h=n-t,u=h*i-(s-e)*r;return!o&&f.isMachineZero(u)&&(u=(h*r+h*r)/(r*r+i*i))>=0&&u<=1&&(u=0),u<0?-1:u>0?1:0},getSignedDistance:function(t,e,r,i,n,s,a){return a||(r-=t,i-=e),0===r?i>0?n-t:t-n:0===i?r<0?s-e:e-s:((n-t)*i-(s-e)*r)/(i>r?i*Math.sqrt(1+r*r/(i*i)):r*Math.sqrt(1+i*i/(r*r)))},getDistance:function(t,e,r,i,n,s,a){return Math.abs(x.getSignedDistance(t,e,r,i,n,s,a))}}}),w=u.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){u.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new W(null,null,this),this._view=Y.create(this,t||it.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return a.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var r=this._view;r&&(r._needsUpdate=!0,!r._requested&&r._autoUpdate&&r.requestUpdate())}var i=this._changes;if(i&&e){var n=this._changesById,s=e._id,a=n[s];a?a.flags|=t:i.push(n[s]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new S({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:C,match:function(r){var i=r._definition,n=i._id;return e[n]||(e[n]=!0,t.push(i)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var r in t){var i=t[r],n=i._selection;1&n&&i.isInserted()?e.push(i):n||this._updateSelection(i)}return e},_updateSelection:function(t){var e=t._id,r=this._selectionItems;t._selection?r[e]!==t&&(this._selectionCount++,r[e]=t):r[e]===t&&(this._selectionCount--,delete r[e])},selectAll:function(){for(var t=this._children,e=0,r=t.length;e<r;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(r,t)},insertLayer:function(t,e){if(e instanceof S){e._remove(!1,!0),a.splice(this._children,[e],t,0),e._setProject(this,!0);var r=e._name;r&&e.setName(r),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,i){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(r,new S(E.NO_INSERT),!0)).insertChild(t,e),i&&e.activate&&e.activate(),e},getItems:function(t){return E._getItems(this,t)},getItem:function(t){return E._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return a.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var r=e[t];if(r){for(var i in r){var n=r[i];for(var s in e){var a=e[s];a&&a!=r&&delete a[n._id]}n.remove()}e[t]=null}}},draw:function(t,e,r){this._updateVersion++,t.save(),e.applyToContext(t);for(var i=this._children,n=new a({offset:new p(0,0),pixelRatio:r,viewMatrix:e.isIdentity()?null:e,matrices:[new y],updateMatrix:!0}),s=0,o=i.length;s<o;s++)i[s].draw(t,n);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var h=this._selectionItems,u=this._scope.settings.handleSize,l=this._updateVersion;for(var c in h)h[c]._drawSelection(t,e,u,h,l);t.restore()}}}),E=a.extend(o,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=a.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new y,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return a.each(t,(function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}}),{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var i=t&&a.isPlainObject(t),n=i&&!0===t.internal,s=this._matrix=new y,o=i&&t.project||ot.project,h=ot.settings;return this._id=n?null:d.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&h.applyMatrix,e&&s.translate(e),s._owner=this,this._style=new W(o._currentStyle,this,o),n||i&&0==t.insert||!h.insertItems&&(!i||1!=t.insert)?this._setProject(o):(i&&t.parent||o)._insertItem(r,this,!0),i&&t!==E.NO_INSERT&&t!==E.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),i},_serialize:function(t,e){var r={},i=this;function n(n){for(var s in n){var o=i[s];a.equals(o,"leading"===s?1.2*n.fontSize:n[s])||(r[s]=a.serialize(o,t,"data"!==s,e))}}return n(this._serializeFields),this instanceof M||n(this._style._defaults),[this._class,r]},_changed:function(t){var e=this._symbol,i=this._parent||e,n=this._project;8&t&&(this._bounds=this._position=this._decomposed=r),16&t&&(this._globalMatrix=r),i&&72&t&&E._clearBoundsCache(i),2&t&&E._clearBoundsCache(this),n&&n._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var i=e._children,n=e._namedChildren;(n[t]=n[t]||[]).push(this),t in i||(i[t]=this)}this._name=t||r,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},a.each(["locked","visible","blendMode","opacity","guide"],(function(t){var e=a.capitalize(t),r="_"+t,i={locked:256,visible:265};this["get"+e]=function(){return this[r]},this["set"+e]=function(e){e!=this[r]&&(this[r]=e,this._changed(i[t]||257))}}),{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var r=this._selection;this.setSelection(e?r|t:r&~t)},isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,r=t.length;e<r;e++)if(t[e].isSelected())return!0;return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,r=0,i=e.length;r<i;r++)e[r].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var r=0,i=t.length;r<i;r++)if(!t[r].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var r=0,i=e.length;r<i;r++)e[r].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?p:m,r=this._position||(this._position=this._getPositionFromBounds());return new e(r.x,r.y,this,"setPosition")},setPosition:function(){this.translate(p.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new m(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=p.read(arguments,0,{clone:!0,readNull:!0}),this._position=r}},a.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},(function(t,e){this[e]=function(e){return this.getBounds(e,t)}}),{beans:!0,getBounds:function(t,e){var r=e||t instanceof y,i=a.set({},r?e:t,this._boundsOptions);i.stroke&&!this.getStrokeScaling()||(i.cacheItem=this);var n=this._getCachedBounds(r&&t,i).rect;return arguments.length?n:new b(n.x,n.y,n.width,n.height,this,"setBounds")},setBounds:function(){var t=_.read(arguments),e=this.getBounds(),r=this._matrix,i=new y,n=t.getCenter();i.translate(n),t.width==e.width&&t.height==e.height||(r.isInvertible()||(r.set(r._backup||(new y).translate(r.getTranslation())),e=this.getBounds()),i.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),n=e.getCenter(),i.translate(-n.x,-n.y),this.transform(i)},_getBounds:function(t,e){var r=this._children;return r&&r.length?(E._updateBoundsCache(this,e.cacheItem),E._getBounds(r,t,e)):new _},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,r){t=t&&t._orNullIfIdentity();var i=e.internal&&!r,n=e.cacheItem,s=i?null:this._matrix._orNullIfIdentity(),a=n&&(!t||t.equals(s))&&this._getBoundsCacheKey(e,i),o=this._bounds;if(E._updateBoundsCache(this._parent||this._symbol,n),a&&o&&a in o)return{rect:(f=o[a]).rect.clone(),nonscaling:f.nonscaling};var h=this._getBounds(t||s,e),u=h.rect||h,l=this._style,c=h.nonscaling||l.hasStroke()&&!l.getStrokeScaling();if(a){o||(this._bounds=o={});var f=o[a]={rect:u.clone(),nonscaling:c,internal:i}}return{rect:u,nonscaling:c}},_getStrokeMatrix:function(t,e){var r=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,i=r?r.getViewMatrix().invert():t;return i&&i._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var r=e._id,i=t._boundsCache=t._boundsCache||{ids:{},list:[]};i.ids[r]||(i.list.push(e),i.ids[r]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=r;for(var i=0,n=e.list,s=n.length;i<s;i++){var a=n[i];a!==t&&(a._bounds=a._position=r,a._boundsCache&&E._clearBoundsCache(a))}}},_getBounds:function(t,e,r){var i=1/0,n=-i,s=i,a=n,o=!1;r=r||{};for(var h=0,u=t.length;h<u;h++){var l=t[h];if(l._visible&&!l.isEmpty(!0)){var c=l._getCachedBounds(e&&e.appended(l._matrix),r,!0),f=c.rect;i=Math.min(f.x,i),s=Math.min(f.y,s),n=Math.max(f.x+f.width,n),a=Math.max(f.y+f.height,a),c.nonscaling&&(o=!0)}}return{rect:isFinite(i)?new _(i,s,n-i,a-s):new _,nonscaling:o}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var r=this._decomposed;this.rotate(t-e),r&&(r.rotation=t,this._decomposed=r)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new m(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var r=this.getRotation(),i=this._decomposed,n=new y,s=f.isZero;if(s(t.x)||s(t.y))n.translate(i.translation),r&&n.rotate(r),n.scale(e.x,e.y),this._matrix.set(n);else{var a=this.getPosition(!0);n.translate(a),r&&n.rotate(r),n.scale(e.x/t.x,e.y/t.y),r&&n.rotate(-r),n.translate(a.negate()),this.transform(n)}i&&(i.scaling=e,this._decomposed=i)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var r=this._parent,i=[];r;){if(!r._globalMatrix){e=null;for(var n=0,s=i.length;n<s;n++)i[n]._globalMatrix=null;break}i.push(r),r=r._parent}e||(e=this._globalMatrix=this._matrix.clone(),(r=this._parent)&&e.prepend(r.getGlobalMatrix(!0)));return t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var r=this._children,i=0,n=r&&r.length;i<n;i++)r[i]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var r=this._children,i=0,n=r&&r.length;i<n;i++)r[i]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof S)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return a.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(E.NO_INSERT),i=this._children,n=a.pick(t?t.insert:r,t===r||!0===t),s=a.pick(t?t.deep:r,!0);i&&e.copyAttributes(this),i&&!s||e.copyContent(this),i||e.copyAttributes(this),n&&e.insertAbove(this);var o=this._name,h=this._parent;if(o&&h){i=h._children;for(var u=o,l=1;i[o];)o=u+" "+l++;o!==u&&e.setName(o)}return e},copyContent:function(t){for(var e=t._children,r=0,i=e&&e.length;r<i;r++)this.addChild(e[r].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var r=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,n=r.length;i<n;i++){var s=r[i];t.hasOwnProperty(s)&&(this[s]=t[s])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,h=t._name;this._data=o?a.clone(o):null,h&&this.setName(h)},rasterize:function(t,e){var i,n,s;a.isPlainObject(t)?(i=t.resolution,n=t.insert,s=t.raster):(i=t,n=e),s||(s=new T(E.NO_INSERT));var o=this.getStrokeBounds(),h=(i||this.getView().getResolution())/72,u=o.getTopLeft().floor(),l=o.getBottomRight().ceil(),c=new g(l.subtract(u)),f=c.multiply(h);if(s.setSize(f,!0),!f.isZero()){var d=s.getContext(!0),p=(new y).scale(h).translate(u.negate());d.save(),p.applyToContext(d),this.draw(d,new a({matrices:[p]})),d.restore()}return s._matrix.set((new y).translate(u.add(c.divide(2))).scale(1/h)),(n===r||n)&&s.insertAbove(this),s},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(p.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var r=e.length-1;r>=0;r--)if(e[r].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return _.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new L.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof E&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(p.read(t),R.getOptions(t))}function e(){var t=arguments,e=p.read(t),r=R.getOptions(t),i=[];return this._hitTest(e,new a({all:i},r)),i}function r(t,e,r,i){var n=this._children;if(n)for(var s=n.length-1;s>=0;s--){var a=n[s],o=a!==i&&a._hitTest(t,e,r);if(o&&!e.all)return o}return null}return w.inject({hitTest:t,hitTestAll:e,_hitTest:r}),{hitTest:t,hitTestAll:e,_hitTestChildren:r}},{_hitTest:function(t,e,r){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var i=this._matrix,n=r?r.appended(i):this.getGlobalMatrix().prepend(this.getView()._matrix),s=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new g(L._getStrokePadding(s,i._shiftless().invert()));if(!(t=i._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var h,u,l=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==a.hyphenate(this._class)||e.class&&!(this instanceof e.class)),c=e.match,f=this;function d(t){return t&&c&&!c(t)&&(t=null),t&&e.all&&e.all.push(t),t}function p(e,r){var i=r?h["get"+r]():f.getPosition();if(t.subtract(i).divide(o).length<=1)return new R(e,f,{name:r?a.hyphenate(r):e,point:i})}var m=e.position,v=e.center,_=e.bounds;if(l&&this._parent&&(m||v||_)){if((v||_)&&(h=this.getInternalBounds()),!(u=m&&p("position")||v&&p("center","Center"))&&_)for(var b=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],y=0;y<8&&!u;y++)u=p("bounds",b[y]);u=d(u)}return u||(u=this._hitTestChildren(t,e,n)||l&&d(this._hitTestSelf(t,e,n,this.getStrokeScaling()?null:n._shiftless().invert()))||null),u&&u.point&&(u.point=i.transform(u.point)),u},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new R("fill",this)},matches:function(t,e){var r=typeof t;if("object"===r){for(var i in t)if(t.hasOwnProperty(i)&&!this.matches(i,t[i]))return!1;return!0}if("function"===r)return t(this);if("match"===t)return e(this);var n=/^(empty|editable)$/.test(t)?this["is"+a.capitalize(t)]():"type"===t?a.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;n=this._class}if("function"==typeof e)return!!e(n);if(e){if(e.test)return e.test(n);if(a.isPlainObject(e))return function t(e,r){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],s=r[i];if(a.isPlainObject(n)&&a.isPlainObject(s)){if(!t(n,s))return!1}else if(!a.equals(n,s))return!1}return!0}(e,n)}return a.equals(n,e)},getItems:function(t){return E._getItems(this,t,this._matrix)},getItem:function(t){return E._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,r,i,n,s){if(!n){var o="object"==typeof r&&r,h=o&&o.overlapping,u=o&&o.inside,l=(b=h||u)&&_.read([b]);n={items:[],recursive:o&&!1!==o.recursive,inside:!!u,overlapping:!!h,rect:l,path:h&&new L.Rectangle({rectangle:l,insert:!1})},o&&(r=a.filter({},r,{recursive:!0,inside:!0,overlapping:!0}))}var c=e._children,f=n.items;i=(l=n.rect)&&(i||new y);for(var d=0,p=c&&c.length;d<p;d++){var m=c[d],g=i&&i.appended(m._matrix),v=!0;if(l){var b=m.getBounds(g);if(!l.intersects(b))continue;l.contains(b)||n.overlapping&&(b.contains(l)||n.path.intersects(m,g))||(v=!1)}if(v&&m.matches(r)&&(f.push(m),s))break;if(!1!==n.recursive&&t(m,r,g,n,s),s&&f.length>0)break}return f}}},{importJSON:function(t){var e=a.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(r,t)},insertChild:function(t,e){var r=e?this.insertChildren(t,[e]):null;return r&&r[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var r=this._children;if(r&&e&&e.length>0){for(var i={},n=(e=a.slice(e)).length-1;n>=0;n--){var s=(l=e[n])&&l._id;!l||i[s]?e.splice(n,1):(l._remove(!1,!0),i[s]=!0)}a.splice(r,e,t,0);for(var o=this._project,h=o._changes,u=(n=0,e.length);n<u;n++){var l,c=(l=e[n])._name;l._parent=this,l._setProject(o,!0),c&&l.setName(c),h&&l._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var r=t&&t._getOwner(),i=t!==this&&r?this:null;return i&&(i._remove(!1,!0),r._insertItem(t._index+e,i)),i},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(r,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(r,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var r=e[0].reduce(t);return this._parent?(r.insertAbove(this),this.remove()):r.remove(),r}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,r=t._namedChildren,i=this._name,n=r[i],s=n?n.indexOf(this):-1;-1!==s&&(e[i]==this&&delete e[i],n.splice(s,1),n.length?e[i]=n[0]:delete r[i])}},_remove:function(t,e){var r=this._getOwner(),i=this._project,n=this._index;return this._style&&this._style._dispose(),!!r&&(this._name&&this._removeNamed(),null!=n&&(i._activeLayer===this&&(i._activeLayer=this.getNextSibling()||this.getPreviousSibling()),a.splice(r._children,null,n,1)),this._installEvents(!1),t&&i._changes&&this._changed(5),e&&r._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=a.pick(e,this._children.length);for(var r=a.splice(this._children,null,t,e-t),i=r.length-1;i>=0;i--)r[i]._remove(!0,!1);return r.length>0&&this._changed(11),r},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,r=e?e.length:0;if(t){for(var i=0;i<r;i++)if(!e[i].isEmpty(t))return!1;return!0}return!r},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var r=e(this),i=e(t),n=0,s=Math.min(r.length,i.length);n<s;n++)if(r[n]!=i[n])return r[n]._index<i[n]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},a.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var r=arguments,i=(e?a:p).read(r),n=p.read(r,0,{readNull:!0});return this.transform((new y)[t](i,n||this.getPosition(!0)))}}),{translate:function(){var t=new y;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,r){var i=this._matrix,n=t&&!t.isIdentity(),s=r&&this._canApplyMatrix||this._applyMatrix&&(n||!i.isIdentity()||e&&this._children);if(!n&&!s)return this;if(n){!t.isInvertible()&&i.isInvertible()&&(i._backup=i.getValues()),i.prepend(t,!0);var a=this._style,o=a.getFillColor(!0),h=a.getStrokeColor(!0);o&&o.transform(t),h&&h.transform(t)}if(s&&(s=this._transformContent(i,e,r))){var u=this._pivot;u&&i._transformPoint(u,u,!0),i.reset(!0),r&&this._canApplyMatrix&&(this._applyMatrix=!0)}var l=this._bounds,c=this._position;(n||s)&&this._changed(25);var f=n&&l&&t.decompose();if(f&&f.skewing.isZero()&&f.rotation%90==0){for(var d in l){var p=l[d];if(p.nonscaling)delete l[d];else if(s||!p.internal){var m=p.rect;t._transformBounds(m,m)}}this._bounds=l;var g=l[this._getBoundsCacheKey(this._boundsOptions||{})];g&&(this._position=this._getPositionFromBounds(g.rect))}else n&&c&&this._pivot&&(this._position=t._transformPoint(c,c));return this},_transformContent:function(t,e,r){var i=this._children;if(i){for(var n=0,s=i.length;n<s;n++)i[n].transform(t,e,r);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(p.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(p.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(p.read(arguments))},localToParent:function(){return this._matrix._transformPoint(p.read(arguments))},fitBounds:function(t,e){t=_.read(arguments);var r=this.getBounds(),i=r.height/r.width,n=t.height/t.width,s=(e?i>n:i<n)?t.width/r.width:t.height/r.height,a=new _(new p,new g(r.width*s,r.height*s));a.setCenter(t.getCenter()),this.setBounds(a)}}),{_setStyles:function(t,e,r){var i=this._style,n=this._matrix;if(i.hasFill()&&(t.fillStyle=i.getFillColor().toCanvasStyle(t,n)),i.hasStroke()){t.strokeStyle=i.getStrokeColor().toCanvasStyle(t,n),t.lineWidth=i.getStrokeWidth();var s=i.getStrokeJoin(),a=i.getStrokeCap(),o=i.getMiterLimit();if(s&&(t.lineJoin=s),a&&(t.lineCap=a),o&&(t.miterLimit=o),ot.support.nativeDash){var h=i.getDashArray(),u=i.getDashOffset();h&&h.length&&("setLineDash"in t?(t.setLineDash(h),t.lineDashOffset=u):(t.mozDash=h,t.mozDashOffset=u))}}if(i.hasShadow()){var l=e.pixelRatio||1,c=r._shiftless().prepend((new y).scale(l,l)),f=c.transform(new p(i.getShadowBlur(),0)),d=c.transform(this.getShadowOffset());t.shadowColor=i.getShadowColor().toCanvasStyle(t),t.shadowBlur=f.getLength(),t.shadowOffsetX=d.x,t.shadowOffsetY=d.y}},draw:function(t,e,r){this._updateVersion=this._project._updateVersion;if(this._visible&&0!==this._opacity){var i=e.matrices,n=e.viewMatrix,s=this._matrix,a=i[i.length-1].appended(s);if(a.isInvertible()){n=n?n.appended(a):a,i.push(a),e.updateMatrix&&(this._globalMatrix=a);var o,h,u,l=this._blendMode,c=f.clamp(this._opacity,0,1),d="normal"===l,p=nt.nativeModes[l],m=d&&1===c||e.dontStart||e.clip||(p||d&&c<1)&&this._canComposite(),g=e.pixelRatio||1;if(!m){var v=this.getStrokeBounds(n);if(!v.width||!v.height)return void i.pop();u=e.offset,h=e.offset=v.getTopLeft().floor(),o=t,t=it.getContext(v.getSize().ceil().add(1).multiply(g)),1!==g&&t.scale(g,g)}t.save();var _=r?r.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&n,b=!m&&e.clipItem,y=!_||b;if(m?(t.globalAlpha=c,p&&(t.globalCompositeOperation=l)):y&&t.translate(-h.x,-h.y),y&&(m?s:n).applyToContext(t),b&&e.clipItem.draw(t,e.extend({clip:!0})),_){t.setTransform(g,0,0,g,0,0);var x=e.offset;x&&t.translate(-x.x,-x.y)}this._draw(t,e,n,_),t.restore(),i.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),m||(nt.process(l,t,o,c,h.subtract(u).multiply(g)),it.release(t),e.offset=u)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof O)return e._isUpdated(t);var r=this._updateVersion===t;return!r&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,r=!0),r},_drawSelection:function(t,e,r,i,n){var s=this._selection,a=1&s,o=2&s||a&&this._selectBounds,h=4&s;if(this._drawSelected||(a=!1),(a||o||h)&&this._isUpdated(n)){var u,l=this.getSelectedColor(!0)||(u=this.getLayer())&&u.getSelectedColor(!0),c=e.appended(this.getGlobalMatrix(!0)),f=r/2;if(t.strokeStyle=t.fillStyle=l?l.toCanvasStyle(t):"#009dec",a&&this._drawSelected(t,c,i),h){var d=this.getPosition(!0),p=this._parent,m=p?p.localToGlobal(d):d,g=m.x,v=m.y;t.beginPath(),t.arc(g,v,f,0,2*Math.PI,!0),t.stroke();for(var _=[[0,-1],[1,0],[0,1],[-1,0]],b=f,y=r+1,x=0;x<4;x++){var w=_[x],E=w[0],M=w[1];t.moveTo(g+E*b,v+M*b),t.lineTo(g+E*y,v+M*y),t.stroke()}}if(o){var S=c._transformCorners(this.getInternalBounds());t.beginPath();for(x=0;x<8;x++)t[x?"lineTo":"moveTo"](S[x],S[++x]);t.closePath(),t.stroke();for(x=0;x<8;x++)t.fillRect(S[x]-f,S[++x]-f,r,r)}}},_canComposite:function(){return!1}},a.each(["down","drag","up","move"],(function(t){this["removeOn"+a.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}}),{removeOn:function(t){for(var e in t)if(t[e]){var r="mouse"+e,i=this._project,n=i._removeSets=i._removeSets||{};n[r]=n[r]||{},n[r][this._id]=this}return this}}),{tween:function(t,e,r){r||(r=e,e=t,t=null,r||(r=e,e=null));var i=r&&r.easing,n=r&&r.start,s=null!=r&&("number"==typeof r?r:r.duration),a=new et(this,t,e,s,i,n);return s&&this.on("frame",(function t(e){a._handleFrame(1e3*e.time),a.running||this.off("frame",t)})),a},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),M=E.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(e){t.base.call(this,e),2050&e&&(this._clipItem=r)},_getClipItem:function(){var t=this._clipItem;if(t===r){t=null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._clipMask){t=e[i];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,r){var i=this._getClipItem();return i?i._getCachedBounds(i._matrix.prepended(e),a.set({},r,{stroke:!1})):t.base.call(this,e,r)},_hitTestChildren:function t(e,r,i){var n=this._getClipItem();return(!n||n.contains(e))&&t.base.call(this,e,r,i,n)},_draw:function(t,e){var r=e.clip,i=!r&&this._getClipItem();e=e.extend({clipItem:i,clip:!1}),r?(t.beginPath(),e.dontStart=e.dontFinish=!0):i&&i.draw(t,e.extend({clip:!0}));for(var n=this._children,s=0,a=n.length;s<a;s++){var o=n[s];o!==i&&o.draw(t,e)}}}),S=M.extend({_class:"Layer",initialize:function(){M.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),A=E.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&a.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new v(t.width,t.height,this,"setSize")},setSize:function(){var t=g.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,r=t.width,i=t.height;"rectangle"===e?this._radius.set(g.min(this._radius,t.divide(2).abs())):"circle"===e?(r=i=(r+i)/2,this._radius=r/2):"ellipse"===e&&this._radius._set(r/2,i/2),this._size._set(r,i),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new v(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var r=2*t;this._radius=t,this._size._set(r,r)}else if(t=g.read(arguments),this._radius){if(this._radius.equals(t))return;if(this._radius.set(t),"rectangle"===e){r=g.max(this._size,t.multiply(2));this._size.set(r)}else"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new(L[a.capitalize(this._type)])({center:new p,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),ot.settings.applyMatrix&&e.setApplyMatrix(!0),(t===r||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,r,i){var n=this._style,s=n.hasFill(),a=n.hasStroke(),o=e.dontFinish||e.clip,h=!i;if(s||a||o){var u=this._type,l=this._radius,c="circle"===u;if(e.dontStart||t.beginPath(),h&&c)t.arc(0,0,l,0,2*Math.PI,!0);else{var f=c?l:l.width,d=c?l:l.height,p=this._size,m=p.width,g=p.height;if(h&&"rectangle"===u&&0===f&&0===d)t.rect(-m/2,-g/2,m,g);else{var v=m/2,_=g/2,b=.44771525016920644,y=f*b,x=d*b,w=[-v,-_+d,-v,-_+x,-v+y,-_,-v+f,-_,v-f,-_,v-y,-_,v,-_+x,v,-_+d,v,_-d,v,_-x,v-y,_,v-f,_,-v+f,_,-v+y,_,-v,_-x,-v,_-d];i&&i.transform(w,w,32),t.moveTo(w[0],w[1]),t.bezierCurveTo(w[2],w[3],w[4],w[5],w[6],w[7]),v!==f&&t.lineTo(w[8],w[9]),t.bezierCurveTo(w[10],w[11],w[12],w[13],w[14],w[15]),_!==d&&t.lineTo(w[16],w[17]),t.bezierCurveTo(w[18],w[19],w[20],w[21],w[22],w[23]),v!==f&&t.lineTo(w[24],w[25]),t.bezierCurveTo(w[26],w[27],w[28],w[29],w[30],w[31])}}t.closePath()}o||!s&&!a||(this._setStyles(t,e,r),s&&(t.fill(n.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),a&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var r=new _(this._size).setCenter(0,0),i=this._style,n=e.stroke&&i.hasStroke()&&i.getStrokeWidth();return t&&(r=t._transformBounds(r)),n?r.expand(L._getStrokePadding(n,this._getStrokeMatrix(t,e))):r}},new function(){function t(t,e,r){var i=t._radius;if(!i.isZero())for(var n=t._size.divide(2),s=1;s<=4;s++){var a=new p(s>1&&s<4?-1:1,s>2?-1:1),o=a.multiply(n),h=o.subtract(a.multiply(i));if(new _(r?o.add(a.multiply(r)):o,h).contains(e))return{point:h,quadrant:s}}}function e(t,e,r,i){var n=t.divide(e);return(!i||n.isInQuadrant(i))&&n.subtract(n.normalize()).multiply(e).divide(r).length<=1}return{_contains:function e(r){if("rectangle"===this._type){var i=t(this,r);return i?r.subtract(i.point).divide(this._radius).getLength()<=1:e.base.call(this,r)}return r.divide(this.size).getLength()<=.5},_hitTestSelf:function r(i,n,s,a){var o=!1,h=this._style,u=n.stroke&&h.hasStroke(),l=n.fill&&h.hasFill();if(u||l){var c=this._type,f=this._radius,d=u?h.getStrokeWidth()/2:0,p=n._tolerancePadding.add(L._getStrokePadding(d,!h.getStrokeScaling()&&a));if("rectangle"===c){var m=p.multiply(2),g=t(this,i,m);if(g)o=e(i.subtract(g.point),f,p,g.quadrant);else{var v=new _(this._size).setCenter(0,0),b=v.expand(m),y=v.expand(m.negate());o=b._containsPoint(i)&&!y._containsPoint(i)}}else o=e(i,f,p)}return o?new R(u?"stroke":"fill",this):r.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,r,i,n){var s=a.create(A.prototype);return s._type=t,s._size=r,s._radius=i,s._initialize(a.getNamed(n),e),s}return{Circle:function(){var e=arguments,r=p.readNamed(e,"center"),i=a.readNamed(e,"radius");return t("circle",r,new g(2*i),i,e)},Rectangle:function(){var e=arguments,r=_.readNamed(e,"rectangle"),i=g.min(g.readNamed(e,"radius"),r.getSize(!0).divide(2));return t("rectangle",r.getCenter(!0),r.getSize(!0),i,e)},Ellipse:function(){var e=arguments,r=A._readEllipse(e),i=r.radius;return t("ellipse",r.center,i.multiply(2),i,e)},_readEllipse:function(t){var e,r;if(a.hasNamed(t,"radius"))e=p.readNamed(t,"center"),r=g.readNamed(t,"radius");else{var i=_.readNamed(t,"rectangle");e=i.getCenter(!0),r=i.getSize(!0).divide(2)}return{center:e,radius:r}}}}}),T=E.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(t,e){if(!this._initialize(t,e!==r&&p.read(arguments))){var i,s=typeof t,a="string"===s?n.getElementById(t):"object"===s?t:null;if(a&&a!==E.NO_INSERT)if(a.getContext||null!=a.naturalHeight)i=a;else if(a){var o=g.read(arguments);o.isZero()||(i=it.getCanvas(o))}i?this.setImage(i):this.setSource(t)}this._size||(this._size=new g,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,r=t._canvas;if(e)this._setImage(e);else if(r){var i=it.getCanvas(t._size);i.getContext("2d").drawImage(r,0,0),this._setImage(i)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new v(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var r=g.read(arguments);if(r.equals(this._size))e&&this.clear();else if(r.width>0&&r.height>0){var i=!e&&this.getElement();this._setImage(it.getCanvas(r)),i&&this.getContext(!0).drawImage(i,0,0,r.width,r.height)}else this._canvas&&it.release(this._canvas),this._size=r.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new p(0,0).transform(t),r=new p(1,0).transform(t).subtract(e),i=new p(0,1).transform(t).subtract(e);return new g(72/r.getLength(),72/i.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function r(t){var r=e.getView(),i=t&&t.type||"load";r&&e.responds(i)&&(ot=r._scope,e.emit(i,new $(t)))}this._setImage(t),this._loaded?setTimeout(r,0):t&&X.add(t,{load:function(i){e._setImage(t),r(i)},error:r})},_setImage:function(t){this._canvas&&it.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new g(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=it.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){it.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var r=new e.Image,i=this._crossOrigin;i&&(r.crossOrigin=i),t&&(r.src=t),this.setImage(r)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing="string"==typeof t?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=_.read(arguments),e=it.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=_.read(arguments),e=new T(E.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var r=this.getCanvas();return r?r.toDataURL.apply(r,arguments):null},drawImage:function(t){var e=p.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,r;if(t?t instanceof B?(r=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new _(t):"x"in t&&(e=new _(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var i=Math.min(e.width,32),n=Math.min(e.height,32),s=T._sampleContext;s?s.clearRect(0,0,33,33):s=T._sampleContext=it.getContext(new g(32)),s.save();var o=(new y).scale(i/e.width,n/e.height).translate(-e.x,-e.y);o.applyToContext(s),r&&r.draw(s,new a({clip:!0,matrices:[o]})),this._matrix.applyToContext(s);var h=this.getElement(),u=this._size;h&&s.drawImage(h,-u.width/2,-u.height/2),s.restore();for(var l=s.getImageData(.5,.5,Math.ceil(i),Math.ceil(n)).data,c=[0,0,0],f=0,d=0,p=l.length;d<p;d+=4){var m=l[d+3];f+=m,m/=255,c[0]+=l[d]*m,c[1]+=l[d+1]*m,c[2]+=l[d+2]*m}for(d=0;d<3;d++)c[d]/=f;return f?H.read(c):null},getPixel:function(){var t=p.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new H("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=p.read(t),r=H.read(t),i=r._convert("rgb"),n=r._alpha,s=this.getContext(!0),a=s.createImageData(1,1),o=a.data;o[0]=255*i[0],o[1]=255*i[1],o[2]=255*i[2],o[3]=null!=n?255*n:255,s.putImageData(a,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=g.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=_.read(arguments);return t.isEmpty()&&(t=new _(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var e=p.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,e){var r=new _(this._size).setCenter(0,0);return t?t._transformBounds(r):r},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new R("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,r){var i=this.getElement();if(i&&i.width>0&&i.height>0){t.globalAlpha=f.clamp(this._opacity,0,1),this._setStyles(t,e,r);var n=this._smoothing,s="off"===n;q.setPrefixed(t,s?"imageSmoothingEnabled":"imageSmoothingQuality",!s&&n),t.drawImage(i,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),C=E.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,e){this._initialize(t,e!==r&&p.read(arguments,1))||this.setDefinition(t instanceof D?t:new D(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var r=this._definition._item;return r._getCachedBounds(r._matrix.prepended(t),e)},_hitTestSelf:function(t,e,r){var i=e.extend({all:!1}),n=this._definition._item._hitTest(t,i,r);return n&&(n.item=this),n},_draw:function(t,e){this._definition._item.draw(t,e)}}),D=a.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=d.get(),this.project=ot.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,(function(){return a.serialize([this._class,this._item],t,!1,e)}))},_changed:function(t){8&t&&E._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new p),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new C(this,t)},clone:function(){return new D(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),R=a.extend({_class:"HitResult",initialize:function(t,e,r){this.type=t,this.item=e,r&&this.inject(r)},statics:{getOptions:function(t){var e=t&&a.read(t);return new a({type:null,tolerance:ot.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),I=a.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,e,i,n,s,a){var o,h,u,l,c=arguments.length;c>0&&(null==t||"object"==typeof t?1===c&&t&&"point"in t?(o=t.point,h=t.handleIn,u=t.handleOut,l=t.selection):(o=t,h=e,u=i,l=n):(o=[t,e],h=i!==r?[i,n]:null,u=s!==r?[s,a]:null)),new P(o,this,"_point"),new P(h,this,"_handleIn"),new P(u,this,"_handleOut"),l&&this.setSelection(l)},_serialize:function(t,e){var r=this._point,i=this._selection,n=i||this.hasHandles()?[r,this._handleIn,this._handleOut]:r;return i&&n.push(i),a.serialize(n,t,!0,e)},_changed:function(t){var e=this._path;if(e){var r,i=e._curves,n=this._index;i&&(t&&t!==this._point&&t!==this._handleIn||!(r=n>0?i[n-1]:e._closed?i[i.length-1]:null)||r._changed(),t&&t!==this._point&&t!==this._handleOut||!(r=i[n])||r._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(p.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(p.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(p.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,r=this._path;this._selection=t=t||0,r&&t!==e&&(r._updateSelection(this,e,t),r._changed(257))},_changeSelection:function(t,e){var r=this._selection;this.setSelection(e?r|t:r&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==r?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new k(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,i){var n=t||{},s=n.type,a=n.factor,o=this.getPrevious(),h=this.getNext(),u=(o||this)._point,l=this._point,c=(h||this)._point,f=u.getDistance(l),d=l.getDistance(c);if(s&&"catmull-rom"!==s){if("geometric"!==s)throw new Error("Smoothing method '"+s+"' not supported.");if(o&&h){var m=u.subtract(c),g=a===r?.4:a,v=g*f/(f+d);e||this.setHandleIn(m.multiply(v)),i||this.setHandleOut(m.multiply(v-g))}}else{var _=a===r?.5:a,b=Math.pow(f,_),y=b*b,x=Math.pow(d,_),w=x*x;if(!e&&o){var E=2*w+3*x*b+y,M=3*x*(x+b);this.setHandleIn(0!==M?new p((w*u._x+E*l._x-y*c._x)/M-l._x,(w*u._y+E*l._y-y*c._y)/M-l._y):new p)}if(!i&&h){E=2*y+3*b*x+w,M=3*b*(b+x);this.setHandleOut(0!==M?new p((y*c._x+E*l._x-w*u._x)/M-l._x,(y*c._y+E*l._y-w*u._y)/M-l._y):new p)}}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,r=t.clone();t.set(e),e.set(r)},reversed:function(){return new I(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new I(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,r){var i=1-r,n=r,s=t._point,a=e._point,o=t._handleIn,h=e._handleIn,u=e._handleOut,l=t._handleOut;this._point._set(i*s._x+n*a._x,i*s._y+n*a._y,!0),this._handleIn._set(i*o._x+n*h._x,i*o._y+n*h._y,!0),this._handleOut._set(i*l._x+n*u._x,i*l._y+n*u._y,!0),this._changed()},_transformCoordinates:function(t,e,r){var i=this._point,n=r&&this._handleIn.isZero()?null:this._handleIn,s=r&&this._handleOut.isZero()?null:this._handleOut,a=i._x,o=i._y,h=2;return e[0]=a,e[1]=o,n&&(e[h++]=n._x+a,e[h++]=n._y+o),s&&(e[h++]=s._x+a,e[h++]=s._y+o),t&&(t._transformCoordinates(e,e,h/2),a=e[0],o=e[1],r?(i._x=a,i._y=o,h=2,n&&(n._x=e[h++]-a,n._y=e[h++]-o),s&&(s._x=e[h++]-a,s._y=e[h++]-o)):(n||(e[h++]=a,e[h++]=o),s||(e[h++]=a,e[h++]=o))),e}}),P=p.extend({initialize:function(t,e,i){var n,s,a;if(t)if((n=t[0])!==r)s=t[1];else{var o=t;(n=o.x)===r&&(n=(o=p.read(arguments)).x),s=o.y,a=o.selected}else n=s=0;this._x=n,this._y=s,this._owner=e,e[i]=this,a&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=f.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),N=a.extend({_class:"Curve",beans:!0,initialize:function(t,e,r,i,n,s,a,o){var h,u,l,c,f,d,p=arguments.length;3===p?(this._path=t,h=e,u=r):p?1===p?"segment1"in t?(h=new I(t.segment1),u=new I(t.segment2)):"point1"in t?(l=t.point1,f=t.handle1,d=t.handle2,c=t.point2):Array.isArray(t)&&(l=[t[0],t[1]],c=[t[6],t[7]],f=[t[2]-t[0],t[3]-t[1]],d=[t[4]-t[6],t[5]-t[7]]):2===p?(h=new I(t),u=new I(e)):4===p?(l=t,f=e,d=r,c=i):8===p&&(l=[t,e],c=[a,o],f=[r-t,i-e],d=[n-a,s-o]):(h=new I,u=new I),this._segment1=h||new I(l,null,f),this._segment2=u||new I(c,d,null)},_serialize:function(t,e){return a.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=r},clone:function(){return new N(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return N.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,r=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(r)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(p.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(p.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(p.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(p.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return N.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],r=0;r<8;r+=2)e.push(new p(t[r],t[r+1]));return e}},{getLength:function(){return null==this._length&&(this._length=N.getLength(this.getValues(),0,1)),this._length},getArea:function(){return N.getArea(this.getValues())},getLine:function(){return new x(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new N(N.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return N.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var r=null;if(t>=1e-8&&t<=.99999999){var i=N.subdivide(this.getValues(),t),n=i[0],s=i[1],a=e||this.hasHandles(),o=this._segment1,h=this._segment2,u=this._path;a&&(o._handleOut._set(n[2]-n[0],n[3]-n[1]),h._handleIn._set(s[4]-s[6],s[5]-s[7]));var l=n[6],c=n[7],f=new I(new p(l,c),a&&new p(n[4]-l,n[5]-c),a&&new p(s[2]-l,s[3]-c));u?(u.insert(o._index+1,f),r=this.getNext()):(this._segment2=f,this._changed(),r=new N(f,h))}return r},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===r?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===r?.5:e?t:this.getTimeAt(t))},reversed:function(){return new N(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,r,i){var n=t._point,s=t._handleOut,a=e._handleIn,o=e._point,h=n.x,u=n.y,l=o.x,c=o.y,f=i?[h,u,h,u,l,c,l,c]:[h,u,h+s._x,u+s._y,l+a._x,c+a._y,l,c];return r&&r._transformCoordinates(f,f,4),f},subdivide:function(t,e){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],h=t[5],u=t[6],l=t[7];e===r&&(e=.5);var c=1-e,f=c*i+e*s,d=c*n+e*a,p=c*s+e*o,m=c*a+e*h,g=c*o+e*u,v=c*h+e*l,_=c*f+e*p,b=c*d+e*m,y=c*p+e*g,x=c*m+e*v,w=c*_+e*y,E=c*b+e*x;return[[i,n,f,d,_,b,w,E],[w,E,y,x,g,v,u,l]]},getMonoCurves:function(t,e){var r=[],i=e?0:1,n=t[i+0],s=t[i+2],a=t[i+4],o=t[i+6];if(n>=s==s>=a&&s>=a==a>=o||N.isStraight(t))r.push(t);else{var h=3*(s-a)-n+o,u=2*(n+a)-4*s,l=s-n,c=[],d=f.solveQuadratic(h,u,l,c,1e-8,.99999999);if(d){c.sort();var p=c[0],m=N.subdivide(t,p);r.push(m[0]),d>1&&(p=(c[1]-p)/(1-p),m=N.subdivide(m[1],p),r.push(m[0])),r.push(m[1])}else r.push(t)}return r},solveCubic:function(t,e,r,i,n,s){var a=t[e],o=t[e+2],h=t[e+4],u=t[e+6],l=0;if(!(a<r&&u<r&&o<r&&h<r||a>r&&u>r&&o>r&&h>r)){var c=3*(o-a),d=3*(h-o)-c,p=u-a-c-d;l=f.solveCubic(p,d,c,a-r,i,n,s)}return l},getTimeOf:function(t,e){var r=new p(t[0],t[1]),i=new p(t[6],t[7]),n=1e-7;if(null===(e.isClose(r,1e-12)?0:e.isClose(i,1e-12)?1:null))for(var s=[e.x,e.y],a=[],o=0;o<2;o++)for(var h=N.solveCubic(t,o,s[o],a,0,1),u=0;u<h;u++){var l=a[u];if(e.isClose(N.getPoint(t,l),n))return l}return e.isClose(r,n)?0:e.isClose(i,n)?1:null},getNearestTime:function(t,e){if(N.isStraight(t)){var r=t[0],i=t[1],n=t[6]-r,s=t[7]-i,a=n*n+s*s;if(0===a)return 0;var o=((e.x-r)*n+(e.y-i)*s)/a;return o<1e-12?0:o>.999999999999?1:N.getTimeOf(t,new p(r+o*n,i+o*s))}var h=1/0,u=0;function l(r){if(r>=0&&r<=1){var i=e.getDistance(N.getPoint(t,r),!0);if(i<h)return h=i,u=r,!0}}for(var c=0;c<=100;c++)l(c/100);for(var f=.005;f>1e-8;)l(u-f)||l(u+f)||(f/=2);return u},getPart:function(t,e,r){var i=e>r;if(i){var n=e;e=r,r=n}return e>0&&(t=N.subdivide(t,e)[1]),r<1&&(t=N.subdivide(t,(r-e)/(1-e))[0]),i?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],h=t[6],u=t[7],l=3*n-2*r-h,c=3*s-2*i-u,f=3*a-2*h-r,d=3*o-2*u-i;return Math.max(l*l,f*f)+Math.max(c*c,d*d)<=16*e*e},getArea:function(t){var e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7];return 3*((h-r)*(i+s)-(o-e)*(n+a)+n*(e-s)-i*(r-a)+h*(s+e/3)-o*(a+r/3))/20},getBounds:function(t){for(var e=t.slice(0,2),r=e.slice(),i=[0,0],n=0;n<2;n++)N._addBounds(t[n],t[n+2],t[n+4],t[n+6],n,0,e,r,i);return new _(e[0],e[1],r[0]-e[0],r[1]-e[1])},_addBounds:function(t,e,r,i,n,s,a,o,h){function u(t,e){var r=t-e,i=t+e;r<a[n]&&(a[n]=r),i>o[n]&&(o[n]=i)}s/=2;var l=a[n]+s,c=o[n]-s;if(t<l||e<l||r<l||i<l||t>c||e>c||r>c||i>c)if(e<t!=e<i&&r<t!=r<i)u(t,0),u(i,0);else{var d=3*(e-r)-t+i,p=2*(t+r)-4*e,m=e-t,g=f.solveQuadratic(d,p,m,h);u(i,0);for(var v=0;v<g;v++){var _=h[v],b=1-_;1e-8<=_&&_<=.99999999&&u(b*b*b*t+3*b*b*_*e+3*b*_*_*r+_*_*_*i,s)}}}}},a.each(["getBounds","getStrokeBounds","getHandleBounds"],(function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=L[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}}),{}),a.each({isStraight:function(t,e,r,i){if(e.isZero()&&r.isZero())return!0;var n=i.subtract(t);if(n.isZero())return!1;if(n.isCollinear(e)&&n.isCollinear(r)){var s=new x(t,i);if(s.getDistance(t.add(e))<1e-7&&s.getDistance(i.add(r))<1e-7){var a=n.dot(n),o=n.dot(e)/a,h=n.dot(r)/a;return o>=0&&o<=1&&h<=0&&h>=-1}}return!1},isLinear:function(t,e,r,i){var n=i.subtract(t).divide(3);return e.equals(n)&&r.negate().equals(n)}},(function(t,e){this[e]=function(e){var r=this._segment1,i=this._segment2;return t(r._point,r._handleOut,i._handleIn,i._point,e)},this.statics[e]=function(e,r){var i=e[0],n=e[1],s=e[6],a=e[7];return t(new p(i,n),new p(e[2]-i,e[3]-n),new p(e[4]-s,e[5]-a),new p(s,a),r)}}),{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new k(this,t):null},getTimeAt:function(t,e){return N.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=p.read(arguments);return t.isZero()?[]:N.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(p.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return N.getTimeOf(this.getValues(),p.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=p.read(arguments),e=this.getValues(),r=N.getNearestTime(e,t),i=N.getPoint(e,r);return new k(this,r,i,null,t.getDistance(i))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return a.each(t,(function(t){this[t+"At"]=function(e,r){var i=this.getValues();return N[t](i,r?e:N.getTimeAt(i,e))},this[t+"AtTime"]=function(e){return N[t](this.getValues(),e)}}),{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=9*(i-s)+3*(o-e),l=6*(e+s)-12*i,c=3*(i-e),f=9*(n-a)+3*(h-r),d=6*(r+a)-12*n,p=3*(n-r);return function(t){var e=(u*t+l)*t+c,r=(f*t+d)*t+p;return Math.sqrt(e*e+r*r)}}function e(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function i(t,e,r,i){if(null==e||e<0||e>1)return null;var n=t[0],s=t[1],a=t[2],o=t[3],h=t[4],u=t[5],l=t[6],c=t[7],d=f.isZero;d(a-n)&&d(o-s)&&(a=n,o=s),d(h-l)&&d(u-c)&&(h=l,u=c);var m,g,v=3*(a-n),_=3*(h-a)-v,b=l-n-v-_,y=3*(o-s),x=3*(u-o)-y,w=c-s-y-x;if(0===r)m=0===e?n:1===e?l:((b*e+_)*e+v)*e+n,g=0===e?s:1===e?c:((w*e+x)*e+y)*e+s;else{var E=1e-8,M=1-E;if(e<E?(m=v,g=y):e>M?(m=3*(l-h),g=3*(c-u)):(m=(3*b*e+2*_)*e+v,g=(3*w*e+2*x)*e+y),i){0===m&&0===g&&(e<E||e>M)&&(m=h-a,g=u-o);var S=Math.sqrt(m*m+g*g);S&&(m/=S,g/=S)}if(3===r){h=6*b*e+2*_,u=6*w*e+2*x;var A=Math.pow(m*m+g*g,1.5);m=0!==A?(m*u-g*h)/A:0,g=0}}return 2===r?new p(g,-m):new p(m,g)}return{statics:{classify:function(t){var e=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],h=t[6],u=t[7],l=n*(i-u)+s*(h-e)+e*u-i*h,c=3*(a*(s-i)+o*(e-n)+n*i-s*e),d=c-l,p=d-l+(e*(u-o)+i*(a-h)+h*o-u*a),m=Math.sqrt(p*p+d*d+c*c),g=0!==m?1/m:0,v=f.isZero,_="serpentine";function b(t,e,i){var n=e!==r,s=n&&e>0&&e<1,a=n&&i>0&&i<1;return!n||(s||a)&&("loop"!==t||s&&a)||(t="arch",s=a=!1),{type:t,roots:s||a?s&&a?e<i?[e,i]:[i,e]:[s?e:i]:null}}if(d*=g,c*=g,v(p*=g))return v(d)?b(v(c)?"line":"quadratic"):b(_,c/(3*d));var y=3*d*d-4*p*c;if(v(y))return b("cusp",d/(2*p));var x=y>0?Math.sqrt(y/3):Math.sqrt(-y),w=2*p;return b(y>0?_:"loop",(d+x)/w,(d-x)/w)},getLength:function(i,n,s,a){if(n===r&&(n=0),s===r&&(s=1),N.isStraight(i)){var o=i;s<1&&(o=N.subdivide(o,s)[0],n/=s),n>0&&(o=N.subdivide(o,n)[1]);var h=o[6]-o[0],u=o[7]-o[1];return Math.sqrt(h*h+u*u)}return f.integrate(a||t(i),n,s,e(n,s))},getTimeAt:function(i,n,s){if(s===r&&(s=n<0?1:0),0===n)return s;var a=Math.abs,o=n>0,h=o?s:0,u=o?1:s,l=t(i),c=N.getLength(i,h,u,l),d=a(n)-c;if(a(d)<1e-12)return o?u:h;if(d>1e-12)return null;var p=n/c,m=0;return f.findRoot((function(t){return m+=f.integrate(l,s,t,e(s,t)),s=t,m-n}),l,s+p,h,u,32,1e-12)},getPoint:function(t,e){return i(t,e,0,!1)},getTangent:function(t,e){return i(t,e,1,!0)},getWeightedTangent:function(t,e){return i(t,e,1,!1)},getNormal:function(t,e){return i(t,e,2,!0)},getWeightedNormal:function(t,e){return i(t,e,2,!1)},getCurvature:function(t,e){return i(t,e,3,!1).x},getPeaks:function(t){var e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=3*i-e-3*s+t[6],h=3*e-6*i+3*s,u=-3*e+3*i,l=3*n-r-3*a+t[7],c=3*r-6*n+3*a,d=-3*r+3*n,p=[];return f.solveCubic(9*(o*o+l*l),9*(o*h+c*l),2*(h*h+c*c)+3*(u*o+d*l),u*h+c*d,p,1e-8,.99999999),p.sort()}}}},new function(){function t(t,e,r,i,n,s,a){var o=!a&&r.getPrevious()===n,h=!a&&r!==n&&r.getNext()===n,u=1e-8,l=1-u;if(null!==i&&i>=(o?u:0)&&i<=(h?l:1)&&null!==s&&s>=(h?u:0)&&s<=(o?l:1)){var c=new k(r,i,null,a),f=new k(n,s,null,a);c._intersection=f,f._intersection=c,e&&!e(c)||k.insert(t,c,!0)}}function e(i,n,s,a,o,h,u,l,c,f,d,p,m){if(++c>=4096||++l>=40)return c;var g,v,_=n[0],b=n[1],y=n[6],w=n[7],E=x.getSignedDistance,M=E(_,b,y,w,n[2],n[3]),S=E(_,b,y,w,n[4],n[5]),A=M*S>0?3/4:4/9,T=A*Math.min(0,M,S),C=A*Math.max(0,M,S),D=E(_,b,y,w,i[0],i[1]),R=E(_,b,y,w,i[2],i[3]),I=E(_,b,y,w,i[4],i[5]),P=E(_,b,y,w,i[6],i[7]),k=function(t,e,r,i){var n,s=[0,t],a=[1/3,e],o=[2/3,r],h=[1,i],u=e-(2*t+i)/3,l=r-(t+2*i)/3;if(u*l<0)n=[[s,a,h],[s,o,h]];else{var c=u/l;n=[c>=2?[s,a,h]:c<=.5?[s,o,h]:[s,a,o,h],[s,h]]}return(u||l)<0?n.reverse():n}(D,R,I,P),B=k[0],L=k[1];if(0===M&&0===S&&0===D&&0===R&&0===I&&0===P||null==(g=r(B,L,T,C))||null==(v=r(B.reverse(),L.reverse(),T,C)))return c;var O=f+(d-f)*g,F=f+(d-f)*v;if(Math.max(m-p,F-O)<1e-9){var U=(O+F)/2,z=(p+m)/2;t(o,h,u?a:s,u?z:U,u?s:a,u?U:z)}else{i=N.getPart(i,g,v);var G=m-p;if(v-g>.8)if(F-O>G){U=(O+F)/2;c=e(n,(H=N.subdivide(i,.5))[0],a,s,o,h,!u,l,c,p,m,O,U),c=e(n,H[1],a,s,o,h,!u,l,c,p,m,U,F)}else{var H;z=(p+m)/2;c=e((H=N.subdivide(n,.5))[0],i,a,s,o,h,!u,l,c,p,z,O,F),c=e(H[1],i,a,s,o,h,!u,l,c,z,m,O,F)}else c=0===G||G>=1e-9?e(n,i,a,s,o,h,!u,l,c,p,m,O,F):e(i,n,s,a,o,h,u,l,c,O,F,p,m)}return c}function r(t,e,r,n){return t[0][1]<r?i(t,!0,r):e[0][1]>n?i(e,!1,n):t[0][0]}function i(t,e,r){for(var i=t[0][0],n=t[0][1],s=1,a=t.length;s<a;s++){var o=t[s][0],h=t[s][1];if(e?h>=r:h<=r)return h===r?o:i+(r-n)*(o-i)/(h-n);i=o,n=h}return null}function n(t,e,r,i,n){var s=f.isZero;if(s(i)&&s(n)){var a=N.getTimeOf(t,new p(e,r));return null===a?[]:[a]}for(var o=Math.atan2(-n,i),h=Math.sin(o),u=Math.cos(o),l=[],c=[],d=0;d<8;d+=2){var m=t[d]-e,g=t[d+1]-r;l.push(m*u-g*h,m*h+g*u)}return N.solveCubic(l,1,0,c,0,1),c}function s(e,r,i,s,a,o,h){for(var u=r[0],l=r[1],c=n(e,u,l,r[6]-u,r[7]-l),f=0,d=c.length;f<d;f++){var p=c[f],m=N.getPoint(e,p),g=N.getTimeOf(r,m);null!==g&&t(a,o,h?s:i,h?g:p,h?i:s,h?p:g)}}function a(e,r,i,n,s,a){var o=x.intersect(e[0],e[1],e[6],e[7],r[0],r[1],r[6],r[7]);o&&t(s,a,i,N.getTimeOf(e,o),n,N.getTimeOf(r,o))}function o(r,i,n,o,h,l){var c=1e-12,f=Math.min,d=Math.max;if(d(r[0],r[2],r[4],r[6])+c>f(i[0],i[2],i[4],i[6])&&f(r[0],r[2],r[4],r[6])-c<d(i[0],i[2],i[4],i[6])&&d(r[1],r[3],r[5],r[7])+c>f(i[1],i[3],i[5],i[7])&&f(r[1],r[3],r[5],r[7])-c<d(i[1],i[3],i[5],i[7])){var m=u(r,i);if(m)for(var g=0;g<2;g++){var v=m[g];t(h,l,n,v[0],o,v[1],!0)}else{var _=N.isStraight(r),b=N.isStraight(i),y=_&&b,x=_&&!b,w=h.length;if((y?a:_||b?s:e)(x?i:r,x?r:i,x?o:n,x?n:o,h,l,x,0,0,0,1,0,1),!y||h.length===w)for(g=0;g<4;g++){var E=g>>1,M=1&g,S=6*E,A=6*M,T=new p(r[S],r[S+1]),C=new p(i[A],i[A+1]);T.isClose(C,c)&&t(h,l,n,E,o,M)}}}return h}function h(e,r,i,n){var s=N.classify(e);if("loop"===s.type){var a=s.roots;t(i,n,r,a[0],r,a[1])}return i}function u(t,e){function r(t){var e=t[6]-t[0],r=t[7]-t[1];return e*e+r*r}var i=Math.abs,n=x.getDistance,s=1e-7,a=N.isStraight(t),o=N.isStraight(e),h=a&&o,u=r(t)<r(e),l=u?e:t,c=u?t:e,f=l[0],d=l[1],m=l[6]-f,g=l[7]-d;if(n(f,d,m,g,c[0],c[1],!0)<s&&n(f,d,m,g,c[6],c[7],!0)<s)!h&&n(f,d,m,g,l[2],l[3],!0)<s&&n(f,d,m,g,l[4],l[5],!0)<s&&n(f,d,m,g,c[2],c[3],!0)<s&&n(f,d,m,g,c[4],c[5],!0)<s&&(a=o=h=!0);else if(h)return null;if(a^o)return null;for(var v=[t,e],_=[],b=0;b<4&&_.length<2;b++){var y=1&b,w=1^y,E=b>>1,M=N.getTimeOf(v[y],new p(v[w][E?6:0],v[w][E?7:1]));if(null!=M){var S=y?[E,M]:[M,E];(!_.length||i(S[0]-_[0][0])>1e-8&&i(S[1]-_[0][1])>1e-8)&&_.push(S)}if(b>2&&!_.length)break}if(2!==_.length)_=null;else if(!h){var A=N.getPart(t,_[0][0],_[1][0]),T=N.getPart(e,_[0][1],_[1][1]);(i(T[2]-A[2])>s||i(T[3]-A[3])>s||i(T[4]-A[4])>s||i(T[5]-A[5])>s)&&(_=null)}return _}return{getIntersections:function(t){var e=this.getValues(),r=t&&t!==this&&t.getValues();return r?o(e,r,this,t,[]):h(e,this,[])},statics:{getOverlaps:u,getIntersections:function(t,e,r,i,n,s){var a=!e;a&&(e=t);for(var u=t.length,c=e.length,f=new Array(u),d=a?f:new Array(c),p=[],m=0;m<u;m++)f[m]=t[m].getValues(i);if(!a)for(m=0;m<c;m++)d[m]=e[m].getValues(n);for(var g=l.findCurveBoundsCollisions(f,d,1e-7),v=0;v<u;v++){var _=t[v],b=f[v];a&&h(b,_,p,r);var y=g[v];if(y)for(var x=0;x<y.length;x++){if(s&&p.length)return p;var w=y[x];if(!a||w>v){var E=e[w];o(b,d[w],_,E,p,r)}}}return p},getCurveLineIntersections:n,getTimesWithTangent:function(t,e){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],h=t[6],u=t[7],l=e.normalize(),c=l.x,d=l.y,p=3*h-9*a+9*n-3*r,m=3*u-9*o+9*s-3*i,g=6*a-12*n+6*r,v=6*o-12*s+6*i,_=3*n-3*r,b=3*s-3*i,y=2*p*d-2*m*c,x=[];if(Math.abs(y)<f.CURVETIME_EPSILON){if(0!=(y=p*v-m*g)){var w=-(p*b-m*_)/y;w>=0&&w<=1&&x.push(w)}}else{var E=(g*g-4*p*_)*d*d+(-2*g*v+4*m*_+4*p*b)*c*d+(v*v-4*m*b)*c*c,M=g*d-v*c;if(E>=0&&0!=y){var S=Math.sqrt(E),A=-(M+S)/y,T=(-M+S)/y;A>=0&&A<=1&&x.push(A),T>=0&&T<=1&&x.push(T)}}return x}}}}),k=a.extend({_class:"CurveLocation",initialize:function(t,e,r,i,n){if(e>=.99999999){var s=t.getNext();s&&(e=0,t=s)}this._setCurve(t),this._time=e,this._point=r||t.getPointAtTime(e),this._overlap=i,this._distance=n,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),r=this.getTime();0===r?t=e._segment1:1===r?t=e._segment2:null!=r&&(t=e.getPartLength(0,r)<e.getPartLength(r,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function r(t){var r=t&&t.getCurve();if(r&&null!=(e._time=r.getTimeOf(e._point)))return e._setCurve(r),r}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||r(this._segment)||r(this._segment1)||r(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),r=this.getIndex();if(e&&null!=r)for(var i=e.getCurves(),n=0;n<r;n++)t+=i[n].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),r=this.getTime();this._curveOffset=t=null!=r&&e&&e.getPartLength(0,r)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,r=t&&t.splitAtTime(this.getTime());return r&&this._setSegment(e.getLastSegment()),r},equals:function(t,e){var r=this===t;if(!r&&t instanceof k){var i=this.getCurve(),n=t.getCurve(),s=i._path;if(s===n._path){var a=Math.abs,o=a(this.getOffset()-t.getOffset()),h=!e&&this._intersection,u=!e&&t._intersection;r=(o<1e-7||s&&a(s.getLength()-o)<1e-7)&&(!h&&!u||h&&u&&h.equals(u,!0))}}return r},toString:function(){var t=[],e=this.getPoint(),r=c.instance;e&&t.push("point: "+e);var i=this.getIndex();null!=i&&t.push("index: "+i);var n=this.getTime();return null!=n&&t.push("time: "+r.number(n)),null!=this._distance&&t.push("distance: "+r.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),r=t.getCurve();return!(e.isStraight()&&r.isStraight()&&e.getLine().intersect(r.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),r=t.getTime(),i=1e-8,n=1-i,s=e>=i&&e<=n,a=r>=i&&r<=n;if(s&&a)return!this.isTouching();var o=this.getCurve(),h=o&&e<i?o.getPrevious():o,u=t.getCurve(),l=u&&r<i?u.getPrevious():u;if(e>n&&(o=o.getNext()),r>n&&(u=u.getNext()),!(h&&o&&l&&u))return!1;var c=[];function f(t,e){var r=t.getValues(),i=N.classify(r).roots||N.getPeaks(r),n=i.length,s=N.getLength(r,e&&n?i[n-1]:0,!e&&n?i[0]:1);c.push(n?s:s/32)}function d(t,e,r){return e<r?t>e&&t<r:t>e||t<r}s||(f(h,!0),f(o,!1)),a||(f(l,!0),f(u,!1));var p=this.getPoint(),m=Math.min.apply(Math,c),g=s?o.getTangentAtTime(e):o.getPointAt(m).subtract(p),v=s?g.negate():h.getPointAt(-m).subtract(p),_=a?u.getTangentAtTime(r):u.getPointAt(m).subtract(p),b=a?_.negate():l.getPointAt(-m).subtract(p),y=v.getAngle(),x=g.getAngle(),w=b.getAngle(),E=_.getAngle();return!!(s?d(y,w,E)^d(x,w,E)&&d(y,E,w)^d(x,E,w):d(w,y,x)^d(E,y,x)&&d(w,x,y)^d(E,x,y))},hasOverlap:function(){return!!this._overlap}},a.each(N._evaluateMethods,(function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),r=this.getTime();return null!=r&&t&&t[e](r,!0)}}),{preserve:!0}),new function(){function t(t,e,r){var i=t.length,n=0,s=i-1;function a(r,n){for(var s=r+n;s>=-1&&s<=i;s+=n){var a=t[(s%i+i)%i];if(!e.getPoint().isClose(a.getPoint(),1e-7))break;if(e.equals(a))return a}return null}for(;n<=s;){var o,h=n+s>>>1,u=t[h];if(r&&(o=e.equals(u)?u:a(h,-1)||a(h,1)))return e._overlap&&(o._overlap=o._intersection._overlap=!0),o;var l=e.getPath(),c=u.getPath();(l!==c?l._id-c._id:e.getIndex()+e.getTime()-(u.getIndex()+u.getTime()))<0?s=h-1:n=h+1}return t.splice(n,0,e),e}return{statics:{insert:t,expand:function(e){for(var r=e.slice(),i=e.length-1;i>=0;i--)t(r,e[i]._intersection,!1);return r}}}}),B=E.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,r,i;if(a.isPlainObject(t)?(r=t.segments,e=t.pathData):Array.isArray(t)?r=t:"string"==typeof t&&(e=t),r){var n=r[0];i=n&&Array.isArray(n[0])}else e&&(i=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(i?O:L)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,r,i,n=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),s=!1,a=new p,o=new p;function h(t,r){var i=+e[t];return s&&(i+=a[r]),i}function u(t){return new p(h(t,"x"),h(t+1,"y"))}this.clear();for(var l=0,c=n&&n.length;l<c;l++){var f=n[l],d=f[0],m=d.toLowerCase(),v=(e=f.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(s=d===m,"z"!==r||/[mz]/.test(m)||this.moveTo(a),m){case"m":case"l":for(var _="m"===m,b=0;b<v;b+=2)this[_?"moveTo":"lineTo"](a=u(b)),_&&(o=a,_=!1);i=a;break;case"h":case"v":var y="h"===m?"x":"y";a=a.clone();for(b=0;b<v;b++)a[y]=h(b,y),this.lineTo(a);i=a;break;case"c":for(b=0;b<v;b+=6)this.cubicCurveTo(u(b),i=u(b+2),a=u(b+4));break;case"s":for(b=0;b<v;b+=4)this.cubicCurveTo(/[cs]/.test(r)?a.multiply(2).subtract(i):a,i=u(b),a=u(b+2)),r=m;break;case"q":for(b=0;b<v;b+=4)this.quadraticCurveTo(i=u(b),a=u(b+2));break;case"t":for(b=0;b<v;b+=2)this.quadraticCurveTo(i=/[qt]/.test(r)?a.multiply(2).subtract(i):a,a=u(b)),r=m;break;case"a":for(b=0;b<v;b+=7)this.arcTo(a=u(b+5),new g(+e[b],+e[b+1]),+e[b+2],+e[b+4],+e[b+3]);break;case"z":this.closePath(1e-12),a=o}r=m}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,r,i){var n=this===t||!t,s=this._matrix._orNullIfIdentity(),a=n?s:(r||t._matrix)._orNullIfIdentity();return n||this.getBounds(s).intersects(t.getBounds(a),1e-12)?N.getIntersections(this.getCurves(),!n&&t.getCurves(),e,s,a,i):[]},getCrossings:function(t){return this.getIntersections(t,(function(t){return t.isCrossing()}))},getNearestLocation:function(){for(var t=p.read(arguments),e=this.getCurves(),r=1/0,i=null,n=0,s=e.length;n<s;n++){var a=e[n].getNearestLocation(t);a._distance<r&&(r=a._distance,i=a)}return i},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,r){var i=!this._children,n=i?"_segments":"_children",s=t[n],a=e[n],o=this[n];if(!s||!a||s.length!==a.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var h=o.length,u=a.length;if(h<u)for(var l=i?I:L,c=h;c<u;c++)this.add(new l);else h>u&&this[i?"removeSegments":"removeChildren"](u,h);for(c=0;c<u;c++)o[c].interpolate(s[c],a[c],r);i&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var r=this._children||[this],i=t._children?t._children.slice():[t],n=r.length,s=i.length,a=[],o=0;e=!0;for(var h=l.findItemBoundsCollisions(r,i,f.GEOMETRIC_EPSILON),u=n-1;u>=0&&e;u--){var c=r[u];e=!1;var d=h[u];if(d)for(var p=d.length-1;p>=0&&!e;p--)c.compare(i[d[p]])&&(a[d[p]]||(a[d[p]]=!0,o++),e=!0)}e=e&&o===s}return e}}),L=B.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var e=arguments,i=Array.isArray(t)?"object"==typeof t[0]?t:e:!t||t.size!==r||t.x===r&&t.point===r?null:e;i&&i.length>0?this.setSegments(i):(this._curves=r,this._segmentSelection=0,i||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!i&&t)},_equals:function(t){return this._closed===t._closed&&a.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),8&e){if(this._length=this._area=r,32&e)this._version++;else if(this._curves)for(var i=0,n=this._curves.length;i<n;i++)this._curves[i]._changed()}else 64&e&&(this._bounds=r)},getStyle:function(){var t=this._parent;return(t instanceof O?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),i=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=r,i){var n=t[i-1];"boolean"==typeof n&&(this.setClosed(n),i--),this._add(I.readList(t,0,{},i))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var r=this._countCurves();t=this._curves=new Array(r);for(var i=0;i<r;i++)t[i]=new N(this,e[i],e[i+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new N(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var r,i,n,s,a,o,h,u,l=this._segments,f=l.length,d=new c(e),p=new Array(6),m=!0,g=[];function v(e,l){if(e._transformCoordinates(t,p),r=p[0],i=p[1],m)g.push("M"+d.pair(r,i)),m=!1;else if(a=p[2],o=p[3],a===r&&o===i&&h===n&&u===s){if(!l){var c=r-n,f=i-s;g.push(0===c?"v"+d.number(f):0===f?"h"+d.number(c):"l"+d.pair(c,f))}}else g.push("c"+d.pair(h-n,u-s)+" "+d.pair(a-n,o-s)+" "+d.pair(r-n,i-s));n=r,s=i,h=p[4],u=p[5]}if(!f)return"";for(var _=0;_<f;_++)v(l[_]);return this._closed&&f>0&&(v(l[0],!0),g.push("z")),g.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,r=new Array(6),i=0,n=e.length;i<n;i++)e[i]._transformCoordinates(t,r,!0);return!0},_add:function(t,e){for(var r=this._segments,i=this._curves,n=t.length,s=null==e,o=(e=s?r.length:e,0);o<n;o++){var h=t[o];h._path&&(h=t[o]=h.clone()),h._path=this,h._index=e+o,h._selection&&this._updateSelection(h,0,h._selection)}if(s)a.push(r,t);else{r.splice.apply(r,[e,0].concat(t));o=e+n;for(var u=r.length;o<u;o++)r[o]._index=o}if(i){var l=this._countCurves(),c=e>0&&e+n-1===l?e-1:e,f=c,d=Math.min(c+n,l);t._curves&&(i.splice.apply(i,[c,0].concat(t._curves)),f+=t._curves.length);for(o=f;o<d;o++)i.splice(o,0,new N(this,null,null));this._adjustCurves(c,d)}return this._changed(41),t},_adjustCurves:function(t,e){for(var r,i=this._segments,n=this._curves,s=t;s<e;s++)(r=n[s])._path=this,r._segment1=i[s],r._segment2=i[s+1]||i[0],r._changed();(r=n[this._closed&&!t?i.length-1:t-1])&&(r._segment2=i[t]||i[0],r._changed()),(r=n[e])&&(r._segment1=i[e],r._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(I.readList(e)):this._add([I.read(e)])[0]},insert:function(t,e){var r=arguments;return r.length>2&&"number"!=typeof e?this._add(I.readList(r,1),t):this._add([I.read(r,1)],t)[0]},addSegment:function(){return this._add([I.read(arguments)])[0]},insertSegment:function(t){return this._add([I.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(I.readList(t))},insertSegments:function(t,e){return this._add(I.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,r){t=t||0,e=a.pick(e,this._segments.length);var i=this._segments,n=this._curves,s=i.length,o=i.splice(t,e-t),h=o.length;if(!h)return o;for(var u=0;u<h;u++){var l=o[u];l._selection&&this._updateSelection(l,l._selection,0),l._index=l._path=null}u=t;for(var c=i.length;u<c;u++)i[u]._index=u;if(n){var f=t>0&&e===s+(this._closed?1:0)?t-1:t;for(u=(n=n.splice(f,h)).length-1;u>=0;u--)n[u]._path=null;r&&(o._curves=n.slice(1)),this._adjustCurves(f,f)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,r=t.length;e<r;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,r=t.length;e<r;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,r=0,i=t.length;r<i;r++)e+=t[r].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,r=this._closed;t=0;for(var i=0,n=e.length;i<n;i++){var s=i+1===n;t+=N.getArea(N.getValues(e[i],e[s?0:i+1],null,s&&!r))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,r=e.length,i=t?7:0;this._segmentSelection=i*r;for(var n=0;n<r;n++)e[n]._selection=i},_updateSelection:function(t,e,r){t._selection=r,(this._segmentSelection+=r-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,r=this.getLocationAt(t);return r&&(e=r.getCurve().divideAt(r.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),r=e&&e.index,i=e&&e.time;i>.99999999&&(r++,i=0);var n=this.getCurves();if(r>=0&&r<n.length){i>=1e-8&&n[r++].divideAtTime(i);var s,a=this.removeSegments(r,this._segments.length,!0);return this._closed?(this.setClosed(!1),s=this):((s=new L(E.NO_INSERT)).insertAbove(this),s.copyAttributes(this)),s._add(a,0),this.addSegment(a[0]),s}return null},split:function(t,e){var i,n=e===r?t:(i=this.getCurves()[t])&&i.getLocationAtTime(e);return null!=n?this.splitAt(n):null},join:function(t,e){var r=e||0;if(t&&t!==this){var i=t._segments,n=this.getLastSegment(),s=t.getLastSegment();if(!s)return this;n&&n._point.isClose(s._point,r)&&t.reverse();var a=t.getFirstSegment();if(n&&n._point.isClose(a._point,r))n.setHandleOut(a._handleOut),this._add(i.slice(1));else{var o=this.getFirstSegment();o&&o._point.isClose(a._point,r)&&t.reverse(),s=t.getLastSegment(),o&&o._point.isClose(s._point,r)?(o.setHandleIn(s._handleIn),this._add(i.slice(0,i.length-1),0)):this._add(i.slice())}t._closed&&this._add([i[0]]),t.remove()}var h=this.getFirstSegment(),u=this.getLastSegment();return h!==u&&h._point.isClose(u._point,r)&&(h.setHandleIn(u._handleIn),u.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),r=t&&t.simplify,i=r?1e-7:0,n=e.length-1;n>=0;n--){var s=e[n];!s.hasHandles()&&(!s.hasLength(i)||r&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var r=this._segments[t],i=r._handleIn;r._handleIn=r._handleOut,r._handleOut=i,r._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new F(this,t||.25,256,!0).parts,r=e.length,i=[],n=0;n<r;n++)i.push(new I(e[n].curve.slice(0,2)));!this._closed&&r>0&&i.push(new I(e[r-1].curve.slice(6))),this.setSegments(i)},simplify:function(t){var e=new U(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,i=t||{},n=i.type||"asymmetric",s=this._segments,a=s.length,o=this._closed;function h(t,r){var i=t&&t.index;if(null!=i){var n=t.path;if(n&&n!==e)throw new Error(t._class+" "+i+" of "+n+" is not part of "+e);r&&t instanceof N&&i++}else i="number"==typeof t?t:r;return Math.min(i<0&&o?i%a:i<0?i+a:i,a-1)}var u=o&&i.from===r&&i.to===r,l=h(i.from,0),c=h(i.to,a-1);if(l>c)if(o)l-=a;else{var f=l;l=c,c=f}if(/^(?:asymmetric|continuous)$/.test(n)){var d="asymmetric"===n,p=Math.min,m=c-l+1,g=m-1,v=u?p(m,4):1,_=v,b=v,y=[];if(o||(_=p(1,l),b=p(1,a-c-1)),(g+=_+b)<=1)return;for(var x=0,w=l-_;x<=g;x++,w++)y[x]=s[(w<0?w+a:w)%a]._point;var E=y[0]._x+2*y[1]._x,M=y[0]._y+2*y[1]._y,S=2,A=g-1,T=[E],C=[M],D=[S],R=[],I=[];for(x=1;x<g;x++){var P=x<A,k=P?4:d?2:7,B=P?4:d?3:8,L=P?2:d?0:1,O=(P||d?1:2)/S;S=D[x]=k-O,E=T[x]=B*y[x]._x+L*y[x+1]._x-O*E,M=C[x]=B*y[x]._y+L*y[x+1]._y-O*M}R[A]=T[A]/D[A],I[A]=C[A]/D[A];for(x=g-2;x>=0;x--)R[x]=(T[x]-R[x+1])/D[x],I[x]=(C[x]-I[x+1])/D[x];R[g]=(3*y[g]._x-R[A])/2,I[g]=(3*y[g]._y-I[A])/2;x=_;var F=g-b;for(w=l;x<=F;x++,w++){var U=s[w<0?w+a:w],z=U._point,G=R[x]-z._x,H=I[x]-z._y;(u||x<F)&&U.setHandleOut(G,H),(u||x>_)&&U.setHandleIn(-G,-H)}}else for(x=l;x<=c;x++)s[x<0?x+a:x].smooth(i,!u&&x===l,!u&&x===c)},toShape:function(t){if(!this._closed)return null;var e,i,n,s,a,o,h,u=this._segments;function l(t,e){var r=u[t],i=r.getNext(),n=u[e],s=n.getNext();return r._handleOut.isZero()&&i._handleIn.isZero()&&n._handleOut.isZero()&&s._handleIn.isZero()&&i._point.subtract(r._point).isCollinear(s._point.subtract(n._point))}function c(t){var e=u[t],r=e.getNext(),i=e._handleOut,n=r._handleIn,s=.5522847498307936;if(i.isOrthogonal(n)){var a=e._point,o=r._point,h=new x(a,i,!0).intersect(new x(o,n,!0),!0);return h&&f.isZero(i.getLength()/h.subtract(a).getLength()-s)&&f.isZero(n.getLength()/h.subtract(o).getLength()-s)}return!1}function d(t,e){return u[t]._point.getDistance(u[e]._point)}if(!this.hasHandles()&&4===u.length&&l(0,2)&&l(1,3)&&(a=u[1],o=a.getPrevious(),h=a.getNext(),o._handleOut.isZero()&&a._handleIn.isZero()&&a._handleOut.isZero()&&h._handleIn.isZero()&&a._point.subtract(o._point).isOrthogonal(h._point.subtract(a._point)))?(e=A.Rectangle,i=new g(d(0,3),d(0,1)),s=u[1]._point.add(u[2]._point).divide(2)):8===u.length&&c(0)&&c(2)&&c(4)&&c(6)&&l(1,5)&&l(3,7)?(e=A.Rectangle,n=(i=new g(d(1,6),d(0,3))).subtract(new g(d(0,7),d(1,2))).divide(2),s=u[3]._point.add(u[4]._point).divide(2)):4===u.length&&c(0)&&c(1)&&c(2)&&c(3)&&(f.isZero(d(0,2)-d(1,3))?(e=A.Circle,n=d(0,2)/2):(e=A.Ellipse,n=new g(d(2,0)/2,d(3,1)/2)),s=u[1]._point),e){var p=this.getPosition(!0),m=new e({center:p,size:i,radius:n,insert:!1});return m.copyAttributes(this,!0),m._matrix.prepend(this._matrix),m.rotate(s.subtract(p).getAngle()+90),(t===r||t)&&m.insertAbove(this),m}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof O)return t.base.call(this,e);var r=this.getCurves(),i=e.getCurves(),n=r.length,s=i.length;if(!n||!s)return n==s;for(var a,o,h=r[0].getValues(),u=[],l=0,c=0,f=0;f<s;f++){var d=i[f].getValues();if(u.push(d),g=N.getOverlaps(h,d)){a=!f&&g[0][0]>0?s-1:f,o=g[0][1];break}}var p,m=Math.abs;for(d=u[a];h&&d;){var g;if(g=N.getOverlaps(h,d))if(m(g[0][0]-c)<1e-8){1===(c=g[1][0])&&(h=++l<n?r[l].getValues():null,c=0);var v=g[0][1];if(m(v-o)<1e-8){if(p||(p=[a,v]),1===(o=g[1][1])&&(++a>=s&&(a=0),d=u[a]||i[a].getValues(),o=0),!h)return p[0]===a&&p[1]===o;continue}}break}return!1},_hitTestSelf:function(t,e,r,i){var n,s,a,o,h,u,l=this,c=this.getStyle(),f=this._segments,d=f.length,p=this._closed,m=e._tolerancePadding,g=m,v=e.stroke&&c.hasStroke(),_=e.fill&&c.hasFill(),b=e.curves,y=v?c.getStrokeWidth()/2:_&&e.tolerance>0||b?0:null;function x(e,r){return t.subtract(e).divide(r).length<=1}function w(t,r,i){if(!e.selected||r.isSelected()){var n=t._point;if(r!==n&&(r=r.add(n)),x(r,g))return new R(i,l,{segment:t,point:r})}}function E(t,r){return(r||e.segments)&&w(t,t._point,"segment")||!r&&e.handles&&(w(t,t._handleIn,"handle-in")||w(t,t._handleOut,"handle-out"))}function M(t){o.add(t)}function S(e){var r,h=p||e._index>0&&e._index<d-1;return"round"===(h?n:s)?x(e._point,g):(o=new L({internal:!0,closed:!0}),h?e.isSmooth()||L._addBevelJoin(e,n,y,a,null,i,M,!0):"square"===s&&L._addSquareCap(e,s,y,null,i,M,!0),o.isEmpty()?void 0:o.contains(t)||(r=o.getNearestLocation(t))&&x(r.getPoint(),m))}if(null!==y&&(y>0?(n=c.getStrokeJoin(),s=c.getStrokeCap(),a=c.getMiterLimit(),g=g.add(L._getStrokePadding(y,i))):n=s="round"),!e.ends||e.segments||p){if(e.segments||e.handles)for(var A=0;A<d;A++)if(u=E(f[A]))return u}else if(u=E(f[0],!0)||E(f[d-1],!0))return u;if(null!==y){if(h=this.getNearestLocation(t)){var T=h.getTime();0===T||1===T&&d>1?S(h.getSegment())||(h=null):x(h.getPoint(),g)||(h=null)}if(!h&&"miter"===n&&d>1)for(A=0;A<d;A++){var C=f[A];if(t.getDistance(C._point)<=a*y&&S(C)){h=C.getLocation();break}}}return!h&&_&&this._contains(t)||h&&!v&&!b?new R("fill",this):h?new R(v?"stroke":"curve",this,{location:h,point:h.getPoint()}):null}},a.each(N._evaluateMethods,(function(t){this[t+"At"]=function(e){var r=this.getLocationAt(e);return r&&r[t]()}}),{beans:!1,getLocationOf:function(){for(var t=p.read(arguments),e=this.getCurves(),r=0,i=e.length;r<i;r++){var n=e[r].getLocationOf(t);if(n)return n}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),r=0,i=0,n=e.length;i<n;i++){var s=r,a=e[i];if((r+=a.getLength())>t)return a.getLocationAt(t-s)}if(e.length>0&&t<=this.getLength())return new k(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=p.read(arguments);if(t.isZero())return[];for(var e=[],r=0,i=this.getCurves(),n=0,s=i.length;n<s;n++){for(var a=i[n],o=a.getTimesWithTangent(t),h=0,u=o.length;h<u;h++){var l=r+a.getOffsetAtTime(o[h]);e.indexOf(l)<0&&e.push(l)}r+=a.length}return e}}),new function(){function t(t,e,r){var i,n,s,a,o,h,u,l,c=e._segments,f=c.length,d=new Array(6),p=!0;function m(e){if(r)e._transformCoordinates(r,d),i=d[0],n=d[1];else{var c=e._point;i=c._x,n=c._y}if(p)t.moveTo(i,n),p=!1;else{if(r)o=d[2],h=d[3];else{var f=e._handleIn;o=i+f._x,h=n+f._y}o===i&&h===n&&u===s&&l===a?t.lineTo(i,n):t.bezierCurveTo(u,l,o,h,i,n)}if(s=i,a=n,r)u=d[4],l=d[5];else{f=e._handleOut;u=s+f._x,l=a+f._y}}for(var g=0;g<f;g++)m(c[g]);e._closed&&f>0&&m(c[0])}return{_draw:function(e,r,i,n){var s=r.dontStart,a=r.dontFinish||r.clip,o=this.getStyle(),h=o.hasFill(),u=o.hasStroke(),l=o.getDashArray(),c=!ot.support.nativeDash&&u&&l&&l.length;function f(t){return l[(t%c+c)%c]}if(s||e.beginPath(),(h||u&&!c||a)&&(t(e,this,n),this._closed&&e.closePath()),!a&&(h||u)&&(this._setStyles(e,r,i),h&&(e.fill(o.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),u)){if(c){s||e.beginPath();for(var d,p=new F(this,.25,32,!1,n),m=p.length,g=-o.getDashOffset(),v=0;g>0;)g-=f(v--)+f(v--);for(;g<m;)d=g+f(v++),(g>0||d>0)&&p.drawPart(e,Math.max(g,0),Math.max(d,0)),g=d+f(v++)}e.stroke()}},_drawSelected:function(e,r){e.beginPath(),t(e,this,r),e.stroke(),function(t,e,r,i){if(!(i<=0))for(var n,s,a=i/2,o=i-2,h=a-1,u=new Array(6),l=0,c=e.length;l<c;l++){var f=e[l],d=f._selection;if(f._transformCoordinates(r,u),n=u[0],s=u[1],2&d&&m(2),4&d&&m(4),t.fillRect(n-a,s-a,i,i),o>0&&!(1&d)){var p=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(n-h,s-h,o,o),t.fillStyle=p}}function m(e){var r=u[e],i=u[e+1];n==r&&s==i||(t.beginPath(),t.moveTo(n,s),t.lineTo(r,i),t.stroke(),t.beginPath(),t.arc(r,i,a,0,2*Math.PI,!0),t.fill())}}(e,this._segments,r,ot.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new I(p.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new I(p.read(arguments))])},cubicCurveTo:function(){var e=arguments,r=p.read(e),i=p.read(e),n=p.read(e),s=t(this);s.setHandleOut(r.subtract(s._point)),this._add([new I(n,i.subtract(n))])},quadraticCurveTo:function(){var e=arguments,r=p.read(e),i=p.read(e),n=t(this)._point;this.cubicCurveTo(r.add(n.subtract(r).multiply(1/3)),r.add(i.subtract(r).multiply(1/3)),i)},curveTo:function(){var e=arguments,r=p.read(e),i=p.read(e),n=a.pick(a.read(e),.5),s=1-n,o=t(this)._point,h=r.subtract(o.multiply(s*s)).subtract(i.multiply(n*n)).divide(2*n*s);if(h.isNaN())throw new Error("Cannot put a curve through points with parameter = "+n);this.quadraticCurveTo(h,i)},arcTo:function(){var e,r,i,n,s=arguments,o=Math.abs,h=Math.sqrt,u=t(this),l=u._point,c=p.read(s),d=a.peek(s);if("boolean"==typeof(w=a.pick(d,!0)))var m=(M=l.add(c).divide(2)).add(M.subtract(l).rotate(w?-90:90));else if(a.remain(s)<=2)m=c,c=p.read(s);else if(!l.equals(c)){var v=g.read(s),_=f.isZero;if(_(v.width)||_(v.height))return this.lineTo(c);var b=a.read(s),w=!!a.read(s),E=!!a.read(s),M=l.add(c).divide(2),S=(Y=l.subtract(M).rotate(-b)).x,A=Y.y,T=o(v.width),C=o(v.height),D=T*T,R=C*C,P=S*S,N=A*A,k=h(P/D+N/R);if(k>1&&(D=(T*=k)*T,R=(C*=k)*C),o(k=(D*R-D*N-R*P)/(D*N+R*P))<1e-12&&(k=0),k<0)throw new Error("Cannot create an arc with the given arguments");e=new p(T*A/C,-C*S/T).multiply((E===w?-1:1)*h(k)).rotate(b).add(M),r=(i=(n=(new y).translate(e).rotate(b).scale(T,C))._inverseTransform(l)).getDirectedAngle(n._inverseTransform(c)),!w&&r>0?r-=360:w&&r<0&&(r+=360)}if(m){var B=new x(l.add(m).divide(2),m.subtract(l).rotate(90),!0),L=new x(m.add(c).divide(2),c.subtract(m).rotate(90),!0),O=new x(l,c),F=O.getSide(m);if(!(e=B.intersect(L,!0))){if(!F)return this.lineTo(c);throw new Error("Cannot create an arc with the given arguments")}r=(i=l.subtract(e)).getDirectedAngle(c.subtract(e));var U=O.getSide(e,!0);0===U?r=F*o(r):F===U&&(r+=r<0?360:-360)}if(r){for(var z=1e-5,G=o(r),H=G>=360?4:Math.ceil((G-z)/90),j=r/H,V=j*Math.PI/360,W=4/3*Math.sin(V)/(1+Math.cos(V)),q=[],X=0;X<=H;X++){var Y=c,Z=null;if(X<H&&(Z=i.rotate(90).multiply(W),n?(Y=n._transformPoint(i),Z=n._transformPoint(i.add(Z)).subtract(Y)):Y=e.add(i)),X){var $=i.rotate(-90).multiply(W);n&&($=n._transformPoint(i.add($)).subtract(Y)),q.push(new I(Y,$,Z))}else u.setHandleOut(Z);i=i.rotate(j)}this._add(q)}},lineBy:function(){var e=p.read(arguments),r=t(this)._point;this.lineTo(r.add(e))},curveBy:function(){var e=arguments,r=p.read(e),i=p.read(e),n=a.read(e),s=t(this)._point;this.curveTo(s.add(r),s.add(i),n)},cubicCurveBy:function(){var e=arguments,r=p.read(e),i=p.read(e),n=p.read(e),s=t(this)._point;this.cubicCurveTo(s.add(r),s.add(i),s.add(n))},quadraticCurveBy:function(){var e=arguments,r=p.read(e),i=p.read(e),n=t(this)._point;this.quadraticCurveTo(n.add(r),n.add(i))},arcBy:function(){var e=arguments,r=t(this)._point,i=r.add(p.read(e)),n=a.pick(a.peek(e),!0);"boolean"==typeof n?this.arcTo(i,n):this.arcTo(i,r.add(p.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){var r=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return L[r](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,r,i,n,s){var a=t[0];if(!a)return new _;var o=new Array(6),h=a._transformCoordinates(i,new Array(6)),u=h.slice(0,2),l=u.slice(),c=new Array(2);function f(t){t._transformCoordinates(i,o);for(var e=0;e<2;e++)N._addBounds(h[e],h[e+4],o[e+2],o[e],e,s?s[e]:0,u,l,c);var r=h;h=o,o=r}for(var d=1,p=t.length;d<p;d++)f(t[d]);return e&&f(a),new _(u[0],u[1],l[0]-u[0],l[1]-u[1])},getStrokeBounds:function(t,e,r,i,n){var s=r.getStyle(),a=s.hasStroke(),o=s.getStrokeWidth(),h=a&&r._getStrokeMatrix(i,n),u=a&&L._getStrokePadding(o,h),l=L.getBounds(t,e,r,i,n,u);if(!a)return l;var c=o/2,f=s.getStrokeJoin(),d=s.getStrokeCap(),p=s.getMiterLimit(),m=new _(new g(u));function v(t){l=l.include(t)}function b(t){l=l.unite(m.setCenter(t._point.transform(i)))}function y(t,e){"round"===e||t.isSmooth()?b(t):L._addBevelJoin(t,e,c,p,i,h,v)}function x(t,e){"round"===e?b(t):L._addSquareCap(t,e,c,i,h,v)}var w=t.length-(e?0:1);if(w>0){for(var E=1;E<w;E++)y(t[E],f);e?y(t[0],f):(x(t[0],d),x(t[t.length-1],d))}return l},_getStrokePadding:function(t,e){if(!e)return[t,t];var r=new p(t,0).transform(e),i=new p(0,t).transform(e),n=r.getAngleInRadians(),s=r.getLength(),a=i.getLength(),o=Math.sin(n),h=Math.cos(n),u=Math.tan(n),l=Math.atan2(a*u,s),c=Math.atan2(a,u*s);return[Math.abs(s*Math.cos(l)*h+a*Math.sin(l)*o),Math.abs(a*Math.sin(c)*h+s*Math.cos(c)*o)]},_addBevelJoin:function(t,e,r,i,n,s,a,o){var h=t.getCurve(),u=h.getPrevious(),l=h.getPoint1().transform(n),c=u.getNormalAtTime(1).multiply(r).transform(s),f=h.getNormalAtTime(0).multiply(r).transform(s),d=c.getDirectedAngle(f);if((d<0||d>=180)&&(c=c.negate(),f=f.negate()),o&&a(l),a(l.add(c)),"miter"===e){var m=new x(l.add(c),new p(-c.y,c.x),!0).intersect(new x(l.add(f),new p(-f.y,f.x),!0),!0);m&&l.getDistance(m)<=i*r&&a(m)}a(l.add(f))},_addSquareCap:function(t,e,r,i,n,s,a){var o=t._point.transform(i),h=t.getLocation(),u=h.getNormal().multiply(0===h.getTime()?r:-r).transform(n);"square"===e&&(a&&(s(o.subtract(u)),s(o.add(u))),o=o.add(u.rotate(-90))),s(o.add(u)),s(o.subtract(u))},getHandleBounds:function(t,e,r,i,n){var s,a,o=r.getStyle();if(n.stroke&&o.hasStroke()){var h=r._getStrokeMatrix(i,n),u=o.getStrokeWidth()/2,l=u;"miter"===o.getStrokeJoin()&&(l=u*o.getMiterLimit()),"square"===o.getStrokeCap()&&(l=Math.max(l,u*Math.SQRT2)),s=L._getStrokePadding(u,h),a=L._getStrokePadding(l,h)}for(var c=new Array(6),f=1/0,d=-f,p=f,m=d,g=0,v=t.length;g<v;g++){t[g]._transformCoordinates(i,c);for(var b=0;b<6;b+=2){var y=b?s:a,x=y?y[0]:0,w=y?y[1]:0,E=c[b],M=c[b+1],S=E-x,A=E+x,T=M-w,C=M+w;S<f&&(f=S),A>d&&(d=A),T<p&&(p=T),C>m&&(m=C)}}return new _(f,p,d-f,m-p)}}});L.inject({statics:new function(){var t=.5522847498307936,e=[new I([-1,0],[0,t],[0,-t]),new I([0,-1],[-t,0],[t,0]),new I([1,0],[0,-t],[0,t]),new I([0,1],[t,0],[-t,0])];function r(t,e,r){var i=a.getNamed(r),n=new L(i&&(1==i.insert?E.INSERT:0==i.insert?E.NO_INSERT:null));return n._add(t),n._closed=e,n.set(i,E.INSERT)}function i(t,i,n){for(var s=new Array(4),a=0;a<4;a++){var o=e[a];s[a]=new I(o._point.multiply(i).add(t),o._handleIn.multiply(i),o._handleOut.multiply(i))}return r(s,!0,n)}return{Line:function(){var t=arguments;return r([new I(p.readNamed(t,"from")),new I(p.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,e=p.readNamed(t,"center"),r=a.readNamed(t,"radius");return i(e,new g(r),t)},Rectangle:function(){var e,i=arguments,n=_.readNamed(i,"rectangle"),s=g.readNamed(i,"radius",0,{readNull:!0}),a=n.getBottomLeft(!0),o=n.getTopLeft(!0),h=n.getTopRight(!0),u=n.getBottomRight(!0);if(!s||s.isZero())e=[new I(a),new I(o),new I(h),new I(u)];else{var l=(s=g.min(s,n.getSize(!0).divide(2))).width,c=s.height,f=l*t,d=c*t;e=[new I(a.add(l,0),null,[-f,0]),new I(a.subtract(0,c),[0,d]),new I(o.add(0,c),null,[0,-d]),new I(o.add(l,0),[-f,0],null),new I(h.subtract(l,0),null,[f,0]),new I(h.add(0,c),[0,-d],null),new I(u.subtract(0,c),null,[0,d]),new I(u.subtract(l,0),[f,0])]}return r(e,!0,i)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=A._readEllipse(t);return i(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=p.readNamed(t,"from"),r=p.readNamed(t,"through"),i=p.readNamed(t,"to"),n=a.getNamed(t),s=new L(n&&0==n.insert&&E.NO_INSERT);return s.moveTo(e),s.arcTo(r,i),s.set(n)},RegularPolygon:function(){for(var t=arguments,e=p.readNamed(t,"center"),i=a.readNamed(t,"sides"),n=a.readNamed(t,"radius"),s=360/i,o=i%3==0,h=new p(0,o?-n:n),u=o?-1:.5,l=new Array(i),c=0;c<i;c++)l[c]=new I(e.add(h.rotate((c+u)*s)));return r(l,!0,t)},Star:function(){for(var t=arguments,e=p.readNamed(t,"center"),i=2*a.readNamed(t,"points"),n=a.readNamed(t,"radius1"),s=a.readNamed(t,"radius2"),o=360/i,h=new p(0,-1),u=new Array(i),l=0;l<i;l++)u[l]=new I(e.add(h.rotate(o*l).multiply(l%2?s:n)));return r(u,!0,t)}}}});var O=B.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,r){var i=r,n=i[0];n&&"number"==typeof n[0]&&(i=[i]);for(var s=r.length-1;s>=0;s--){var o=i[s];i!==r||o instanceof L||(i=a.slice(i)),Array.isArray(o)?i[s]=new L({segments:o,insert:!1}):o instanceof O&&(i.splice.apply(i,[s,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,i)},reduce:function t(e){for(var r=this._children,i=r.length-1;i>=0;i--){var n;(n=r[i].reduce(e)).isEmpty()&&n.remove()}return r.length?t.base.call(this):((n=new L(E.NO_INSERT)).copyAttributes(this),n.insertAbove(this),this.remove(),n)},isClosed:function(){for(var t=this._children,e=0,r=t.length;e<r;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,r=0,i=e.length;r<i;r++)e[r].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],r=0,i=t.length;r<i;r++)a.push(e,t[r].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,r=0,i=t.length;r<i;r++)e+=t[r].getArea();return e},getLength:function(){for(var t=this._children,e=0,r=0,i=t.length;r<i;r++)e+=t[r].getLength();return e},getPathData:function(t,e){for(var r=this._children,i=[],n=0,s=r.length;n<s;n++){var a=r[n],o=a._matrix;i.push(a.getPathData(t&&!o.isIdentity()?t.appended(o):t,e))}return i.join("")},_hitTestChildren:function t(e,r,i){return t.base.call(this,e,r.class===L||"path"===r.type?r:a.set({},r,{fill:!1}),i)},_draw:function(t,e,r,i){var n=this._children;if(n.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var s=0,a=n.length;s<a;s++)n[s].draw(t,e,i);if(!e.clip){this._setStyles(t,e,r);var o=this._style;o.hasFill()&&(t.fill(o.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,r){for(var i=this._children,n=0,s=i.length;n<s;n++){var a=i[n],o=a._matrix;r[a._id]||a._drawSelected(t,o.isIdentity()?e:e.appended(o))}}},new function(){function t(t,e){var r=t._children;if(e&&!r.length)throw new Error("Use a moveTo() command first");return r[r.length-1]}return a.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],(function(e){this[e]=function(){var r=t(this,!0);r[e].apply(r,arguments)}}),{moveTo:function(){var e=t(this),r=e&&e.isEmpty()?e:new L(E.NO_INSERT);r!==e&&this.addChild(r),r.moveTo.apply(r,arguments)},moveBy:function(){var e=t(this,!0),r=e&&e.getLastSegment(),i=p.read(arguments);this.moveTo(r?i.add(r._point):i)},closePath:function(e){t(this,!0).closePath(e)}})},a.each(["reverse","flatten","simplify","smooth"],(function(t){this[t]=function(e){for(var r,i=this._children,n=0,s=i.length;n<s;n++)r=i[n][t](e)||r;return r}}),{}));B.inject(new function(){var t=Math.min,e=Math.max,i=Math.abs,n={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function s(t){return t._children||[t]}function o(t,e){var r=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var i=s(r),n=0,a=i.length;n<a;n++){(t=i[n])._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0))}r=r.resolveCrossings().reorient("nonzero"===r.getFillRule(),!0)}return r}function h(t,e,r,i,n){var s=new O(E.NO_INSERT);return s.addChildren(t,!0),s=s.reduce({simplify:e}),n&&0==n.insert||s.insertAbove(i&&r.isSibling(i)&&r.getIndex()<i.getIndex()?i:r),s.copyAttributes(r,!0),s}function u(t){return t.hasOverlap()||t.isCrossing()}function c(t,e,r,i){if(i&&(0==i.trace||i.stroke)&&/^(subtract|intersect)$/.test(r))return d(t,e,r);var c=o(t,!0),f=e&&t!==e&&o(e,!0),p=n[r];p[r]=!0,f&&(p.subtract||p.exclude)^f.isClockwise()^c.isClockwise()&&f.reverse();var m,_=v(k.expand(c.getIntersections(f,u))),x=s(c),w=f&&s(f),E=[],M=[];function S(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];a.push(E,i._segments),a.push(M,i.getCurves()),i._overlapsOnly=!0}}function A(t){for(var e=[],r=0,i=t&&t.length;r<i;r++)e.push(M[t[r]]);return e}if(_.length){S(x),w&&S(w);for(var T=new Array(M.length),C=0,D=M.length;C<D;C++)T[C]=M[C].getValues();var R=l.findCurveBoundsCollisions(T,T,0,!0),I={};for(C=0;C<M.length;C++){var P=M[C],N=P._path._id;(I[N]=I[N]||{})[P.getIndex()]={hor:A(R[C].hor),ver:A(R[C].ver)}}for(C=0,D=_.length;C<D;C++)b(_[C]._segment,c,f,I,p);for(C=0,D=E.length;C<D;C++){var B=E[C],L=B._intersection;B._winding||b(B,c,f,I,p),L&&L._overlap||(B._path._overlapsOnly=!1)}m=y(E,p)}else m=g(w?x.concat(w):x.slice(),(function(t){return!!p[t]}));return h(m,!0,t,e,i)}function d(t,e,r){var i=o(t),n=o(e),s=i.getIntersections(n,u),a="subtract"===r,l="divide"===r,c={},f=[];function d(t){if(!c[t._id]&&(l||n.contains(t.getPointAt(t.getLength()/2))^a))return f.unshift(t),c[t._id]=!0}for(var p=s.length-1;p>=0;p--){var m=s[p].split();m&&(d(m)&&m.getFirstSegment().setHandleIn(0,0),i.getLastSegment().setHandleOut(0,0))}return d(i),h(f,!1,t,e)}function p(t,e){for(var r=t;r;){if(r===e)return;r=r._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function m(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function g(t,e,r){var n=t&&t.length;if(n){var s=a.each(t,(function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}}),{}),o=t.slice().sort((function(t,e){return i(e.getArea())-i(t.getArea())})),h=o[0],u=l.findItemBoundsCollisions(o,null,f.GEOMETRIC_EPSILON);null==r&&(r=h.isClockwise());for(var c=0;c<n;c++){var d=o[c],p=s[d._id],m=0,g=u[c];if(g)for(var v=null,_=g.length-1;_>=0;_--)if(g[_]<c){v=v||d.getInteriorPoint();var b=o[g[_]];if(b.contains(v)){var y=s[b._id];m=y.winding,p.winding+=m,p.container=y.exclude?y.container:b;break}}if(e(p.winding)===e(m))p.exclude=!0,t[p.index]=null;else{var x=p.container;d.setClockwise(x?!x.isClockwise():r)}}}return t}function v(t,e,r){var i,n,s,a=e&&[],o=1e-8,h=!1,u=r||[],l=r&&{};function c(t){return t._path._id+"."+t._segment1._index}for(var f=(r&&r.length)-1;f>=0;f--){(d=r[f])._path&&(l[c(d)]=!0)}for(f=t.length-1;f>=0;f--){var d,g,v=t[f],_=v._time,b=_,y=e&&!e(v);if((d=v._curve)&&(d!==n?(h=!d.hasHandles()||l&&l[c(d)],i=[],s=null,n=d):s>=o&&(_/=s)),y)i&&i.push(v);else{if(e&&a.unshift(v),s=b,_<o)g=d._segment1;else if(_>.99999999)g=d._segment2;else{var x=d.divideAtTime(_,!0);h&&u.push(d,x),g=x._segment1;for(var w=i.length-1;w>=0;w--){var E=i[w];E._time=(E._time-_)/(1-_)}}v._setSegment(g);var M=g._intersection,S=v._intersection;if(M){p(M,S);for(var A=M;A;)p(A._intersection,M),A=A._next}else g._intersection=S}}return r||m(u),a||t}function _(r,n,s,a,o){var h,u,l=Array.isArray(n)?n:n[s?"hor":"ver"],c=s?1:0,f=1^c,d=[r.x,r.y],p=d[c],m=d[f],g=1e-6,v=p-1e-9,b=p+1e-9,y=0,x=0,w=0,E=0,M=!1,S=!1,A=1,T=[];function C(i){var u=i[f+0],l=i[f+6];if(!(m<t(u,l)||m>e(u,l))){var d=i[c+0],y=i[c+2],x=i[c+4],S=i[c+6];if(u!==l){var C=m===u?0:m===l||v>e(d,y,x,S)||b<t(d,y,x,S)?1:N.solveCubic(i,f,m,T,0,1)>0?T[0]:1,D=0===C?d:1===C?S:N.getPoint(i,C)[s?"y":"x"],R=u>l?1:-1,I=h[f]>h[f+6]?1:-1,P=h[c+6];return m!==u?(D<v?w+=R:D>b?E+=R:M=!0,D>p-g&&D<p+g&&(A/=2)):(R!==I?d<v?w+=R:d>b&&(E+=R):d!=P&&(P<b&&D>b?(E+=R,M=!0):P>v&&D<v&&(w+=R,M=!0)),A/=4),h=i,!o&&D>v&&D<b&&0===N.getTangent(i,C)[s?"x":"y"]&&_(r,n,!s,a,!0)}(d<b&&S>v||S<b&&d>v)&&(M=!0)}}function D(r){var i=r[f+0],n=r[f+2],a=r[f+4],o=r[f+6];if(m<=e(i,n,a,o)&&m>=t(i,n,a,o))for(var h,u=r[c+0],l=r[c+2],d=r[c+4],p=r[c+6],g=v>e(u,l,d,p)||b<t(u,l,d,p)?[r]:N.getMonoCurves(r,s),_=0,y=g.length;_<y;_++)if(h=C(g[_]))return h}for(var R=0,I=l.length;R<I;R++){var P,k=l[R],B=k._path,L=k.getValues();if(!(R&&l[R-1]._path===B||(h=null,B._closed||(u=N.getValues(B.getLastCurve().getSegment2(),k.getSegment1(),null,!a))[f]!==u[f+6]&&(h=u),h))){h=L;for(var O=B.getLastCurve();O&&O!==k;){var F=O.getValues();if(F[f]!==F[f+6]){h=F;break}O=O.getPrevious()}}if(P=D(L))return P;if(R+1===I||l[R+1]._path!==B){if(u&&(P=D(u)))return P;!M||w||E||(w=E=B.isClockwise(a)^s?1:-1),y+=w,x+=E,w=E=0,M&&(S=!0,M=!1),u=null}}return y=i(y),x=i(x),{winding:e(y,x),windingL:y,windingR:x,quality:A,onPath:S}}function b(t,e,r,n,s){var a=[],o=t,h=0;do{if(b=t.getCurve()){var u=b.getLength();a.push({segment:t,curve:b,length:u}),h+=u}t=t.getNext()}while(t&&!t._intersection&&t!==o);for(var l=[.5,.25,.75],c={winding:0,quality:-1},d=0;d<l.length&&c.quality<.5;d++){u=h*l[d];for(var p=0,m=a.length;p<m;p++){var g=a[p],v=g.length;if(u<=v){var b,y=(b=g.curve)._path,x=y._parent,w=x instanceof O?x:y,E=f.clamp(b.getTimeAt(u),.001,.999),M=b.getPointAtTime(E),S=i(b.getTangentAtTime(E).y)<Math.SQRT1_2,A=null;if(s.subtract&&r){var T=(w===e?r:e)._getWinding(M,S,!0);if(w===e&&T.winding||w===r&&!T.winding){if(T.quality<1)continue;A={winding:0,quality:1}}}(A=A||_(M,n[y._id][b.getIndex()],S,!0)).quality>c.quality&&(c=A);break}u-=v}}for(p=a.length-1;p>=0;p--)a[p].segment._winding=c}function y(t,e){var r,i=[];function n(t){var r;return!(!t||t._visited||e&&(!e[(r=t._winding||{}).winding]||e.unite&&2===r.winding&&r.windingL&&r.windingR))}function s(t){if(t)for(var e=0,i=r.length;e<i;e++)if(t===r[e])return!0;return!1}function a(t){for(var e=t._segments,r=0,i=e.length;r<i;r++)e[r]._visited=!0}function o(t,e){var i=t._intersection,a=i,o=[];function h(i,a){for(;i&&i!==a;){var h=i._segment,u=h&&h._path;if(u){var l=h.getNext()||u.getFirstSegment(),c=l._intersection;h!==t&&(s(h)||s(l)||l&&n(h)&&(n(l)||c&&n(c._segment)))&&o.push(h),e&&r.push(h)}i=i._next}}if(e&&(r=[t]),i){for(h(i);i&&i._previous;)i=i._previous;h(i,a)}return o}t.sort((function(t,e){var r=t._intersection,i=e._intersection,n=!(!r||!r._overlap),s=!(!i||!i._overlap),a=t._path,o=e._path;return n^s?n?1:-1:!r^!i?r?1:-1:a!==o?a._id-o._id:t._index-e._index}));for(var h=0,u=t.length;h<u;h++){var l,c,f,d=t[h],p=n(d),m=null,g=!1,v=!0,_=[];if(p&&d._path._overlapsOnly){var b=d._path,y=d._intersection._segment._path;b.compare(y)&&(b.getArea()&&i.push(b.clone(!1)),a(b),a(y),p=!1)}for(;p;){var x=!m,w=o(d,x),M=w.shift(),S=!(g=!x&&(s(d)||s(M)))&&M;if(x&&(m=new L(E.NO_INSERT),l=null),g){(d.isFirst()||d.isLast())&&(v=d._path._closed),d._visited=!0;break}if(S&&l&&(_.push(l),l=null),l||(S&&w.push(d),l={start:m._segments.length,crossings:w,visited:c=[],handleIn:f}),S&&(d=M),!n(d)){m.removeSegments(l.start);for(var A=0,T=c.length;A<T;A++)c[A]._visited=!1;c.length=0;do{(d=l&&l.crossings.shift())&&d._path||(d=null,(l=_.pop())&&(c=l.visited,f=l.handleIn))}while(l&&!n(d));if(!d)break}var C=d.getNext();m.add(new I(d._point,f,C&&d._handleOut)),d._visited=!0,c.push(d),d=C||d._path.getFirstSegment(),f=C&&C._handleIn}g&&(v&&(m.getFirstSegment().setHandleIn(f),m.setClosed(v)),0!==m.getArea()&&i.push(m))}return i}return{_getWinding:function(t,e,r){return _(t,this.getCurves(),e,r)},unite:function(t,e){return c(this,t,"unite",e)},intersect:function(t,e){return c(this,t,"intersect",e)},subtract:function(t,e){return c(this,t,"subtract",e)},exclude:function(t,e){return c(this,t,"exclude",e)},divide:function(t,e){return e&&(0==e.trace||e.stroke)?d(this,t,"divide"):h([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function r(t,e){var r=t&&t._intersection;return r&&r._overlap&&r._path===e}var i=!1,n=!1,s=this.getIntersections(null,(function(t){return t.hasOverlap()&&(i=!0)||t.isCrossing()&&(n=!0)})),o=i&&n&&[];if(s=k.expand(s),i)for(var h=v(s,(function(t){return t.hasOverlap()}),o),u=h.length-1;u>=0;u--){var l=h[u],c=l._path,f=l._segment,d=f.getPrevious(),p=f.getNext();r(d,c)&&r(p,c)&&(f.remove(),d._handleOut._set(0,0),p._handleIn._set(0,0),d===f||d.getCurve().hasLength()||(p._handleIn.set(d._handleIn),d.remove()))}n&&(v(s,i&&function(t){var e=t.getCurve(),r=t.getSegment(),i=t._intersection,n=i._curve,s=i._segment;if(e&&n&&e._path&&n._path)return!0;r&&(r._intersection=null),s&&(s._intersection=null)},o),o&&m(o),e=y(a.each(e,(function(t){a.push(this,t._segments)}),[])));var g,_=e.length;return _>1&&t?(e!==t&&this.setChildren(e),g=this):1!==_||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),g=this),g||((g=new O(E.NO_INSERT)).addChildren(e),(g=g.reduce()).copyAttributes(this),this.replaceWith(g)),g},reorient:function(t,e){var i=this._children;return i&&i.length?this.setChildren(g(this.removeChildren(),(function(e){return!!(t?e:1&e)}),e)):e!==r&&this.setClockwise(e),this},getInteriorPoint:function(){var r=this.getBounds().getCenter(!0);if(!this.contains(r)){for(var i=this.getCurves(),n=r.y,s=[],a=[],o=0,h=i.length;o<h;o++){var u=i[o].getValues(),l=u[1],c=u[3],f=u[5],d=u[7];if(n>=t(l,c,f,d)&&n<=e(l,c,f,d))for(var p=N.getMonoCurves(u),m=0,g=p.length;m<g;m++){var v=p[m],_=v[1],b=v[7];if(_!==b&&(n>=_&&n<=b||n>=b&&n<=_)){var y=n===_?v[0]:n===b?v[6]:1===N.solveCubic(v,1,n,a,0,1)?N.getPoint(v,a[0]).x:(v[0]+v[6])/2;s.push(y)}}}s.length>1&&(s.sort((function(t,e){return t-e})),r.x=(s[0]+s[1])/2)}return r}}});var F=a.extend({_class:"PathFlattener",initialize:function(t,e,r,i,n){var s,a=[],o=[],h=0,u=1/(r||32),l=t._segments,c=l[0];function f(t,e){var r=N.getValues(t,e,n);a.push(r),d(r,t._index,0,1)}function d(t,r,n,s){if(!(s-n>u)||i&&N.isStraight(t)||N.isFlatEnough(t,e||.25)){var a=t[6]-t[0],l=t[7]-t[1],c=Math.sqrt(a*a+l*l);c>0&&(h+=c,o.push({offset:h,curve:t,index:r,time:s}))}else{var f=N.subdivide(t,.5),p=(n+s)/2;d(f[0],r,n,p),d(f[1],r,p,s)}}for(var p=1,m=l.length;p<m;p++)f(c,s=l[p]),c=s;t._closed&&f(s||c,l[0]),this.curves=a,this.parts=o,this.length=h,this.index=0},_get:function(t){for(var e,r=this.parts,i=r.length,n=this.index;e=n,n&&!(r[--n].offset<t););for(;e<i;e++){var s=r[e];if(s.offset>=t){this.index=e;var a=r[e-1],o=a&&a.index===s.index?a.time:0,h=a?a.offset:0;return{index:s.index,time:o+(s.time-o)*(t-h)/(s.offset-h)}}}return{index:r[i-1].index,time:1}},drawPart:function(t,e,r){for(var i=this._get(e),n=this._get(r),s=i.index,a=n.index;s<=a;s++){var o=N.getPart(this.curves[s],s===i.index?i.time:0,s===n.index?n.time:1);s===i.index&&t.moveTo(o[0],o[1]),t.bezierCurveTo.apply(t,o.slice(2))}}},a.each(N._evaluateMethods,(function(t){this[t+"At"]=function(e){var r=this._get(e);return N[t](this.curves[r.index],r.time)}}),{})),U=a.extend({initialize:function(t){for(var e,r=this.points=[],i=t._segments,n=t._closed,s=0,a=i.length;s<a;s++){var o=i[s].point;e&&e.equals(o)||r.push(e=o.clone())}n&&(r.unshift(r[r.length-1]),r.push(r[1])),this.closed=n},fit:function(t){var e=this.points,r=e.length,i=null;return r>0&&(i=[new I(e[0])],r>1&&(this.fitCubic(i,t,0,r-1,e[1].subtract(e[0]),e[r-2].subtract(e[r-1])),this.closed&&(i.shift(),i.pop()))),i},fitCubic:function(t,e,r,i,n,s){var a=this.points;if(i-r!=1){for(var o,h=this.chordLengthParameterize(r,i),u=Math.max(e,e*e),l=!0,c=0;c<=4;c++){var f=this.generateBezier(r,i,h,n,s),d=this.findMaxError(r,i,f,h);if(d.error<e&&l)return void this.addCurve(t,f);if(o=d.index,d.error>=u)break;l=this.reparameterize(r,i,h,f),u=d.error}var p=a[o-1].subtract(a[o+1]);this.fitCubic(t,e,r,o,n,p),this.fitCubic(t,e,o,i,p.negate(),s)}else{var m=a[r],g=a[i],v=m.getDistance(g)/3;this.addCurve(t,[m,m.add(n.normalize(v)),g.add(s.normalize(v)),g])}},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new I(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,r,i,n){for(var s=1e-12,a=Math.abs,o=this.points,h=o[t],u=o[e],l=[[0,0],[0,0]],c=[0,0],f=0,d=e-t+1;f<d;f++){var p=r[f],m=1-p,g=3*p*m,v=m*m*m,_=g*m,b=g*p,y=p*p*p,x=i.normalize(_),w=n.normalize(b),E=o[t+f].subtract(h.multiply(v+_)).subtract(u.multiply(b+y));l[0][0]+=x.dot(x),l[0][1]+=x.dot(w),l[1][0]=l[0][1],l[1][1]+=w.dot(w),c[0]+=x.dot(E),c[1]+=w.dot(E)}var M,S,A=l[0][0]*l[1][1]-l[1][0]*l[0][1];if(a(A)>s){var T=l[0][0]*c[1]-l[1][0]*c[0];M=(c[0]*l[1][1]-c[1]*l[0][1])/A,S=T/A}else{var C=l[0][0]+l[0][1],D=l[1][0]+l[1][1];M=S=a(C)>s?c[0]/C:a(D)>s?c[1]/D:0}var R,I,P=u.getDistance(h),N=s*P;if(M<N||S<N)M=S=P/3;else{var k=u.subtract(h);R=i.normalize(M),I=n.normalize(S),R.dot(k)-I.dot(k)>P*P&&(M=S=P/3,R=I=null)}return[h,h.add(R||i.normalize(M)),u.add(I||n.normalize(S)),u]},reparameterize:function(t,e,r,i){for(var n=t;n<=e;n++)r[n-t]=this.findRoot(i,this.points[n],r[n-t]);n=1;for(var s=r.length;n<s;n++)if(r[n]<=r[n-1])return!1;return!0},findRoot:function(t,e,r){for(var i=[],n=[],s=0;s<=2;s++)i[s]=t[s+1].subtract(t[s]).multiply(3);for(s=0;s<=1;s++)n[s]=i[s+1].subtract(i[s]).multiply(2);var a=this.evaluate(3,t,r),o=this.evaluate(2,i,r),h=this.evaluate(1,n,r),u=a.subtract(e),l=o.dot(o)+u.dot(h);return f.isMachineZero(l)?r:r-u.dot(o)/l},evaluate:function(t,e,r){for(var i=e.slice(),n=1;n<=t;n++)for(var s=0;s<=t-n;s++)i[s]=i[s].multiply(1-r).add(i[s+1].multiply(r));return i[0]},chordLengthParameterize:function(t,e){for(var r=[0],i=t+1;i<=e;i++)r[i-t]=r[i-t-1]+this.points[i].getDistance(this.points[i-1]);i=1;for(var n=e-t;i<=n;i++)r[i]/=r[n];return r},findMaxError:function(t,e,r,i){for(var n=Math.floor((e-t+1)/2),s=0,a=t+1;a<e;a++){var o=this.evaluate(3,r,i[a-t]).subtract(this.points[a]),h=o.x*o.x+o.y*o.y;h>=s&&(s=h,n=a)}return{error:s,index:n}}}),z=E.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var e=t&&a.isPlainObject(t)&&t.x===r&&t.y===r;this._initialize(e&&t,!e&&p.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),G=z.extend({_class:"PointText",initialize:function(){z.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new m(t.x,t.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,r){if(this._content){this._setStyles(t,e,r);var i=this._lines,n=this._style,s=n.hasFill(),a=n.hasStroke(),o=n.getLeading(),h=t.shadowColor;t.font=n.getFontStyle(),t.textAlign=n.getJustification();for(var u=0,l=i.length;u<l;u++){t.shadowColor=h;var c=i[u];s&&(t.fillText(c,0,0),t.shadowColor="rgba(0,0,0,0)"),a&&t.strokeText(c,0,0),t.translate(0,o)}}},_getBounds:function(t,e){var r=this._style,i=this._lines,n=i.length,s=r.getJustification(),a=r.getLeading(),o=this.getView().getTextWidth(r.getFontStyle(),i),h=0;"left"!==s&&(h-=o/("center"===s?2:1));var u=new _(h,n?-.75*a:0,o,n*a);return t?t._transformBounds(u,u):u}}),H=a.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},r={},n={transparent:[0,0,0,0]};function s(e){var r,s=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),a="rgb";if(s){var o=s[4]?4:3;r=new Array(o);for(var h=0;h<o;h++){var u=s[h+1];r[h]=parseInt(1==u.length?u+u:u,16)/255}}else if(s=e.match(/^(rgb|hsl)a?\((.*)\)$/)){a=s[1],r=s[2].trim().split(/[,\s]+/g);for(var l="hsl"===a,c=(h=0,Math.min(r.length,4));h<c;h++){var f=r[h];u=parseFloat(f);if(l)if(0===h){var d=f.match(/([a-z]*)$/)[1];u*={turn:360,rad:180/Math.PI,grad:.9}[d]||1}else h<3&&(u/=100);else h<3&&(u/=/%$/.test(f)?100:255);r[h]=u}}else{var p=n[e];if(!p)if(i){t||((t=it.getContext(1,1,{willReadFrequently:!0})).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var m=t.getImageData(0,0,1,1).data;p=n[e]=[m[0]/255,m[1]/255,m[2]/255]}else p=[0,0,0];r=p.slice()}return[a,r]}var o=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],h={"rgb-hsb":function(t,e,r){var i=Math.max(t,e,r),n=i-Math.min(t,e,r);return[0===n?0:60*(i==t?(e-r)/n+(e<r?6:0):i==e?(r-t)/n+2:(t-e)/n+4),0===i?0:n/i,i]},"hsb-rgb":function(t,e,r){var i,n=(t=(t/60%6+6)%6)-(i=Math.floor(t)),s=[r,r*(1-e),r*(1-e*n),r*(1-e*(1-n))];return[s[(i=o[i])[0]],s[i[1]],s[i[2]]]},"rgb-hsl":function(t,e,r){var i=Math.max(t,e,r),n=Math.min(t,e,r),s=i-n,a=0===s,o=(i+n)/2;return[a?0:60*(i==t?(e-r)/s+(e<r?6:0):i==e?(r-t)/s+2:(t-e)/s+4),a?0:o<.5?s/(i+n):s/(2-i-n),o]},"hsl-rgb":function(t,e,r){if(0===e)return[r,r,r];for(var i=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],n=r<.5?r*(1+e):r+e-r*e,s=2*r-n,a=[],o=0;o<3;o++){var h=i[o];h<0&&(h+=1),h>1&&(h-=1),a[o]=6*h<1?s+6*(n-s)*h:2*h<1?n:3*h<2?s+(n-s)*(2/3-h)*6:s}return a},"rgb-gray":function(t,e,r){return[.2989*t+.587*e+.114*r]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return a.each(e,(function(t,i){r[i]=[],a.each(t,(function(t,n){var s=a.capitalize(t),o=/^(hue|saturation)$/.test(t),h=r[i][n]="gradient"===i?"gradient"===t?function(t){var e=this._components[0];return e!==(t=j.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return p.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+s]=function(){return this._type===i||o&&/^hs[bl]$/.test(this._type)?this._components[n]:this._convert(i)[n]},this["set"+s]=function(t){this._type===i||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(i),this._properties=e[i],this._type=i),this._components[n]=h.call(this,t),this._changed()}}),this)}),{_class:"Color",_readIndex:!0,initialize:function t(i){var n,o,h,u,l=arguments,c=this.__read,f=0;Array.isArray(i)&&(i=(l=i)[0]);var d=null!=i&&typeof i;if("string"===d&&i in e&&(n=i,i=l[1],Array.isArray(i)?(o=i,h=l[2]):(c&&(f=1),l=a.slice(l,1),d=typeof i)),!o){if(u="number"===d?l:"object"===d&&null!=i.length?i:null){n||(n=u.length>=3?"rgb":"gray");var p=e[n].length;h=u[p],c&&(f+=u===arguments?p+(null!=h?1:0):1),u.length>p&&(u=a.slice(u,0,p))}else if("string"===d){var m=s(i);n=m[0],4===(o=m[1]).length&&(h=o[3],o.length--)}else if("object"===d)if(i.constructor===t){if(n=i._type,o=i._components.slice(),h=i._alpha,"gradient"===n)for(var g=1,v=o.length;g<v;g++){var _=o[g];_&&(o[g]=_.clone())}}else if(i.constructor===j)n="gradient",u=l;else{var b=e[n="hue"in i?"lightness"in i?"hsl":"hsb":"gradient"in i||"stops"in i||"radial"in i?"gradient":"gray"in i?"gray":"rgb"],y=r[n];this._components=o=[];for(g=0,v=b.length;g<v;g++){null==(x=i[b[g]])&&!g&&"gradient"===n&&"stops"in i&&(x={stops:i.stops,radial:i.radial}),null!=(x=y[g].call(this,x))&&(o[g]=x)}h=i.alpha}c&&n&&(f=1)}if(this._type=n||"rgb",!o){this._components=o=[];for(g=0,v=(y=r[this._type]).length;g<v;g++){var x;null!=(x=y[g].call(this,u&&u[g]))&&(o[g]=x)}}return this._components=o,this._properties=e[this._type],this._alpha=h,c&&(this.__read=f),this},set:"#initialize",_serialize:function(t,e){var r=this.getComponents();return a.serialize(/^(gray|rgb)$/.test(this._type)?r:[this._type].concat(r),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=h[this._type+"-"+t])?e.apply(this,this._components):h["rgb-"+t].apply(this,h[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new H(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=a.isPlainValue(t,!0)?H.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&a.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],r="gradient"===this._type,i=c.instance,n=0,s=t.length;n<s;n++){var a=this._components[n];null!=a&&e.push(t[n]+": "+(r?a:i.number(a)))}return null!=this._alpha&&e.push("alpha: "+i.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),r=t||null==this._alpha?1:this._alpha;function i(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[i(e[0]),i(e[1]),i(e[2])],r<1&&e.push(r<0?0:r),t?"#"+(16777216+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var r,i=this._components,n=i[0],s=n._stops,a=i[1],o=i[2],h=i[3],u=e&&e.inverted();if(u&&(a=u._transformPoint(a),o=u._transformPoint(o),h&&(h=u._transformPoint(h))),n._radial){var l=o.getDistance(a);if(h){var c=h.subtract(a);c.getLength()>l&&(h=a.add(c.normalize(l-.1)))}var f=h||a;r=t.createRadialGradient(f.x,f.y,0,a.x,a.y,l)}else r=t.createLinearGradient(a.x,a.y,o.x,o.y);for(var d=0,p=s.length;d<p;d++){var m=s[d],g=m._offset;r.addColorStop(null==g?d/(p-1):g,m._color.toCanvasStyle())}return this._canvasStyle=r},transform:function(t){if("gradient"===this._type){for(var e=this._components,r=1,i=e.length;r<i;r++){var n=e[r];t._transformPoint(n,n,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new H(t(),t(),t())},_setOwner:function(t,e,r){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=r||null)),t}}})},new function(){return a.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},(function(t,e){this[e]=function(e){e=H.read(arguments);for(var r=this._type,i=this._components,n=e._convert(r),s=0,a=i.length;s<a;s++)n[s]=t(i[s],n[s]);return new H(r,n,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}}),{})}),j=a.extend({_class:"Gradient",initialize:function(t,e){this._id=d.get(),t&&a.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,(function(){return a.serialize([this._stops,this._radial],t,!0,e)}))},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;-1!=e&&(this._owners.splice(e,1),this._owners.length||(this._owners=r))},clone:function(){for(var t=[],e=0,r=this._stops.length;e<r;e++)t[e]=this._stops[e].clone();return new j(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var i=0,n=e.length;i<n;i++)e[i]._owner=r;for(i=0,n=(e=this._stops=V.readList(t,0,{clone:!0})).length;i<n;i++)e[i]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,r=t._stops,i=e.length;if(i===r.length){for(var n=0;n<i;n++)if(!e[n].equals(r[n]))return!1;return!0}}return!1}}),V=a.extend({_class:"GradientStop",initialize:function(t,e){var i=t,n=e;"object"==typeof t&&e===r&&(Array.isArray(t)&&"number"!=typeof t[0]?(i=t[0],n=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(i=t.color,n=t.offset||t.rampPoint||0)),this.setColor(i),this.setOffset(n)},clone:function(){return new V(this._color.clone(),this._offset)},_serialize:function(t,e){var r=this._color,i=this._offset;return a.serialize(null==i?[r]:[r,i],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){H._setOwner(this._color,null),this._color=H._setOwner(H.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),W=a.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new p,selectedColor:null},e=a.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),i=a.set({},e,{fillColor:new H}),n={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},s={beans:!0},o={_class:"Style",beans:!0,initialize:function(r,n,s){this._values={},this._owner=n,this._project=n&&n._project||s||ot.project,this._defaults=!n||n instanceof M?e:n instanceof z?i:t,r&&this.set(r)}};return a.each(e,(function(t,e){var i=/Color$/.test(e),h="shadowOffset"===e,u=a.capitalize(e),l=n[e],c="set"+u,f="get"+u;o[c]=function(t){var r=this._owner,n=r&&r._children,s=n&&n.length>0&&!(r instanceof O);if(s)for(var a=0,o=n.length;a<o;a++)n[a]._style[c](t);if(("selectedColor"===e||!s)&&e in this._defaults){var h=this._values[e];h!==t&&(i&&(h&&(H._setOwner(h,null),h._canvasStyle=null),t&&t.constructor===H&&(t=H._setOwner(t,r,s&&c))),this._values[e]=t,r&&r._changed(l||129))}},o[f]=function(t){var n=this._owner,s=n&&n._children,o=s&&s.length>0&&!(n instanceof O);if(o&&!t)for(var u=0,l=s.length;u<l;u++){var d=s[u]._style[f]();if(u){if(!a.equals(m,d))return r}else m=d}else if(e in this._defaults){var m;if((m=this._values[e])===r)(m=this._defaults[e])&&m.clone&&(m=m.clone());else{var g=i?H:h?p:null;!g||m&&m.constructor===g||(this._values[e]=m=g.read([m],0,{readNull:!0,clone:!0}))}}return m&&i&&(m=H._setOwner(m,n,o&&c)),m},s[f]=function(t){return this._style[f](t)},s[c]=function(t){this._style[c](t)}})),a.each({Font:"FontFamily",WindingRule:"FillRule"},(function(t,e){var r="get"+e,i="set"+e;o[r]=s[r]="#get"+t,o[i]=s[i]="#set"+t})),E.inject(s),o},{set:function(t){var e=t instanceof W,r=e?t._values:t;if(r)for(var i in r)if(i in this._defaults){var n=r[i];this[i]=n&&e&&n.clone?n.clone():n}},equals:function(t){function e(t,e,i){var n=t._values,s=e._values,o=e._defaults;for(var h in n){var u=n[h],l=s[h];if(!(i&&h in s||a.equals(u,l===r?o[h]:l)))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),r=this.getFontSize();return/pt|em|%|px/.test(r)&&(r=this.getView().getPixelSize(r)),null!=e?e:1.2*r}}),q=new function(){function t(t,e,r,i){for(var n=["","webkit","moz","Moz","ms","o"],s=e[0].toUpperCase()+e.substring(1),a=0;a<6;a++){var o=n[a],h=o?o+s:e;if(h in t){if(!r)return t[h];t[h]=i;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,r=e&&e.defaultView;return r&&r.getComputedStyle(t,"")},getBounds:function(t,e){var r,i=t.ownerDocument,n=i.body,s=i.documentElement;try{r=t.getBoundingClientRect()}catch(t){r={left:0,top:0,width:0,height:0}}var a=r.left-(s.clientLeft||n.clientLeft||0),o=r.top-(s.clientTop||n.clientTop||0);if(!e){var h=i.defaultView;a+=h.pageXOffset||s.scrollLeft||n.scrollLeft,o+=h.pageYOffset||s.scrollTop||n.scrollTop}return new _(a,o,r.width,r.height)},getViewportBounds:function(t){var e=t.ownerDocument,r=e.defaultView,i=e.documentElement;return new _(0,0,r.innerWidth||i.clientWidth,r.innerHeight||i.clientHeight)},getOffset:function(t,e){return q.getBounds(t,e).getPoint()},getSize:function(t){return q.getBounds(t,!0).getSize()},isInvisible:function(t){return q.getSize(t).equals(new g(0,0))},isInView:function(t){return!q.isInvisible(t)&&q.getViewportBounds(t).intersects(q.getBounds(t,!0))},isInserted:function(t){return n.body.contains(t)},getPrefixed:function(e,r){return e&&t(e,r)},setPrefixed:function(e,r,i){if("object"==typeof r)for(var n in r)t(e,n,!0,r[n]);else t(e,r,!0,i)}}},X={add:function(t,e){if(t)for(var r in e)for(var i=e[r],s=r.split(/[\s,]+/g),a=0,o=s.length;a<o;a++){var h=s[a],u=t===n&&("touchstart"===h||"touchmove"===h)&&{passive:!1};t.addEventListener(h,i,u)}},remove:function(t,e){if(t)for(var r in e)for(var i=e[r],n=r.split(/[\s,]+/g),s=0,a=n.length;s<a;s++)t.removeEventListener(n[s],i,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new p(e.pageX||e.clientX+n.documentElement.scrollLeft,e.pageY||e.clientY+n.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return X.getPoint(t).subtract(q.getOffset(e||X.getTarget(t)))}};X.requestAnimationFrame=new function(){var t,e=q.getPrefixed(i,"requestAnimationFrame"),r=!1,n=[];function s(){var t=n;n=[];for(var i=0,a=t.length;i<a;i++)t[i]();(r=e&&n.length)&&e(s)}return function(i){n.push(i),e?r||(e(s),r=!0):t||(t=setInterval(s,1e3/60))}};var Y=a.extend(o,{_class:"View",initialize:function t(e,r){function s(t){return r[t]||parseInt(r.getAttribute(t),10)}function a(){var t=q.getSize(r);return t.isNaN()||t.isZero()?new g(s("width"),s("height")):t}var o;if(i&&r){this._id=r.getAttribute("id"),null==this._id&&r.setAttribute("id",this._id="paper-view-"+t._id++),X.add(r,this._viewEvents);var u="none";if(q.setPrefixed(r.style,{userDrag:u,userSelect:u,touchCallout:u,contentZooming:u,tapHighlightColor:"rgba(0,0,0,0)"}),h.hasAttribute(r,"resize")){var l=this;X.add(i,this._windowEvents={resize:function(){l.setViewSize(a())}})}if(o=a(),h.hasAttribute(r,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var c=this._stats.domElement,f=c.style,d=q.getOffset(r);f.position="absolute",f.left=d.x+"px",f.top=d.y+"px",n.body.appendChild(c)}}else o=new g(r),r=null;this._project=e,this._scope=e._scope,this._element=r,this._pixelRatio||(this._pixelRatio=i&&i.devicePixelRatio||1),this._setElementSize(o.width,o.height),this._viewSize=o,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new y)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!ot.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;Y._focused===this&&(Y._focused=null),Y._views.splice(Y._views.indexOf(this),1),delete Y._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),X.remove(this._element,this._viewEvents),X.remove(i,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:a.each(E._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),(function(t){this[t]={}}),{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;X.requestAnimationFrame((function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;q.getPrefixed(n,"hidden")&&"true"!==h.getAttribute(e,"keepalive")||!q.isInView(e)||t._handleFrame()}t._autoUpdate&&t.update()})),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){ot=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new a({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var r=this._frameItems;e?(r[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete r[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var r=this._frameItems[e];r.item.emit("frame",new a(t,{time:r.time+=t.delta,count:r.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=r},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new v(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=g.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var r=this._element;r&&(r.width!==t&&(r.width=t),r.height!==e&&(r.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new _(new p,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return q.isInView(this._element)},isInserted:function(){return q.isInserted(this._element)},getPixelSize:function(t){var e,r=this._element;if(r){var i=r.parentNode,s=n.createElement("div");s.style.fontSize=t,i.appendChild(s),e=parseFloat(q.getStyles(s).fontSize),i.removeChild(s)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},a.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var r=arguments,i=(e?a:p).read(r),n=p.read(r,0,{readNull:!0});return this.transform((new y)[t](i,n||this.getCenter(!0)))}}),{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new y;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=p.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform((new y).scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new m(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(p.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(p.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(p.read(arguments))},getEventPoint:function(t){return this.viewToProject(X.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return n&&"string"==typeof e&&(e=n.getElementById(e)),new(i?Z:Y)(t,e)}}},new function(){if(i){var t,e,r,s,a,o=!1,h=!1,u=i.navigator;u.pointerEnabled||u.msPointerEnabled?(r="pointerdown MSPointerDown",s="pointermove MSPointerMove",a="pointerup pointercancel MSPointerUp MSPointerCancel"):(r="touchstart",s="touchmove",a="touchend touchcancel","ontouchstart"in i&&u.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(r+=" mousedown",s+=" mousemove",a+=" mouseup"));var l={},c={mouseout:function(t){var e=Y._focused,r=X.getRelatedTarget(t);if(e&&(!r||"HTML"===r.nodeName)){var i=X.getOffset(t,e._element),n=i.x,s=Math.abs,a=s(n),o=a-33554432;i.x=s(o)<a?o*(n<0?-1:1):n,T(e,t,e.viewToProject(i))}},scroll:A};l[r]=function(t){var e=Y._focused=S(t);o||(o=!0,e._handleMouseEvent("mousedown",t))},c[s]=function(r){var i=Y._focused;if(!h){var n=S(r);n?i!==n&&(i&&T(i,r),t||(t=i),i=Y._focused=e=n):e&&e===i&&(t&&!t.isInserted()&&(t=null),i=Y._focused=t,t=null,A())}i&&T(i,r)},c[r]=function(){h=!0},c[a]=function(t){var e=Y._focused;e&&o&&e._handleMouseEvent("mouseup",t),h=o=!1},X.add(n,c),X.add(i,{load:A});var f,d,p,m,g,v,_,b,y=!1,x=!1,w={doubleclick:"click",mousedrag:"mousemove"},E=!1,M={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:l,_handleMouseEvent:function(t,e,r){var i=this._itemEvents,n=i.native[t],s="mousemove"===t,a=this._scope.tool,h=this;function u(t){return i.virtual[t]||h.responds(t)||a&&a.responds(t)}s&&o&&u("mousedrag")&&(t="mousedrag"),r||(r=this.getEventPoint(e));var l=this.getBounds().contains(r),c=n&&l&&h._project.hitTest(r,{tolerance:0,fill:!0,stroke:!0}),w=c&&c.item||null,M=!1,S={};if(S[t.substr(5)]=!0,n&&w!==m&&(m&&C(m,null,"mouseleave",e,r),w&&C(w,null,"mouseenter",e,r),m=w),E^l&&(C(this,null,l?"mouseenter":"mouseleave",e,r),l?this:null,M=!0),!l&&!S.drag||r.equals(d)||(D(this,w,s?t:"mousemove",e,r,d),M=!0),E=l,S.down&&l||S.up&&f){if(D(this,w,t,e,r,f),S.down){if(b=w===v&&Date.now()-_<300,p=v=w,!x&&w){for(var A=w;A&&!A.responds("mousedrag");)A=A._parent;A&&(g=w)}f=r}else S.up&&(x||w!==p||(_=Date.now(),D(this,w,b?"doubleclick":"click",e,r,f),b=!1),p=g=null);E=!1,M=!0}d=r,M&&a&&(y=a._handleMouseEvent(t,e,r,S)||y),!1!==e.cancelable&&(y&&!S.move||S.down&&u("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,r,i){var n,s=this._scope,a=s.tool;function o(a){a.responds(t)&&(ot=s,a.emit(t,n=n||new K(t,e,r,i)))}this.isVisible()&&(o(this),a&&a.responds(t)&&o(a))},_countItemEvent:function(t,e){var r=this._itemEvents,i=r.native,n=r.virtual;for(var s in M)i[s]=(i[s]||0)+(M[s][t]||0)*e;n[t]=(n[t]||0)+e},statics:{updateFocus:A,_resetState:function(){o=h=y=E=!1,t=e=f=d=p=m=g=v=_=b=null}}}}function S(t){var e=X.getTarget(t);return e.getAttribute&&Y._viewsById[e.getAttribute("id")]}function A(){var t=Y._focused;if(!t||!t.isVisible())for(var r=0,i=Y._views.length;r<i;r++)if((t=Y._views[r]).isVisible()){Y._focused=e=t;break}}function T(t,e,r){t._handleMouseEvent("mousemove",e,r)}function C(t,e,r,i,n,s,a){var o,h=!1;function u(t,r){if(t.responds(r)){if(o||(o=new Q(r,i,n,e||t,s?n.subtract(s):null)),t.emit(r,o)&&(y=!0,o.prevented&&(x=!0),o.stopped))return h=!0}else{var a=w[r];if(a)return u(t,a)}}for(;t&&t!==a&&!u(t,r);)t=t._parent;return h}function D(t,e,r,i,n,s){return t._project.removeOn(r),x=y=!1,g&&C(g,null,r,i,n,s)||e&&e!==g&&!e.isDescendant(g)&&C(e,null,"mousedrag"===r?"mousemove":r,i,n,s,g)||C(t,g||e||t,r,i,n,s)}}),Z=Y.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof i.HTMLCanvasElement)){var r=g.read(arguments,1);if(r.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+a.slice(arguments,1));e=it.getCanvas(r)}var n=this._context=e.getContext("2d");if(n.save(),this._pixelRatio=1,!/^off|false$/.test(h.getAttribute(e,"hidpi"))){var s=i.devicePixelRatio||1,o=q.getPrefixed(n,"backingStorePixelRatio")||1;this._pixelRatio=s/o}Y.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,r){var i=this._pixelRatio;if(t.base.call(this,e*i,r*i),1!==i){var n=this._element,s=this._context;if(!h.hasAttribute(n,"resize")){var a=n.style;a.width=e+"px",a.height=r+"px"}s.restore(),s.save(),s.scale(i,i)}},getContext:function(){return this._context},getPixelSize:function t(e){var r,i=ot.agent;if(i&&i.firefox)r=t.base.call(this,e);else{var n=this._context,s=n.font;n.font=e+" serif",r=parseFloat(n.font),n.font=s}return r},getTextWidth:function(t,e){var r=this._context,i=r.font,n=0;r.font=t;for(var s=0,a=e.length;s<a;s++)n=Math.max(n,r.measureText(e[s]).width);return r.font=i,n},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,r=this._viewSize;return e.clearRect(0,0,r.width+1,r.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),$=a.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return J.modifiers}}),K=$.extend({_class:"KeyEvent",initialize:function(t,e,r,i){this.type=t,this.event=e,this.key=r,this.character=i},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),J=new function(){var t,e,s={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},o={tab:"\t",space:" ",enter:"\r"},h={},u={},l=new a({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=ot&&ot.agent;return t&&t.mac?this.meta:this.control}}});function c(t){var e=t.key||t.keyIdentifier;return e=/^U\+/.test(e)?String.fromCharCode(parseInt(e.substr(2),16)):/^Arrow[A-Z]/.test(e)?e.substr(5):"Unidentified"===e||e===r?String.fromCharCode(t.keyCode):e,s[e]||(e.length>1?a.hyphenate(e):e.toLowerCase())}function f(e,r,i,n){var s,o=Y._focused;if(h[r]=e,e?u[r]=i:delete u[r],r.length>1&&(s=a.camelize(r))in l){l[s]=e;var c=ot&&ot.agent;if("meta"===s&&c&&c.mac)if(e)t={};else{for(var d in t)d in u&&f(!1,d,t[d],n);t=null}}else e&&t&&(t[r]=i);o&&o._handleKeyEvent(e?"keydown":"keyup",n,r,i)}return X.add(n,{keydown:function(t){var r=c(t),i=ot&&ot.agent;r.length>1||i&&i.chrome&&(t.altKey||i.mac&&t.metaKey||!i.mac&&t.ctrlKey)?f(!0,r,o[r]||(r.length>1?"":r),t):e=r},keypress:function(t){if(e){var r=c(t),i=t.charCode,n=i>=32?String.fromCharCode(i):r.length>1?"":r;r!==e&&(r=n.toLowerCase()),f(!0,r,n,t),e=null}},keyup:function(t){var e=c(t);e in u&&f(!1,e,u[e],t)}}),X.add(i,{blur:function(t){for(var e in u)f(!1,e,u[e],t)}}),{modifiers:l,isDown:function(t){return!!h[t]}}},Q=$.extend({_class:"MouseEvent",initialize:function(t,e,r,i,n){this.type=t,this.event=e,this.point=r,this.target=i,this.delta=n},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),tt=$.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,r){this.tool=t,this.type=e,this.event=r},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,r=e._parent;/^(Group|CompoundPath)$/.test(r._class);)e=r,r=r._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),et=(u.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){u.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,r,i){ot=this._scope,i.drag&&!this.responds(t)&&(t="mousemove");var n=i.move||i.drag,s=this.responds(t),a=this.minDistance,o=this.maxDistance,h=!1,u=this;function l(t,e){var s=r,a=n?u._point:u._downPoint||s;if(n){if(u._moveCount>=0&&s.equals(a))return!1;if(a&&(null!=t||null!=e)){var o=s.subtract(a),h=o.getLength();if(h<(t||0))return!1;e&&(s=a.add(o.normalize(Math.min(h,e))))}u._moveCount++}return u._point=s,u._lastPoint=a||s,i.down&&(u._moveCount=-1,u._downPoint=s,u._downCount++),!0}function c(){s&&(h=u.emit(t,new tt(u,t,e))||h)}if(i.down)l(),c();else if(i.up)l(null,o),c();else if(s)for(;l(a,o);)c();return h}}),a.extend(o,{_class:"Tween",statics:{easings:new a({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:2*(2-t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,r,i,n,s,a){this.object=e;var o=typeof s,h="function"===o;this.type=h?o:"string"===o?s:"linear",this.easing=h?s:t.easings[this.type],this.duration=n,this.running=!1,this._then=null,this._startTime=null;var u=r||i;this._keys=u?Object.keys(u):[],this._parsedKeys=this._parseKeys(this._keys),this._from=u&&this._getState(r),this._to=u&&this._getState(i),!1!==a&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),r=this._keys,i=function(r){return"function"==typeof r?r(e,t):r},n=0,s=r&&r.length;n<s;n++){var o=r[n],h=i(this._from[o]),u=i(this._to[o]),l=h&&u&&h.__add&&u.__add?u.__subtract(h).__multiply(e).__add(h):(u-h)*e+h;this._setProperty(this._parsedKeys[o],l)}this.responds("update")&&this.emit("update",new a({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,r=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(r)},_getState:function(t){for(var e=this._keys,r={},i=0,n=e.length;i<n;i++){var s,a=e[i],o=this._parsedKeys[a],h=this._getProperty(o);if(t){var u=this._resolveValue(h,t[a]);this._setProperty(o,u),s=(s=this._getProperty(o))&&s.clone?s.clone():s,this._setProperty(o,h)}else s=h&&h.clone?h.clone():h;r[a]=s}return r},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var r=e[0];return r&&r.match&&r.match(/^[+\-\*\/]=/)?this._calculate(t,r[0],e[1]):e}if("string"==typeof e){var i=e.match(/^[+\-*/]=(.*)/);if(i){var n=JSON.parse(i[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],n)}}}return e},_calculate:function(t,e,r){return ot.PaperScript.calculateBinary(t,e,r)},_parseKeys:function(t){for(var e={},r=0,i=t.length;r<i;r++){var n=t[r],s=n.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[n]=s.split("/")}return e},_getProperty:function(t,e){for(var r=this.object,i=0,n=t.length-(e||0);i<n&&r;i++)r=r[t[i]];return r},_setProperty:function(t,e){var r=this._getProperty(t,1);r&&(r[t[t.length-1]]=e)}})),rt=function(t){var r=new e.XMLHttpRequest;return r.open((t.method||"get").toUpperCase(),t.url,a.pick(t.async,!0)),t.mimeType&&r.overrideMimeType(t.mimeType),r.onload=function(){var e=r.status;0===e||200===e?t.onLoad&&t.onLoad.call(r,r.responseText):r.onerror()},r.onerror=function(){var e=r.status,i='Could not load "'+t.url+'" (Status: '+e+")";if(!t.onError)throw new Error(i);t.onError(i,e)},r.send(null)},it=a.exports.CanvasProvider={canvases:[],getCanvas:function(t,e,r){if(!i)return null;var s,a=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?s=this.canvases.pop():(s=n.createElement("canvas"),a=!1);var o=s.getContext("2d",r||{});if(!o)throw new Error("Canvas "+s+" is unable to provide a 2D context.");return s.width===t&&s.height===e?a&&o.clearRect(0,0,t+1,e+1):(s.width=t,s.height=e),o.save(),s},getContext:function(t,e,r){var i=this.getCanvas(t,e,r);return i?i.getContext("2d",r||{}):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},nt=new function(){var t,e,r,i,n,s,o,h,u,l,c,f=Math.min,d=Math.max,p=Math.abs;function m(t,e,r){return.2989*t+.587*e+.114*r}function g(t,e,r,i){var n=i-m(t,e,r),s=(i=m(u=t+n,l=e+n,c=r+n),f(u,l,c)),a=d(u,l,c);if(s<0){var o=i-s;u=i+(u-i)*i/o,l=i+(l-i)*i/o,c=i+(c-i)*i/o}if(a>255){var h=255-i,p=a-i;u=i+(u-i)*h/p,l=i+(l-i)*h/p,c=i+(c-i)*h/p}}function v(t,e,r){return d(t,e,r)-f(t,e,r)}function _(t,e,r,i){var n,s=[t,e,r],a=d(t,e,r),o=f(t,e,r);n=0===f(o=o===t?0:o===e?1:2,a=a===t?0:a===e?1:2)?1===d(o,a)?2:1:0,s[a]>s[o]?(s[n]=(s[n]-s[o])*i/(s[a]-s[o]),s[a]=i):s[n]=s[a]=0,s[o]=0,u=s[0],l=s[1],c=s[2]}var b={multiply:function(){u=n*t/255,l=s*e/255,c=o*r/255},screen:function(){u=n+t-n*t/255,l=s+e-s*e/255,c=o+r-o*r/255},overlay:function(){u=n<128?2*n*t/255:255-2*(255-n)*(255-t)/255,l=s<128?2*s*e/255:255-2*(255-s)*(255-e)/255,c=o<128?2*o*r/255:255-2*(255-o)*(255-r)/255},"soft-light":function(){var i=t*n/255;u=i+n*(255-(255-n)*(255-t)/255-i)/255,l=(i=e*s/255)+s*(255-(255-s)*(255-e)/255-i)/255,c=(i=r*o/255)+o*(255-(255-o)*(255-r)/255-i)/255},"hard-light":function(){u=t<128?2*t*n/255:255-2*(255-t)*(255-n)/255,l=e<128?2*e*s/255:255-2*(255-e)*(255-s)/255,c=r<128?2*r*o/255:255-2*(255-r)*(255-o)/255},"color-dodge":function(){u=0===n?0:255===t?255:f(255,255*n/(255-t)),l=0===s?0:255===e?255:f(255,255*s/(255-e)),c=0===o?0:255===r?255:f(255,255*o/(255-r))},"color-burn":function(){u=255===n?255:0===t?0:d(0,255-255*(255-n)/t),l=255===s?255:0===e?0:d(0,255-255*(255-s)/e),c=255===o?255:0===r?0:d(0,255-255*(255-o)/r)},darken:function(){u=n<t?n:t,l=s<e?s:e,c=o<r?o:r},lighten:function(){u=n>t?n:t,l=s>e?s:e,c=o>r?o:r},difference:function(){(u=n-t)<0&&(u=-u),(l=s-e)<0&&(l=-l),(c=o-r)<0&&(c=-c)},exclusion:function(){u=n+t*(255-n-n)/255,l=s+e*(255-s-s)/255,c=o+r*(255-o-o)/255},hue:function(){_(t,e,r,v(n,s,o)),g(u,l,c,m(n,s,o))},saturation:function(){_(n,s,o,v(t,e,r)),g(u,l,c,m(n,s,o))},luminosity:function(){g(n,s,o,m(t,e,r))},color:function(){g(t,e,r,m(n,s,o))},add:function(){u=f(n+t,255),l=f(s+e,255),c=f(o+r,255)},subtract:function(){u=d(n-t,0),l=d(s-e,0),c=d(o-r,0)},average:function(){u=(n+t)/2,l=(s+e)/2,c=(o+r)/2},negation:function(){u=255-p(255-t-n),l=255-p(255-e-s),c=255-p(255-r-o)}},y=this.nativeModes=a.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],(function(t){this[t]=!0}),{}),x=it.getContext(1,1,{willReadFrequently:!0});x&&(a.each(b,(function(t,e){var r="darken"===e,i=!1;x.save();try{x.fillStyle=r?"#300":"#a00",x.fillRect(0,0,1,1),x.globalCompositeOperation=e,x.globalCompositeOperation===e&&(x.fillStyle=r?"#a00":"#300",x.fillRect(0,0,1,1),i=x.getImageData(0,0,1,1).data[0]!==r?170:51)}catch(t){}x.restore(),y[e]=i})),it.release(x)),this.process=function(a,f,d,p,m){var g=f.canvas,v="normal"===a;if(v||y[a])d.save(),d.setTransform(1,0,0,1,0,0),d.globalAlpha=p,v||(d.globalCompositeOperation=a),d.drawImage(g,m.x,m.y),d.restore();else{var _=b[a];if(!_)return;for(var x=d.getImageData(m.x,m.y,g.width,g.height),w=x.data,E=f.getImageData(0,0,g.width,g.height).data,M=0,S=w.length;M<S;M+=4){t=E[M],n=w[M],e=E[M+1],s=w[M+1],r=E[M+2],o=w[M+2],i=E[M+3],h=w[M+3],_();var A=i*p/255,T=1-A;w[M]=A*u+T*n,w[M+1]=A*l+T*s,w[M+2]=A*c+T*o,w[M+3]=i*p+T*h}d.putImageData(x,m.x,m.y)}}},st=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",r="http://www.w3.org/1999/xlink",i={href:r,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function s(t,e,r){for(var n in e){var s=e[n],a=i[n];"number"==typeof s&&r&&(s=r.number(s)),a?t.setAttributeNS(a,n,s):t.setAttribute(n,s)}return t}return{svg:t,xmlns:e,xlink:r,create:function(e,r,i){return s(n.createElementNS(t,e),r,i)},get:function(t,e){var r=i[e],n=r?t.getAttributeNS(r,e):t.getAttribute(e);return"null"===n?null:n},set:s}},at=a.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof B||t instanceof A||t instanceof z)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},(function(t,e){var r=a.capitalize(e),i=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:i,fromSVG:i&&a.each(i,(function(t,e){this[t]=e}),{}),exportFilter:t[3],get:"get"+r,set:"set"+r}}),{});new function(){var t;function r(e,r,i){var n,s=new a,o=e.getTranslation();r&&(e.isInvertible()?(n=(e=e._shiftless())._inverseTransform(o),o=null):n=new p,s[i?"cx":"x"]=n.x,s[i?"cy":"y"]=n.y);if(!e.isIdentity()){var h=e.decompose();if(h){var u=[],l=h.rotation,c=h.scaling,d=h.skewing;o&&!o.isZero()&&u.push("translate("+t.point(o)+")"),l&&u.push("rotate("+t.number(l)+")"),f.isZero(c.x-1)&&f.isZero(c.y-1)||u.push("scale("+t.point(c)+")"),d.x&&u.push("skewX("+t.number(d.x)+")"),d.y&&u.push("skewY("+t.number(d.y)+")"),s.transform=u.join(" ")}else s.transform="matrix("+e.getValues().join(",")+")"}return s}function i(e,i){for(var n=r(e._matrix),s=e._children,a=st.create("g",n,t),o=0,h=s.length;o<h;o++){var u=s[o],c=g(u,i);if(c)if(u.isClipMask()){var f=st.create("clipPath");f.appendChild(c),l(u,f,"clip"),st.set(a,{"clip-path":"url(#"+f.id+")"})}else a.appendChild(c)}return a}function n(e){var i=e._type,n=e._radius,s=r(e._matrix,!0,"rectangle"!==i);if("rectangle"===i){i="rect";var a=e._size,o=a.width,h=a.height;s.x-=o/2,s.y-=h/2,s.width=o,s.height=h,n.isZero()&&(n=null)}return n&&("circle"===i?s.r=n:(s.rx=n.width,s.ry=n.height)),st.create(i,s,t)}var s,o={Group:i,Layer:i,Raster:function(e,i){var n=r(e._matrix,!0),s=e.getSize(),a=e.getImage();return n.x-=s.width/2,n.y-=s.height/2,n.width=s.width,n.height=s.height,n.href=0==i.embedImages&&a&&a.src||e.toDataURL(),st.create("image",n,t)},Path:function(e,i){var s=i.matchShapes;if(s){var a=e.toShape(!1);if(a)return n(a)}var o,h=e._segments,u=h.length,l=r(e._matrix);if(s&&u>=2&&!e.hasHandles())if(u>2){o=e._closed?"polygon":"polyline";for(var c=[],f=0;f<u;f++)c.push(t.point(h[f]._point));l.points=c.join(" ")}else{o="line";var d=h[0]._point,p=h[1]._point;l.set({x1:d.x,y1:d.y,x2:p.x,y2:p.y})}else o="path",l.d=e.getPathData(null,i.precision);return st.create(o,l,t)},Shape:n,CompoundPath:function(e,i){var n=r(e._matrix),s=e.getPathData(null,i.precision);return s&&(n.d=s),st.create("path",n,t)},SymbolItem:function(e,i){var n=r(e._matrix,!0),s=e._definition,a=u(s,"symbol"),o=s._item,h=o.getStrokeBounds();return a||((a=st.create("symbol",{viewBox:t.rectangle(h)})).appendChild(g(o,i)),l(s,a,"symbol")),n.href="#"+a.id,n.x+=h.x,n.y+=h.y,n.width=h.width,n.height=h.height,n.overflow="visible",st.create("use",n,t)},PointText:function(e){var i=st.create("text",r(e._matrix,!0),t);return i.textContent=e._content,i}};function h(e,r,i){var n={},s=!i&&e.getParent(),o=[];return null!=e._name&&(n.id=e._name),a.each(at,(function(r){var i=r.get,h=r.type,c=e[i]();if(r.exportFilter?r.exportFilter(e,c):!s||!a.equals(s[i](),c)){if("color"===h&&null!=c){var f=c.getAlpha();f<1&&(n[r.attribute+"-opacity"]=f)}"style"===h?o.push(r.attribute+": "+c):n[r.attribute]=null==c?"none":"color"===h?c.gradient?function(e){var r=u(e,"color");if(!r){var i,n=e.getGradient(),s=n._radial,a=e.getOrigin(),o=e.getDestination();if(s){i={cx:a.x,cy:a.y,r:a.getDistance(o)};var h=e.getHighlight();h&&(i.fx=h.x,i.fy=h.y)}else i={x1:a.x,y1:a.y,x2:o.x,y2:o.y};i.gradientUnits="userSpaceOnUse",r=st.create((s?"radial":"linear")+"Gradient",i,t);for(var c=n._stops,f=0,d=c.length;f<d;f++){var p=c[f],m=p._color,g=m.getAlpha(),v=p._offset;i={offset:null==v?f/(d-1):v},m&&(i["stop-color"]=m.toCSS(!0)),g<1&&(i["stop-opacity"]=g),r.appendChild(st.create("stop",i,t))}l(e,r,"color")}return"url(#"+r.id+")"}(c):c.toCSS(!0):"array"===h?c.join(","):"lookup"===h?r.toSVG[c]:c}})),o.length&&(n.style=o.join(";")),1===n.opacity&&delete n.opacity,e._visible||(n.visibility="hidden"),st.set(r,n,t)}function u(t,e){return s||(s={ids:{},svgs:{}}),t&&s.svgs[e+"-"+(t._id||t.__id||(t.__id=d.get("svg")))]}function l(t,e,r){s||u();var i=s.ids[r]=(s.ids[r]||0)+1;e.id=r+"-"+i,s.svgs[r+"-"+(t._id||t.__id)]=e}function m(t,r){var i=t,n=null;if(s){for(var a in i="svg"===t.nodeName.toLowerCase()&&t,s.svgs)n||(i||(i=st.create("svg")).appendChild(t),n=i.insertBefore(st.create("defs"),i.firstChild)),n.appendChild(s.svgs[a]);s=null}return r.asString?(new e.XMLSerializer).serializeToString(i):i}function g(t,e,r){var i=o[t._class],n=i&&i(t,e);if(n){var s=e.onExport;s&&(n=s(t,n,e)||n);var a=JSON.stringify(t._data);a&&"{}"!==a&&"null"!==a&&n.setAttribute("data-paper-data",a)}return n&&h(t,n,r)}function v(e){return e||(e={}),t=new c(e.precision),e}E.inject({exportSVG:function(t){return m(g(this,t=v(t),!0),t)}}),w.inject({exportSVG:function(e){e=v(e);var i=this._children,n=this.getView(),s=a.pick(e.bounds,"view"),o=e.matrix||"view"===s&&n._matrix,h=o&&y.read([o]),u="view"===s?new _([0,0],n.getViewSize()):"content"===s?E._getBounds(i,h,{stroke:!0}).rect:_.read([s],0,{readNull:!0}),l={version:"1.1",xmlns:st.svg,"xmlns:xlink":st.xlink};u&&(l.width=u.width,l.height=u.height,(u.x||0===u.x||u.y||0===u.y)&&(l.viewBox=t.rectangle(u)));var c=st.create("svg",l,t),f=c;h&&!h.isIdentity()&&(f=c.appendChild(st.create("g",r(h),t)));for(var d=0,p=i.length;d<p;d++)f.appendChild(g(i[d],e,!0));return m(c,e)}})},new function(){var t,s={};function o(e,r,i,n,s,a){var o=st.get(e,r)||a,h=null==o?n?null:i?"":0:i?o:parseFloat(o);return/%\s*$/.test(o)?h/100*(s?1:t[/x|^width/.test(r)?"width":"height"]):h}function h(t,e,r,i,n,s,a){return e=o(t,e||"x",!1,i,n,s),r=o(t,r||"y",!1,i,n,a),!i||null!=e&&null!=r?new p(e,r):null}function u(t,e,r,i,n){return e=o(t,e||"width",!1,i,n),r=o(t,r||"height",!1,i,n),!i||null!=e&&null!=r?new g(e,r):null}function l(t,e,r){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?R(t)||t:"lookup"===e?r[t]:t}function c(t,e,r,i){var n=t.childNodes,s="clippath"===e,a="defs"===e,o=new M,h=o._project,u=h._currentStyle,l=[];if(s||a||(o=C(o,t,i),h._currentStyle=o._style.clone()),i)for(var c=t.querySelectorAll("defs"),f=0,d=c.length;f<d;f++)I(c[f],r,!1);for(f=0,d=n.length;f<d;f++){var p,m=n[f];1!==m.nodeType||/^defs$/i.test(m.nodeName)||!(p=I(m,r,!1))||p instanceof D||l.push(p)}return o.addChildren(l),s&&(o=C(o.reduce(),t,i)),h._currentStyle=u,(s||a)&&(o.remove(),o=null),o}function f(t,e){for(var r=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),i=[],n=0,s=r.length;n<s;n+=2)i.push(new p(parseFloat(r[n]),parseFloat(r[n+1])));var a=new L(i);return"polygon"===e&&a.closePath(),a}function d(t,e){var r,i=(o(t,"href",!0)||"").substring(1),n="radialgradient"===e;if(i)(r=s[i].getGradient())._radial^n&&((r=r.clone())._radial=n);else{for(var a=t.childNodes,u=[],l=0,c=a.length;l<c;l++){var f=a[l];1===f.nodeType&&u.push(C(new V,f))}r=new j(u,n)}var d,p,m,g="userSpaceOnUse"!==o(t,"gradientUnits",!0);return n?(p=(d=h(t,"cx","cy",!1,g,"50%","50%")).add(o(t,"r",!1,!1,g,"50%"),0),m=h(t,"fx","fy",!0,g)):(d=h(t,"x1","y1",!1,g,"0%","0%"),p=h(t,"x2","y2",!1,g,"100%","0%")),C(new H(r,d,p,m),t)._scaleToBounds=g,null}var m={"#document":function(t,e,r,i){for(var n=t.childNodes,s=0,a=n.length;s<a;s++){var o=n[s];if(1===o.nodeType)return I(o,r,i)}},g:c,svg:c,clippath:c,polygon:f,polyline:f,path:function(t){return B.create(t.getAttribute("d"))},lineargradient:d,radialgradient:d,image:function(t){var e=new T(o(t,"href",!0));return e.on("load",(function(){var e=u(t);this.setSize(e);var r=h(t).add(e.divide(2));this._matrix.append((new y).translate(r))})),e},symbol:function(t,e,r,i){return new D(c(t,e,r,i),!0)},defs:c,use:function(t){var e=(o(t,"href",!0)||"").substring(1),r=s[e],i=h(t);return r?r instanceof D?r.place(i):r.clone().translate(i):null},circle:function(t){return new A.Circle(h(t,"cx","cy"),o(t,"r"))},ellipse:function(t){return new A.Ellipse({center:h(t,"cx","cy"),radius:u(t,"rx","ry")})},rect:function(t){return new A.Rectangle(new _(h(t),u(t)),u(t,"rx","ry"))},line:function(t){return new L.Line(h(t,"x1","y1"),h(t,"x2","y2"))},text:function(t){var e=new G(h(t).add(h(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:c};function v(t,e,r,i){if(t.transform){for(var n=(i.getAttribute(r)||"").split(/\)\s*/g),s=new y,a=0,o=n.length;a<o;a++){var h=n[a];if(!h)break;for(var u=h.split(/\(\s*/),l=u[0],c=u[1].split(/[\s,]+/g),f=0,d=c.length;f<d;f++)c[f]=parseFloat(c[f]);switch(l){case"matrix":s.append(new y(c[0],c[1],c[2],c[3],c[4],c[5]));break;case"rotate":s.rotate(c[0],c[1]||0,c[2]||0);break;case"translate":s.translate(c[0],c[1]||0);break;case"scale":s.scale(c);break;case"skewX":s.skew(c[0],0);break;case"skewY":s.skew(0,c[0])}}t.transform(s)}}function b(t,e,r){var i="fill-opacity"===r?"getFillColor":"getStrokeColor",n=t[i]&&t[i]();n&&n.setAlpha(parseFloat(e))}var x=a.set(a.each(at,(function(t){this[t.attribute]=function(e,r){if(e[t.set]&&(e[t.set](l(r,t.type,t.fromSVG)),"color"===t.type)){var i=e[t.get]();if(i&&i._scaleToBounds){var n=e.getBounds();i.transform((new y).translate(n.getPoint()).scale(n.getSize()))}}}}),{}),{id:function(t,e){s[e]=t,t.setName&&t.setName(e)},"clip-path":function(t,e){var r=R(e);if(r){if((r=r.clone()).setClipMask(!0),!(t instanceof M))return new M(r,t);t.insertChild(0,r)}},gradientTransform:v,transform:v,"fill-opacity":b,"stroke-opacity":b,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var r=e.match(/(.*)%$/);t.setOffset(r?r[1]/100:parseFloat(e))}},viewBox:function(t,e,r,i,n){var s,a=new _(l(e,"array")),o=u(i,null,null,!0);if(t instanceof M){var h=o?o.divide(a.getSize()):1,c=(new y).scale(h).translate(a.getPoint().negate());s=t}else t instanceof D&&(o&&a.setSize(o),s=t._item);if(s){if("visible"!==S(i,"overflow",n)){var f=new A.Rectangle(a);f.setClipMask(!0),s.addChild(f)}c&&s.transform(c)}}});function S(t,e,i){var n=t.attributes[e],s=n&&n.value;if(!s&&t.style){var o=a.camelize(e);(s=t.style[o])||i.node[o]===i.parent[o]||(s=i.node[o])}return s?"none"===s?null:s:r}function C(t,e,i){var n=e.parentNode,s={node:q.getStyles(e)||{},parent:!i&&!/^defs$/i.test(n.tagName)&&q.getStyles(n)||{}};return a.each(x,(function(i,n){var a=S(e,n,s);t=a!==r&&i(t,a,n,e,s)||t})),t}function R(t){var e=t&&t.match(/\((?:["'#]*)([^"')]+)/),r=e&&e[1],n=r&&s[i?r.replace(i.location.href.split("#")[0]+"#",""):r];return n&&n._scaleToBounds&&((n=n.clone())._scaleToBounds=!0),n}function I(e,r,i){var o,h,l,c=e.nodeName.toLowerCase(),f="#document"!==c,d=n.body;i&&f&&(t=ot.getView().getSize(),t=u(e,null,null,!0)||t,o=st.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),h=e.parentNode,l=e.nextSibling,o.appendChild(e),d.appendChild(o));var p=ot.settings,g=p.applyMatrix,v=p.insertItems;p.applyMatrix=!1,p.insertItems=!1;var _=m[c],b=_&&_(e,c,r,i)||null;if(p.insertItems=v,p.applyMatrix=g,b){!f||b instanceof M||(b=C(b,e,i));var y=r.onImport,x=f&&e.getAttribute("data-paper-data");y&&(b=y(e,b,r)||b),r.expandShapes&&b instanceof A&&(b.remove(),b=b.toPath()),x&&(b._data=JSON.parse(x))}return o&&(d.removeChild(o),h&&(l?h.insertBefore(e,l):h.appendChild(e))),i&&(s={},b&&a.pick(r.applyMatrix,g)&&b.matrix.apply(!0,!0)),b}function P(t,i,s){if(!t)return null;i="function"==typeof i?{onLoad:i}:i||{};var a=ot,o=null;function h(n){try{var h="object"==typeof n?n:(new e.DOMParser).parseFromString(n.trim(),"image/svg+xml");if(!h.nodeName)throw h=null,new Error("Unsupported SVG source: "+t);ot=a,o=I(h,i,!0),i&&!1===i.insert||s._insertItem(r,o);var l=i.onLoad;l&&l(o,n)}catch(t){u(t)}}function u(t,e){var r=i.onError;if(!r)throw new Error(t);r(t,e)}if("string"!=typeof t||/^[\s\S]*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var l=new FileReader;return l.onload=function(){h(l.result)},l.onerror=function(){u(l.error)},l.readAsText(t)}h(t)}else{var c=n.getElementById(t);c?h(c):rt({url:t,async:!0,onLoad:h,onError:u})}return o}E.inject({importSVG:function(t,e){return P(t,e,this)}}),w.inject({importSVG:function(t,e){return this.activate(),P(t,e,this)}})};var ot=new(h.inject(a.exports,{Base:a,Numerical:f,Key:J,DomEvent:X,DomElement:q,document:n,window:i,Symbol:D,PlacedSymbol:C}));return ot.agent.node&&s("4AFFV")(ot),"function"==typeof define&&define.amd?define("paper",ot):t&&(t.exports=ot),ot}).call(this,"object"==typeof self?self:null)})),s.register("a5hY7",(function(t,r){var i;e(t.exports,"randomBytes",(()=>i),(t=>i=t)),i=s("1oa4b"),s("eRLLs"),s("9SGAM");var n=s("jxFqc"),a=Object.keys(n),o=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(a);var h=s("wQ7R3");h.pbkdf2,h.pbkdf2Sync;var u=s("hHzFD");u.Cipher,u.createCipher,u.Cipheriv,u.createCipheriv,u.Decipher,u.createDecipher,u.Decipheriv,u.createDecipheriv,u.getCiphers,u.listCiphers;var l=s("ePdJQ");l.DiffieHellmanGroup,l.createDiffieHellmanGroup,l.getDiffieHellman,l.createDiffieHellman,l.DiffieHellman;var c=s("aUuNJ");c.createSign,c.Sign,c.createVerify,c.Verify,s("1R43x");var f=s("8oudU");f.publicEncrypt,f.privateEncrypt,f.publicDecrypt,f.privateDecrypt;var d=s("bxyoK");d.randomFill,d.randomFillSync})),s.register("1oa4b",(function(e,r){var i=s("9Mq5w"),n=65536;var a=s("k0Rto").Buffer,o=t.crypto||t.msCrypto;o&&o.getRandomValues?e.exports=function(t,e){if(t>4294967295)throw new RangeError("requested too many random bytes");var r=a.allocUnsafe(t);if(t>0)if(t>n)for(var s=0;s<t;s+=n)o.getRandomValues(r.slice(s,s+n));else o.getRandomValues(r);return"function"==typeof e?i.nextTick((function(){e(null,r)})):r}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}})),s.register("9Mq5w",(function(t,e){var r,i,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var h,u=[],l=!1,c=-1;function f(){l&&h&&(l=!1,h.length?u=h.concat(u):c=-1,u.length&&d())}function d(){if(!l){var t=o(f);l=!0;for(var e=u.length;e;){for(h=u,u=[];++c<e;)h&&h[c].run();c=-1,e=u.length}h=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new p(t,e)),1!==u.length||l||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}})),s.register("k0Rto",(function(t,e){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=s("awmEs"),i=r.Buffer;function n(t,e){for(var r in t)e[r]=t[r]}function a(t,e,r){return i(t,e,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(n(r,t.exports),t.exports.Buffer=a),a.prototype=Object.create(i.prototype),n(i,a),a.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,r)},a.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=i(t);return void 0!==e?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}})),s.register("awmEs",(function(t,r){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var i,n,a,o;e(t.exports,"Buffer",(()=>i),(t=>i=t)),e(t.exports,"SlowBuffer",(()=>n),(t=>n=t)),e(t.exports,"INSPECT_MAX_BYTES",(()=>a),(t=>a=t)),e(t.exports,"kMaxLength",(()=>o),(t=>o=t));var h=s("cK8LV"),u=s("7y6mg"),l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;i=d,n=function(t){+t!=t&&(t=0);return d.alloc(+t)},a=50;var c=2147483647;function f(t){if(t>c)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,d.prototype),e}function d(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return g(t)}return p(t,e,r)}function p(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!d.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|y(t,e),i=f(r),n=i.write(t,e);n!==r&&(i=i.slice(0,n));return i}(t,e);if(ArrayBuffer.isView(t))return function(t){if(q(t,Uint8Array)){var e=new Uint8Array(t);return _(e.buffer,e.byteOffset,e.byteLength)}return v(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(q(t,ArrayBuffer)||t&&q(t.buffer,ArrayBuffer))return _(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(q(t,SharedArrayBuffer)||t&&q(t.buffer,SharedArrayBuffer)))return _(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return d.from(i,e,r);var n=function(t){if(d.isBuffer(t)){var e=0|b(t.length),r=f(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||X(t.length)?f(0):v(t);if("Buffer"===t.type&&Array.isArray(t.data))return v(t.data)}(t);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return d.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function m(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function g(t){return m(t),f(t<0?0:0|b(t))}function v(t){for(var e=t.length<0?0:0|b(t.length),r=f(e),i=0;i<e;i+=1)r[i]=255&t[i];return r}function _(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(i,d.prototype),i}function b(t){if(t>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|t}function y(t,e){if(d.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||q(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(t).length;default:if(n)return i?-1:j(t).length;e=(""+e).toLowerCase(),n=!0}}function x(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return N(this,e,r);case"latin1":case"binary":return k(this,e,r);case"base64":return R(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function w(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function E(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),X(r=+r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=d.from(e,i)),d.isBuffer(e))return 0===e.length?-1:M(t,e,r,i,n);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):M(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function M(t,e,r,i,n){var s,a=1,o=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;a=2,o/=2,h/=2,r/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(n){var l=-1;for(s=r;s<o;s++)if(u(t,s)===u(e,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===h)return l*a}else-1!==l&&(s-=s-l),l=-1}else for(r+h>o&&(r=o-h),s=r;s>=0;s--){for(var c=!0,f=0;f<h;f++)if(u(t,s+f)!==u(e,f)){c=!1;break}if(c)return s}return-1}function S(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=e.length;i>s/2&&(i=s/2);for(var a=0;a<i;++a){var o=parseInt(e.substr(2*a,2),16);if(X(o))return a;t[r+a]=o}return a}function A(t,e,r,i){return W(j(e,t.length-r),t,r,i)}function T(t,e,r,i){return W(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,i)}function C(t,e,r,i){return W(V(e),t,r,i)}function D(t,e,r,i){return W(function(t,e){for(var r,i,n,s=[],a=0;a<t.length&&!((e-=2)<0);++a)i=(r=t.charCodeAt(a))>>8,n=r%256,s.push(n),s.push(i);return s}(e,t.length-r),t,r,i)}function R(t,e,r){return 0===e&&r===t.length?h.fromByteArray(t):h.fromByteArray(t.slice(e,r))}function I(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var s,a,o,h,u=t[n],l=null,c=u>239?4:u>223?3:u>191?2:1;if(n+c<=r)switch(c){case 1:u<128&&(l=u);break;case 2:128==(192&(s=t[n+1]))&&(h=(31&u)<<6|63&s)>127&&(l=h);break;case 3:s=t[n+1],a=t[n+2],128==(192&s)&&128==(192&a)&&(h=(15&u)<<12|(63&s)<<6|63&a)>2047&&(h<55296||h>57343)&&(l=h);break;case 4:s=t[n+1],a=t[n+2],o=t[n+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&(h=(15&u)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&h<1114112&&(l=h)}null===l?(l=65533,c=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),n+=c}return function(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);var r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=P));return r}(i)}o=c,d.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(t,e,r){return p(t,e,r)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(t,e,r){return function(t,e,r){return m(t),t<=0?f(t):void 0!==e?"string"==typeof r?f(t).fill(e,r):f(t).fill(e):f(t)}(t,e,r)},d.allocUnsafe=function(t){return g(t)},d.allocUnsafeSlow=function(t){return g(t)},d.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==d.prototype},d.compare=function(t,e){if(q(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),q(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(t)||!d.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},d.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return d.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=d.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var s=t[r];if(q(s,Uint8Array))n+s.length>i.length?d.from(s).copy(i,n):Uint8Array.prototype.set.call(i,s,n);else{if(!d.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n)}n+=s.length}return i},d.byteLength=y,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)w(this,e,e+1);return this},d.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},d.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},d.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):x.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(t){if(!d.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===d.compare(this,t)},d.prototype.inspect=function(){var t="",e=a;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},l&&(d.prototype[l]=d.prototype.inspect),d.prototype.compare=function(t,e,r,i,n){if(q(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(e>>>=0),o=Math.min(s,a),h=this.slice(i,n),u=t.slice(e,r),l=0;l<o;++l)if(h[l]!==u[l]){s=h[l],a=u[l];break}return s<a?-1:a<s?1:0},d.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},d.prototype.indexOf=function(t,e,r){return E(this,t,e,r,!0)},d.prototype.lastIndexOf=function(t,e,r){return E(this,t,e,r,!1)},d.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return S(this,t,e,r);case"utf8":case"utf-8":return A(this,t,e,r);case"ascii":case"latin1":case"binary":return T(this,t,e,r);case"base64":return C(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function N(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function k(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function B(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=Y[t[s]];return n}function L(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,r,i,n,s){if(!d.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function U(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function z(t,e,r,i,n){return e=+e,r>>>=0,n||U(t,0,r,4),u.write(t,e,r,i,23,4),r+4}function G(t,e,r,i,n){return e=+e,r>>>=0,n||U(t,0,r,8),u.write(t,e,r,i,52,8),r+8}d.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return Object.setPrototypeOf(i,d.prototype),i},d.prototype.readUintLE=d.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i},d.prototype.readUintBE=d.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},d.prototype.readUint8=d.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},d.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},d.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var i=e,n=1,s=this[t+--i];i>0&&(n*=256);)s+=this[t+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},d.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},d.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},d.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},d.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),u.read(this,t,!0,23,4)},d.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),u.read(this,t,!1,23,4)},d.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),u.read(this,t,!0,52,8)},d.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),u.read(this,t,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(t,e,r,i){(t=+t,e>>>=0,r>>>=0,i)||F(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n&255;return e+r},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(t,e,r,i){(t=+t,e>>>=0,r>>>=0,i)||F(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s&255;return e+r},d.prototype.writeUint8=d.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,255,0),this[e]=255&t,e+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},d.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);F(this,t,e,r,n-1,-n)}var s=0,a=1,o=0;for(this[e]=255&t;++s<r&&(a*=256);)t<0&&0===o&&0!==this[e+s-1]&&(o=1),this[e+s]=(t/a>>0)-o&255;return e+r},d.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);F(this,t,e,r,n-1,-n)}var s=r-1,a=1,o=0;for(this[e+s]=255&t;--s>=0&&(a*=256);)t<0&&0===o&&0!==this[e+s+1]&&(o=1),this[e+s]=(t/a>>0)-o&255;return e+r},d.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},d.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},d.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},d.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},d.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},d.prototype.writeFloatLE=function(t,e,r){return z(this,t,e,!0,r)},d.prototype.writeFloatBE=function(t,e,r){return z(this,t,e,!1,r)},d.prototype.writeDoubleLE=function(t,e,r){return G(this,t,e,!0,r)},d.prototype.writeDoubleBE=function(t,e,r){return G(this,t,e,!1,r)},d.prototype.copy=function(t,e,r,i){if(!d.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n=i-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,i):Uint8Array.prototype.set.call(t,this.subarray(r,i),e),n},d.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!d.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var n=t.charCodeAt(0);("utf8"===i&&n<128||"latin1"===i)&&(t=n)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=d.isBuffer(t)?t:d.from(t,i),o=a.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%o]}return this};var H=/[^+/0-9A-Za-z-_]/g;function j(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],a=0;a<i;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(a+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function V(t){return h.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function W(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function X(t){return t!=t}var Y=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)e[i+n]=t[r]+t[n];return e}()})),s.register("cK8LV",(function(t,r){var i,n;e(t.exports,"toByteArray",(()=>i),(t=>i=t)),e(t.exports,"fromByteArray",(()=>n),(t=>n=t)),i=function(t){var e,r,i=c(t),n=i[0],s=i[1],h=new o(function(t,e,r){return 3*(e+r)/4-r}(0,n,s)),u=0,l=s>0?n-4:n;for(r=0;r<l;r+=4)e=a[t.charCodeAt(r)]<<18|a[t.charCodeAt(r+1)]<<12|a[t.charCodeAt(r+2)]<<6|a[t.charCodeAt(r+3)],h[u++]=e>>16&255,h[u++]=e>>8&255,h[u++]=255&e;2===s&&(e=a[t.charCodeAt(r)]<<2|a[t.charCodeAt(r+1)]>>4,h[u++]=255&e);1===s&&(e=a[t.charCodeAt(r)]<<10|a[t.charCodeAt(r+1)]<<4|a[t.charCodeAt(r+2)]>>2,h[u++]=e>>8&255,h[u++]=255&e);return h},n=function(t){for(var e,r=t.length,i=r%3,n=[],a=16383,o=0,h=r-i;o<h;o+=a)n.push(f(t,o,o+a>h?h:o+a));1===i?(e=t[r-1],n.push(s[e>>2]+s[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],n.push(s[e>>10]+s[e>>4&63]+s[e<<2&63]+"="));return n.join("")};for(var s=[],a=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,l=h.length;u<l;++u)s[u]=h[u],a[h.charCodeAt(u)]=u;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function f(t,e,r){for(var i,n,a=[],o=e;o<r;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),a.push(s[(n=i)>>18&63]+s[n>>12&63]+s[n>>6&63]+s[63&n]);return a.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63})),s.register("7y6mg",(function(t,r){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var i,n;e(t.exports,"read",(()=>i),(t=>i=t)),e(t.exports,"write",(()=>n),(t=>n=t)),i=function(t,e,r,i,n){var s,a,o=8*n-i-1,h=(1<<o)-1,u=h>>1,l=-7,c=r?n-1:0,f=r?-1:1,d=t[e+c];for(c+=f,s=d&(1<<-l)-1,d>>=-l,l+=o;l>0;s=256*s+t[e+c],c+=f,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=i;l>0;a=256*a+t[e+c],c+=f,l-=8);if(0===s)s=1-u;else{if(s===h)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),s-=u}return(d?-1:1)*a*Math.pow(2,s-i)},n=function(t,e,r,i,n,s){var a,o,h,u=8*s-n-1,l=(1<<u)-1,c=l>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),(e+=a+c>=1?f/h:f*Math.pow(2,1-c))*h>=2&&(a++,h/=2),a+c>=l?(o=0,a=l):a+c>=1?(o=(e*h-1)*Math.pow(2,n),a+=c):(o=e*Math.pow(2,c-1)*Math.pow(2,n),a=0));n>=8;t[r+d]=255&o,d+=p,o/=256,n-=8);for(a=a<<n|o,u+=n;u>0;t[r+d]=255&a,d+=p,a/=256,u-=8);t[r+d-p]|=128*m}})),s.register("eRLLs",(function(t,e){var r=s("6cuMU"),i=s("liMpH"),n=s("D6ODP"),a=s("9iz0U"),o=s("eYksn");function h(t){o.call(this,"digest"),this._hash=t}r(h,o),h.prototype._update=function(t){this._hash.update(t)},h.prototype._final=function(){return this._hash.digest()},t.exports=function(t){return"md5"===(t=t.toLowerCase())?new i:"rmd160"===t||"ripemd160"===t?new n:new h(a(t))}})),s.register("6cuMU",(function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}})),s.register("liMpH",(function(t,e){var r=s("6cuMU"),i=s("ikMd7"),n=s("k0Rto").Buffer,a=new Array(16);function o(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function h(t,e){return t<<e|t>>>32-e}function u(t,e,r,i,n,s,a){return h(t+(e&r|~e&i)+n+s|0,a)+e|0}function l(t,e,r,i,n,s,a){return h(t+(e&i|r&~i)+n+s|0,a)+e|0}function c(t,e,r,i,n,s,a){return h(t+(e^r^i)+n+s|0,a)+e|0}function f(t,e,r,i,n,s,a){return h(t+(r^(e|~i))+n+s|0,a)+e|0}r(o,i),o.prototype._update=function(){for(var t=a,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);var r=this._a,i=this._b,n=this._c,s=this._d;r=u(r,i,n,s,t[0],3614090360,7),s=u(s,r,i,n,t[1],3905402710,12),n=u(n,s,r,i,t[2],606105819,17),i=u(i,n,s,r,t[3],3250441966,22),r=u(r,i,n,s,t[4],4118548399,7),s=u(s,r,i,n,t[5],1200080426,12),n=u(n,s,r,i,t[6],2821735955,17),i=u(i,n,s,r,t[7],4249261313,22),r=u(r,i,n,s,t[8],1770035416,7),s=u(s,r,i,n,t[9],2336552879,12),n=u(n,s,r,i,t[10],4294925233,17),i=u(i,n,s,r,t[11],2304563134,22),r=u(r,i,n,s,t[12],1804603682,7),s=u(s,r,i,n,t[13],4254626195,12),n=u(n,s,r,i,t[14],2792965006,17),r=l(r,i=u(i,n,s,r,t[15],1236535329,22),n,s,t[1],4129170786,5),s=l(s,r,i,n,t[6],3225465664,9),n=l(n,s,r,i,t[11],643717713,14),i=l(i,n,s,r,t[0],3921069994,20),r=l(r,i,n,s,t[5],3593408605,5),s=l(s,r,i,n,t[10],38016083,9),n=l(n,s,r,i,t[15],3634488961,14),i=l(i,n,s,r,t[4],3889429448,20),r=l(r,i,n,s,t[9],568446438,5),s=l(s,r,i,n,t[14],3275163606,9),n=l(n,s,r,i,t[3],4107603335,14),i=l(i,n,s,r,t[8],1163531501,20),r=l(r,i,n,s,t[13],2850285829,5),s=l(s,r,i,n,t[2],4243563512,9),n=l(n,s,r,i,t[7],1735328473,14),r=c(r,i=l(i,n,s,r,t[12],2368359562,20),n,s,t[5],4294588738,4),s=c(s,r,i,n,t[8],2272392833,11),n=c(n,s,r,i,t[11],1839030562,16),i=c(i,n,s,r,t[14],4259657740,23),r=c(r,i,n,s,t[1],2763975236,4),s=c(s,r,i,n,t[4],1272893353,11),n=c(n,s,r,i,t[7],4139469664,16),i=c(i,n,s,r,t[10],3200236656,23),r=c(r,i,n,s,t[13],681279174,4),s=c(s,r,i,n,t[0],3936430074,11),n=c(n,s,r,i,t[3],3572445317,16),i=c(i,n,s,r,t[6],76029189,23),r=c(r,i,n,s,t[9],3654602809,4),s=c(s,r,i,n,t[12],3873151461,11),n=c(n,s,r,i,t[15],530742520,16),r=f(r,i=c(i,n,s,r,t[2],3299628645,23),n,s,t[0],4096336452,6),s=f(s,r,i,n,t[7],1126891415,10),n=f(n,s,r,i,t[14],2878612391,15),i=f(i,n,s,r,t[5],4237533241,21),r=f(r,i,n,s,t[12],1700485571,6),s=f(s,r,i,n,t[3],2399980690,10),n=f(n,s,r,i,t[10],4293915773,15),i=f(i,n,s,r,t[1],2240044497,21),r=f(r,i,n,s,t[8],1873313359,6),s=f(s,r,i,n,t[15],4264355552,10),n=f(n,s,r,i,t[6],2734768916,15),i=f(i,n,s,r,t[13],1309151649,21),r=f(r,i,n,s,t[4],4149444226,6),s=f(s,r,i,n,t[11],3174756917,10),n=f(n,s,r,i,t[2],718787259,15),i=f(i,n,s,r,t[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+i|0,this._c=this._c+n|0,this._d=this._d+s|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=n.allocUnsafe(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t},t.exports=o})),s.register("ikMd7",(function(t,e){var r=s("k0Rto").Buffer,i=s("l8KM5").Transform;function n(t){i.call(this),this._block=r.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}s("6cuMU")(n,i),n.prototype._transform=function(t,e,r){var i=null;try{this.update(t,e)}catch(t){i=t}r(i)},n.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(t){e=t}t(e)},n.prototype.update=function(t,e){if(function(t,e){if(!r.isBuffer(t)&&"string"!=typeof t)throw new TypeError(e+" must be a string or a buffer")}(t,"Data"),this._finalized)throw new Error("Digest already called");r.isBuffer(t)||(t=r.from(t,e));for(var i=this._block,n=0;this._blockOffset+t.length-n>=this._blockSize;){for(var s=this._blockOffset;s<this._blockSize;)i[s++]=t[n++];this._update(),this._blockOffset=0}for(;n<t.length;)i[this._blockOffset++]=t[n++];for(var a=0,o=8*t.length;o>0;++a)this._length[a]+=o,(o=this._length[a]/4294967296|0)>0&&(this._length[a]-=4294967296*o);return this},n.prototype._update=function(){throw new Error("_update is not implemented")},n.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();void 0!==t&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return e},n.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=n})),s.register("l8KM5",(function(t,e){(e=t.exports=s("340fO")).Stream=e,e.Readable=e,e.Writable=s("lWtyM"),e.Duplex=s("1SlAW"),e.Transform=s("f7L7V"),e.PassThrough=s("dX7Dt"),e.finished=s("f6xbQ"),e.pipeline=s("2mqHM")})),s.register("340fO",(function(e,r){var i,n=s("9Mq5w");e.exports=A,A.ReadableState=S;s("k4yOc").EventEmitter;var a=function(t,e){return t.listeners(e).length},o=s("4HDlr"),h=s("awmEs").Buffer,u=t.Uint8Array||function(){};var l,c=s("4AFFV");l=c&&c.debuglog?c.debuglog("stream"):function(){};var f,d,p,m=s("3QRBN"),g=s("5CW71"),v=s("71wq3").getHighWaterMark,_=s("kdLmP").codes,b=_.ERR_INVALID_ARG_TYPE,y=_.ERR_STREAM_PUSH_AFTER_EOF,x=_.ERR_METHOD_NOT_IMPLEMENTED,w=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s("6cuMU")(A,o);var E=g.errorOrDestroy,M=["error","close","destroy","pause","resume"];function S(t,e,r){i=i||s("1SlAW"),t=t||{},"boolean"!=typeof r&&(r=e instanceof i),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=v(this,t,"readableHighWaterMark",r),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=s("bWgSm").StringDecoder),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function A(t){if(i=i||s("1SlAW"),!(this instanceof A))return new A(t);var e=this instanceof i;this._readableState=new S(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function T(t,e,r,i,n){l("readableAddChunk",e);var s,a=t._readableState;if(null===e)a.reading=!1,function(t,e){if(l("onEofChunk"),e.ended)return;if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?I(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,P(t)))}(t,a);else if(n||(s=function(t,e){var r;i=e,h.isBuffer(i)||i instanceof u||"string"==typeof e||void 0===e||t.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],e));var i;return r}(a,e)),s)E(t,s);else if(a.objectMode||e&&e.length>0)if("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===h.prototype||(e=function(t){return h.from(t)}(e)),i)a.endEmitted?E(t,new w):C(t,a,e,!0);else if(a.ended)E(t,new y);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(e=a.decoder.write(e),a.objectMode||0!==e.length?C(t,a,e,!1):N(t,a)):C(t,a,e,!1)}else i||(a.reading=!1,N(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function C(t,e,r,i){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&I(t)),N(t,e)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),A.prototype.destroy=g.destroy,A.prototype._undestroy=g.undestroy,A.prototype._destroy=function(t,e){e(t)},A.prototype.push=function(t,e){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof t&&((e=e||i.defaultEncoding)!==i.encoding&&(t=h.from(t,e),e=""),r=!0),T(this,t,e,!1,r)},A.prototype.unshift=function(t){return T(this,t,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(t){f||(f=s("bWgSm").StringDecoder);var e=new f(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var D=1073741824;function R(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=D?t=D:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function I(t){var e=t._readableState;l("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(l("emitReadable",e.flowing),e.emittedReadable=!0,n.nextTick(P,t))}function P(t){var e=t._readableState;l("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,F(t)}function N(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(k,t,e))}function k(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var r=e.length;if(l("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}function B(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function L(t){l("readable nexttick read 0"),t.read(0)}function O(t,e){l("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),F(t),e.flowing&&!e.reading&&t.read(0)}function F(t){var e=t._readableState;for(l("flow",e.flowing);e.flowing&&null!==t.read(););}function U(t,e){return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r);var r}function z(t){var e=t._readableState;l("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,n.nextTick(G,e,t))}function G(t,e){if(l("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}function H(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}A.prototype.read=function(t){l("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return l("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?z(this):I(this),null;if(0===(t=R(t,e))&&e.ended)return 0===e.length&&z(this),null;var i,n=e.needReadable;return l("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&l("length less than watermark",n=!0),e.ended||e.reading?l("reading or ended",n=!1):n&&(l("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=R(r,e))),null===(i=t>0?U(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&z(this)),null!==i&&this.emit("data",i),i},A.prototype._read=function(t){E(this,new x("_read()"))},A.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,e);var s=(!e||!1!==e.end)&&t!==n.stdout&&t!==n.stderr?h:g;function o(e,n){l("onunpipe"),e===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),t.removeListener("close",p),t.removeListener("finish",m),t.removeListener("drain",u),t.removeListener("error",d),t.removeListener("unpipe",o),r.removeListener("end",h),r.removeListener("end",g),r.removeListener("data",f),c=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||u())}function h(){l("onend"),t.end()}i.endEmitted?n.nextTick(s):r.once("end",s),t.on("unpipe",o);var u=function(t){return function(){var e=t._readableState;l("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,F(t))}}(r);t.on("drain",u);var c=!1;function f(e){l("ondata");var n=t.write(e);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==H(i.pipes,t))&&!c&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(e){l("onerror",e),g(),t.removeListener("error",d),0===a(t,"error")&&E(t,e)}function p(){t.removeListener("finish",m),g()}function m(){l("onfinish"),t.removeListener("close",p),g()}function g(){l("unpipe"),r.unpipe(t)}return r.on("data",f),function(t,e,r){if("function"==typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r)}(t,"error",d),t.once("close",p),t.once("finish",m),t.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),t},A.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r)),this;if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=H(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r)),this},A.prototype.on=function(t,e){var r=o.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?I(this):i.reading||n.nextTick(L,this))),r},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(t,e){var r=o.prototype.removeListener.call(this,t,e);return"readable"===t&&n.nextTick(B,this),r},A.prototype.removeAllListeners=function(t){var e=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||n.nextTick(B,this),e},A.prototype.resume=function(){var t=this._readableState;return t.flowing||(l("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(O,t,e))}(this,t)),t.paused=!1,this},A.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;for(var n in t.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var t=r.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(n){(l("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n)||(r.objectMode||n&&n.length)&&(e.push(n)||(i=!0,t.pause()))})),t)void 0===this[n]&&"function"==typeof t[n]&&(this[n]=function(e){return function(){return t[e].apply(t,arguments)}}(n));for(var s=0;s<M.length;s++)t.on(M[s],this.emit.bind(this,M[s]));return this._read=function(e){l("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=s("Mkrm6")),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),A._fromList=U,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(t,e){return void 0===p&&(p=s("7UlCx")),p(A,t,e)})})),s.register("k4yOc",(function(t,e){var r,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",n),r([].slice.call(arguments))}g(t,e,s,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&g(t,"error",e,r)}(t,n,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function h(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function l(t,e,r,i){var n,s,a,o;if(h(r),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),void 0===a)a=s[e]=r,++t._eventsCount;else if("function"==typeof a?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),(n=u(t))>0&&a.length>n&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=a.length,o=l,console&&console.warn&&console.warn(o)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=c.bind(i);return n.listener=r,i.wrapFn=n,n}function d(t,e,r){var i=t._events;if(void 0===i)return[];var n=i[e];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(n):m(n,n.length)}function p(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function g(t,e,r,i){if("function"==typeof t.on)i.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");o=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i="error"===t,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var h=s[t];if(void 0===h)return!1;if("function"==typeof h)n(h,this,e);else{var u=h.length,l=m(h,u);for(r=0;r<u;++r)n(l[r],this,e)}return!0},a.prototype.addListener=function(t,e){return l(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return l(this,t,e,!0)},a.prototype.once=function(t,e){return h(e),this.on(t,f(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return h(e),this.prependListener(t,f(this,t,e)),this},a.prototype.removeListener=function(t,e){var r,i,n,s,a;if(h(e),void 0===(i=this._events))return this;if(void 0===(r=i[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){a=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,n),1===r.length&&(i[t]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",t,a||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}})),s.register("4HDlr",(function(t,e){t.exports=s("k4yOc").EventEmitter})),s.register("3QRBN",(function(t,e){function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=s("awmEs").Buffer,o=s("4AFFV").inspect,h=o&&o.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e,s,u;return e=t,s=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r}},{key:"concat",value:function(t){if(0===this.length)return a.alloc(0);for(var e,r,i,n=a.allocUnsafe(t>>>0),s=this.head,o=0;s;)e=s.data,r=n,i=o,a.prototype.copy.call(e,r,i),o+=s.data.length,s=s.next;return n}},{key:"consume",value:function(t,e){var r;return t<this.head.data.length?(r=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):r=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,r=1,i=e.data;for(t-=i.length;e=e.next;){var n=e.data,s=t>n.length?n.length:t;if(s===n.length?i+=n:i+=n.slice(0,t),0==(t-=s)){s===n.length?(++r,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=n.slice(s));break}++r}return this.length-=r,i}},{key:"_getBuffer",value:function(t){var e=a.allocUnsafe(t),r=this.head,i=1;for(r.data.copy(e),t-=r.data.length;r=r.next;){var n=r.data,s=t>n.length?n.length:t;if(n.copy(e,e.length-t,0,s),0==(t-=s)){s===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(s));break}++i}return this.length-=i,e}},{key:h,value:function(t,e){return o(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}],s&&n(e.prototype,s),u&&n(e,u),t}()})),s.register("5CW71",(function(t,e){var r=s("9Mq5w");function i(t,e){a(t,e),n(t)}function n(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function a(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var s=this,o=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return o||h?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(a,this,t)):r.nextTick(a,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?s._writableState?s._writableState.errorEmitted?r.nextTick(n,s):(s._writableState.errorEmitted=!0,r.nextTick(i,s,t)):r.nextTick(i,s,t):e?(r.nextTick(n,s),e(t)):r.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}}})),s.register("71wq3",(function(t,e){var r=s("kdLmP").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,i,n){var s=function(t,e,r){return null!=t.highWaterMark?t.highWaterMark:e?t[r]:null}(e,n,i);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(n?i:"highWaterMark",s);return Math.floor(s)}return t.objectMode?16:16384}}})),s.register("kdLmP",(function(t,r){var i;e(t.exports,"codes",(()=>i),(t=>i=t));var n={};function s(t,e,r){r||(r=Error);var i=function(t){var r,i;function n(r,i,n){return t.call(this,function(t,r,i){return"string"==typeof e?e:e(t,r,i)}(r,i,n))||this}return i=t,(r=n).prototype=Object.create(i.prototype),r.prototype.constructor=r,r.__proto__=i,n}(r);i.prototype.name=r.name,i.prototype.code=t,n[t]=i}function a(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map((function(t){return String(t)})),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:2===r?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}s("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),s("ERR_INVALID_ARG_TYPE",(function(t,e,r){var i,n,s,o;if("string"==typeof e&&(n="not ",e.substr(!s||s<0?0:+s,n.length)===n)?(i="must not be",e=e.replace(/^not /,"")):i="must be",function(t,e,r){return(void 0===r||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}(t," argument"))o="The ".concat(t," ").concat(i," ").concat(a(e,"type"));else{var h=function(t,e,r){return"number"!=typeof r&&(r=0),!(r+e.length>t.length)&&-1!==t.indexOf(e,r)}(t,".")?"property":"argument";o='The "'.concat(t,'" ').concat(h," ").concat(i," ").concat(a(e,"type"))}return o+=". Received type ".concat(typeof r)}),TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),i=n})),s.register("1SlAW",(function(t,e){var r=s("9Mq5w"),i=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};t.exports=l;var n=s("340fO"),a=s("lWtyM");s("6cuMU")(l,n);for(var o=i(a.prototype),h=0;h<o.length;h++){var u=o[h];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(t){if(!(this instanceof l))return new l(t);n.call(this,t),a.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||r.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})})),s.register("lWtyM",(function(e,r){var i,n=s("9Mq5w");function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,r){var i=t.entry;t.entry=null;for(;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}(e,t)}}e.exports=A,A.WritableState=S;var o={deprecate:s("bmKAk")},h=s("4HDlr"),u=s("awmEs").Buffer,l=t.Uint8Array||function(){};var c,f=s("5CW71"),d=s("71wq3").getHighWaterMark,p=s("kdLmP").codes,m=p.ERR_INVALID_ARG_TYPE,g=p.ERR_METHOD_NOT_IMPLEMENTED,v=p.ERR_MULTIPLE_CALLBACK,_=p.ERR_STREAM_CANNOT_PIPE,b=p.ERR_STREAM_DESTROYED,y=p.ERR_STREAM_NULL_VALUES,x=p.ERR_STREAM_WRITE_AFTER_END,w=p.ERR_UNKNOWN_ENCODING,E=f.errorOrDestroy;function M(){}function S(t,e,r){i=i||s("1SlAW"),t=t||{},"boolean"!=typeof r&&(r=e instanceof i),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var r=t._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new v;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),e)!function(t,e,r,i,s){--e.pendingcb,r?(n.nextTick(s,i),n.nextTick(P,t,e),t._writableState.errorEmitted=!0,E(t,i)):(s(i),t._writableState.errorEmitted=!0,E(t,i),P(t,e))}(t,r,i,e,s);else{var a=R(r)||t.destroyed;a||r.corked||r.bufferProcessing||!r.bufferedRequest||D(t,r),i?n.nextTick(C,t,r,a,s):C(t,r,a,s)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function A(t){var e=this instanceof(i=i||s("1SlAW"));if(!e&&!c.call(A,this))return new A(t);this._writableState=new S(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),h.call(this)}function T(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new b("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function C(t,e,r,i){r||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,i(),P(t,e)}function D(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var o=0,h=!0;r;)n[o]=r,r.isBuf||(h=!1),r=r.next,o+=1;n.allBuffers=h,T(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,c=r.callback;if(T(t,e,!1,e.objectMode?1:u.length,u,l,c),r=r.next,e.bufferedRequestCount--,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}function R(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function I(t,e){t._final((function(r){e.pendingcb--,r&&E(t,r),e.prefinished=!0,t.emit("prefinish"),P(t,e)}))}function P(t,e){var r=R(e);if(r&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,n.nextTick(I,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}s("6cuMU")(A,h),S.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(S.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(t){return!!c.call(this,t)||this===A&&(t&&t._writableState instanceof S)}})):c=function(t){return t instanceof this},A.prototype.pipe=function(){E(this,new _)},A.prototype.write=function(t,e,r){var i,s=this._writableState,a=!1,o=!s.objectMode&&(i=t,u.isBuffer(i)||i instanceof l);return o&&!u.isBuffer(t)&&(t=function(t){return u.from(t)}(t)),"function"==typeof e&&(r=e,e=null),o?e="buffer":e||(e=s.defaultEncoding),"function"!=typeof r&&(r=M),s.ending?function(t,e){var r=new x;E(t,r),n.nextTick(e,r)}(this,r):(o||function(t,e,r,i){var s;return null===r?s=new y:"string"==typeof r||e.objectMode||(s=new m("chunk",["string","Buffer"],r)),!s||(E(t,s),n.nextTick(i,s),!1)}(this,s,t,r))&&(s.pendingcb++,a=function(t,e,r,i,n,s){if(!r){var a=function(t,e,r){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=u.from(e,r));return e}(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var h=e.length<e.highWaterMark;h||(e.needDrain=!0);if(e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else T(t,e,!1,o,i,n,s);return h}(this,s,o,t,e,r)),a},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||D(this,t))},A.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new w(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(t,e,r){r(new g("_write()"))},A.prototype._writev=null,A.prototype.end=function(t,e,r){var i=this._writableState;return"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,e,r){e.ending=!0,P(t,e),r&&(e.finished?n.nextTick(r):t.once("finish",r));e.ended=!0,t.writable=!1}(this,i,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),A.prototype.destroy=f.destroy,A.prototype._undestroy=f.undestroy,A.prototype._destroy=function(t,e){e(t)}})),s.register("bmKAk",(function(e,r){function i(e){try{if(!t.localStorage)return!1}catch(t){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(t,e){if(i("noDeprecation"))return t;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}})),s.register("bWgSm",(function(t,r){var i;e(t.exports,"StringDecoder",(()=>i),(t=>i=t));var n=s("k0Rto").Buffer,a=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===a||!a(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=f,this.end=d,e=3;break;default:return this.write=p,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function h(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function u(t){var e=this.lastTotal-this.lastNeed,r=function(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function f(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function p(t){return t.toString(this.encoding)}function m(t){return t&&t.length?this.write(t):""}i=o,o.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var r=function(t,e,r){var i=e.length-1;if(i<r)return 0;var n=h(e[i]);if(n>=0)return n>0&&(t.lastNeed=n-1),n;if(--i<r||-2===n)return 0;if(n=h(e[i]),n>=0)return n>0&&(t.lastNeed=n-2),n;if(--i<r||-2===n)return 0;if(n=h(e[i]),n>=0)return n>0&&(2===n?n=0:t.lastNeed=n-3),n;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}})),s.register("Mkrm6",(function(t,e){var r,i=s("9Mq5w");function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=s("f6xbQ"),o=Symbol("lastResolve"),h=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function p(t,e){return{value:t,done:e}}function m(t){var e=t[o];if(null!==e){var r=t[d].read();null!==r&&(t[c]=null,t[o]=null,t[h]=null,e(p(r,!1)))}}function g(t){i.nextTick(m,t)}var v=Object.getPrototypeOf((function(){})),_=Object.setPrototypeOf((n(r={get stream(){return this[d]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[l])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(e,r){i.nextTick((function(){t[u]?r(t[u]):e(p(void 0,!0))}))}));var r,n=this[c];if(n)r=new Promise(function(t,e){return function(r,i){t.then((function(){e[l]?r(p(void 0,!0)):e[f](r,i)}),i)}}(n,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(p(s,!1));r=new Promise(this[f])}return this[c]=r,r}},Symbol.asyncIterator,(function(){return this})),n(r,"return",(function(){var t=this;return new Promise((function(e,r){t[d].destroy(null,(function(t){t?r(t):e(p(void 0,!0))}))}))})),r),v);t.exports=function(t){var e,r=Object.create(_,(n(e={},d,{value:t,writable:!0}),n(e,o,{value:null,writable:!0}),n(e,h,{value:null,writable:!0}),n(e,u,{value:null,writable:!0}),n(e,l,{value:t._readableState.endEmitted,writable:!0}),n(e,f,{value:function(t,e){var i=r[d].read();i?(r[c]=null,r[o]=null,r[h]=null,t(p(i,!1))):(r[o]=t,r[h]=e)},writable:!0}),e));return r[c]=null,a(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=r[h];return null!==e&&(r[c]=null,r[o]=null,r[h]=null,e(t)),void(r[u]=t)}var i=r[o];null!==i&&(r[c]=null,r[o]=null,r[h]=null,i(p(void 0,!0))),r[l]=!0})),t.on("readable",g.bind(null,r)),r}})),s.register("f6xbQ",(function(t,e){var r=s("kdLmP").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function t(e,n,s){if("function"==typeof n)return t(e,null,n);n||(n={}),s=function(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}(s||i);var a=n.readable||!1!==n.readable&&e.readable,o=n.writable||!1!==n.writable&&e.writable,h=function(){e.writable||l()},u=e._writableState&&e._writableState.finished,l=function(){o=!1,u=!0,a||s.call(e)},c=e._readableState&&e._readableState.endEmitted,f=function(){a=!1,c=!0,o||s.call(e)},d=function(t){s.call(e,t)},p=function(){var t;return a&&!c?(e._readableState&&e._readableState.ended||(t=new r),s.call(e,t)):o&&!u?(e._writableState&&e._writableState.ended||(t=new r),s.call(e,t)):void 0},m=function(){e.req.on("finish",l)};return!function(t){return t.setHeader&&"function"==typeof t.abort}(e)?o&&!e._writableState&&(e.on("end",h),e.on("close",h)):(e.on("complete",l),e.on("abort",p),e.req?m():e.on("request",m)),e.on("end",f),e.on("finish",l),!1!==n.error&&e.on("error",d),e.on("close",p),function(){e.removeListener("complete",l),e.removeListener("abort",p),e.removeListener("request",m),e.req&&e.req.removeListener("finish",l),e.removeListener("end",h),e.removeListener("close",h),e.removeListener("finish",l),e.removeListener("end",f),e.removeListener("error",d),e.removeListener("close",p)}}})),s.register("7UlCx",(function(t,e){t.exports=function(){throw new Error("Readable.from is not available in the browser")}})),s.register("f7L7V",(function(t,e){t.exports=l;var r=s("kdLmP").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,n=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,h=s("1SlAW");function u(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new n);r.writechunk=null,r.writecb=null,null!=e&&this.push(e),i(t);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function l(t){if(!(this instanceof l))return new l(t);h.call(this,t),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",c)}function c(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(e,r){f(t,e,r)}))}function f(t,e,r){if(e)return t.emit("error",e);if(null!=r&&t.push(r),t._writableState.length)throw new o;if(t._transformState.transforming)throw new a;return t.push(null)}s("6cuMU")(l,h),l.prototype.push=function(t,e){return this._transformState.needTransform=!1,h.prototype.push.call(this,t,e)},l.prototype._transform=function(t,e,r){r(new i("_transform()"))},l.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},l.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},l.prototype._destroy=function(t,e){h.prototype._destroy.call(this,t,(function(t){e(t)}))}})),s.register("dX7Dt",(function(t,e){t.exports=i;var r=s("f7L7V");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}s("6cuMU")(i,r),i.prototype._transform=function(t,e,r){r(null,t)}})),s.register("2mqHM",(function(t,e){var r;var i=s("kdLmP").codes,n=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function o(t){if(t)throw t}function h(t,e,i,n){n=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(n);var o=!1;t.on("close",(function(){o=!0})),void 0===r&&(r=s("f6xbQ")),r(t,{readable:e,writable:i},(function(t){if(t)return n(t);o=!0,n()}));var h=!1;return function(e){if(!o&&!h)return h=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void n(e||new a("pipe"))}}function u(t){t()}function l(t,e){return t.pipe(e)}function c(t){return t.length?"function"!=typeof t[t.length-1]?o:t.pop():o}t.exports=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i,s=c(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new n("streams");var a=e.map((function(t,r){var n=r<e.length-1;return h(t,n,r>0,(function(t){i||(i=t),t&&a.forEach(u),n||(a.forEach(u),s(i))}))}));return e.reduce(l)}})),s.register("D6ODP",(function(t,e){var r=s("awmEs").Buffer,i=s("6cuMU"),n=s("ikMd7"),a=new Array(16),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],u=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],c=[0,1518500249,1859775393,2400959708,2840853838],f=[1352829926,1548603684,1836072691,2053994217,0];function d(){n.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(t,e){return t<<e|t>>>32-e}function m(t,e,r,i,n,s,a,o){return p(t+(e^r^i)+s+a|0,o)+n|0}function g(t,e,r,i,n,s,a,o){return p(t+(e&r|~e&i)+s+a|0,o)+n|0}function v(t,e,r,i,n,s,a,o){return p(t+((e|~r)^i)+s+a|0,o)+n|0}function _(t,e,r,i,n,s,a,o){return p(t+(e&i|r&~i)+s+a|0,o)+n|0}function b(t,e,r,i,n,s,a,o){return p(t+(e^(r|~i))+s+a|0,o)+n|0}i(d,n),d.prototype._update=function(){for(var t=a,e=0;e<16;++e)t[e]=this._block.readInt32LE(4*e);for(var r=0|this._a,i=0|this._b,n=0|this._c,s=0|this._d,d=0|this._e,y=0|this._a,x=0|this._b,w=0|this._c,E=0|this._d,M=0|this._e,S=0;S<80;S+=1){var A,T;S<16?(A=m(r,i,n,s,d,t[o[S]],c[0],u[S]),T=b(y,x,w,E,M,t[h[S]],f[0],l[S])):S<32?(A=g(r,i,n,s,d,t[o[S]],c[1],u[S]),T=_(y,x,w,E,M,t[h[S]],f[1],l[S])):S<48?(A=v(r,i,n,s,d,t[o[S]],c[2],u[S]),T=v(y,x,w,E,M,t[h[S]],f[2],l[S])):S<64?(A=_(r,i,n,s,d,t[o[S]],c[3],u[S]),T=g(y,x,w,E,M,t[h[S]],f[3],l[S])):(A=b(r,i,n,s,d,t[o[S]],c[4],u[S]),T=m(y,x,w,E,M,t[h[S]],f[4],l[S])),r=d,d=s,s=p(n,10),n=i,i=A,y=M,M=E,E=p(w,10),w=x,x=T}var C=this._b+n+E|0;this._b=this._c+s+M|0,this._c=this._d+d+y|0,this._d=this._e+r+x|0,this._e=this._a+i+w|0,this._a=C},d.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=r.alloc?r.alloc(20):new r(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t},t.exports=d})),s.register("9iz0U",(function(t,e){var r=t.exports=function(t){t=t.toLowerCase();var e=r[t];if(!e)throw new Error(t+" is not supported (we accept pull requests)");return new e};r.sha=s("3v0U2"),r.sha1=s("iajBv"),r.sha224=s("hRKrB"),r.sha256=s("gzhVs"),r.sha384=s("WtwGf"),r.sha512=s("kyS4u")})),s.register("3v0U2",(function(t,e){var r=s("6cuMU"),i=s("gsfFS"),n=s("k0Rto").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function h(){this.init(),this._w=o,i.call(this,64,56)}function u(t){return t<<30|t>>>2}function l(t,e,r,i){return 0===t?e&r|~e&i:2===t?e&r|e&i|r&i:e^r^i}r(h,i),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(t){for(var e,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,o=0|this._d,h=0|this._e,c=0;c<16;++c)r[c]=t.readInt32BE(4*c);for(;c<80;++c)r[c]=r[c-3]^r[c-8]^r[c-14]^r[c-16];for(var f=0;f<80;++f){var d=~~(f/20),p=0|((e=i)<<5|e>>>27)+l(d,n,s,o)+h+r[f]+a[d];h=o,o=s,s=u(n),n=i,i=p}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=h+this._e|0},h.prototype._hash=function(){var t=n.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=h})),s.register("gsfFS",(function(t,e){var r=s("k0Rto").Buffer;function i(t,e){this._block=r.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}i.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=r.from(t,e));for(var i=this._block,n=this._blockSize,s=t.length,a=this._len,o=0;o<s;){for(var h=a%n,u=Math.min(s-o,n-h),l=0;l<u;l++)i[h+l]=t[o+l];o+=u,(a+=u)%n==0&&this._update(i)}return this._len+=s,this},i.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var i=(4294967295&r)>>>0,n=(r-i)/4294967296;this._block.writeUInt32BE(n,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var s=this._hash();return t?s.toString(t):s},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i})),s.register("iajBv",(function(t,e){var r=s("6cuMU"),i=s("gsfFS"),n=s("k0Rto").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function h(){this.init(),this._w=o,i.call(this,64,56)}function u(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function c(t,e,r,i){return 0===t?e&r|~e&i:2===t?e&r|e&i|r&i:e^r^i}r(h,i),h.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},h.prototype._update=function(t){for(var e,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,o=0|this._d,h=0|this._e,f=0;f<16;++f)r[f]=t.readInt32BE(4*f);for(;f<80;++f)r[f]=(e=r[f-3]^r[f-8]^r[f-14]^r[f-16])<<1|e>>>31;for(var d=0;d<80;++d){var p=~~(d/20),m=u(i)+c(p,n,s,o)+h+r[d]+a[p]|0;h=o,o=s,s=l(n),n=i,i=m}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=h+this._e|0},h.prototype._hash=function(){var t=n.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=h})),s.register("hRKrB",(function(t,e){var r=s("6cuMU"),i=s("gzhVs"),n=s("gsfFS"),a=s("k0Rto").Buffer,o=new Array(64);function h(){this.init(),this._w=o,n.call(this,64,56)}r(h,i),h.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},h.prototype._hash=function(){var t=a.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=h})),s.register("gzhVs",(function(t,e){var r=s("6cuMU"),i=s("gsfFS"),n=s("k0Rto").Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function h(){this.init(),this._w=o,i.call(this,64,56)}function u(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function c(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function f(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function d(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}r(h,i),h.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},h.prototype._update=function(t){for(var e,r=this._w,i=0|this._a,n=0|this._b,s=0|this._c,o=0|this._d,h=0|this._e,p=0|this._f,m=0|this._g,g=0|this._h,v=0;v<16;++v)r[v]=t.readInt32BE(4*v);for(;v<64;++v)r[v]=0|(((e=r[v-2])>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+r[v-7]+d(r[v-15])+r[v-16];for(var _=0;_<64;++_){var b=g+f(h)+u(h,p,m)+a[_]+r[_]|0,y=c(i)+l(i,n,s)|0;g=m,m=p,p=h,h=o+b|0,o=s,s=n,n=i,i=b+y|0}this._a=i+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=h+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=g+this._h|0},h.prototype._hash=function(){var t=n.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=h})),s.register("WtwGf",(function(t,e){var r=s("6cuMU"),i=s("kyS4u"),n=s("gsfFS"),a=s("k0Rto").Buffer,o=new Array(160);function h(){this.init(),this._w=o,n.call(this,128,112)}r(h,i),h.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},h.prototype._hash=function(){var t=a.allocUnsafe(48);function e(e,r,i){t.writeInt32BE(e,i),t.writeInt32BE(r,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=h})),s.register("kyS4u",(function(t,e){var r=s("6cuMU"),i=s("gsfFS"),n=s("k0Rto").Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function h(){this.init(),this._w=o,i.call(this,128,112)}function u(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function c(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function f(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function d(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function m(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function g(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function v(t,e){return t>>>0<e>>>0?1:0}r(h,i),h.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},h.prototype._update=function(t){for(var e=this._w,r=0|this._ah,i=0|this._bh,n=0|this._ch,s=0|this._dh,o=0|this._eh,h=0|this._fh,_=0|this._gh,b=0|this._hh,y=0|this._al,x=0|this._bl,w=0|this._cl,E=0|this._dl,M=0|this._el,S=0|this._fl,A=0|this._gl,T=0|this._hl,C=0;C<32;C+=2)e[C]=t.readInt32BE(4*C),e[C+1]=t.readInt32BE(4*C+4);for(;C<160;C+=2){var D=e[C-30],R=e[C-30+1],I=d(D,R),P=p(R,D),N=m(D=e[C-4],R=e[C-4+1]),k=g(R,D),B=e[C-14],L=e[C-14+1],O=e[C-32],F=e[C-32+1],U=P+L|0,z=I+B+v(U,P)|0;z=(z=z+N+v(U=U+k|0,k)|0)+O+v(U=U+F|0,F)|0,e[C]=z,e[C+1]=U}for(var G=0;G<160;G+=2){z=e[G],U=e[G+1];var H=l(r,i,n),j=l(y,x,w),V=c(r,y),W=c(y,r),q=f(o,M),X=f(M,o),Y=a[G],Z=a[G+1],$=u(o,h,_),K=u(M,S,A),J=T+X|0,Q=b+q+v(J,T)|0;Q=(Q=(Q=Q+$+v(J=J+K|0,K)|0)+Y+v(J=J+Z|0,Z)|0)+z+v(J=J+U|0,U)|0;var tt=W+j|0,et=V+H+v(tt,W)|0;b=_,T=A,_=h,A=S,h=o,S=M,o=s+Q+v(M=E+J|0,E)|0,s=n,E=w,n=i,w=x,i=r,x=y,r=Q+et+v(y=J+tt|0,J)|0}this._al=this._al+y|0,this._bl=this._bl+x|0,this._cl=this._cl+w|0,this._dl=this._dl+E|0,this._el=this._el+M|0,this._fl=this._fl+S|0,this._gl=this._gl+A|0,this._hl=this._hl+T|0,this._ah=this._ah+r+v(this._al,y)|0,this._bh=this._bh+i+v(this._bl,x)|0,this._ch=this._ch+n+v(this._cl,w)|0,this._dh=this._dh+s+v(this._dl,E)|0,this._eh=this._eh+o+v(this._el,M)|0,this._fh=this._fh+h+v(this._fl,S)|0,this._gh=this._gh+_+v(this._gl,A)|0,this._hh=this._hh+b+v(this._hl,T)|0},h.prototype._hash=function(){var t=n.allocUnsafe(64);function e(e,r,i){t.writeInt32BE(e,i),t.writeInt32BE(r,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=h})),s.register("eYksn",(function(t,e){var r=s("k0Rto").Buffer,i=s("5o6YA").Transform,n=s("bWgSm").StringDecoder;function a(t){i.call(this),this.hashMode="string"==typeof t,this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}s("6cuMU")(a,i),a.prototype.update=function(t,e,i){"string"==typeof t&&(t=r.from(t,e));var n=this._update(t);return this.hashMode?this:(i&&(n=this._toString(n,i)),n)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(t,e,r){var i;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(t){i=t}finally{r(i)}},a.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(t){e=t}t(e)},a.prototype._finalOrDigest=function(t){var e=this.__final()||r.alloc(0);return t&&(e=this._toString(e,t,!0)),e},a.prototype._toString=function(t,e,r){if(this._decoder||(this._decoder=new n(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var i=this._decoder.write(t);return r&&(i+=this._decoder.end()),i},t.exports=a})),s.register("5o6YA",(function(t,e){t.exports=i;var r=s("k4yOc").EventEmitter;function i(){r.call(this)}s("6cuMU")(i,r),i.Readable=s("340fO"),i.Writable=s("lWtyM"),i.Duplex=s("1SlAW"),i.Transform=s("f7L7V"),i.PassThrough=s("dX7Dt"),i.finished=s("f6xbQ"),i.pipeline=s("2mqHM"),i.Stream=i,i.prototype.pipe=function(t,e){var i=this;function n(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function s(){i.readable&&i.resume&&i.resume()}i.on("data",n),t.on("drain",s),t._isStdio||e&&!1===e.end||(i.on("end",o),i.on("close",h));var a=!1;function o(){a||(a=!0,t.end())}function h(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){i.removeListener("data",n),t.removeListener("drain",s),i.removeListener("end",o),i.removeListener("close",h),i.removeListener("error",u),t.removeListener("error",u),i.removeListener("end",l),i.removeListener("close",l),t.removeListener("close",l)}return i.on("error",u),t.on("error",u),i.on("end",l),i.on("close",l),t.on("close",l),t.emit("pipe",i),t}})),s.register("9SGAM",(function(t,e){var r=s("6cuMU"),i=s("1cJxa"),n=s("eYksn"),a=s("k0Rto").Buffer,o=s("bbr5c"),h=s("D6ODP"),u=s("9iz0U"),l=a.alloc(128);function c(t,e){n.call(this,"digest"),"string"==typeof e&&(e=a.from(e));var r="sha512"===t||"sha384"===t?128:64;(this._alg=t,this._key=e,e.length>r)?e=("rmd160"===t?new h:u(t)).update(e).digest():e.length<r&&(e=a.concat([e,l],r));for(var i=this._ipad=a.allocUnsafe(r),s=this._opad=a.allocUnsafe(r),o=0;o<r;o++)i[o]=54^e[o],s[o]=92^e[o];this._hash="rmd160"===t?new h:u(t),this._hash.update(i)}r(c,n),c.prototype._update=function(t){this._hash.update(t)},c.prototype._final=function(){var t=this._hash.digest();return("rmd160"===this._alg?new h:u(this._alg)).update(this._opad).update(t).digest()},t.exports=function(t,e){return"rmd160"===(t=t.toLowerCase())||"ripemd160"===t?new c("rmd160",e):"md5"===t?new i(o,e):new c(t,e)}})),s.register("1cJxa",(function(t,e){var r=s("6cuMU"),i=s("k0Rto").Buffer,n=s("eYksn"),a=i.alloc(128),o=64;function h(t,e){n.call(this,"digest"),"string"==typeof e&&(e=i.from(e)),this._alg=t,this._key=e,e.length>o?e=t(e):e.length<o&&(e=i.concat([e,a],o));for(var r=this._ipad=i.allocUnsafe(o),s=this._opad=i.allocUnsafe(o),h=0;h<o;h++)r[h]=54^e[h],s[h]=92^e[h];this._hash=[r]}r(h,n),h.prototype._update=function(t){this._hash.push(t)},h.prototype._final=function(){var t=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,t]))},t.exports=h})),s.register("bbr5c",(function(t,e){var r=s("liMpH");t.exports=function(t){return(new r).update(t).digest()}})),s.register("jxFqc",(function(t,e){t.exports=s("b526X")})),s.register("b526X",(function(t,e){t.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')})),s.register("wQ7R3",(function(t,r){var i,n;e(t.exports,"pbkdf2",(()=>i),(t=>i=t)),e(t.exports,"pbkdf2Sync",(()=>n),(t=>n=t)),i=s("ltUlK"),n=s("83DTm")})),s.register("ltUlK",(function(e,r){var i,n,a=s("k0Rto").Buffer,o=s("9Eo3k"),h=s("lTVtk"),u=s("83DTm"),l=s("fzmE1"),c=t.crypto&&t.crypto.subtle,f={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function p(){return n||(n=t.process&&t.process.nextTick?t.process.nextTick:t.queueMicrotask?t.queueMicrotask:t.setImmediate?t.setImmediate:t.setTimeout)}function m(t,e,r,i,n){return c.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then((function(t){return c.deriveBits({name:"PBKDF2",salt:e,iterations:r,hash:{name:n}},t,i<<3)})).then((function(t){return a.from(t)}))}e.exports=function(e,r,n,s,g,v){"function"==typeof g&&(v=g,g=void 0);var _=f[(g=g||"sha1").toLowerCase()];if(_&&"function"==typeof t.Promise){if(o(n,s),e=l(e,h,"Password"),r=l(r,h,"Salt"),"function"!=typeof v)throw new Error("No callback provided to pbkdf2");!function(t,e){t.then((function(t){p()((function(){e(null,t)}))}),(function(t){p()((function(){e(t)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!c||!c.importKey||!c.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var r=m(i=i||a.alloc(8),i,10,128,e).then((function(){return!0})).catch((function(){return!1}));return d[e]=r,r}(_).then((function(t){return t?m(e,r,n,s,_):u(e,r,n,s,g)})),v)}else p()((function(){var t;try{t=u(e,r,n,s,g)}catch(t){return v(t)}v(null,t)}))}})),s.register("9Eo3k",(function(t,e){var r=Math.pow(2,30)-1;t.exports=function(t,e){if("number"!=typeof t)throw new TypeError("Iterations not a number");if(t<0)throw new TypeError("Bad iterations");if("number"!=typeof e)throw new TypeError("Key length not a number");if(e<0||e>r||e!=e)throw new TypeError("Bad key length")}})),s.register("lTVtk",(function(e,r){var i,n=s("9Mq5w");if(t.process&&t.process.browser)i="utf-8";else if(t.process&&t.process.version){i=parseInt(n.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary"}else i="utf-8";e.exports=i})),s.register("83DTm",(function(t,e){var r=s("bbr5c"),i=s("D6ODP"),n=s("9iz0U"),a=s("k0Rto").Buffer,o=s("9Eo3k"),h=s("lTVtk"),u=s("fzmE1"),l=a.alloc(128),c={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function f(t,e,s){var o=function(t){function e(e){return n(t).update(e).digest()}function s(t){return(new i).update(t).digest()}return"rmd160"===t||"ripemd160"===t?s:"md5"===t?r:e}(t),h="sha512"===t||"sha384"===t?128:64;e.length>h?e=o(e):e.length<h&&(e=a.concat([e,l],h));for(var u=a.allocUnsafe(h+c[t]),f=a.allocUnsafe(h+c[t]),d=0;d<h;d++)u[d]=54^e[d],f[d]=92^e[d];var p=a.allocUnsafe(h+s+4);u.copy(p,0,0,h),this.ipad1=p,this.ipad2=u,this.opad=f,this.alg=t,this.blocksize=h,this.hash=o,this.size=c[t]}f.prototype.run=function(t,e){return t.copy(e,this.blocksize),this.hash(e).copy(this.opad,this.blocksize),this.hash(this.opad)},t.exports=function(t,e,r,i,n){o(r,i);var s=new f(n=n||"sha1",t=u(t,h,"Password"),(e=u(e,h,"Salt")).length),l=a.allocUnsafe(i),d=a.allocUnsafe(e.length+4);e.copy(d,0,0,e.length);for(var p=0,m=c[n],g=Math.ceil(i/m),v=1;v<=g;v++){d.writeUInt32BE(v,e.length);for(var _=s.run(d,s.ipad1),b=_,y=1;y<r;y++){b=s.run(b,s.ipad2);for(var x=0;x<m;x++)_[x]^=b[x]}_.copy(l,p),p+=m}return l}})),s.register("fzmE1",(function(t,e){var r=s("k0Rto").Buffer;t.exports=function(t,e,i){if(r.isBuffer(t))return t;if("string"==typeof t)return r.from(t,e);if(ArrayBuffer.isView(t))return r.from(t.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}})),s.register("hHzFD",(function(t,r){var i,n,a,o,h,u,l,c,f,d;e(t.exports,"createCipher",(()=>i),(t=>i=t)),e(t.exports,"Cipher",(()=>n),(t=>n=t)),e(t.exports,"createCipheriv",(()=>a),(t=>a=t)),e(t.exports,"Cipheriv",(()=>o),(t=>o=t)),e(t.exports,"createDecipher",(()=>h),(t=>h=t)),e(t.exports,"Decipher",(()=>u),(t=>u=t)),e(t.exports,"createDecipheriv",(()=>l),(t=>l=t)),e(t.exports,"Decipheriv",(()=>c),(t=>c=t)),e(t.exports,"listCiphers",(()=>f),(t=>f=t)),e(t.exports,"getCiphers",(()=>d),(t=>d=t));var p=s("7A32q"),m=s("enuUj"),g=s("jSo6L"),v=s("eNVM2"),_=s("afScy");function b(t,e,r){if(t=t.toLowerCase(),g[t])return m.createCipheriv(t,e,r);if(v[t])return new p({key:e,iv:r,mode:t});throw new TypeError("invalid suite type")}function y(t,e,r){if(t=t.toLowerCase(),g[t])return m.createDecipheriv(t,e,r);if(v[t])return new p({key:e,iv:r,mode:t,decrypt:!0});throw new TypeError("invalid suite type")}i=n=function(t,e){var r,i;if(t=t.toLowerCase(),g[t])r=g[t].key,i=g[t].iv;else{if(!v[t])throw new TypeError("invalid suite type");r=8*v[t].key,i=v[t].iv}var n=_(e,!1,r,i);return b(t,n.key,n.iv)},a=o=b,h=u=function(t,e){var r,i;if(t=t.toLowerCase(),g[t])r=g[t].key,i=g[t].iv;else{if(!v[t])throw new TypeError("invalid suite type");r=8*v[t].key,i=v[t].iv}var n=_(e,!1,r,i);return y(t,n.key,n.iv)},l=c=y,f=d=function(){return Object.keys(v).concat(m.getCiphers())}})),s.register("7A32q",(function(t,e){var r=s("eYksn"),i=s("56EVK"),n=s("6cuMU"),a=s("k0Rto").Buffer,o={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function h(t){r.call(this);var e,i=t.mode.toLowerCase(),n=o[i];e=t.decrypt?"decrypt":"encrypt";var s=t.key;a.isBuffer(s)||(s=a.from(s)),"des-ede"!==i&&"des-ede-cbc"!==i||(s=a.concat([s,s.slice(0,8)]));var h=t.iv;a.isBuffer(h)||(h=a.from(h)),this._des=n.create({key:s,iv:h,type:e})}o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],t.exports=h,n(h,r),h.prototype._update=function(t){return a.from(this._des.update(t))},h.prototype._final=function(){return a.from(this._des.final())}})),s.register("56EVK",(function(t,r){var i,n,a;e(t.exports,"DES",(()=>i),(t=>i=t)),e(t.exports,"CBC",(()=>n),(t=>n=t)),e(t.exports,"EDE",(()=>a),(t=>a=t)),s("dosmQ"),s("9qjtF"),i=s("1jTyK"),n=s("l1oFj"),a=s("1Hvfl")})),s.register("dosmQ",(function(t,r){var i,n,s,a,o,h,u,l,c,f,d;e(t.exports,"readUInt32BE",(()=>i),(t=>i=t)),e(t.exports,"writeUInt32BE",(()=>n),(t=>n=t)),e(t.exports,"ip",(()=>s),(t=>s=t)),e(t.exports,"rip",(()=>a),(t=>a=t)),e(t.exports,"pc1",(()=>o),(t=>o=t)),e(t.exports,"r28shl",(()=>h),(t=>h=t)),e(t.exports,"pc2",(()=>u),(t=>u=t)),e(t.exports,"expand",(()=>l),(t=>l=t)),e(t.exports,"substitute",(()=>c),(t=>c=t)),e(t.exports,"permute",(()=>f),(t=>f=t)),e(t.exports,"padSplit",(()=>d),(t=>d=t)),i=function(t,e){return(t[0+e]<<24|t[1+e]<<16|t[2+e]<<8|t[3+e])>>>0},n=function(t,e,r){t[0+r]=e>>>24,t[1+r]=e>>>16&255,t[2+r]=e>>>8&255,t[3+r]=255&e},s=function(t,e,r,i){for(var n=0,s=0,a=6;a>=0;a-=2){for(var o=0;o<=24;o+=8)n<<=1,n|=e>>>o+a&1;for(o=0;o<=24;o+=8)n<<=1,n|=t>>>o+a&1}for(a=6;a>=0;a-=2){for(o=1;o<=25;o+=8)s<<=1,s|=e>>>o+a&1;for(o=1;o<=25;o+=8)s<<=1,s|=t>>>o+a&1}r[i+0]=n>>>0,r[i+1]=s>>>0},a=function(t,e,r,i){for(var n=0,s=0,a=0;a<4;a++)for(var o=24;o>=0;o-=8)n<<=1,n|=e>>>o+a&1,n<<=1,n|=t>>>o+a&1;for(a=4;a<8;a++)for(o=24;o>=0;o-=8)s<<=1,s|=e>>>o+a&1,s<<=1,s|=t>>>o+a&1;r[i+0]=n>>>0,r[i+1]=s>>>0},o=function(t,e,r,i){for(var n=0,s=0,a=7;a>=5;a--){for(var o=0;o<=24;o+=8)n<<=1,n|=e>>o+a&1;for(o=0;o<=24;o+=8)n<<=1,n|=t>>o+a&1}for(o=0;o<=24;o+=8)n<<=1,n|=e>>o+a&1;for(a=1;a<=3;a++){for(o=0;o<=24;o+=8)s<<=1,s|=e>>o+a&1;for(o=0;o<=24;o+=8)s<<=1,s|=t>>o+a&1}for(o=0;o<=24;o+=8)s<<=1,s|=t>>o+a&1;r[i+0]=n>>>0,r[i+1]=s>>>0},h=function(t,e){return t<<e&268435455|t>>>28-e};var p=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];u=function(t,e,r,i){for(var n=0,s=0,a=p.length>>>1,o=0;o<a;o++)n<<=1,n|=t>>>p[o]&1;for(o=a;o<p.length;o++)s<<=1,s|=e>>>p[o]&1;r[i+0]=n>>>0,r[i+1]=s>>>0},l=function(t,e,r){var i=0,n=0;i=(1&t)<<5|t>>>27;for(var s=23;s>=15;s-=4)i<<=6,i|=t>>>s&63;for(s=11;s>=3;s-=4)n|=t>>>s&63,n<<=6;n|=(31&t)<<1|t>>>31,e[r+0]=i>>>0,e[r+1]=n>>>0};var m=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];c=function(t,e){for(var r=0,i=0;i<4;i++){r<<=4,r|=m[64*i+(t>>>18-6*i&63)]}for(i=0;i<4;i++){r<<=4,r|=m[256+64*i+(e>>>18-6*i&63)]}return r>>>0};var g=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];f=function(t){for(var e=0,r=0;r<g.length;r++)e<<=1,e|=t>>>g[r]&1;return e>>>0},d=function(t,e,r){for(var i=t.toString(2);i.length<e;)i="0"+i;for(var n=[],s=0;s<e;s+=r)n.push(i.slice(s,s+r));return n.join(" ")}})),s.register("9qjtF",(function(t,e){var r=s("7xO1L");function i(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}t.exports=i,i.prototype._init=function(){},i.prototype.update=function(t){return 0===t.length?[]:"decrypt"===this.type?this._updateDecrypt(t):this._updateEncrypt(t)},i.prototype._buffer=function(t,e){for(var r=Math.min(this.buffer.length-this.bufferOff,t.length-e),i=0;i<r;i++)this.buffer[this.bufferOff+i]=t[e+i];return this.bufferOff+=r,r},i.prototype._flushBuffer=function(t,e){return this._update(this.buffer,0,t,e),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(t){var e=0,r=0,i=(this.bufferOff+t.length)/this.blockSize|0,n=new Array(i*this.blockSize);0!==this.bufferOff&&(e+=this._buffer(t,e),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(n,r)));for(var s=t.length-(t.length-e)%this.blockSize;e<s;e+=this.blockSize)this._update(t,e,n,r),r+=this.blockSize;for(;e<t.length;e++,this.bufferOff++)this.buffer[this.bufferOff]=t[e];return n},i.prototype._updateDecrypt=function(t){for(var e=0,r=0,i=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,n=new Array(i*this.blockSize);i>0;i--)e+=this._buffer(t,e),r+=this._flushBuffer(n,r);return e+=this._buffer(t,e),n},i.prototype.final=function(t){var e,r;return t&&(e=this.update(t)),r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),e?e.concat(r):r},i.prototype._pad=function(t,e){if(0===e)return!1;for(;e<t.length;)t[e++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},i.prototype._unpad=function(t){return t},i.prototype._finalDecrypt=function(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)}})),s.register("7xO1L",(function(t,e){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=r,r.equal=function(t,e,r){if(t!=e)throw new Error(r||"Assertion failed: "+t+" != "+e)}})),s.register("1jTyK",(function(t,e){var r=s("7xO1L"),i=s("6cuMU"),n=s("dosmQ"),a=s("9qjtF");function o(){this.tmp=new Array(2),this.keys=null}function h(t){a.call(this,t);var e=new o;this._desState=e,this.deriveKeys(e,t.key)}i(h,a),t.exports=h,h.create=function(t){return new h(t)};var u=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];h.prototype.deriveKeys=function(t,e){t.keys=new Array(32),r.equal(e.length,this.blockSize,"Invalid key length");var i=n.readUInt32BE(e,0),s=n.readUInt32BE(e,4);n.pc1(i,s,t.tmp,0),i=t.tmp[0],s=t.tmp[1];for(var a=0;a<t.keys.length;a+=2){var o=u[a>>>1];i=n.r28shl(i,o),s=n.r28shl(s,o),n.pc2(i,s,t.keys,a)}},h.prototype._update=function(t,e,r,i){var s=this._desState,a=n.readUInt32BE(t,e),o=n.readUInt32BE(t,e+4);n.ip(a,o,s.tmp,0),a=s.tmp[0],o=s.tmp[1],"encrypt"===this.type?this._encrypt(s,a,o,s.tmp,0):this._decrypt(s,a,o,s.tmp,0),a=s.tmp[0],o=s.tmp[1],n.writeUInt32BE(r,a,i),n.writeUInt32BE(r,o,i+4)},h.prototype._pad=function(t,e){for(var r=t.length-e,i=e;i<t.length;i++)t[i]=r;return!0},h.prototype._unpad=function(t){for(var e=t[t.length-1],i=t.length-e;i<t.length;i++)r.equal(t[i],e);return t.slice(0,t.length-e)},h.prototype._encrypt=function(t,e,r,i,s){for(var a=e,o=r,h=0;h<t.keys.length;h+=2){var u=t.keys[h],l=t.keys[h+1];n.expand(o,t.tmp,0),u^=t.tmp[0],l^=t.tmp[1];var c=n.substitute(u,l),f=o;o=(a^n.permute(c))>>>0,a=f}n.rip(o,a,i,s)},h.prototype._decrypt=function(t,e,r,i,s){for(var a=r,o=e,h=t.keys.length-2;h>=0;h-=2){var u=t.keys[h],l=t.keys[h+1];n.expand(a,t.tmp,0),u^=t.tmp[0],l^=t.tmp[1];var c=n.substitute(u,l),f=a;a=(o^n.permute(c))>>>0,o=f}n.rip(a,o,i,s)}})),s.register("l1oFj",(function(t,r){var i;e(t.exports,"instantiate",(()=>i),(t=>i=t));var n=s("7xO1L"),a=s("6cuMU"),o={};function h(t){n.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var e=0;e<this.iv.length;e++)this.iv[e]=t[e]}i=function(t){function e(e){t.call(this,e),this._cbcInit()}a(e,t);for(var r=Object.keys(o),i=0;i<r.length;i++){var n=r[i];e.prototype[n]=o[n]}return e.create=function(t){return new e(t)},e},o._cbcInit=function(){var t=new h(this.options.iv);this._cbcState=t},o._update=function(t,e,r,i){var n=this._cbcState,s=this.constructor.super_.prototype,a=n.iv;if("encrypt"===this.type){for(var o=0;o<this.blockSize;o++)a[o]^=t[e+o];s._update.call(this,a,0,r,i);for(o=0;o<this.blockSize;o++)a[o]=r[i+o]}else{s._update.call(this,t,e,r,i);for(o=0;o<this.blockSize;o++)r[i+o]^=a[o];for(o=0;o<this.blockSize;o++)a[o]=t[e+o]}}})),s.register("1Hvfl",(function(t,e){var r=s("7xO1L"),i=s("6cuMU"),n=s("9qjtF"),a=s("1jTyK");function o(t,e){r.equal(e.length,24,"Invalid key length");var i=e.slice(0,8),n=e.slice(8,16),s=e.slice(16,24);this.ciphers="encrypt"===t?[a.create({type:"encrypt",key:i}),a.create({type:"decrypt",key:n}),a.create({type:"encrypt",key:s})]:[a.create({type:"decrypt",key:s}),a.create({type:"encrypt",key:n}),a.create({type:"decrypt",key:i})]}function h(t){n.call(this,t);var e=new o(this.type,this.options.key);this._edeState=e}i(h,n),t.exports=h,h.create=function(t){return new h(t)},h.prototype._update=function(t,e,r,i){var n=this._edeState;n.ciphers[0]._update(t,e,r,i),n.ciphers[1]._update(r,i,r,i),n.ciphers[2]._update(r,i,r,i)},h.prototype._pad=a.prototype._pad,h.prototype._unpad=a.prototype._unpad})),s.register("enuUj",(function(t,r){var i,n,a;e(t.exports,"createCipheriv",(()=>i),(t=>i=t)),e(t.exports,"createDecipheriv",(()=>n),(t=>n=t)),e(t.exports,"getCiphers",(()=>a),(t=>a=t));var o=s("6zcOF"),h=s("elNiL"),u=s("9hPv9");o.createCipher,i=o.createCipheriv,h.createDecipher,n=h.createDecipheriv,a=function(){return Object.keys(u)}})),s.register("6zcOF",(function(t,r){var i,n;e(t.exports,"createCipheriv",(()=>i),(t=>i=t)),e(t.exports,"createCipher",(()=>n),(t=>n=t));var a=s("jSo6L"),o=s("kf2vr"),h=s("k0Rto").Buffer,u=s("iO2jP"),l=s("eYksn"),c=s("21xbU"),f=s("afScy");function d(t,e,r){l.call(this),this._cache=new m,this._cipher=new c.AES(e),this._prev=h.from(r),this._mode=t,this._autopadding=!0}s("6cuMU")(d,l),d.prototype._update=function(t){var e,r;this._cache.add(t);for(var i=[];e=this._cache.get();)r=this._mode.encrypt(this,e),i.push(r);return h.concat(i)};var p=h.alloc(16,16);function m(){this.cache=h.allocUnsafe(0)}function g(t,e,r){var i=a[t.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof e&&(e=h.from(e)),e.length!==i.key/8)throw new TypeError("invalid key length "+e.length);if("string"==typeof r&&(r=h.from(r)),"GCM"!==i.mode&&r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===i.type?new u(i.module,e,r):"auth"===i.type?new o(i.module,e,r):new d(i.module,e,r)}d.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return t=this._mode.encrypt(this,t),this._cipher.scrub(),t;if(!t.equals(p))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},m.prototype.add=function(t){this.cache=h.concat([this.cache,t])},m.prototype.get=function(){if(this.cache.length>15){var t=this.cache.slice(0,16);return this.cache=this.cache.slice(16),t}return null},m.prototype.flush=function(){for(var t=16-this.cache.length,e=h.allocUnsafe(t),r=-1;++r<t;)e.writeUInt8(t,r);return h.concat([this.cache,e])},i=g,n=function(t,e){var r=a[t.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var i=f(e,!1,r.key,r.iv);return g(t,i.key,i.iv)}})),s.register("jSo6L",(function(t,e){var r={ECB:s("4zu5S"),CBC:s("kSfHW"),CFB:s("7tgje"),CFB8:s("aYXGv"),CFB1:s("kG0Tc"),OFB:s("jveiQ"),CTR:s("d6z7x"),GCM:s("d6z7x")},i=s("9hPv9");for(var n in i)i[n].module=r[i[n].mode];t.exports=i})),s.register("4zu5S",(function(t,r){var i,n;e(t.exports,"encrypt",(()=>i),(t=>i=t)),e(t.exports,"decrypt",(()=>n),(t=>n=t)),i=function(t,e){return t._cipher.encryptBlock(e)},n=function(t,e){return t._cipher.decryptBlock(e)}})),s.register("kSfHW",(function(t,r){var i,n;e(t.exports,"encrypt",(()=>i),(t=>i=t)),e(t.exports,"decrypt",(()=>n),(t=>n=t));var a=s("k7re5");i=function(t,e){var r=a(e,t._prev);return t._prev=t._cipher.encryptBlock(r),t._prev},n=function(t,e){var r=t._prev;t._prev=e;var i=t._cipher.decryptBlock(e);return a(i,r)}})),s.register("k7re5",(function(t,e){var r=s("awmEs").Buffer;t.exports=function(t,e){for(var i=Math.min(t.length,e.length),n=new r(i),s=0;s<i;++s)n[s]=t[s]^e[s];return n}})),s.register("7tgje",(function(t,r){var i;e(t.exports,"encrypt",(()=>i),(t=>i=t));var n=s("k0Rto").Buffer,a=s("k7re5");function o(t,e,r){var i=e.length,s=a(e,t._cache);return t._cache=t._cache.slice(i),t._prev=n.concat([t._prev,r?e:s]),s}i=function(t,e,r){for(var i,s=n.allocUnsafe(0);e.length;){if(0===t._cache.length&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=n.allocUnsafe(0)),!(t._cache.length<=e.length)){s=n.concat([s,o(t,e,r)]);break}i=t._cache.length,s=n.concat([s,o(t,e.slice(0,i),r)]),e=e.slice(i)}return s}})),s.register("aYXGv",(function(t,r){var i;e(t.exports,"encrypt",(()=>i),(t=>i=t));var n=s("k0Rto").Buffer;function a(t,e,r){var i=t._cipher.encryptBlock(t._prev)[0]^e;return t._prev=n.concat([t._prev.slice(1),n.from([r?e:i])]),i}i=function(t,e,r){for(var i=e.length,s=n.allocUnsafe(i),o=-1;++o<i;)s[o]=a(t,e[o],r);return s}})),s.register("kG0Tc",(function(t,r){var i;e(t.exports,"encrypt",(()=>i),(t=>i=t));var n=s("k0Rto").Buffer;function a(t,e,r){for(var i,n,s=-1,a=0;++s<8;)i=e&1<<7-s?128:0,a+=(128&(n=t._cipher.encryptBlock(t._prev)[0]^i))>>s%8,t._prev=o(t._prev,r?i:n);return a}function o(t,e){var r=t.length,i=-1,s=n.allocUnsafe(t.length);for(t=n.concat([t,n.from([e])]);++i<r;)s[i]=t[i]<<1|t[i+1]>>7;return s}i=function(t,e,r){for(var i=e.length,s=n.allocUnsafe(i),o=-1;++o<i;)s[o]=a(t,e[o],r);return s}})),s.register("jveiQ",(function(t,r){var i;e(t.exports,"encrypt",(()=>i),(t=>i=t));var n=s("awmEs").Buffer,a=s("k7re5");function o(t){return t._prev=t._cipher.encryptBlock(t._prev),t._prev}i=function(t,e){for(;t._cache.length<e.length;)t._cache=n.concat([t._cache,o(t)]);var r=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),a(e,r)}})),s.register("d6z7x",(function(t,r){var i;e(t.exports,"encrypt",(()=>i),(t=>i=t));var n=s("k7re5"),a=s("k0Rto").Buffer,o=s("iEbfO");function h(t){var e=t._cipher.encryptBlockRaw(t._prev);return o(t._prev),e}i=function(t,e){var r=Math.ceil(e.length/16),i=t._cache.length;t._cache=a.concat([t._cache,a.allocUnsafe(16*r)]);for(var s=0;s<r;s++){var o=h(t),u=i+16*s;t._cache.writeUInt32BE(o[0],u+0),t._cache.writeUInt32BE(o[1],u+4),t._cache.writeUInt32BE(o[2],u+8),t._cache.writeUInt32BE(o[3],u+12)}var l=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),n(e,l)}})),s.register("iEbfO",(function(t,e){t.exports=function(t){for(var e,r=t.length;r--;){if(255!==(e=t.readUInt8(r))){e++,t.writeUInt8(e,r);break}t.writeUInt8(0,r)}}})),s.register("9hPv9",(function(t,e){t.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')})),s.register("kf2vr",(function(t,e){var r=s("21xbU"),i=s("k0Rto").Buffer,n=s("eYksn"),a=s("6cuMU"),o=s("huQ30"),h=s("k7re5"),u=s("iEbfO");function l(t,e,s,a){n.call(this);var h=i.alloc(4,0);this._cipher=new r.AES(e);var l=this._cipher.encryptBlock(h);this._ghash=new o(l),s=function(t,e,r){if(12===e.length)return t._finID=i.concat([e,i.from([0,0,0,1])]),i.concat([e,i.from([0,0,0,2])]);var n=new o(r),s=e.length,a=s%16;n.update(e),a&&(a=16-a,n.update(i.alloc(a,0))),n.update(i.alloc(8,0));var h=8*s,l=i.alloc(8);l.writeUIntBE(h,0,8),n.update(l),t._finID=n.state;var c=i.from(t._finID);return u(c),c}(this,s,l),this._prev=i.from(s),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=t,this._authTag=null,this._called=!1}a(l,n),l.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=i.alloc(e,0),this._ghash.update(e))}this._called=!0;var r=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(r),this._len+=t.length,r},l.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=h(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(t,e){var r=0;t.length!==e.length&&r++;for(var i=Math.min(t.length,e.length),n=0;n<i;++n)r+=t[n]^e[n];return r}(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=t,this._cipher.scrub()},l.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},l.prototype.setAuthTag=function(t){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=t},l.prototype.setAAD=function(t){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(t),this._alen+=t.length},t.exports=l})),s.register("21xbU",(function(t,r){var i;e(t.exports,"AES",(()=>i),(t=>i=t));var n=s("k0Rto").Buffer;function a(t){n.isBuffer(t)||(t=n.from(t));for(var e=t.length/4|0,r=new Array(e),i=0;i<e;i++)r[i]=t.readUInt32BE(4*i);return r}function o(t){for(;0<t.length;t++)t[0]=0}function h(t,e,r,i,n){for(var s,a,o,h,u=r[0],l=r[1],c=r[2],f=r[3],d=t[0]^e[0],p=t[1]^e[1],m=t[2]^e[2],g=t[3]^e[3],v=4,_=1;_<n;_++)s=u[d>>>24]^l[p>>>16&255]^c[m>>>8&255]^f[255&g]^e[v++],a=u[p>>>24]^l[m>>>16&255]^c[g>>>8&255]^f[255&d]^e[v++],o=u[m>>>24]^l[g>>>16&255]^c[d>>>8&255]^f[255&p]^e[v++],h=u[g>>>24]^l[d>>>16&255]^c[p>>>8&255]^f[255&m]^e[v++],d=s,p=a,m=o,g=h;return s=(i[d>>>24]<<24|i[p>>>16&255]<<16|i[m>>>8&255]<<8|i[255&g])^e[v++],a=(i[p>>>24]<<24|i[m>>>16&255]<<16|i[g>>>8&255]<<8|i[255&d])^e[v++],o=(i[m>>>24]<<24|i[g>>>16&255]<<16|i[d>>>8&255]<<8|i[255&p])^e[v++],h=(i[g>>>24]<<24|i[d>>>16&255]<<16|i[p>>>8&255]<<8|i[255&m])^e[v++],[s>>>=0,a>>>=0,o>>>=0,h>>>=0]}var u=[0,1,2,4,8,16,32,64,128,27,54],l=function(){for(var t=new Array(256),e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;for(var r=[],i=[],n=[[],[],[],[]],s=[[],[],[],[]],a=0,o=0,h=0;h<256;++h){var u=o^o<<1^o<<2^o<<3^o<<4;u=u>>>8^255&u^99,r[a]=u,i[u]=a;var l=t[a],c=t[l],f=t[c],d=257*t[u]^16843008*u;n[0][a]=d<<24|d>>>8,n[1][a]=d<<16|d>>>16,n[2][a]=d<<8|d>>>24,n[3][a]=d,d=16843009*f^65537*c^257*l^16843008*a,s[0][u]=d<<24|d>>>8,s[1][u]=d<<16|d>>>16,s[2][u]=d<<8|d>>>24,s[3][u]=d,0===a?a=o=1:(a=l^t[t[t[f^l]]],o^=t[t[o]])}return{SBOX:r,INV_SBOX:i,SUB_MIX:n,INV_SUB_MIX:s}}();function c(t){this._key=a(t),this._reset()}c.blockSize=16,c.keySize=32,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var t=this._key,e=t.length,r=e+6,i=4*(r+1),n=[],s=0;s<e;s++)n[s]=t[s];for(s=e;s<i;s++){var a=n[s-1];s%e==0?(a=a<<8|a>>>24,a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a],a^=u[s/e|0]<<24):e>6&&s%e==4&&(a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a]),n[s]=n[s-e]^a}for(var o=[],h=0;h<i;h++){var c=i-h,f=n[c-(h%4?0:4)];o[h]=h<4||c<=4?f:l.INV_SUB_MIX[0][l.SBOX[f>>>24]]^l.INV_SUB_MIX[1][l.SBOX[f>>>16&255]]^l.INV_SUB_MIX[2][l.SBOX[f>>>8&255]]^l.INV_SUB_MIX[3][l.SBOX[255&f]]}this._nRounds=r,this._keySchedule=n,this._invKeySchedule=o},c.prototype.encryptBlockRaw=function(t){return h(t=a(t),this._keySchedule,l.SUB_MIX,l.SBOX,this._nRounds)},c.prototype.encryptBlock=function(t){var e=this.encryptBlockRaw(t),r=n.allocUnsafe(16);return r.writeUInt32BE(e[0],0),r.writeUInt32BE(e[1],4),r.writeUInt32BE(e[2],8),r.writeUInt32BE(e[3],12),r},c.prototype.decryptBlock=function(t){var e=(t=a(t))[1];t[1]=t[3],t[3]=e;var r=h(t,this._invKeySchedule,l.INV_SUB_MIX,l.INV_SBOX,this._nRounds),i=n.allocUnsafe(16);return i.writeUInt32BE(r[0],0),i.writeUInt32BE(r[3],4),i.writeUInt32BE(r[2],8),i.writeUInt32BE(r[1],12),i},c.prototype.scrub=function(){o(this._keySchedule),o(this._invKeySchedule),o(this._key)},i=c})),s.register("huQ30",(function(t,e){var r=s("k0Rto").Buffer,i=r.alloc(16,0);function n(t){var e=r.allocUnsafe(16);return e.writeUInt32BE(t[0]>>>0,0),e.writeUInt32BE(t[1]>>>0,4),e.writeUInt32BE(t[2]>>>0,8),e.writeUInt32BE(t[3]>>>0,12),e}function a(t){this.h=t,this.state=r.alloc(16,0),this.cache=r.allocUnsafe(0)}a.prototype.ghash=function(t){for(var e=-1;++e<t.length;)this.state[e]^=t[e];this._multiply()},a.prototype._multiply=function(){for(var t,e,r,i=[(t=this.h).readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)],s=[0,0,0,0],a=-1;++a<128;){for(0!=(this.state[~~(a/8)]&1<<7-a%8)&&(s[0]^=i[0],s[1]^=i[1],s[2]^=i[2],s[3]^=i[3]),r=0!=(1&i[3]),e=3;e>0;e--)i[e]=i[e]>>>1|(1&i[e-1])<<31;i[0]=i[0]>>>1,r&&(i[0]=-520093696^i[0])}this.state=n(s)},a.prototype.update=function(t){var e;for(this.cache=r.concat([this.cache,t]);this.cache.length>=16;)e=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(e)},a.prototype.final=function(t,e){return this.cache.length&&this.ghash(r.concat([this.cache,i],16)),this.ghash(n([0,t,0,e])),this.state},t.exports=a})),s.register("iO2jP",(function(t,e){var r=s("21xbU"),i=s("k0Rto").Buffer,n=s("eYksn");function a(t,e,s,a){n.call(this),this._cipher=new r.AES(e),this._prev=i.from(s),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._mode=t}s("6cuMU")(a,n),a.prototype._update=function(t){return this._mode.encrypt(this,t,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},t.exports=a})),s.register("afScy",(function(t,e){var r=s("k0Rto").Buffer,i=s("liMpH");t.exports=function(t,e,n,s){if(r.isBuffer(t)||(t=r.from(t,"binary")),e&&(r.isBuffer(e)||(e=r.from(e,"binary")),8!==e.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=n/8,o=r.alloc(a),h=r.alloc(s||0),u=r.alloc(0);a>0||s>0;){var l=new i;l.update(u),l.update(t),e&&l.update(e),u=l.digest();var c=0;if(a>0){var f=o.length-a;c=Math.min(a,u.length),u.copy(o,f,0,c),a-=c}if(c<u.length&&s>0){var d=h.length-s,p=Math.min(s,u.length-c);u.copy(h,d,c,c+p),s-=p}}return u.fill(0),{key:o,iv:h}}})),s.register("elNiL",(function(t,r){var i,n;e(t.exports,"createDecipher",(()=>i),(t=>i=t)),e(t.exports,"createDecipheriv",(()=>n),(t=>n=t));var a=s("kf2vr"),o=s("k0Rto").Buffer,h=s("jSo6L"),u=s("iO2jP"),l=s("eYksn"),c=s("21xbU"),f=s("afScy");function d(t,e,r){l.call(this),this._cache=new p,this._last=void 0,this._cipher=new c.AES(e),this._prev=o.from(r),this._mode=t,this._autopadding=!0}function p(){this.cache=o.allocUnsafe(0)}function m(t,e,r){var i=h[t.toLowerCase()];if(!i)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=o.from(r)),"GCM"!==i.mode&&r.length!==i.iv)throw new TypeError("invalid iv length "+r.length);if("string"==typeof e&&(e=o.from(e)),e.length!==i.key/8)throw new TypeError("invalid key length "+e.length);return"stream"===i.type?new u(i.module,e,r,!0):"auth"===i.type?new a(i.module,e,r,!0):new d(i.module,e,r)}s("6cuMU")(d,l),d.prototype._update=function(t){var e,r;this._cache.add(t);for(var i=[];e=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,e),i.push(r);return o.concat(i)},d.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return function(t){var e=t[15];if(e<1||e>16)throw new Error("unable to decrypt data");var r=-1;for(;++r<e;)if(t[r+(16-e)]!==e)throw new Error("unable to decrypt data");if(16===e)return;return t.slice(0,16-e)}(this._mode.decrypt(this,t));if(t)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this},p.prototype.add=function(t){this.cache=o.concat([this.cache,t])},p.prototype.get=function(t){var e;if(t){if(this.cache.length>16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e}else if(this.cache.length>=16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e;return null},p.prototype.flush=function(){if(this.cache.length)return this.cache},i=function(t,e){var r=h[t.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var i=f(e,!1,r.key,r.iv);return m(t,i.key,i.iv)},n=m})),s.register("eNVM2",(function(t,r){var i,n,s,a,o,h,u,l;e(t.exports,"des-ecb",(()=>i),(t=>i=t)),e(t.exports,"des-cbc",(()=>n),(t=>n=t)),e(t.exports,"des",(()=>s),(t=>s=t)),e(t.exports,"des-ede3-cbc",(()=>a),(t=>a=t)),e(t.exports,"des3",(()=>o),(t=>o=t)),e(t.exports,"des-ede3",(()=>h),(t=>h=t)),e(t.exports,"des-ede-cbc",(()=>u),(t=>u=t)),e(t.exports,"des-ede",(()=>l),(t=>l=t)),i={key:8,iv:0},n=s={key:8,iv:8},a=o={key:24,iv:8},h={key:24,iv:0},u={key:16,iv:8},l={key:16,iv:0}})),s.register("ePdJQ",(function(t,r){var i,n,a,o,h;e(t.exports,"DiffieHellmanGroup",(()=>i),(t=>i=t)),e(t.exports,"createDiffieHellmanGroup",(()=>n),(t=>n=t)),e(t.exports,"getDiffieHellman",(()=>a),(t=>a=t)),e(t.exports,"createDiffieHellman",(()=>o),(t=>o=t)),e(t.exports,"DiffieHellman",(()=>h),(t=>h=t));var u=s("awmEs").Buffer,l=s("2iTIX"),c=s("85YpT"),f=s("7EVbB");var d={binary:!0,hex:!0,base64:!0};i=n=a=function(t){var e=new u(c[t].prime,"hex"),r=new u(c[t].gen,"hex");return new f(e,r)},o=h=function t(e,r,i,n){return u.isBuffer(r)||void 0===d[r]?t(e,"binary",r,i):(r=r||"binary",n=n||"binary",i=i||new u([2]),u.isBuffer(i)||(i=new u(i,n)),"number"==typeof e?new f(l(e,i),i,!0):(u.isBuffer(e)||(e=new u(e,r)),new f(e,i,!0)))}})),s.register("2iTIX",(function(t,e){var r=s("1oa4b");t.exports=v,v.simpleSieve=m,v.fermatTest=g;var i=s("g5rlv"),n=new i(24),a=new(s("e3f0s")),o=new i(1),h=new i(2),u=new i(5),l=(new i(16),new i(8),new i(10)),c=new i(3),f=(new i(7),new i(11)),d=new i(4),p=(new i(12),null);function m(t){for(var e=function(){if(null!==p)return p;var t=[];t[0]=2;for(var e=1,r=3;r<1048576;r+=2){for(var i=Math.ceil(Math.sqrt(r)),n=0;n<e&&t[n]<=i&&r%t[n]!=0;n++);e!==n&&t[n]<=i||(t[e++]=r)}return p=t,t}(),r=0;r<e.length;r++)if(0===t.modn(e[r]))return 0===t.cmpn(e[r]);return!0}function g(t){var e=i.mont(t);return 0===h.toRed(e).redPow(t.subn(1)).fromRed().cmpn(1)}function v(t,e){if(t<16)return new i(2===e||5===e?[140,123]:[140,39]);var s,p;for(e=new i(e);;){for(s=new i(r(Math.ceil(t/8)));s.bitLength()>t;)s.ishrn(1);if(s.isEven()&&s.iadd(o),s.testn(1)||s.iadd(h),e.cmp(h)){if(!e.cmp(u))for(;s.mod(l).cmp(c);)s.iadd(d)}else for(;s.mod(n).cmp(f);)s.iadd(d);if(m(p=s.shrn(1))&&m(s)&&g(p)&&g(s)&&a.test(p)&&a.test(s))return s}}})),s.register("g5rlv",(function(t,e){!function(t,e){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function n(t,e,r){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var a;"object"==typeof t?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:s("4AFFV").Buffer}catch(t){}function o(t,e){var r=t.charCodeAt(e);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function h(t,e,r){var i=o(t,r);return r-1>=e&&(i|=o(t,r-1)<<4),i}function u(t,e,r,i){for(var n=0,s=Math.min(t.length,r),a=e;a<s;a++){var o=t.charCodeAt(a)-48;n*=i,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,e){return t.cmp(e)>0?t:e},n.min=function(t,e){return t.cmp(e)<0?t:e},n.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),r(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,i):(this._parseBase(t,e,n),"le"===i&&this._initArray(this.toArray(),e,i)))},n.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},n.prototype._initArray=function(t,e,i){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,a,o=0;if("be"===i)for(n=t.length-1,s=0;n>=0;n-=3)a=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===i)for(n=0,s=0;n<t.length;n+=3)a=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this.strip()},n.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,a=0;if("be"===r)for(i=t.length-1;i>=e;i-=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;else for(i=(t.length-e)%2==0?e+1:e;i<t.length;i+=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;this.strip()},n.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=e)i++;i--,n=n/e|0;for(var s=t.length-r,a=s%i,o=Math.min(s,s-a)+r,h=0,l=r;l<o;l+=i)h=u(t,l,l+i,e),this.imuln(n),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(0!==a){var c=1;for(h=u(t,l,t.length,e),l=0;l<a;l++)c*=e;this.imuln(c),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this.strip()},n.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(t,e,r){r.negative=e.negative^t.negative;var i=t.length+e.length|0;r.length=i,i=i-1|0;var n=0|t.words[0],s=0|e.words[0],a=n*s,o=67108863&a,h=a/67108864|0;r.words[0]=o;for(var u=1;u<i;u++){for(var l=h>>>26,c=67108863&h,f=Math.min(u,e.length-1),d=Math.max(0,u-t.length+1);d<=f;d++){var p=u-d|0;l+=(a=(n=0|t.words[p])*(s=0|e.words[d])+c)/67108864|0,c=67108863&a}r.words[u]=0|c,h=0|l}return 0!==h?r.words[u]=0|h:r.length--,r.strip()}n.prototype.toString=function(t,e){var i;if(e=0|e||1,16===(t=t||10)||"hex"===t){i="";for(var n=0,s=0,a=0;a<this.length;a++){var o=this.words[a],h=(16777215&(o<<n|s)).toString(16);i=0!==(s=o>>>24-n&16777215)||a!==this.length-1?l[6-h.length]+h+i:h+i,(n+=2)>=26&&(n-=26,a--)}for(0!==s&&(i=s.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var u=c[t],d=f[t];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(d).toString(t);i=(p=p.idivn(d)).isZero()?m+i:l[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(t,e){return r(void 0!==a),this.toArrayLike(a,t,e)},n.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},n.prototype.toArrayLike=function(t,e,i){var n=this.byteLength(),s=i||Math.max(1,n);r(n<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0"),this.strip();var a,o,h="le"===e,u=new t(s),l=this.clone();if(h){for(o=0;!l.isZero();o++)a=l.andln(255),l.iushrn(8),u[o]=a;for(;o<s;o++)u[o]=0}else{for(o=0;o<s-n;o++)u[o]=0;for(o=0;!l.isZero();o++)a=l.andln(255),l.iushrn(8),u[s-o-1]=a}return u},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},n.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},n.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},n.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this.strip()},n.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var i=0;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this.strip()},n.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,e){r("number"==typeof t&&t>=0);var i=t/26|0,n=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},n.prototype.iadd=function(t){var e,r,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,i=t):(r=t,i=this);for(var n=0,s=0;s<i.length;s++)e=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<r.length;s++)e=(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},n.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,i,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=t):(r=t,i=this);for(var s=0,a=0;a<i.length;a++)s=(e=(0|r.words[a])-(0|i.words[a])+s)>>26,this.words[a]=67108863&e;for(;0!==s&&a<r.length;a++)s=(e=(0|r.words[a])+s)>>26,this.words[a]=67108863&e;if(0===s&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var p=function(t,e,r){var i,n,s,a=t.words,o=e.words,h=r.words,u=0,l=0|a[0],c=8191&l,f=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,g=0|a[2],v=8191&g,_=g>>>13,b=0|a[3],y=8191&b,x=b>>>13,w=0|a[4],E=8191&w,M=w>>>13,S=0|a[5],A=8191&S,T=S>>>13,C=0|a[6],D=8191&C,R=C>>>13,I=0|a[7],P=8191&I,N=I>>>13,k=0|a[8],B=8191&k,L=k>>>13,O=0|a[9],F=8191&O,U=O>>>13,z=0|o[0],G=8191&z,H=z>>>13,j=0|o[1],V=8191&j,W=j>>>13,q=0|o[2],X=8191&q,Y=q>>>13,Z=0|o[3],$=8191&Z,K=Z>>>13,J=0|o[4],Q=8191&J,tt=J>>>13,et=0|o[5],rt=8191&et,it=et>>>13,nt=0|o[6],st=8191&nt,at=nt>>>13,ot=0|o[7],ht=8191&ot,ut=ot>>>13,lt=0|o[8],ct=8191&lt,ft=lt>>>13,dt=0|o[9],pt=8191&dt,mt=dt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(u+(i=Math.imul(c,G))|0)+((8191&(n=(n=Math.imul(c,H))+Math.imul(f,G)|0))<<13)|0;u=((s=Math.imul(f,H))+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(p,G),n=(n=Math.imul(p,H))+Math.imul(m,G)|0,s=Math.imul(m,H);var vt=(u+(i=i+Math.imul(c,V)|0)|0)+((8191&(n=(n=n+Math.imul(c,W)|0)+Math.imul(f,V)|0))<<13)|0;u=((s=s+Math.imul(f,W)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(v,G),n=(n=Math.imul(v,H))+Math.imul(_,G)|0,s=Math.imul(_,H),i=i+Math.imul(p,V)|0,n=(n=n+Math.imul(p,W)|0)+Math.imul(m,V)|0,s=s+Math.imul(m,W)|0;var _t=(u+(i=i+Math.imul(c,X)|0)|0)+((8191&(n=(n=n+Math.imul(c,Y)|0)+Math.imul(f,X)|0))<<13)|0;u=((s=s+Math.imul(f,Y)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(y,G),n=(n=Math.imul(y,H))+Math.imul(x,G)|0,s=Math.imul(x,H),i=i+Math.imul(v,V)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(_,V)|0,s=s+Math.imul(_,W)|0,i=i+Math.imul(p,X)|0,n=(n=n+Math.imul(p,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var bt=(u+(i=i+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,K)|0)+Math.imul(f,$)|0))<<13)|0;u=((s=s+Math.imul(f,K)|0)+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,i=Math.imul(E,G),n=(n=Math.imul(E,H))+Math.imul(M,G)|0,s=Math.imul(M,H),i=i+Math.imul(y,V)|0,n=(n=n+Math.imul(y,W)|0)+Math.imul(x,V)|0,s=s+Math.imul(x,W)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,Y)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,Y)|0,i=i+Math.imul(p,$)|0,n=(n=n+Math.imul(p,K)|0)+Math.imul(m,$)|0,s=s+Math.imul(m,K)|0;var yt=(u+(i=i+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,tt)|0)+Math.imul(f,Q)|0))<<13)|0;u=((s=s+Math.imul(f,tt)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(A,G),n=(n=Math.imul(A,H))+Math.imul(T,G)|0,s=Math.imul(T,H),i=i+Math.imul(E,V)|0,n=(n=n+Math.imul(E,W)|0)+Math.imul(M,V)|0,s=s+Math.imul(M,W)|0,i=i+Math.imul(y,X)|0,n=(n=n+Math.imul(y,Y)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,Y)|0,i=i+Math.imul(v,$)|0,n=(n=n+Math.imul(v,K)|0)+Math.imul(_,$)|0,s=s+Math.imul(_,K)|0,i=i+Math.imul(p,Q)|0,n=(n=n+Math.imul(p,tt)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,tt)|0;var xt=(u+(i=i+Math.imul(c,rt)|0)|0)+((8191&(n=(n=n+Math.imul(c,it)|0)+Math.imul(f,rt)|0))<<13)|0;u=((s=s+Math.imul(f,it)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(D,G),n=(n=Math.imul(D,H))+Math.imul(R,G)|0,s=Math.imul(R,H),i=i+Math.imul(A,V)|0,n=(n=n+Math.imul(A,W)|0)+Math.imul(T,V)|0,s=s+Math.imul(T,W)|0,i=i+Math.imul(E,X)|0,n=(n=n+Math.imul(E,Y)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,Y)|0,i=i+Math.imul(y,$)|0,n=(n=n+Math.imul(y,K)|0)+Math.imul(x,$)|0,s=s+Math.imul(x,K)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,tt)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,tt)|0,i=i+Math.imul(p,rt)|0,n=(n=n+Math.imul(p,it)|0)+Math.imul(m,rt)|0,s=s+Math.imul(m,it)|0;var wt=(u+(i=i+Math.imul(c,st)|0)|0)+((8191&(n=(n=n+Math.imul(c,at)|0)+Math.imul(f,st)|0))<<13)|0;u=((s=s+Math.imul(f,at)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(P,G),n=(n=Math.imul(P,H))+Math.imul(N,G)|0,s=Math.imul(N,H),i=i+Math.imul(D,V)|0,n=(n=n+Math.imul(D,W)|0)+Math.imul(R,V)|0,s=s+Math.imul(R,W)|0,i=i+Math.imul(A,X)|0,n=(n=n+Math.imul(A,Y)|0)+Math.imul(T,X)|0,s=s+Math.imul(T,Y)|0,i=i+Math.imul(E,$)|0,n=(n=n+Math.imul(E,K)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,K)|0,i=i+Math.imul(y,Q)|0,n=(n=n+Math.imul(y,tt)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,tt)|0,i=i+Math.imul(v,rt)|0,n=(n=n+Math.imul(v,it)|0)+Math.imul(_,rt)|0,s=s+Math.imul(_,it)|0,i=i+Math.imul(p,st)|0,n=(n=n+Math.imul(p,at)|0)+Math.imul(m,st)|0,s=s+Math.imul(m,at)|0;var Et=(u+(i=i+Math.imul(c,ht)|0)|0)+((8191&(n=(n=n+Math.imul(c,ut)|0)+Math.imul(f,ht)|0))<<13)|0;u=((s=s+Math.imul(f,ut)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(B,G),n=(n=Math.imul(B,H))+Math.imul(L,G)|0,s=Math.imul(L,H),i=i+Math.imul(P,V)|0,n=(n=n+Math.imul(P,W)|0)+Math.imul(N,V)|0,s=s+Math.imul(N,W)|0,i=i+Math.imul(D,X)|0,n=(n=n+Math.imul(D,Y)|0)+Math.imul(R,X)|0,s=s+Math.imul(R,Y)|0,i=i+Math.imul(A,$)|0,n=(n=n+Math.imul(A,K)|0)+Math.imul(T,$)|0,s=s+Math.imul(T,K)|0,i=i+Math.imul(E,Q)|0,n=(n=n+Math.imul(E,tt)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,tt)|0,i=i+Math.imul(y,rt)|0,n=(n=n+Math.imul(y,it)|0)+Math.imul(x,rt)|0,s=s+Math.imul(x,it)|0,i=i+Math.imul(v,st)|0,n=(n=n+Math.imul(v,at)|0)+Math.imul(_,st)|0,s=s+Math.imul(_,at)|0,i=i+Math.imul(p,ht)|0,n=(n=n+Math.imul(p,ut)|0)+Math.imul(m,ht)|0,s=s+Math.imul(m,ut)|0;var Mt=(u+(i=i+Math.imul(c,ct)|0)|0)+((8191&(n=(n=n+Math.imul(c,ft)|0)+Math.imul(f,ct)|0))<<13)|0;u=((s=s+Math.imul(f,ft)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(F,G),n=(n=Math.imul(F,H))+Math.imul(U,G)|0,s=Math.imul(U,H),i=i+Math.imul(B,V)|0,n=(n=n+Math.imul(B,W)|0)+Math.imul(L,V)|0,s=s+Math.imul(L,W)|0,i=i+Math.imul(P,X)|0,n=(n=n+Math.imul(P,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,i=i+Math.imul(D,$)|0,n=(n=n+Math.imul(D,K)|0)+Math.imul(R,$)|0,s=s+Math.imul(R,K)|0,i=i+Math.imul(A,Q)|0,n=(n=n+Math.imul(A,tt)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,tt)|0,i=i+Math.imul(E,rt)|0,n=(n=n+Math.imul(E,it)|0)+Math.imul(M,rt)|0,s=s+Math.imul(M,it)|0,i=i+Math.imul(y,st)|0,n=(n=n+Math.imul(y,at)|0)+Math.imul(x,st)|0,s=s+Math.imul(x,at)|0,i=i+Math.imul(v,ht)|0,n=(n=n+Math.imul(v,ut)|0)+Math.imul(_,ht)|0,s=s+Math.imul(_,ut)|0,i=i+Math.imul(p,ct)|0,n=(n=n+Math.imul(p,ft)|0)+Math.imul(m,ct)|0,s=s+Math.imul(m,ft)|0;var St=(u+(i=i+Math.imul(c,pt)|0)|0)+((8191&(n=(n=n+Math.imul(c,mt)|0)+Math.imul(f,pt)|0))<<13)|0;u=((s=s+Math.imul(f,mt)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(F,V),n=(n=Math.imul(F,W))+Math.imul(U,V)|0,s=Math.imul(U,W),i=i+Math.imul(B,X)|0,n=(n=n+Math.imul(B,Y)|0)+Math.imul(L,X)|0,s=s+Math.imul(L,Y)|0,i=i+Math.imul(P,$)|0,n=(n=n+Math.imul(P,K)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,K)|0,i=i+Math.imul(D,Q)|0,n=(n=n+Math.imul(D,tt)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,tt)|0,i=i+Math.imul(A,rt)|0,n=(n=n+Math.imul(A,it)|0)+Math.imul(T,rt)|0,s=s+Math.imul(T,it)|0,i=i+Math.imul(E,st)|0,n=(n=n+Math.imul(E,at)|0)+Math.imul(M,st)|0,s=s+Math.imul(M,at)|0,i=i+Math.imul(y,ht)|0,n=(n=n+Math.imul(y,ut)|0)+Math.imul(x,ht)|0,s=s+Math.imul(x,ut)|0,i=i+Math.imul(v,ct)|0,n=(n=n+Math.imul(v,ft)|0)+Math.imul(_,ct)|0,s=s+Math.imul(_,ft)|0;var At=(u+(i=i+Math.imul(p,pt)|0)|0)+((8191&(n=(n=n+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;u=((s=s+Math.imul(m,mt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,i=Math.imul(F,X),n=(n=Math.imul(F,Y))+Math.imul(U,X)|0,s=Math.imul(U,Y),i=i+Math.imul(B,$)|0,n=(n=n+Math.imul(B,K)|0)+Math.imul(L,$)|0,s=s+Math.imul(L,K)|0,i=i+Math.imul(P,Q)|0,n=(n=n+Math.imul(P,tt)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,tt)|0,i=i+Math.imul(D,rt)|0,n=(n=n+Math.imul(D,it)|0)+Math.imul(R,rt)|0,s=s+Math.imul(R,it)|0,i=i+Math.imul(A,st)|0,n=(n=n+Math.imul(A,at)|0)+Math.imul(T,st)|0,s=s+Math.imul(T,at)|0,i=i+Math.imul(E,ht)|0,n=(n=n+Math.imul(E,ut)|0)+Math.imul(M,ht)|0,s=s+Math.imul(M,ut)|0,i=i+Math.imul(y,ct)|0,n=(n=n+Math.imul(y,ft)|0)+Math.imul(x,ct)|0,s=s+Math.imul(x,ft)|0;var Tt=(u+(i=i+Math.imul(v,pt)|0)|0)+((8191&(n=(n=n+Math.imul(v,mt)|0)+Math.imul(_,pt)|0))<<13)|0;u=((s=s+Math.imul(_,mt)|0)+(n>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,i=Math.imul(F,$),n=(n=Math.imul(F,K))+Math.imul(U,$)|0,s=Math.imul(U,K),i=i+Math.imul(B,Q)|0,n=(n=n+Math.imul(B,tt)|0)+Math.imul(L,Q)|0,s=s+Math.imul(L,tt)|0,i=i+Math.imul(P,rt)|0,n=(n=n+Math.imul(P,it)|0)+Math.imul(N,rt)|0,s=s+Math.imul(N,it)|0,i=i+Math.imul(D,st)|0,n=(n=n+Math.imul(D,at)|0)+Math.imul(R,st)|0,s=s+Math.imul(R,at)|0,i=i+Math.imul(A,ht)|0,n=(n=n+Math.imul(A,ut)|0)+Math.imul(T,ht)|0,s=s+Math.imul(T,ut)|0,i=i+Math.imul(E,ct)|0,n=(n=n+Math.imul(E,ft)|0)+Math.imul(M,ct)|0,s=s+Math.imul(M,ft)|0;var Ct=(u+(i=i+Math.imul(y,pt)|0)|0)+((8191&(n=(n=n+Math.imul(y,mt)|0)+Math.imul(x,pt)|0))<<13)|0;u=((s=s+Math.imul(x,mt)|0)+(n>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,i=Math.imul(F,Q),n=(n=Math.imul(F,tt))+Math.imul(U,Q)|0,s=Math.imul(U,tt),i=i+Math.imul(B,rt)|0,n=(n=n+Math.imul(B,it)|0)+Math.imul(L,rt)|0,s=s+Math.imul(L,it)|0,i=i+Math.imul(P,st)|0,n=(n=n+Math.imul(P,at)|0)+Math.imul(N,st)|0,s=s+Math.imul(N,at)|0,i=i+Math.imul(D,ht)|0,n=(n=n+Math.imul(D,ut)|0)+Math.imul(R,ht)|0,s=s+Math.imul(R,ut)|0,i=i+Math.imul(A,ct)|0,n=(n=n+Math.imul(A,ft)|0)+Math.imul(T,ct)|0,s=s+Math.imul(T,ft)|0;var Dt=(u+(i=i+Math.imul(E,pt)|0)|0)+((8191&(n=(n=n+Math.imul(E,mt)|0)+Math.imul(M,pt)|0))<<13)|0;u=((s=s+Math.imul(M,mt)|0)+(n>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,i=Math.imul(F,rt),n=(n=Math.imul(F,it))+Math.imul(U,rt)|0,s=Math.imul(U,it),i=i+Math.imul(B,st)|0,n=(n=n+Math.imul(B,at)|0)+Math.imul(L,st)|0,s=s+Math.imul(L,at)|0,i=i+Math.imul(P,ht)|0,n=(n=n+Math.imul(P,ut)|0)+Math.imul(N,ht)|0,s=s+Math.imul(N,ut)|0,i=i+Math.imul(D,ct)|0,n=(n=n+Math.imul(D,ft)|0)+Math.imul(R,ct)|0,s=s+Math.imul(R,ft)|0;var Rt=(u+(i=i+Math.imul(A,pt)|0)|0)+((8191&(n=(n=n+Math.imul(A,mt)|0)+Math.imul(T,pt)|0))<<13)|0;u=((s=s+Math.imul(T,mt)|0)+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,i=Math.imul(F,st),n=(n=Math.imul(F,at))+Math.imul(U,st)|0,s=Math.imul(U,at),i=i+Math.imul(B,ht)|0,n=(n=n+Math.imul(B,ut)|0)+Math.imul(L,ht)|0,s=s+Math.imul(L,ut)|0,i=i+Math.imul(P,ct)|0,n=(n=n+Math.imul(P,ft)|0)+Math.imul(N,ct)|0,s=s+Math.imul(N,ft)|0;var It=(u+(i=i+Math.imul(D,pt)|0)|0)+((8191&(n=(n=n+Math.imul(D,mt)|0)+Math.imul(R,pt)|0))<<13)|0;u=((s=s+Math.imul(R,mt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(F,ht),n=(n=Math.imul(F,ut))+Math.imul(U,ht)|0,s=Math.imul(U,ut),i=i+Math.imul(B,ct)|0,n=(n=n+Math.imul(B,ft)|0)+Math.imul(L,ct)|0,s=s+Math.imul(L,ft)|0;var Pt=(u+(i=i+Math.imul(P,pt)|0)|0)+((8191&(n=(n=n+Math.imul(P,mt)|0)+Math.imul(N,pt)|0))<<13)|0;u=((s=s+Math.imul(N,mt)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,i=Math.imul(F,ct),n=(n=Math.imul(F,ft))+Math.imul(U,ct)|0,s=Math.imul(U,ft);var Nt=(u+(i=i+Math.imul(B,pt)|0)|0)+((8191&(n=(n=n+Math.imul(B,mt)|0)+Math.imul(L,pt)|0))<<13)|0;u=((s=s+Math.imul(L,mt)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var kt=(u+(i=Math.imul(F,pt))|0)+((8191&(n=(n=Math.imul(F,mt))+Math.imul(U,pt)|0))<<13)|0;return u=((s=Math.imul(U,mt))+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,h[0]=gt,h[1]=vt,h[2]=_t,h[3]=bt,h[4]=yt,h[5]=xt,h[6]=wt,h[7]=Et,h[8]=Mt,h[9]=St,h[10]=At,h[11]=Tt,h[12]=Ct,h[13]=Dt,h[14]=Rt,h[15]=It,h[16]=Pt,h[17]=Nt,h[18]=kt,0!==u&&(h[19]=u,r.length++),r};function m(t,e,r){return(new g).mulp(t,e,r)}function g(t,e){this.x=t,this.y=e}Math.imul||(p=d),n.prototype.mulTo=function(t,e){var r,i=this.length+t.length;return r=10===this.length&&10===t.length?p(this,t,e):i<63?d(this,t,e):i<1024?function(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var a=n;n=0;for(var o=67108863&i,h=Math.min(s,e.length-1),u=Math.max(0,s-t.length+1);u<=h;u++){var l=s-u,c=(0|t.words[l])*(0|e.words[u]),f=67108863&c;o=67108863&(f=f+o|0),n+=(a=(a=a+(c/67108864|0)|0)+(f>>>26)|0)>>>26,a&=67108863}r.words[s]=o,i=a,a=n}return 0!==i?r.words[s]=i:r.length--,r.strip()}(this,t,e):m(this,t,e),r},g.prototype.makeRBT=function(t){for(var e=new Array(t),r=n.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,r,t);return e},g.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var i=0,n=0;n<e;n++)i|=(1&t)<<e-n-1,t>>=1;return i},g.prototype.permute=function(t,e,r,i,n,s){for(var a=0;a<s;a++)i[a]=e[t[a]],n[a]=r[t[a]]},g.prototype.transform=function(t,e,r,i,n,s){this.permute(s,t,e,r,i,n);for(var a=1;a<n;a<<=1)for(var o=a<<1,h=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),l=0;l<n;l+=o)for(var c=h,f=u,d=0;d<a;d++){var p=r[l+d],m=i[l+d],g=r[l+d+a],v=i[l+d+a],_=c*g-f*v;v=c*v+f*g,g=_,r[l+d]=p+g,i[l+d]=m+v,r[l+d+a]=p-g,i[l+d+a]=m-v,d!==o&&(_=h*c-u*f,f=h*f+u*c,c=_)}},g.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},g.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=t[i];t[i]=t[r-i-1],t[r-i-1]=n,n=e[i],e[i]=-e[r-i-1],e[r-i-1]=-n}},g.prototype.normalize13b=function(t,e){for(var r=0,i=0;i<e/2;i++){var n=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+r;t[i]=67108863&n,r=n<67108864?0:n/67108864|0}return t},g.prototype.convert13b=function(t,e,i,n){for(var s=0,a=0;a<e;a++)s+=0|t[a],i[2*a]=8191&s,s>>>=13,i[2*a+1]=8191&s,s>>>=13;for(a=2*e;a<n;++a)i[a]=0;r(0===s),r(0==(-8192&s))},g.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},g.prototype.mulp=function(t,e,r){var i=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(i),s=this.stub(i),a=new Array(i),o=new Array(i),h=new Array(i),u=new Array(i),l=new Array(i),c=new Array(i),f=r.words;f.length=i,this.convert13b(t.words,t.length,a,i),this.convert13b(e.words,e.length,u,i),this.transform(a,s,o,h,i,n),this.transform(u,s,l,c,i,n);for(var d=0;d<i;d++){var p=o[d]*l[d]-h[d]*c[d];h[d]=o[d]*c[d]+h[d]*l[d],o[d]=p}return this.conjugate(o,h,i),this.transform(o,h,f,s,i,n),this.conjugate(f,s,i),this.normalize13b(f,i),r.negative=t.negative^e.negative,r.length=t.length+e.length,r.strip()},n.prototype.mul=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},n.prototype.mulf=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),m(this,t,e)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){r("number"==typeof t),r(t<67108864);for(var e=0,i=0;i<this.length;i++){var n=(0|this.words[i])*t,s=(67108863&n)+(67108863&e);e>>=26,e+=n/67108864|0,e+=s>>>26,this.words[i]=67108863&s}return 0!==e&&(this.words[i]=e,this.length++),this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var i=r/26|0,n=r%26;e[r]=(t.words[i]&1<<n)>>>n}return e}(t);if(0===e.length)return new n(1);for(var r=this,i=0;i<e.length&&0===e[i];i++,r=r.sqr());if(++i<e.length)for(var s=r.sqr();i<e.length;i++,s=s.sqr())0!==e[i]&&(r=r.mul(s));return r},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var e,i=t%26,n=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var a=0;for(e=0;e<this.length;e++){var o=this.words[e]&s,h=(0|this.words[e])-o<<i;this.words[e]=h|a,a=o>>>26-i}a&&(this.words[e]=a,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this.strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,e,i){var n;r("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,a=Math.min((t-s)/26,this.length),o=67108863^67108863>>>s<<s,h=i;if(n-=a,n=Math.max(0,n),h){for(var u=0;u<a;u++)h.words[u]=this.words[u];h.length=a}if(0===a);else if(this.length>a)for(this.length-=a,u=0;u<this.length;u++)this.words[u]=this.words[u+a];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=n);u--){var c=0|this.words[u];this.words[u]=l<<26-s|c>>>s,l=c&o}return h&&0!==l&&(h.words[h.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(t,e,i){return r(0===this.negative),this.iushrn(t,e,i)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,n=1<<e;return!(this.length<=i)&&!!(this.words[i]&n)},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this.strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,e,i){var n,s,a=t.length+i;this._expand(a);var o=0;for(n=0;n<t.length;n++){s=(0|this.words[n+i])+o;var h=(0|t.words[n])*e;o=((s-=67108863&h)>>26)-(h/67108864|0),this.words[n+i]=67108863&s}for(;n<this.length-i;n++)o=(s=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&s;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(s=-(0|this.words[n])+o)>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},n.prototype._wordDiv=function(t,e){var r=(this.length,t.length),i=this.clone(),s=t,a=0|s.words[s.length-1];0!==(r=26-this._countBits(a))&&(s=s.ushln(r),i.iushln(r),a=0|s.words[s.length-1]);var o,h=i.length-s.length;if("mod"!==e){(o=new n(null)).length=h+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var l=i.clone()._ishlnsubmul(s,1,h);0===l.negative&&(i=l,o&&(o.words[h]=1));for(var c=h-1;c>=0;c--){var f=67108864*(0|i.words[s.length+c])+(0|i.words[s.length+c-1]);for(f=Math.min(f/a|0,67108863),i._ishlnsubmul(s,f,c);0!==i.negative;)f--,i.negative=0,i._ishlnsubmul(s,1,c),i.isZero()||(i.negative^=1);o&&(o.words[c]=f)}return o&&o.strip(),i.strip(),"div"!==e&&0!==r&&i.iushrn(r),{div:o||null,mod:i}},n.prototype.divmod=function(t,e,i){return r(!t.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===t.negative?(o=this.neg().divmod(t,e),"mod"!==e&&(s=o.div.neg()),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.iadd(t)),{div:s,mod:a}):0===this.negative&&0!==t.negative?(o=this.divmod(t.neg(),e),"mod"!==e&&(s=o.div.neg()),{div:s,mod:o.mod}):0!=(this.negative&t.negative)?(o=this.neg().divmod(t.neg(),e),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.isub(t)),{div:o.div,mod:a}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new n(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modn(t.words[0]))}:this._wordDiv(t,e);var s,a,o},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),n=t.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},n.prototype.modn=function(t){r(t<=67108863);for(var e=67108864%t,i=0,n=this.length-1;n>=0;n--)i=(e*i+(0|this.words[n]))%t;return i},n.prototype.idivn=function(t){r(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*e;this.words[i]=n/t|0,e=n%t}return this.strip()},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s=new n(1),a=new n(0),o=new n(0),h=new n(1),u=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++u;for(var l=i.clone(),c=e.clone();!e.isZero();){for(var f=0,d=1;0==(e.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(l),a.isub(c)),s.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(o.isOdd()||h.isOdd())&&(o.iadd(l),h.isub(c)),o.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),s.isub(o),a.isub(h)):(i.isub(e),o.isub(s),h.isub(a))}return{a:o,b:h,gcd:i.iushln(u)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s,a=new n(1),o=new n(0),h=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,l=1;0==(e.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(e.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);for(var c=0,f=1;0==(i.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);e.cmp(i)>=0?(e.isub(i),a.isub(o)):(i.isub(e),o.isub(a))}return(s=0===e.cmpn(1)?a:o).cmpn(0)<0&&s.iadd(t),s},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var i=0;e.isEven()&&r.isEven();i++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var s=e;e=r,r=s}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(i)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var s=n,a=i;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)e=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|t.words[r];if(i!==n){i<n?e=-1:i>n&&(e=1);break}}return e},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new E(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var v={k256:null,p224:null,p192:null,p25519:null};function _(t,e){this.name=t,this.p=new n(e,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(t){if("string"==typeof t){var e=n._prime(t);this.m=e.p,this.prime=e}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function M(t){E.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},_.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},_.prototype.split=function(t,e){t.iushrn(this.n,0,e)},_.prototype.imulK=function(t){return t.imul(this.k)},i(b,_),b.prototype.split=function(t,e){for(var r=4194303,i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=s&r,n=10;n<t.length;n++){var a=0|t.words[n];t.words[n-10]=(a&r)<<4|s>>>22,s=a}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},b.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var i=0|t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(y,_),i(x,_),i(w,_),w.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var i=19*(0|t.words[r])+e,n=67108863&i;i>>>=26,t.words[r]=n,e=i}return 0!==e&&(t.words[t.length++]=e),t},n._prime=function(t){if(v[t])return v[t];var e;if("k256"===t)e=new b;else if("p224"===t)e=new y;else if("p192"===t)e=new x;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new w}return v[t]=e,e},E.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},E.prototype._verify2=function(t,e){r(0==(t.negative|e.negative),"red works only with positives"),r(t.red&&t.red===e.red,"red works only with red numbers")},E.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},E.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},E.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},E.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},E.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},E.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},E.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},E.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},E.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},E.prototype.isqr=function(t){return this.imul(t,t.clone())},E.prototype.sqr=function(t){return this.mul(t,t)},E.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(r(e%2==1),3===e){var i=this.m.add(new n(1)).iushrn(2);return this.pow(t,i)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new n(1).toRed(this),h=o.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);0!==this.pow(l,u).cmp(h);)l.redIAdd(h);for(var c=this.pow(l,s),f=this.pow(t,s.addn(1).iushrn(1)),d=this.pow(t,s),p=a;0!==d.cmp(o);){for(var m=d,g=0;0!==m.cmp(o);g++)m=m.redSqr();r(g<p);var v=this.pow(c,new n(1).iushln(p-g-1));f=f.redMul(v),c=v.redSqr(),d=d.redMul(c),p=g}return f},E.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},E.prototype.pow=function(t,e){if(e.isZero())return new n(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new n(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var s=r[0],a=0,o=0,h=e.bitLength()%26;for(0===h&&(h=26),i=e.length-1;i>=0;i--){for(var u=e.words[i],l=h-1;l>=0;l--){var c=u>>l&1;s!==r[0]&&(s=this.sqr(s)),0!==c||0!==a?(a<<=1,a|=c,(4===++o||0===i&&0===l)&&(s=this.mul(s,r[a]),o=0,a=0)):o=0}h=26}return s},E.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},E.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},n.mont=function(t){return new M(t)},i(M,E),M.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},M.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},M.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},M.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new n(0)._forceRed(this);var r=t.mul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):s.cmpn(0)<0&&(a=s.iadd(this.m)),a._forceRed(this)},M.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)})),s.register("e3f0s",(function(t,e){var r=s("g5rlv"),i=s("laKaL");function n(t){this.rand=t||new i.Rand}t.exports=n,n.create=function(t){return new n(t)},n.prototype._randbelow=function(t){var e=t.bitLength(),i=Math.ceil(e/8);do{var n=new r(this.rand.generate(i))}while(n.cmp(t)>=0);return n},n.prototype._randrange=function(t,e){var r=e.sub(t);return t.add(this._randbelow(r))},n.prototype.test=function(t,e,i){var n=t.bitLength(),s=r.mont(t),a=new r(1).toRed(s);e||(e=Math.max(1,n/48|0));for(var o=t.subn(1),h=0;!o.testn(h);h++);for(var u=t.shrn(h),l=o.toRed(s);e>0;e--){var c=this._randrange(new r(2),o);i&&i(c);var f=c.toRed(s).redPow(u);if(0!==f.cmp(a)&&0!==f.cmp(l)){for(var d=1;d<h;d++){if(0===(f=f.redSqr()).cmp(a))return!1;if(0===f.cmp(l))break}if(d===h)return!1}}return!0},n.prototype.getDivisor=function(t,e){var i=t.bitLength(),n=r.mont(t),s=new r(1).toRed(n);e||(e=Math.max(1,i/48|0));for(var a=t.subn(1),o=0;!a.testn(o);o++);for(var h=t.shrn(o),u=a.toRed(n);e>0;e--){var l=this._randrange(new r(2),a),c=t.gcd(l);if(0!==c.cmpn(1))return c;var f=l.toRed(n).redPow(h);if(0!==f.cmp(s)&&0!==f.cmp(u)){for(var d=1;d<o;d++){if(0===(f=f.redSqr()).cmp(s))return f.fromRed().subn(1).gcd(t);if(0===f.cmp(u))break}if(d===o)return(f=f.redSqr()).fromRed().subn(1).gcd(t)}}return!1}})),s.register("laKaL",(function(t,e){var r;function i(t){this.rand=t}if(t.exports=function(t){return r||(r=new i(null)),r.generate(t)},t.exports.Rand=i,i.prototype.generate=function(t){return this._rand(t)},i.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var e=new Uint8Array(t),r=0;r<e.length;r++)e[r]=this.rand.getByte();return e},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(t){var e=new Uint8Array(t);return self.crypto.getRandomValues(e),e}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(t){var e=new Uint8Array(t);return self.msCrypto.getRandomValues(e),e}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var n=s("4AFFV");if("function"!=typeof n.randomBytes)throw new Error("Not supported");i.prototype._rand=function(t){return n.randomBytes(t)}}catch(t){}})),s.register("85YpT",(function(t,e){t.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')})),s.register("7EVbB",(function(t,e){var r=s("awmEs").Buffer,i=s("g5rlv"),n=new(s("e3f0s")),a=new i(24),o=new i(11),h=new i(10),u=new i(3),l=new i(7),c=s("2iTIX"),f=s("1oa4b");function d(t,e){return e=e||"utf8",r.isBuffer(t)||(t=new r(t,e)),this._pub=new i(t),this}function p(t,e){return e=e||"utf8",r.isBuffer(t)||(t=new r(t,e)),this._priv=new i(t),this}t.exports=g;var m={};function g(t,e,r){this.setGenerator(e),this.__prime=new i(t),this._prime=i.mont(this.__prime),this._primeLen=t.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,r?(this.setPublicKey=d,this.setPrivateKey=p):this._primeCode=8}function v(t,e){var i=new r(t.toArray());return e?i.toString(e):i}Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(t,e){var r=e.toString("hex"),i=[r,t.toString(16)].join("_");if(i in m)return m[i];var s,f=0;if(t.isEven()||!c.simpleSieve||!c.fermatTest(t)||!n.test(t))return f+=1,f+="02"===r||"05"===r?8:4,m[i]=f,f;switch(n.test(t.shrn(1))||(f+=2),r){case"02":t.mod(a).cmp(o)&&(f+=8);break;case"05":(s=t.mod(h)).cmp(u)&&s.cmp(l)&&(f+=8);break;default:f+=4}return m[i]=f,f}(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new i(f(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(t){var e=(t=(t=new i(t)).toRed(this._prime)).redPow(this._priv).fromRed(),n=new r(e.toArray()),s=this.getPrime();if(n.length<s.length){var a=new r(s.length-n.length);a.fill(0),n=r.concat([a,n])}return n},g.prototype.getPublicKey=function(t){return v(this._pub,t)},g.prototype.getPrivateKey=function(t){return v(this._priv,t)},g.prototype.getPrime=function(t){return v(this.__prime,t)},g.prototype.getGenerator=function(t){return v(this._gen,t)},g.prototype.setGenerator=function(t,e){return e=e||"utf8",r.isBuffer(t)||(t=new r(t,e)),this.__gen=t,this._gen=new i(t),this}})),s.register("aUuNJ",(function(t,e){var r=s("k0Rto").Buffer,i=s("eRLLs"),n=s("l8KM5"),a=s("6cuMU"),o=s("1YreY"),h=s("1O2UL"),u=s("b526X");function l(t){n.Writable.call(this);var e=u[t];if(!e)throw new Error("Unknown message digest");this._hashType=e.hash,this._hash=i(e.hash),this._tag=e.id,this._signType=e.sign}function c(t){n.Writable.call(this);var e=u[t];if(!e)throw new Error("Unknown message digest");this._hash=i(e.hash),this._tag=e.id,this._signType=e.sign}function f(t){return new l(t)}function d(t){return new c(t)}Object.keys(u).forEach((function(t){u[t].id=r.from(u[t].id,"hex"),u[t.toLowerCase()]=u[t]})),a(l,n.Writable),l.prototype._write=function(t,e,r){this._hash.update(t),r()},l.prototype.update=function(t,e){return"string"==typeof t&&(t=r.from(t,e)),this._hash.update(t),this},l.prototype.sign=function(t,e){this.end();var r=this._hash.digest(),i=o(r,t,this._hashType,this._signType,this._tag);return e?i.toString(e):i},a(c,n.Writable),c.prototype._write=function(t,e,r){this._hash.update(t),r()},c.prototype.update=function(t,e){return"string"==typeof t&&(t=r.from(t,e)),this._hash.update(t),this},c.prototype.verify=function(t,e,i){"string"==typeof e&&(e=r.from(e,i)),this.end();var n=this._hash.digest();return h(e,n,t,this._signType,this._tag)},t.exports={Sign:f,Verify:d,createSign:f,createVerify:d}})),s.register("1YreY",(function(t,e){var r=s("k0Rto").Buffer,i=s("9SGAM"),n=s("7wEKJ"),a=s("dEDF4").ec,o=s("hMqfZ"),h=s("8sncL"),u=s("1zkIO");function l(t,e,n,s){if((t=r.from(t.toArray())).length<e.byteLength()){var a=r.alloc(e.byteLength()-t.length);t=r.concat([a,t])}var o=n.length,h=function(t,e){t=c(t,e),t=t.mod(e);var i=r.from(t.toArray());if(i.length<e.byteLength()){var n=r.alloc(e.byteLength()-i.length);i=r.concat([n,i])}return i}(n,e),u=r.alloc(o);u.fill(1);var l=r.alloc(o);return l=i(s,l).update(u).update(r.from([0])).update(t).update(h).digest(),u=i(s,l).update(u).digest(),{k:l=i(s,l).update(u).update(r.from([1])).update(t).update(h).digest(),v:u=i(s,l).update(u).digest()}}function c(t,e){var r=new o(t),i=(t.length<<3)-e.bitLength();return i>0&&r.ishrn(i),r}function f(t,e,n){var s,a;do{for(s=r.alloc(0);8*s.length<t.bitLength();)e.v=i(n,e.k).update(e.v).digest(),s=r.concat([s,e.v]);a=c(s,t),e.k=i(n,e.k).update(e.v).update(r.from([0])).digest(),e.v=i(n,e.k).update(e.v).digest()}while(-1!==a.cmp(t));return a}function d(t,e,r,i){return t.toRed(o.mont(r)).redPow(e).fromRed().mod(i)}t.exports=function(t,e,i,s,p){var m=h(e);if(m.curve){if("ecdsa"!==s&&"ecdsa/rsa"!==s)throw new Error("wrong private key type");return function(t,e){var i=u[e.curve.join(".")];if(!i)throw new Error("unknown curve "+e.curve.join("."));var n=new a(i).keyFromPrivate(e.privateKey),s=n.sign(t);return r.from(s.toDER())}(t,m)}if("dsa"===m.type){if("dsa"!==s)throw new Error("wrong private key type");return function(t,e,i){var n,s=e.params.priv_key,a=e.params.p,h=e.params.q,u=e.params.g,p=new o(0),m=c(t,h).mod(h),g=!1,v=l(s,h,t,i);for(;!1===g;)p=d(u,n=f(h,v,i),a,h),0===(g=n.invm(h).imul(m.add(s.mul(p))).mod(h)).cmpn(0)&&(g=!1,p=new o(0));return function(t,e){t=t.toArray(),e=e.toArray(),128&t[0]&&(t=[0].concat(t));128&e[0]&&(e=[0].concat(e));var i=t.length+e.length+4,n=[48,i,2,t.length];return n=n.concat(t,[2,e.length],e),r.from(n)}(p,g)}(t,m,i)}if("rsa"!==s&&"ecdsa/rsa"!==s)throw new Error("wrong private key type");t=r.concat([p,t]);for(var g=m.modulus.byteLength(),v=[0,1];t.length+v.length+1<g;)v.push(255);v.push(0);for(var _=-1;++_<t.length;)v.push(t[_]);return n(v,m)},t.exports.getKey=l,t.exports.makeKey=f})),s.register("7wEKJ",(function(t,e){var r=s("awmEs").Buffer,i=s("6M6Yp"),n=s("1oa4b");function a(t){var e,r=t.modulus.byteLength();do{e=new i(n(r))}while(e.cmp(t.modulus)>=0||!e.umod(t.prime1)||!e.umod(t.prime2));return e}function o(t,e){var n=function(t){var e=a(t);return{blinder:e.toRed(i.mont(t.modulus)).redPow(new i(t.publicExponent)).fromRed(),unblinder:e.invm(t.modulus)}}(e),s=e.modulus.byteLength(),o=new i(t).mul(n.blinder).umod(e.modulus),h=o.toRed(i.mont(e.prime1)),u=o.toRed(i.mont(e.prime2)),l=e.coefficient,c=e.prime1,f=e.prime2,d=h.redPow(e.exponent1).fromRed(),p=u.redPow(e.exponent2).fromRed(),m=d.isub(p).imul(l).umod(c).imul(f);return p.iadd(m).imul(n.unblinder).umod(e.modulus).toArrayLike(r,"be",s)}o.getr=a,t.exports=o})),s.register("6M6Yp",(function(t,e){!function(t,e){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function n(t,e,r){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var a;"object"==typeof t?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:s("4AFFV").Buffer}catch(t){}function o(t,e){var i=t.charCodeAt(e);return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:void r(!1,"Invalid character in "+t)}function h(t,e,r){var i=o(t,r);return r-1>=e&&(i|=o(t,r-1)<<4),i}function u(t,e,i,n){for(var s=0,a=0,o=Math.min(t.length,i),h=e;h<o;h++){var u=t.charCodeAt(h)-48;s*=n,a=u>=49?u-49+10:u>=17?u-17+10:u,r(u>=0&&a<n,"Invalid character"),s+=a}return s}function l(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,e){return t.cmp(e)>0?t:e},n.min=function(t,e){return t.cmp(e)<0?t:e},n.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),r(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,i):(this._parseBase(t,e,n),"le"===i&&this._initArray(this.toArray(),e,i)))},n.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},n.prototype._initArray=function(t,e,i){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,a,o=0;if("be"===i)for(n=t.length-1,s=0;n>=0;n-=3)a=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===i)for(n=0,s=0;n<t.length;n+=3)a=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this._strip()},n.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,a=0;if("be"===r)for(i=t.length-1;i>=e;i-=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;else for(i=(t.length-e)%2==0?e+1:e;i<t.length;i+=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;this._strip()},n.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=e)i++;i--,n=n/e|0;for(var s=t.length-r,a=s%i,o=Math.min(s,s-a)+r,h=0,l=r;l<o;l+=i)h=u(t,l,l+i,e),this.imuln(n),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(0!==a){var c=1;for(h=u(t,l,t.length,e),l=0;l<a;l++)c*=e;this.imuln(c),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this._strip()},n.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype._move=function(t){l(t,this)},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{n.prototype[Symbol.for("nodejs.util.inspect.custom")]=c}catch(t){n.prototype.inspect=c}else n.prototype.inspect=c;function c(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(t,e){var i;if(e=0|e||1,16===(t=t||10)||"hex"===t){i="";for(var n=0,s=0,a=0;a<this.length;a++){var o=this.words[a],h=(16777215&(o<<n|s)).toString(16);s=o>>>24-n&16777215,(n+=2)>=26&&(n-=26,a--),i=0!==s||a!==this.length-1?f[6-h.length]+h+i:h+i}for(0!==s&&(i=s.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var u=d[t],l=p[t];i="";var c=this.clone();for(c.negative=0;!c.isZero();){var m=c.modrn(l).toString(t);i=(c=c.idivn(l)).isZero()?m+i:f[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16,2)},a&&(n.prototype.toBuffer=function(t,e){return this.toArrayLike(a,t,e)}),n.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function m(t,e,r){r.negative=e.negative^t.negative;var i=t.length+e.length|0;r.length=i,i=i-1|0;var n=0|t.words[0],s=0|e.words[0],a=n*s,o=67108863&a,h=a/67108864|0;r.words[0]=o;for(var u=1;u<i;u++){for(var l=h>>>26,c=67108863&h,f=Math.min(u,e.length-1),d=Math.max(0,u-t.length+1);d<=f;d++){var p=u-d|0;l+=(a=(n=0|t.words[p])*(s=0|e.words[d])+c)/67108864|0,c=67108863&a}r.words[u]=0|c,h=0|l}return 0!==h?r.words[u]=0|h:r.length--,r._strip()}n.prototype.toArrayLike=function(t,e,i){this._strip();var n=this.byteLength(),s=i||Math.max(1,n);r(n<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0");var a=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,s);return this["_toArrayLike"+("le"===e?"LE":"BE")](a,n),a},n.prototype._toArrayLikeLE=function(t,e){for(var r=0,i=0,n=0,s=0;n<this.length;n++){var a=this.words[n]<<s|i;t[r++]=255&a,r<t.length&&(t[r++]=a>>8&255),r<t.length&&(t[r++]=a>>16&255),6===s?(r<t.length&&(t[r++]=a>>24&255),i=0,s=0):(i=a>>>24,s+=2)}if(r<t.length)for(t[r++]=i;r<t.length;)t[r++]=0},n.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,i=0,n=0,s=0;n<this.length;n++){var a=this.words[n]<<s|i;t[r--]=255&a,r>=0&&(t[r--]=a>>8&255),r>=0&&(t[r--]=a>>16&255),6===s?(r>=0&&(t[r--]=a>>24&255),i=0,s=0):(i=a>>>24,s+=2)}if(r>=0)for(t[r--]=i;r>=0;)t[r--]=0},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},n.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},n.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},n.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},n.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var i=0;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this._strip()},n.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this._strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,e){r("number"==typeof t&&t>=0);var i=t/26|0,n=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<n:this.words[i]&~(1<<n),this._strip()},n.prototype.iadd=function(t){var e,r,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,i=t):(r=t,i=this);for(var n=0,s=0;s<i.length;s++)e=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<r.length;s++)e=(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},n.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,i,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=t):(r=t,i=this);for(var s=0,a=0;a<i.length;a++)s=(e=(0|r.words[a])-(0|i.words[a])+s)>>26,this.words[a]=67108863&e;for(;0!==s&&a<r.length;a++)s=(e=(0|r.words[a])+s)>>26,this.words[a]=67108863&e;if(0===s&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,r){var i,n,s,a=t.words,o=e.words,h=r.words,u=0,l=0|a[0],c=8191&l,f=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,g=0|a[2],v=8191&g,_=g>>>13,b=0|a[3],y=8191&b,x=b>>>13,w=0|a[4],E=8191&w,M=w>>>13,S=0|a[5],A=8191&S,T=S>>>13,C=0|a[6],D=8191&C,R=C>>>13,I=0|a[7],P=8191&I,N=I>>>13,k=0|a[8],B=8191&k,L=k>>>13,O=0|a[9],F=8191&O,U=O>>>13,z=0|o[0],G=8191&z,H=z>>>13,j=0|o[1],V=8191&j,W=j>>>13,q=0|o[2],X=8191&q,Y=q>>>13,Z=0|o[3],$=8191&Z,K=Z>>>13,J=0|o[4],Q=8191&J,tt=J>>>13,et=0|o[5],rt=8191&et,it=et>>>13,nt=0|o[6],st=8191&nt,at=nt>>>13,ot=0|o[7],ht=8191&ot,ut=ot>>>13,lt=0|o[8],ct=8191&lt,ft=lt>>>13,dt=0|o[9],pt=8191&dt,mt=dt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(u+(i=Math.imul(c,G))|0)+((8191&(n=(n=Math.imul(c,H))+Math.imul(f,G)|0))<<13)|0;u=((s=Math.imul(f,H))+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(p,G),n=(n=Math.imul(p,H))+Math.imul(m,G)|0,s=Math.imul(m,H);var vt=(u+(i=i+Math.imul(c,V)|0)|0)+((8191&(n=(n=n+Math.imul(c,W)|0)+Math.imul(f,V)|0))<<13)|0;u=((s=s+Math.imul(f,W)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(v,G),n=(n=Math.imul(v,H))+Math.imul(_,G)|0,s=Math.imul(_,H),i=i+Math.imul(p,V)|0,n=(n=n+Math.imul(p,W)|0)+Math.imul(m,V)|0,s=s+Math.imul(m,W)|0;var _t=(u+(i=i+Math.imul(c,X)|0)|0)+((8191&(n=(n=n+Math.imul(c,Y)|0)+Math.imul(f,X)|0))<<13)|0;u=((s=s+Math.imul(f,Y)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(y,G),n=(n=Math.imul(y,H))+Math.imul(x,G)|0,s=Math.imul(x,H),i=i+Math.imul(v,V)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(_,V)|0,s=s+Math.imul(_,W)|0,i=i+Math.imul(p,X)|0,n=(n=n+Math.imul(p,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var bt=(u+(i=i+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,K)|0)+Math.imul(f,$)|0))<<13)|0;u=((s=s+Math.imul(f,K)|0)+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,i=Math.imul(E,G),n=(n=Math.imul(E,H))+Math.imul(M,G)|0,s=Math.imul(M,H),i=i+Math.imul(y,V)|0,n=(n=n+Math.imul(y,W)|0)+Math.imul(x,V)|0,s=s+Math.imul(x,W)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,Y)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,Y)|0,i=i+Math.imul(p,$)|0,n=(n=n+Math.imul(p,K)|0)+Math.imul(m,$)|0,s=s+Math.imul(m,K)|0;var yt=(u+(i=i+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,tt)|0)+Math.imul(f,Q)|0))<<13)|0;u=((s=s+Math.imul(f,tt)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(A,G),n=(n=Math.imul(A,H))+Math.imul(T,G)|0,s=Math.imul(T,H),i=i+Math.imul(E,V)|0,n=(n=n+Math.imul(E,W)|0)+Math.imul(M,V)|0,s=s+Math.imul(M,W)|0,i=i+Math.imul(y,X)|0,n=(n=n+Math.imul(y,Y)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,Y)|0,i=i+Math.imul(v,$)|0,n=(n=n+Math.imul(v,K)|0)+Math.imul(_,$)|0,s=s+Math.imul(_,K)|0,i=i+Math.imul(p,Q)|0,n=(n=n+Math.imul(p,tt)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,tt)|0;var xt=(u+(i=i+Math.imul(c,rt)|0)|0)+((8191&(n=(n=n+Math.imul(c,it)|0)+Math.imul(f,rt)|0))<<13)|0;u=((s=s+Math.imul(f,it)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(D,G),n=(n=Math.imul(D,H))+Math.imul(R,G)|0,s=Math.imul(R,H),i=i+Math.imul(A,V)|0,n=(n=n+Math.imul(A,W)|0)+Math.imul(T,V)|0,s=s+Math.imul(T,W)|0,i=i+Math.imul(E,X)|0,n=(n=n+Math.imul(E,Y)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,Y)|0,i=i+Math.imul(y,$)|0,n=(n=n+Math.imul(y,K)|0)+Math.imul(x,$)|0,s=s+Math.imul(x,K)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,tt)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,tt)|0,i=i+Math.imul(p,rt)|0,n=(n=n+Math.imul(p,it)|0)+Math.imul(m,rt)|0,s=s+Math.imul(m,it)|0;var wt=(u+(i=i+Math.imul(c,st)|0)|0)+((8191&(n=(n=n+Math.imul(c,at)|0)+Math.imul(f,st)|0))<<13)|0;u=((s=s+Math.imul(f,at)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(P,G),n=(n=Math.imul(P,H))+Math.imul(N,G)|0,s=Math.imul(N,H),i=i+Math.imul(D,V)|0,n=(n=n+Math.imul(D,W)|0)+Math.imul(R,V)|0,s=s+Math.imul(R,W)|0,i=i+Math.imul(A,X)|0,n=(n=n+Math.imul(A,Y)|0)+Math.imul(T,X)|0,s=s+Math.imul(T,Y)|0,i=i+Math.imul(E,$)|0,n=(n=n+Math.imul(E,K)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,K)|0,i=i+Math.imul(y,Q)|0,n=(n=n+Math.imul(y,tt)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,tt)|0,i=i+Math.imul(v,rt)|0,n=(n=n+Math.imul(v,it)|0)+Math.imul(_,rt)|0,s=s+Math.imul(_,it)|0,i=i+Math.imul(p,st)|0,n=(n=n+Math.imul(p,at)|0)+Math.imul(m,st)|0,s=s+Math.imul(m,at)|0;var Et=(u+(i=i+Math.imul(c,ht)|0)|0)+((8191&(n=(n=n+Math.imul(c,ut)|0)+Math.imul(f,ht)|0))<<13)|0;u=((s=s+Math.imul(f,ut)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(B,G),n=(n=Math.imul(B,H))+Math.imul(L,G)|0,s=Math.imul(L,H),i=i+Math.imul(P,V)|0,n=(n=n+Math.imul(P,W)|0)+Math.imul(N,V)|0,s=s+Math.imul(N,W)|0,i=i+Math.imul(D,X)|0,n=(n=n+Math.imul(D,Y)|0)+Math.imul(R,X)|0,s=s+Math.imul(R,Y)|0,i=i+Math.imul(A,$)|0,n=(n=n+Math.imul(A,K)|0)+Math.imul(T,$)|0,s=s+Math.imul(T,K)|0,i=i+Math.imul(E,Q)|0,n=(n=n+Math.imul(E,tt)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,tt)|0,i=i+Math.imul(y,rt)|0,n=(n=n+Math.imul(y,it)|0)+Math.imul(x,rt)|0,s=s+Math.imul(x,it)|0,i=i+Math.imul(v,st)|0,n=(n=n+Math.imul(v,at)|0)+Math.imul(_,st)|0,s=s+Math.imul(_,at)|0,i=i+Math.imul(p,ht)|0,n=(n=n+Math.imul(p,ut)|0)+Math.imul(m,ht)|0,s=s+Math.imul(m,ut)|0;var Mt=(u+(i=i+Math.imul(c,ct)|0)|0)+((8191&(n=(n=n+Math.imul(c,ft)|0)+Math.imul(f,ct)|0))<<13)|0;u=((s=s+Math.imul(f,ft)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(F,G),n=(n=Math.imul(F,H))+Math.imul(U,G)|0,s=Math.imul(U,H),i=i+Math.imul(B,V)|0,n=(n=n+Math.imul(B,W)|0)+Math.imul(L,V)|0,s=s+Math.imul(L,W)|0,i=i+Math.imul(P,X)|0,n=(n=n+Math.imul(P,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,i=i+Math.imul(D,$)|0,n=(n=n+Math.imul(D,K)|0)+Math.imul(R,$)|0,s=s+Math.imul(R,K)|0,i=i+Math.imul(A,Q)|0,n=(n=n+Math.imul(A,tt)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,tt)|0,i=i+Math.imul(E,rt)|0,n=(n=n+Math.imul(E,it)|0)+Math.imul(M,rt)|0,s=s+Math.imul(M,it)|0,i=i+Math.imul(y,st)|0,n=(n=n+Math.imul(y,at)|0)+Math.imul(x,st)|0,s=s+Math.imul(x,at)|0,i=i+Math.imul(v,ht)|0,n=(n=n+Math.imul(v,ut)|0)+Math.imul(_,ht)|0,s=s+Math.imul(_,ut)|0,i=i+Math.imul(p,ct)|0,n=(n=n+Math.imul(p,ft)|0)+Math.imul(m,ct)|0,s=s+Math.imul(m,ft)|0;var St=(u+(i=i+Math.imul(c,pt)|0)|0)+((8191&(n=(n=n+Math.imul(c,mt)|0)+Math.imul(f,pt)|0))<<13)|0;u=((s=s+Math.imul(f,mt)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(F,V),n=(n=Math.imul(F,W))+Math.imul(U,V)|0,s=Math.imul(U,W),i=i+Math.imul(B,X)|0,n=(n=n+Math.imul(B,Y)|0)+Math.imul(L,X)|0,s=s+Math.imul(L,Y)|0,i=i+Math.imul(P,$)|0,n=(n=n+Math.imul(P,K)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,K)|0,i=i+Math.imul(D,Q)|0,n=(n=n+Math.imul(D,tt)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,tt)|0,i=i+Math.imul(A,rt)|0,n=(n=n+Math.imul(A,it)|0)+Math.imul(T,rt)|0,s=s+Math.imul(T,it)|0,i=i+Math.imul(E,st)|0,n=(n=n+Math.imul(E,at)|0)+Math.imul(M,st)|0,s=s+Math.imul(M,at)|0,i=i+Math.imul(y,ht)|0,n=(n=n+Math.imul(y,ut)|0)+Math.imul(x,ht)|0,s=s+Math.imul(x,ut)|0,i=i+Math.imul(v,ct)|0,n=(n=n+Math.imul(v,ft)|0)+Math.imul(_,ct)|0,s=s+Math.imul(_,ft)|0;var At=(u+(i=i+Math.imul(p,pt)|0)|0)+((8191&(n=(n=n+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;u=((s=s+Math.imul(m,mt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,i=Math.imul(F,X),n=(n=Math.imul(F,Y))+Math.imul(U,X)|0,s=Math.imul(U,Y),i=i+Math.imul(B,$)|0,n=(n=n+Math.imul(B,K)|0)+Math.imul(L,$)|0,s=s+Math.imul(L,K)|0,i=i+Math.imul(P,Q)|0,n=(n=n+Math.imul(P,tt)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,tt)|0,i=i+Math.imul(D,rt)|0,n=(n=n+Math.imul(D,it)|0)+Math.imul(R,rt)|0,s=s+Math.imul(R,it)|0,i=i+Math.imul(A,st)|0,n=(n=n+Math.imul(A,at)|0)+Math.imul(T,st)|0,s=s+Math.imul(T,at)|0,i=i+Math.imul(E,ht)|0,n=(n=n+Math.imul(E,ut)|0)+Math.imul(M,ht)|0,s=s+Math.imul(M,ut)|0,i=i+Math.imul(y,ct)|0,n=(n=n+Math.imul(y,ft)|0)+Math.imul(x,ct)|0,s=s+Math.imul(x,ft)|0;var Tt=(u+(i=i+Math.imul(v,pt)|0)|0)+((8191&(n=(n=n+Math.imul(v,mt)|0)+Math.imul(_,pt)|0))<<13)|0;u=((s=s+Math.imul(_,mt)|0)+(n>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,i=Math.imul(F,$),n=(n=Math.imul(F,K))+Math.imul(U,$)|0,s=Math.imul(U,K),i=i+Math.imul(B,Q)|0,n=(n=n+Math.imul(B,tt)|0)+Math.imul(L,Q)|0,s=s+Math.imul(L,tt)|0,i=i+Math.imul(P,rt)|0,n=(n=n+Math.imul(P,it)|0)+Math.imul(N,rt)|0,s=s+Math.imul(N,it)|0,i=i+Math.imul(D,st)|0,n=(n=n+Math.imul(D,at)|0)+Math.imul(R,st)|0,s=s+Math.imul(R,at)|0,i=i+Math.imul(A,ht)|0,n=(n=n+Math.imul(A,ut)|0)+Math.imul(T,ht)|0,s=s+Math.imul(T,ut)|0,i=i+Math.imul(E,ct)|0,n=(n=n+Math.imul(E,ft)|0)+Math.imul(M,ct)|0,s=s+Math.imul(M,ft)|0;var Ct=(u+(i=i+Math.imul(y,pt)|0)|0)+((8191&(n=(n=n+Math.imul(y,mt)|0)+Math.imul(x,pt)|0))<<13)|0;u=((s=s+Math.imul(x,mt)|0)+(n>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,i=Math.imul(F,Q),n=(n=Math.imul(F,tt))+Math.imul(U,Q)|0,s=Math.imul(U,tt),i=i+Math.imul(B,rt)|0,n=(n=n+Math.imul(B,it)|0)+Math.imul(L,rt)|0,s=s+Math.imul(L,it)|0,i=i+Math.imul(P,st)|0,n=(n=n+Math.imul(P,at)|0)+Math.imul(N,st)|0,s=s+Math.imul(N,at)|0,i=i+Math.imul(D,ht)|0,n=(n=n+Math.imul(D,ut)|0)+Math.imul(R,ht)|0,s=s+Math.imul(R,ut)|0,i=i+Math.imul(A,ct)|0,n=(n=n+Math.imul(A,ft)|0)+Math.imul(T,ct)|0,s=s+Math.imul(T,ft)|0;var Dt=(u+(i=i+Math.imul(E,pt)|0)|0)+((8191&(n=(n=n+Math.imul(E,mt)|0)+Math.imul(M,pt)|0))<<13)|0;u=((s=s+Math.imul(M,mt)|0)+(n>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,i=Math.imul(F,rt),n=(n=Math.imul(F,it))+Math.imul(U,rt)|0,s=Math.imul(U,it),i=i+Math.imul(B,st)|0,n=(n=n+Math.imul(B,at)|0)+Math.imul(L,st)|0,s=s+Math.imul(L,at)|0,i=i+Math.imul(P,ht)|0,n=(n=n+Math.imul(P,ut)|0)+Math.imul(N,ht)|0,s=s+Math.imul(N,ut)|0,i=i+Math.imul(D,ct)|0,n=(n=n+Math.imul(D,ft)|0)+Math.imul(R,ct)|0,s=s+Math.imul(R,ft)|0;var Rt=(u+(i=i+Math.imul(A,pt)|0)|0)+((8191&(n=(n=n+Math.imul(A,mt)|0)+Math.imul(T,pt)|0))<<13)|0;u=((s=s+Math.imul(T,mt)|0)+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,i=Math.imul(F,st),n=(n=Math.imul(F,at))+Math.imul(U,st)|0,s=Math.imul(U,at),i=i+Math.imul(B,ht)|0,n=(n=n+Math.imul(B,ut)|0)+Math.imul(L,ht)|0,s=s+Math.imul(L,ut)|0,i=i+Math.imul(P,ct)|0,n=(n=n+Math.imul(P,ft)|0)+Math.imul(N,ct)|0,s=s+Math.imul(N,ft)|0;var It=(u+(i=i+Math.imul(D,pt)|0)|0)+((8191&(n=(n=n+Math.imul(D,mt)|0)+Math.imul(R,pt)|0))<<13)|0;u=((s=s+Math.imul(R,mt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(F,ht),n=(n=Math.imul(F,ut))+Math.imul(U,ht)|0,s=Math.imul(U,ut),i=i+Math.imul(B,ct)|0,n=(n=n+Math.imul(B,ft)|0)+Math.imul(L,ct)|0,s=s+Math.imul(L,ft)|0;var Pt=(u+(i=i+Math.imul(P,pt)|0)|0)+((8191&(n=(n=n+Math.imul(P,mt)|0)+Math.imul(N,pt)|0))<<13)|0;u=((s=s+Math.imul(N,mt)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,i=Math.imul(F,ct),n=(n=Math.imul(F,ft))+Math.imul(U,ct)|0,s=Math.imul(U,ft);var Nt=(u+(i=i+Math.imul(B,pt)|0)|0)+((8191&(n=(n=n+Math.imul(B,mt)|0)+Math.imul(L,pt)|0))<<13)|0;u=((s=s+Math.imul(L,mt)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var kt=(u+(i=Math.imul(F,pt))|0)+((8191&(n=(n=Math.imul(F,mt))+Math.imul(U,pt)|0))<<13)|0;return u=((s=Math.imul(U,mt))+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,h[0]=gt,h[1]=vt,h[2]=_t,h[3]=bt,h[4]=yt,h[5]=xt,h[6]=wt,h[7]=Et,h[8]=Mt,h[9]=St,h[10]=At,h[11]=Tt,h[12]=Ct,h[13]=Dt,h[14]=Rt,h[15]=It,h[16]=Pt,h[17]=Nt,h[18]=kt,0!==u&&(h[19]=u,r.length++),r};function v(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var a=n;n=0;for(var o=67108863&i,h=Math.min(s,e.length-1),u=Math.max(0,s-t.length+1);u<=h;u++){var l=s-u,c=(0|t.words[l])*(0|e.words[u]),f=67108863&c;o=67108863&(f=f+o|0),n+=(a=(a=a+(c/67108864|0)|0)+(f>>>26)|0)>>>26,a&=67108863}r.words[s]=o,i=a,a=n}return 0!==i?r.words[s]=i:r.length--,r._strip()}function _(t,e,r){return v(t,e,r)}function b(t,e){this.x=t,this.y=e}Math.imul||(g=m),n.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):r<63?m(this,t,e):r<1024?v(this,t,e):_(this,t,e)},b.prototype.makeRBT=function(t){for(var e=new Array(t),r=n.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,r,t);return e},b.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var i=0,n=0;n<e;n++)i|=(1&t)<<e-n-1,t>>=1;return i},b.prototype.permute=function(t,e,r,i,n,s){for(var a=0;a<s;a++)i[a]=e[t[a]],n[a]=r[t[a]]},b.prototype.transform=function(t,e,r,i,n,s){this.permute(s,t,e,r,i,n);for(var a=1;a<n;a<<=1)for(var o=a<<1,h=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),l=0;l<n;l+=o)for(var c=h,f=u,d=0;d<a;d++){var p=r[l+d],m=i[l+d],g=r[l+d+a],v=i[l+d+a],_=c*g-f*v;v=c*v+f*g,g=_,r[l+d]=p+g,i[l+d]=m+v,r[l+d+a]=p-g,i[l+d+a]=m-v,d!==o&&(_=h*c-u*f,f=h*f+u*c,c=_)}},b.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},b.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=t[i];t[i]=t[r-i-1],t[r-i-1]=n,n=e[i],e[i]=-e[r-i-1],e[r-i-1]=-n}},b.prototype.normalize13b=function(t,e){for(var r=0,i=0;i<e/2;i++){var n=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+r;t[i]=67108863&n,r=n<67108864?0:n/67108864|0}return t},b.prototype.convert13b=function(t,e,i,n){for(var s=0,a=0;a<e;a++)s+=0|t[a],i[2*a]=8191&s,s>>>=13,i[2*a+1]=8191&s,s>>>=13;for(a=2*e;a<n;++a)i[a]=0;r(0===s),r(0==(-8192&s))},b.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},b.prototype.mulp=function(t,e,r){var i=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(i),s=this.stub(i),a=new Array(i),o=new Array(i),h=new Array(i),u=new Array(i),l=new Array(i),c=new Array(i),f=r.words;f.length=i,this.convert13b(t.words,t.length,a,i),this.convert13b(e.words,e.length,u,i),this.transform(a,s,o,h,i,n),this.transform(u,s,l,c,i,n);for(var d=0;d<i;d++){var p=o[d]*l[d]-h[d]*c[d];h[d]=o[d]*c[d]+h[d]*l[d],o[d]=p}return this.conjugate(o,h,i),this.transform(o,h,f,s,i,n),this.conjugate(f,s,i),this.normalize13b(f,i),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},n.prototype.mul=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},n.prototype.mulf=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),_(this,t,e)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){var e=t<0;e&&(t=-t),r("number"==typeof t),r(t<67108864);for(var i=0,n=0;n<this.length;n++){var s=(0|this.words[n])*t,a=(67108863&s)+(67108863&i);i>>=26,i+=s/67108864|0,i+=a>>>26,this.words[n]=67108863&a}return 0!==i&&(this.words[n]=i,this.length++),e?this.ineg():this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var i=r/26|0,n=r%26;e[r]=t.words[i]>>>n&1}return e}(t);if(0===e.length)return new n(1);for(var r=this,i=0;i<e.length&&0===e[i];i++,r=r.sqr());if(++i<e.length)for(var s=r.sqr();i<e.length;i++,s=s.sqr())0!==e[i]&&(r=r.mul(s));return r},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var e,i=t%26,n=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var a=0;for(e=0;e<this.length;e++){var o=this.words[e]&s,h=(0|this.words[e])-o<<i;this.words[e]=h|a,a=o>>>26-i}a&&(this.words[e]=a,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this._strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,e,i){var n;r("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,a=Math.min((t-s)/26,this.length),o=67108863^67108863>>>s<<s,h=i;if(n-=a,n=Math.max(0,n),h){for(var u=0;u<a;u++)h.words[u]=this.words[u];h.length=a}if(0===a);else if(this.length>a)for(this.length-=a,u=0;u<this.length;u++)this.words[u]=this.words[u+a];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=n);u--){var c=0|this.words[u];this.words[u]=l<<26-s|c>>>s,l=c&o}return h&&0!==l&&(h.words[h.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(t,e,i){return r(0===this.negative),this.iushrn(t,e,i)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,n=1<<e;return!(this.length<=i)&&!!(this.words[i]&n)},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this._strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,e,i){var n,s,a=t.length+i;this._expand(a);var o=0;for(n=0;n<t.length;n++){s=(0|this.words[n+i])+o;var h=(0|t.words[n])*e;o=((s-=67108863&h)>>26)-(h/67108864|0),this.words[n+i]=67108863&s}for(;n<this.length-i;n++)o=(s=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&s;if(0===o)return this._strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(s=-(0|this.words[n])+o)>>26,this.words[n]=67108863&s;return this.negative=1,this._strip()},n.prototype._wordDiv=function(t,e){var r=(this.length,t.length),i=this.clone(),s=t,a=0|s.words[s.length-1];0!==(r=26-this._countBits(a))&&(s=s.ushln(r),i.iushln(r),a=0|s.words[s.length-1]);var o,h=i.length-s.length;if("mod"!==e){(o=new n(null)).length=h+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var l=i.clone()._ishlnsubmul(s,1,h);0===l.negative&&(i=l,o&&(o.words[h]=1));for(var c=h-1;c>=0;c--){var f=67108864*(0|i.words[s.length+c])+(0|i.words[s.length+c-1]);for(f=Math.min(f/a|0,67108863),i._ishlnsubmul(s,f,c);0!==i.negative;)f--,i.negative=0,i._ishlnsubmul(s,1,c),i.isZero()||(i.negative^=1);o&&(o.words[c]=f)}return o&&o._strip(),i._strip(),"div"!==e&&0!==r&&i.iushrn(r),{div:o||null,mod:i}},n.prototype.divmod=function(t,e,i){return r(!t.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===t.negative?(o=this.neg().divmod(t,e),"mod"!==e&&(s=o.div.neg()),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.iadd(t)),{div:s,mod:a}):0===this.negative&&0!==t.negative?(o=this.divmod(t.neg(),e),"mod"!==e&&(s=o.div.neg()),{div:s,mod:o.mod}):0!=(this.negative&t.negative)?(o=this.neg().divmod(t.neg(),e),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.isub(t)),{div:o.div,mod:a}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new n(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modrn(t.words[0]))}:this._wordDiv(t,e);var s,a,o},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),n=t.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},n.prototype.modrn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var i=67108864%t,n=0,s=this.length-1;s>=0;s--)n=(i*n+(0|this.words[s]))%t;return e?-n:n},n.prototype.modn=function(t){return this.modrn(t)},n.prototype.idivn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var i=0,n=this.length-1;n>=0;n--){var s=(0|this.words[n])+67108864*i;this.words[n]=s/t|0,i=s%t}return this._strip(),e?this.ineg():this},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s=new n(1),a=new n(0),o=new n(0),h=new n(1),u=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++u;for(var l=i.clone(),c=e.clone();!e.isZero();){for(var f=0,d=1;0==(e.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(l),a.isub(c)),s.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(o.isOdd()||h.isOdd())&&(o.iadd(l),h.isub(c)),o.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),s.isub(o),a.isub(h)):(i.isub(e),o.isub(s),h.isub(a))}return{a:o,b:h,gcd:i.iushln(u)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s,a=new n(1),o=new n(0),h=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,l=1;0==(e.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(e.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);for(var c=0,f=1;0==(i.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);e.cmp(i)>=0?(e.isub(i),a.isub(o)):(i.isub(e),o.isub(a))}return(s=0===e.cmpn(1)?a:o).cmpn(0)<0&&s.iadd(t),s},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var i=0;e.isEven()&&r.isEven();i++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var s=e;e=r,r=s}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(i)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var s=n,a=i;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this._strip(),this.length>1)e=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|t.words[r];if(i!==n){i<n?e=-1:i>n&&(e=1);break}}return e},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new A(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function x(t,e){this.name=t,this.p=new n(e,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function M(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(t){if("string"==typeof t){var e=n._prime(t);this.m=e.p,this.prime=e}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function T(t){A.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}x.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},x.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},x.prototype.split=function(t,e){t.iushrn(this.n,0,e)},x.prototype.imulK=function(t){return t.imul(this.k)},i(w,x),w.prototype.split=function(t,e){for(var r=4194303,i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=s&r,n=10;n<t.length;n++){var a=0|t.words[n];t.words[n-10]=(a&r)<<4|s>>>22,s=a}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},w.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var i=0|t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(E,x),i(M,x),i(S,x),S.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var i=19*(0|t.words[r])+e,n=67108863&i;i>>>=26,t.words[r]=n,e=i}return 0!==e&&(t.words[t.length++]=e),t},n._prime=function(t){if(y[t])return y[t];var e;if("k256"===t)e=new w;else if("p224"===t)e=new E;else if("p192"===t)e=new M;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new S}return y[t]=e,e},A.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},A.prototype._verify2=function(t,e){r(0==(t.negative|e.negative),"red works only with positives"),r(t.red&&t.red===e.red,"red works only with red numbers")},A.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(l(t,t.umod(this.m)._forceRed(this)),t)},A.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},A.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},A.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},A.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},A.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},A.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},A.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},A.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},A.prototype.isqr=function(t){return this.imul(t,t.clone())},A.prototype.sqr=function(t){return this.mul(t,t)},A.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(r(e%2==1),3===e){var i=this.m.add(new n(1)).iushrn(2);return this.pow(t,i)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new n(1).toRed(this),h=o.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);0!==this.pow(l,u).cmp(h);)l.redIAdd(h);for(var c=this.pow(l,s),f=this.pow(t,s.addn(1).iushrn(1)),d=this.pow(t,s),p=a;0!==d.cmp(o);){for(var m=d,g=0;0!==m.cmp(o);g++)m=m.redSqr();r(g<p);var v=this.pow(c,new n(1).iushln(p-g-1));f=f.redMul(v),c=v.redSqr(),d=d.redMul(c),p=g}return f},A.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},A.prototype.pow=function(t,e){if(e.isZero())return new n(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new n(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var s=r[0],a=0,o=0,h=e.bitLength()%26;for(0===h&&(h=26),i=e.length-1;i>=0;i--){for(var u=e.words[i],l=h-1;l>=0;l--){var c=u>>l&1;s!==r[0]&&(s=this.sqr(s)),0!==c||0!==a?(a<<=1,a|=c,(4===++o||0===i&&0===l)&&(s=this.mul(s,r[a]),o=0,a=0)):o=0}h=26}return s},A.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},A.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},n.mont=function(t){return new T(t)},i(T,A),T.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},T.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},T.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},T.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new n(0)._forceRed(this);var r=t.mul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):s.cmpn(0)<0&&(a=s.iadd(this.m)),a._forceRed(this)},T.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)})),s.register("dEDF4",(function(t,e){var r=t.exports;r.version=s("7i4XP").version,r.utils=s("brS1t"),r.rand=s("laKaL"),r.curve=s("jSUNI"),r.curves=s("3sWIt"),r.ec=s("clHeT"),r.eddsa=s("jVnqQ")})),s.register("7i4XP",(function(t,e){t.exports=JSON.parse('{"license":"MIT","private":true,"scripts":{"serve":"parcel --dist-dir bin","electron":"wait-on http://localhost:1234 && electron --js-flags=--max-old-space-size=8192 .","start":"concurrently \\"yarn serve\\" \\"yarn electron\\" -k -c auto -s command-1","postinstall":"husky install","build":"parcel build --target genclub --no-content-hash"},"lint-staged":{"*.ts":["eslint --fix","prettier --write"]},"source":"index.html","main":"electron.js","targets":{"genclub":{"context":"browser","sourceMap":false,"publicUrl":"./"}},"staticFiles":{"staticPath":"assets"},"dependencies":{"@pdf-lib/fontkit":"^1.1.1","@pixi-essentials/svg":"^1.1.5","@pixi/filter-noise":"^7.2.1","@pixi/mesh-extras":"^7.0.5","@tweenjs/tween.js":"^18.6.4","canvas-capture":"^2.0.6","color-convert":"^2.0.1","get-pixels":"^3.3.3","hull.js":"^1.0.3","mathjs":"^11.5.0","paper":"^0.12.17","pixi.js":"^7.2.1","random-js":"^2.1.0","rxjs":"^7.8.0","simplex-noise":"^4.0.1","stats.js":"^0.17.0","three":"^0.148.0"},"devDependencies":{"@tsconfig/recommended":"^1.0.1","@types/color-convert":"^2.0.0","@types/get-pixels":"^3.3.2","@types/hull.js":"^1.0.2","@types/stats.js":"^0.17.0","@types/three":"^0.148.0","@typescript-eslint/eslint-plugin":"^5.47.0","@typescript-eslint/parser":"^5.47.0","buffer":"^5.5.0","concurrently":"^8.0.1","crypto-browserify":"^3.12.0","electron":"^24.1.2","eslint":"^8.30.0","eslint-config-prettier":"^8.5.0","eslint-import-resolver-typescript":"^3.5.2","eslint-plugin-import":"^2.26.0","eslint-plugin-unused-imports":"^2.0.0","events":"^3.1.0","husky":"^8.0.3","lint-staged":"^13.1.0","parcel":"^2.8.2","parcel-reporter-static-files-copy":"^1.4.0","parcel-resolver-ts-base-url":"^1.3.1","path-browserify":"^1.0.0","prettier":"2.8.1","process":"^0.11.10","punycode":"^1.4.1","querystring-es3":"^0.2.1","stream-browserify":"^3.0.0","typescript":"^4.9.4","wait-on":"^7.0.1"}}')})),s.register("brS1t",(function(t,e){var r=t.exports,i=s("g5rlv"),n=s("7xO1L"),a=s("jtggp");r.assert=n,r.toArray=a.toArray,r.zero2=a.zero2,r.toHex=a.toHex,r.encode=a.encode,r.getNAF=function(t,e,r){var i=new Array(Math.max(t.bitLength(),r)+1);i.fill(0);for(var n=1<<e+1,s=t.clone(),a=0;a<i.length;a++){var o,h=s.andln(n-1);s.isOdd()?(o=h>(n>>1)-1?(n>>1)-h:h,s.isubn(o)):o=0,i[a]=o,s.iushrn(1)}return i},r.getJSF=function(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var i,n=0,s=0;t.cmpn(-n)>0||e.cmpn(-s)>0;){var a,o,h=t.andln(3)+n&3,u=e.andln(3)+s&3;3===h&&(h=-1),3===u&&(u=-1),a=0==(1&h)?0:3!==(i=t.andln(7)+n&7)&&5!==i||2!==u?h:-h,r[0].push(a),o=0==(1&u)?0:3!==(i=e.andln(7)+s&7)&&5!==i||2!==h?u:-u,r[1].push(o),2*n===a+1&&(n=1-n),2*s===o+1&&(s=1-s),t.iushrn(1),e.iushrn(1)}return r},r.cachedProperty=function(t,e,r){var i="_"+e;t.prototype[e]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},r.parseBytes=function(t){return"string"==typeof t?r.toArray(t,"hex"):t},r.intFromLE=function(t){return new i(t,"hex","le")}})),s.register("jtggp",(function(t,e){var r=t.exports;function i(t){return 1===t.length?"0"+t:t}function n(t){for(var e="",r=0;r<t.length;r++)e+=i(t[r].toString(16));return e}r.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if("string"!=typeof t){for(var i=0;i<t.length;i++)r[i]=0|t[i];return r}if("hex"===e){(t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t);for(i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(i=0;i<t.length;i++){var n=t.charCodeAt(i),s=n>>8,a=255&n;s?r.push(s,a):r.push(a)}return r},r.zero2=i,r.toHex=n,r.encode=function(t,e){return"hex"===e?n(t):t}})),s.register("jSUNI",(function(t,e){var r=t.exports;r.base=s("gQuxP"),r.short=s("hSKW7"),r.mont=s("ilOO6"),r.edwards=s("a92lJ")})),s.register("gQuxP",(function(t,e){var r=s("g5rlv"),i=s("brS1t"),n=i.getNAF,a=i.getJSF,o=i.assert;function h(t,e){this.type=t,this.p=new r(e.p,16),this.red=e.prime?r.red(e.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=e.n&&new r(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(t,e){this.curve=t,this.type=e,this.precomputed=null}t.exports=h,h.prototype.point=function(){throw new Error("Not implemented")},h.prototype.validate=function(){throw new Error("Not implemented")},h.prototype._fixedNafMul=function(t,e){o(t.precomputed);var r=t._getDoubles(),i=n(e,1,this._bitLength),s=(1<<r.step+1)-(r.step%2==0?2:1);s/=3;var a,h,u=[];for(a=0;a<i.length;a+=r.step){h=0;for(var l=a+r.step-1;l>=a;l--)h=(h<<1)+i[l];u.push(h)}for(var c=this.jpoint(null,null,null),f=this.jpoint(null,null,null),d=s;d>0;d--){for(a=0;a<u.length;a++)(h=u[a])===d?f=f.mixedAdd(r.points[a]):h===-d&&(f=f.mixedAdd(r.points[a].neg()));c=c.add(f)}return c.toP()},h.prototype._wnafMul=function(t,e){var r=4,i=t._getNAFPoints(r);r=i.wnd;for(var s=i.points,a=n(e,r,this._bitLength),h=this.jpoint(null,null,null),u=a.length-1;u>=0;u--){for(var l=0;u>=0&&0===a[u];u--)l++;if(u>=0&&l++,h=h.dblp(l),u<0)break;var c=a[u];o(0!==c),h="affine"===t.type?c>0?h.mixedAdd(s[c-1>>1]):h.mixedAdd(s[-c-1>>1].neg()):c>0?h.add(s[c-1>>1]):h.add(s[-c-1>>1].neg())}return"affine"===t.type?h.toP():h},h.prototype._wnafMulAdd=function(t,e,r,i,s){var o,h,u,l=this._wnafT1,c=this._wnafT2,f=this._wnafT3,d=0;for(o=0;o<i;o++){var p=(u=e[o])._getNAFPoints(t);l[o]=p.wnd,c[o]=p.points}for(o=i-1;o>=1;o-=2){var m=o-1,g=o;if(1===l[m]&&1===l[g]){var v=[e[m],null,null,e[g]];0===e[m].y.cmp(e[g].y)?(v[1]=e[m].add(e[g]),v[2]=e[m].toJ().mixedAdd(e[g].neg())):0===e[m].y.cmp(e[g].y.redNeg())?(v[1]=e[m].toJ().mixedAdd(e[g]),v[2]=e[m].add(e[g].neg())):(v[1]=e[m].toJ().mixedAdd(e[g]),v[2]=e[m].toJ().mixedAdd(e[g].neg()));var _=[-3,-1,-5,-7,0,7,5,1,3],b=a(r[m],r[g]);for(d=Math.max(b[0].length,d),f[m]=new Array(d),f[g]=new Array(d),h=0;h<d;h++){var y=0|b[0][h],x=0|b[1][h];f[m][h]=_[3*(y+1)+(x+1)],f[g][h]=0,c[m]=v}}else f[m]=n(r[m],l[m],this._bitLength),f[g]=n(r[g],l[g],this._bitLength),d=Math.max(f[m].length,d),d=Math.max(f[g].length,d)}var w=this.jpoint(null,null,null),E=this._wnafT4;for(o=d;o>=0;o--){for(var M=0;o>=0;){var S=!0;for(h=0;h<i;h++)E[h]=0|f[h][o],0!==E[h]&&(S=!1);if(!S)break;M++,o--}if(o>=0&&M++,w=w.dblp(M),o<0)break;for(h=0;h<i;h++){var A=E[h];0!==A&&(A>0?u=c[h][A-1>>1]:A<0&&(u=c[h][-A-1>>1].neg()),w="affine"===u.type?w.mixedAdd(u):w.add(u))}}for(o=0;o<i;o++)c[o]=null;return s?w:w.toP()},h.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},h.prototype.decodePoint=function(t,e){t=i.toArray(t,e);var r=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*r)return 6===t[0]?o(t[t.length-1]%2==0):7===t[0]&&o(t[t.length-1]%2==1),this.point(t.slice(1,1+r),t.slice(1+r,1+2*r));if((2===t[0]||3===t[0])&&t.length-1===r)return this.pointFromX(t.slice(1,1+r),3===t[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(t){return this.encode(t,!0)},u.prototype._encode=function(t){var e=this.curve.p.byteLength(),r=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",e))},u.prototype.encode=function(t,e){return i.encode(this._encode(e),t)},u.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},u.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},u.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,n=0;n<e;n+=t){for(var s=0;s<t;s++)i=i.dbl();r.push(i)}return{step:t,points:r}},u.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],r=(1<<t)-1,i=1===r?null:this.dbl(),n=1;n<r;n++)e[n]=e[n-1].add(i);return{wnd:t,points:e}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(t){for(var e=this,r=0;r<t;r++)e=e.dbl();return e}})),s.register("hSKW7",(function(t,e){var r=s("brS1t"),i=s("g5rlv"),n=s("6cuMU"),a=s("gQuxP"),o=r.assert;function h(t){a.call(this,"short",t),this.a=new i(t.a,16).toRed(this.red),this.b=new i(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(t,e,r,n){a.BasePoint.call(this,t,"affine"),null===e&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(e,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function l(t,e,r,n){a.BasePoint.call(this,t,"jacobian"),null===e&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(e,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}n(h,a),t.exports=h,h.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,r;if(t.beta)e=new i(t.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);e=(e=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(t.lambda)r=new i(t.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(e))?r=s[0]:(r=s[1],o(0===this.g.mul(r).x.cmp(this.g.x.redMul(e))))}return{beta:e,lambda:r,basis:t.basis?t.basis.map((function(t){return{a:new i(t.a,16),b:new i(t.b,16)}})):this._getEndoBasis(r)}}},h.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:i.mont(t),r=new i(2).toRed(e).redInvm(),n=r.redNeg(),s=new i(3).toRed(e).redNeg().redSqrt().redMul(r);return[n.redAdd(s).fromRed(),n.redSub(s).fromRed()]},h.prototype._getEndoBasis=function(t){for(var e,r,n,s,a,o,h,u,l,c=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=t,d=this.n.clone(),p=new i(1),m=new i(0),g=new i(0),v=new i(1),_=0;0!==f.cmpn(0);){var b=d.div(f);u=d.sub(b.mul(f)),l=g.sub(b.mul(p));var y=v.sub(b.mul(m));if(!n&&u.cmp(c)<0)e=h.neg(),r=p,n=u.neg(),s=l;else if(n&&2==++_)break;h=u,d=f,f=u,g=p,p=l,v=m,m=y}a=u.neg(),o=l;var x=n.sqr().add(s.sqr());return a.sqr().add(o.sqr()).cmp(x)>=0&&(a=e,o=r),n.negative&&(n=n.neg(),s=s.neg()),a.negative&&(a=a.neg(),o=o.neg()),[{a:n,b:s},{a:a,b:o}]},h.prototype._endoSplit=function(t){var e=this.endo.basis,r=e[0],i=e[1],n=i.b.mul(t).divRound(this.n),s=r.b.neg().mul(t).divRound(this.n),a=n.mul(r.a),o=s.mul(i.a),h=n.mul(r.b),u=s.mul(i.b);return{k1:t.sub(a).sub(o),k2:h.add(u).neg()}},h.prototype.pointFromX=function(t,e){(t=new i(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var s=n.fromRed().isOdd();return(e&&!s||!e&&s)&&(n=n.redNeg()),this.point(t,n)},h.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,r=t.y,i=this.a.redMul(e),n=e.redSqr().redMul(e).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(n).cmpn(0)},h.prototype._endoWnafMulAdd=function(t,e,r){for(var i=this._endoWnafT1,n=this._endoWnafT2,s=0;s<t.length;s++){var a=this._endoSplit(e[s]),o=t[s],h=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),h=h.neg(!0)),i[2*s]=o,i[2*s+1]=h,n[2*s]=a.k1,n[2*s+1]=a.k2}for(var u=this._wnafMulAdd(1,i,n,2*s,r),l=0;l<2*s;l++)i[l]=null,n[l]=null;return u},n(u,a.BasePoint),h.prototype.point=function(t,e,r){return new u(this,t,e,r)},h.prototype.pointFromJSON=function(t,e){return u.fromJSON(this,t,e)},u.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var r=this.curve,i=function(t){return r.point(t.x.redMul(r.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return e}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(t,e,r){"string"==typeof e&&(e=JSON.parse(e));var i=t.point(e[0],e[1],r);if(!e[2])return i;function n(e){return t.point(e[0],e[1],r)}var s=e[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(n))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(n))}},i},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var r=e.redSqr().redISub(this.x).redISub(t.x),i=e.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},u.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,r=this.x.redSqr(),i=t.redInvm(),n=r.redAdd(r).redIAdd(r).redIAdd(e).redMul(i),s=n.redSqr().redISub(this.x.redAdd(this.x)),a=n.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,a)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(t){return t=new i(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},u.prototype.mulAdd=function(t,e,r){var i=[this,e],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n):this.curve._wnafMulAdd(1,i,n,2)},u.prototype.jmulAdd=function(t,e,r){var i=[this,e],n=[t,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n,!0):this.curve._wnafMulAdd(1,i,n,2,!0)},u.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},u.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var r=this.precomputed,i=function(t){return t.neg()};e.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return e},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},n(l,a.BasePoint),h.prototype.jpoint=function(t,e,r){return new l(this,t,e,r)},l.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),r=this.x.redMul(e),i=this.y.redMul(e).redMul(t);return this.curve.point(r,i)},l.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},l.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(e),n=t.x.redMul(r),s=this.y.redMul(e.redMul(t.z)),a=t.y.redMul(r.redMul(this.z)),o=i.redSub(n),h=s.redSub(a);if(0===o.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=o.redSqr(),l=u.redMul(o),c=i.redMul(u),f=h.redSqr().redIAdd(l).redISub(c).redISub(c),d=h.redMul(c.redISub(f)).redISub(s.redMul(l)),p=this.z.redMul(t.z).redMul(o);return this.curve.jpoint(f,d,p)},l.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),r=this.x,i=t.x.redMul(e),n=this.y,s=t.y.redMul(e).redMul(this.z),a=r.redSub(i),o=n.redSub(s);if(0===a.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=a.redSqr(),u=h.redMul(a),l=r.redMul(h),c=o.redSqr().redIAdd(u).redISub(l).redISub(l),f=o.redMul(l.redISub(c)).redISub(n.redMul(u)),d=this.z.redMul(a);return this.curve.jpoint(c,f,d)},l.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var e;if(this.curve.zeroA||this.curve.threeA){var r=this;for(e=0;e<t;e++)r=r.dbl();return r}var i=this.curve.a,n=this.curve.tinv,s=this.x,a=this.y,o=this.z,h=o.redSqr().redSqr(),u=a.redAdd(a);for(e=0;e<t;e++){var l=s.redSqr(),c=u.redSqr(),f=c.redSqr(),d=l.redAdd(l).redIAdd(l).redIAdd(i.redMul(h)),p=s.redMul(c),m=d.redSqr().redISub(p.redAdd(p)),g=p.redISub(m),v=d.redMul(g);v=v.redIAdd(v).redISub(f);var _=u.redMul(o);e+1<t&&(h=h.redMul(f)),s=m,o=_,u=v}return this.curve.jpoint(s,u.redMul(n),o)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},l.prototype._zeroDbl=function(){var t,e,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),a=this.x.redAdd(n).redSqr().redISub(i).redISub(s);a=a.redIAdd(a);var o=i.redAdd(i).redIAdd(i),h=o.redSqr().redISub(a).redISub(a),u=s.redIAdd(s);u=(u=u.redIAdd(u)).redIAdd(u),t=h,e=o.redMul(a.redISub(h)).redISub(u),r=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),c=this.y.redSqr(),f=c.redSqr(),d=this.x.redAdd(c).redSqr().redISub(l).redISub(f);d=d.redIAdd(d);var p=l.redAdd(l).redIAdd(l),m=p.redSqr(),g=f.redIAdd(f);g=(g=g.redIAdd(g)).redIAdd(g),t=m.redISub(d).redISub(d),e=p.redMul(d.redISub(t)).redISub(g),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(t,e,r)},l.prototype._threeDbl=function(){var t,e,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),s=n.redSqr(),a=this.x.redAdd(n).redSqr().redISub(i).redISub(s);a=a.redIAdd(a);var o=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),h=o.redSqr().redISub(a).redISub(a);t=h;var u=s.redIAdd(s);u=(u=u.redIAdd(u)).redIAdd(u),e=o.redMul(a.redISub(h)).redISub(u),r=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),c=this.y.redSqr(),f=this.x.redMul(c),d=this.x.redSub(l).redMul(this.x.redAdd(l));d=d.redAdd(d).redIAdd(d);var p=f.redIAdd(f),m=(p=p.redIAdd(p)).redAdd(p);t=d.redSqr().redISub(m),r=this.y.redAdd(this.z).redSqr().redISub(c).redISub(l);var g=c.redSqr();g=(g=(g=g.redIAdd(g)).redIAdd(g)).redIAdd(g),e=d.redMul(p.redISub(t)).redISub(g)}return this.curve.jpoint(t,e,r)},l.prototype._dbl=function(){var t=this.curve.a,e=this.x,r=this.y,i=this.z,n=i.redSqr().redSqr(),s=e.redSqr(),a=r.redSqr(),o=s.redAdd(s).redIAdd(s).redIAdd(t.redMul(n)),h=e.redAdd(e),u=(h=h.redIAdd(h)).redMul(a),l=o.redSqr().redISub(u.redAdd(u)),c=u.redISub(l),f=a.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=o.redMul(c).redISub(f),p=r.redAdd(r).redMul(i);return this.curve.jpoint(l,d,p)},l.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr(),i=e.redSqr(),n=t.redAdd(t).redIAdd(t),s=n.redSqr(),a=this.x.redAdd(e).redSqr().redISub(t).redISub(i),o=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(s)).redSqr(),h=i.redIAdd(i);h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var u=n.redIAdd(a).redSqr().redISub(s).redISub(o).redISub(h),l=e.redMul(u);l=(l=l.redIAdd(l)).redIAdd(l);var c=this.x.redMul(o).redISub(l);c=(c=c.redIAdd(c)).redIAdd(c);var f=this.y.redMul(u.redMul(h.redISub(u)).redISub(a.redMul(o)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=this.z.redAdd(a).redSqr().redISub(r).redISub(o);return this.curve.jpoint(c,f,d)},l.prototype.mul=function(t,e){return t=new i(t,e),this.curve._wnafMul(this,t)},l.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),r=t.z.redSqr();if(0!==this.x.redMul(r).redISub(t.x.redMul(e)).cmpn(0))return!1;var i=e.redMul(this.z),n=r.redMul(t.z);return 0===this.y.redMul(n).redISub(t.y.redMul(i)).cmpn(0)},l.prototype.eqXToP=function(t){var e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(r))return!0;for(var i=t.clone(),n=this.curve.redN.redMul(e);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),0===this.x.cmp(r))return!0}},l.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}})),s.register("ilOO6",(function(t,e){var r=s("g5rlv"),i=s("6cuMU"),n=s("gQuxP"),a=s("brS1t");function o(t){n.call(this,"mont",t),this.a=new r(t.a,16).toRed(this.red),this.b=new r(t.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function h(t,e,i){n.BasePoint.call(this,t,"projective"),null===e&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(e,16),this.z=new r(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(o,n),t.exports=o,o.prototype.validate=function(t){var e=t.normalize().x,r=e.redSqr(),i=r.redMul(e).redAdd(r.redMul(this.a)).redAdd(e);return 0===i.redSqrt().redSqr().cmp(i)},i(h,n.BasePoint),o.prototype.decodePoint=function(t,e){return this.point(a.toArray(t,e),1)},o.prototype.point=function(t,e){return new h(this,t,e)},o.prototype.pointFromJSON=function(t){return h.fromJSON(this,t)},h.prototype.precompute=function(){},h.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},h.fromJSON=function(t,e){return new h(t,e[0],e[1]||t.one)},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},h.prototype.dbl=function(){var t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),r=t.redSub(e),i=t.redMul(e),n=r.redMul(e.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,n)},h.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.diffAdd=function(t,e){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),n=t.x.redAdd(t.z),s=t.x.redSub(t.z).redMul(r),a=n.redMul(i),o=e.z.redMul(s.redAdd(a).redSqr()),h=e.x.redMul(s.redISub(a).redSqr());return this.curve.point(o,h)},h.prototype.mul=function(t){for(var e=t.clone(),r=this,i=this.curve.point(null,null),n=[];0!==e.cmpn(0);e.iushrn(1))n.push(e.andln(1));for(var s=n.length-1;s>=0;s--)0===n[s]?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},h.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},h.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},h.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()}})),s.register("a92lJ",(function(t,e){var r=s("brS1t"),i=s("g5rlv"),n=s("6cuMU"),a=s("gQuxP"),o=r.assert;function h(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,a.call(this,"edwards",t),this.a=new i(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function u(t,e,r,n,s){a.BasePoint.call(this,t,"projective"),null===e&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(e,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=s&&new i(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}n(h,a),t.exports=h,h.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},h.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},h.prototype.jpoint=function(t,e,r,i){return this.point(t,e,r,i)},h.prototype.pointFromX=function(t,e){(t=new i(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr(),n=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),a=n.redMul(s.redInvm()),o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var h=o.fromRed().isOdd();return(e&&!h||!e&&h)&&(o=o.redNeg()),this.point(t,o)},h.prototype.pointFromY=function(t,e){(t=new i(t,16)).red||(t=t.toRed(this.red));var r=t.redSqr(),n=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),a=n.redMul(s.redInvm());if(0===a.cmp(this.zero)){if(e)throw new Error("invalid point");return this.point(this.zero,t)}var o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return o.fromRed().isOdd()!==e&&(o=o.redNeg()),this.point(o,t)},h.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var e=t.x.redSqr(),r=t.y.redSqr(),i=e.redMul(this.a).redAdd(r),n=this.c2.redMul(this.one.redAdd(this.d.redMul(e).redMul(r)));return 0===i.cmp(n)},n(u,a.BasePoint),h.prototype.pointFromJSON=function(t){return u.fromJSON(this,t)},h.prototype.point=function(t,e,r,i){return new u(this,t,e,r,i)},u.fromJSON=function(t,e){return new u(t,e[0],e[1],e[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},u.prototype._extDbl=function(){var t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(t),n=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),s=i.redAdd(e),a=s.redSub(r),o=i.redSub(e),h=n.redMul(a),u=s.redMul(o),l=n.redMul(o),c=a.redMul(s);return this.curve.point(h,u,c,l)},u.prototype._projDbl=function(){var t,e,r,i,n,s,a=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),h=this.y.redSqr();if(this.curve.twisted){var u=(i=this.curve._mulA(o)).redAdd(h);this.zOne?(t=a.redSub(o).redSub(h).redMul(u.redSub(this.curve.two)),e=u.redMul(i.redSub(h)),r=u.redSqr().redSub(u).redSub(u)):(n=this.z.redSqr(),s=u.redSub(n).redISub(n),t=a.redSub(o).redISub(h).redMul(s),e=u.redMul(i.redSub(h)),r=u.redMul(s))}else i=o.redAdd(h),n=this.curve._mulC(this.z).redSqr(),s=i.redSub(n).redSub(n),t=this.curve._mulC(a.redISub(i)).redMul(s),e=this.curve._mulC(i).redMul(o.redISub(h)),r=i.redMul(s);return this.curve.point(t,e,r)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(t){var e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),r=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),n=this.z.redMul(t.z.redAdd(t.z)),s=r.redSub(e),a=n.redSub(i),o=n.redAdd(i),h=r.redAdd(e),u=s.redMul(a),l=o.redMul(h),c=s.redMul(h),f=a.redMul(o);return this.curve.point(u,l,f,c)},u.prototype._projAdd=function(t){var e,r,i=this.z.redMul(t.z),n=i.redSqr(),s=this.x.redMul(t.x),a=this.y.redMul(t.y),o=this.curve.d.redMul(s).redMul(a),h=n.redSub(o),u=n.redAdd(o),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(s).redISub(a),c=i.redMul(h).redMul(l);return this.curve.twisted?(e=i.redMul(u).redMul(a.redSub(this.curve._mulA(s))),r=h.redMul(u)):(e=i.redMul(u).redMul(a.redSub(s)),r=this.curve._mulC(h).redMul(u)),this.curve.point(c,e,r)},u.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},u.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},u.prototype.mulAdd=function(t,e,r){return this.curve._wnafMulAdd(1,[this,e],[t,r],2,!1)},u.prototype.jmulAdd=function(t,e,r){return this.curve._wnafMulAdd(1,[this,e],[t,r],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},u.prototype.eqXToP=function(t){var e=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(e))return!0;for(var r=t.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(i),0===this.x.cmp(e))return!0}},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add})),s.register("3sWIt",(function(t,e){var r,i=t.exports,n=s("fSvQP"),a=s("jSUNI"),o=s("brS1t").assert;function h(t){"short"===t.type?this.curve=new a.short(t):"edwards"===t.type?this.curve=new a.edwards(t):this.curve=new a.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(t,e){Object.defineProperty(i,t,{configurable:!0,enumerable:!0,get:function(){var r=new h(e);return Object.defineProperty(i,t,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=h,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=s("iG5mh")}catch(t){r=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})})),s.register("fSvQP",(function(t,e){var r=t.exports;r.utils=s("332F3"),r.common=s("gWB3G"),r.sha=s("hQRHq"),r.ripemd=s("iFNMe"),r.hmac=s("eg6uK"),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160})),s.register("332F3",(function(t,r){var i,n,a,o,h,u,l,c,f,d,p,m,g,v,_,b,y,x,w,E,M,S,A,T,C,D;e(t.exports,"inherits",(()=>i),(t=>i=t)),e(t.exports,"toArray",(()=>n),(t=>n=t)),e(t.exports,"toHex",(()=>a),(t=>a=t)),e(t.exports,"htonl",(()=>o),(t=>o=t)),e(t.exports,"toHex32",(()=>h),(t=>h=t)),e(t.exports,"zero2",(()=>u),(t=>u=t)),e(t.exports,"zero8",(()=>l),(t=>l=t)),e(t.exports,"join32",(()=>c),(t=>c=t)),e(t.exports,"split32",(()=>f),(t=>f=t)),e(t.exports,"rotr32",(()=>d),(t=>d=t)),e(t.exports,"rotl32",(()=>p),(t=>p=t)),e(t.exports,"sum32",(()=>m),(t=>m=t)),e(t.exports,"sum32_3",(()=>g),(t=>g=t)),e(t.exports,"sum32_4",(()=>v),(t=>v=t)),e(t.exports,"sum32_5",(()=>_),(t=>_=t)),e(t.exports,"sum64",(()=>b),(t=>b=t)),e(t.exports,"sum64_hi",(()=>y),(t=>y=t)),e(t.exports,"sum64_lo",(()=>x),(t=>x=t)),e(t.exports,"sum64_4_hi",(()=>w),(t=>w=t)),e(t.exports,"sum64_4_lo",(()=>E),(t=>E=t)),e(t.exports,"sum64_5_hi",(()=>M),(t=>M=t)),e(t.exports,"sum64_5_lo",(()=>S),(t=>S=t)),e(t.exports,"rotr64_hi",(()=>A),(t=>A=t)),e(t.exports,"rotr64_lo",(()=>T),(t=>T=t)),e(t.exports,"shr64_hi",(()=>C),(t=>C=t)),e(t.exports,"shr64_lo",(()=>D),(t=>D=t));var R=s("7xO1L"),I=s("6cuMU");function P(t,e){return 55296==(64512&t.charCodeAt(e))&&(!(e<0||e+1>=t.length)&&56320==(64512&t.charCodeAt(e+1)))}function N(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function k(t){return 1===t.length?"0"+t:t}function B(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}i=I,n=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=63&s|128):P(t,n)?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++n)),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=63&s|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=63&s|128)}else for(n=0;n<t.length;n++)r[n]=0|t[n];return r},a=function(t){for(var e="",r=0;r<t.length;r++)e+=k(t[r].toString(16));return e},o=N,h=function(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];"little"===e&&(n=N(n)),r+=B(n.toString(16))}return r},u=k,l=B,c=function(t,e,r,i){var n=r-e;R(n%4==0);for(var s=new Array(n/4),a=0,o=e;a<s.length;a++,o+=4){var h;h="big"===i?t[o]<<24|t[o+1]<<16|t[o+2]<<8|t[o+3]:t[o+3]<<24|t[o+2]<<16|t[o+1]<<8|t[o],s[a]=h>>>0}return s},f=function(t,e){for(var r=new Array(4*t.length),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];"big"===e?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=255&s):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=255&s)}return r},d=function(t,e){return t>>>e|t<<32-e},p=function(t,e){return t<<e|t>>>32-e},m=function(t,e){return t+e>>>0},g=function(t,e,r){return t+e+r>>>0},v=function(t,e,r,i){return t+e+r+i>>>0},_=function(t,e,r,i,n){return t+e+r+i+n>>>0},b=function(t,e,r,i){var n=t[e],s=i+t[e+1]>>>0,a=(s<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=s},y=function(t,e,r,i){return(e+i>>>0<e?1:0)+t+r>>>0},x=function(t,e,r,i){return e+i>>>0},w=function(t,e,r,i,n,s,a,o){var h=0,u=e;return h+=(u=u+i>>>0)<e?1:0,h+=(u=u+s>>>0)<s?1:0,t+r+n+a+(h+=(u=u+o>>>0)<o?1:0)>>>0},E=function(t,e,r,i,n,s,a,o){return e+i+s+o>>>0},M=function(t,e,r,i,n,s,a,o,h,u){var l=0,c=e;return l+=(c=c+i>>>0)<e?1:0,l+=(c=c+s>>>0)<s?1:0,l+=(c=c+o>>>0)<o?1:0,t+r+n+a+h+(l+=(c=c+u>>>0)<u?1:0)>>>0},S=function(t,e,r,i,n,s,a,o,h,u){return e+i+s+o+u>>>0},A=function(t,e,r){return(e<<32-r|t>>>r)>>>0},T=function(t,e,r){return(t<<32-r|e>>>r)>>>0},C=function(t,e,r){return t>>>r},D=function(t,e,r){return(t<<32-r|e>>>r)>>>0}})),s.register("gWB3G",(function(t,r){var i;e(t.exports,"BlockHash",(()=>i),(t=>i=t));var n=s("332F3"),a=s("7xO1L");function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i=o,o.prototype.update=function(t,e){if(t=n.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var r=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-r,t.length),0===this.pending.length&&(this.pending=null),t=n.join32(t,0,t.length-r,this.endian);for(var i=0;i<t.length;i+=this._delta32)this._update(t,i,i+this._delta32)}return this},o.prototype.digest=function(t){return this.update(this._pad()),a(null===this.pending),this._digest(t)},o.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,r=e-(t+this.padLength)%e,i=new Array(r+this.padLength);i[0]=128;for(var n=1;n<r;n++)i[n]=0;if(t<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)i[n++]=0;i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=t>>>24&255,i[n++]=t>>>16&255,i[n++]=t>>>8&255,i[n++]=255&t}else for(i[n++]=255&t,i[n++]=t>>>8&255,i[n++]=t>>>16&255,i[n++]=t>>>24&255,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,s=8;s<this.padLength;s++)i[n++]=0;return i}})),s.register("hQRHq",(function(t,r){var i,n,a,o,h;e(t.exports,"sha1",(()=>i),(t=>i=t)),e(t.exports,"sha224",(()=>n),(t=>n=t)),e(t.exports,"sha256",(()=>a),(t=>a=t)),e(t.exports,"sha384",(()=>o),(t=>o=t)),e(t.exports,"sha512",(()=>h),(t=>h=t)),i=s("eBOUY"),n=s("9Jq2d"),a=s("gMHmU"),o=s("kKCiD"),h=s("96rhG")})),s.register("eBOUY",(function(t,e){var r=s("332F3"),i=s("gWB3G"),n=s("gQHsq"),a=r.rotl32,o=r.sum32,h=r.sum32_5,u=n.ft_1,l=i.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function f(){if(!(this instanceof f))return new f;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(f,l),t.exports=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(t,e){for(var r=this.W,i=0;i<16;i++)r[i]=t[e+i];for(;i<r.length;i++)r[i]=a(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var n=this.h[0],s=this.h[1],l=this.h[2],f=this.h[3],d=this.h[4];for(i=0;i<r.length;i++){var p=~~(i/20),m=h(a(n,5),u(p,s,l,f),d,r[i],c[p]);d=f,f=l,l=a(s,30),s=n,n=m}this.h[0]=o(this.h[0],n),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],l),this.h[3]=o(this.h[3],f),this.h[4]=o(this.h[4],d)},f.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}})),s.register("gQHsq",(function(t,r){var i,n,a,o,h,u,l;e(t.exports,"ft_1",(()=>i),(t=>i=t)),e(t.exports,"ch32",(()=>n),(t=>n=t)),e(t.exports,"maj32",(()=>a),(t=>a=t)),e(t.exports,"s0_256",(()=>o),(t=>o=t)),e(t.exports,"s1_256",(()=>h),(t=>h=t)),e(t.exports,"g0_256",(()=>u),(t=>u=t)),e(t.exports,"g1_256",(()=>l),(t=>l=t));var c=s("332F3").rotr32;function f(t,e,r){return t&e^~t&r}function d(t,e,r){return t&e^t&r^e&r}function p(t,e,r){return t^e^r}i=function(t,e,r,i){return 0===t?f(e,r,i):1===t||3===t?p(e,r,i):2===t?d(e,r,i):void 0},n=f,a=d,o=function(t){return c(t,2)^c(t,13)^c(t,22)},h=function(t){return c(t,6)^c(t,11)^c(t,25)},u=function(t){return c(t,7)^c(t,18)^t>>>3},l=function(t){return c(t,17)^c(t,19)^t>>>10}})),s.register("9Jq2d",(function(t,e){var r=s("332F3"),i=s("gMHmU");function n(){if(!(this instanceof n))return new n;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(n,i),t.exports=n,n.blockSize=512,n.outSize=224,n.hmacStrength=192,n.padLength=64,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}})),s.register("gMHmU",(function(t,e){var r=s("332F3"),i=s("gWB3G"),n=s("gQHsq"),a=s("7xO1L"),o=r.sum32,h=r.sum32_4,u=r.sum32_5,l=n.ch32,c=n.maj32,f=n.s0_256,d=n.s1_256,p=n.g0_256,m=n.g1_256,g=i.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _(){if(!(this instanceof _))return new _;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}r.inherits(_,g),t.exports=_,_.blockSize=512,_.outSize=256,_.hmacStrength=192,_.padLength=64,_.prototype._update=function(t,e){for(var r=this.W,i=0;i<16;i++)r[i]=t[e+i];for(;i<r.length;i++)r[i]=h(m(r[i-2]),r[i-7],p(r[i-15]),r[i-16]);var n=this.h[0],s=this.h[1],g=this.h[2],v=this.h[3],_=this.h[4],b=this.h[5],y=this.h[6],x=this.h[7];for(a(this.k.length===r.length),i=0;i<r.length;i++){var w=u(x,d(_),l(_,b,y),this.k[i],r[i]),E=o(f(n),c(n,s,g));x=y,y=b,b=_,_=o(v,w),v=g,g=s,s=n,n=o(w,E)}this.h[0]=o(this.h[0],n),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],g),this.h[3]=o(this.h[3],v),this.h[4]=o(this.h[4],_),this.h[5]=o(this.h[5],b),this.h[6]=o(this.h[6],y),this.h[7]=o(this.h[7],x)},_.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}})),s.register("kKCiD",(function(t,e){var r=s("332F3"),i=s("96rhG");function n(){if(!(this instanceof n))return new n;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(n,i),t.exports=n,n.blockSize=1024,n.outSize=384,n.hmacStrength=192,n.padLength=128,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}})),s.register("96rhG",(function(t,e){var r=s("332F3"),i=s("gWB3G"),n=s("7xO1L"),a=r.rotr64_hi,o=r.rotr64_lo,h=r.shr64_hi,u=r.shr64_lo,l=r.sum64,c=r.sum64_hi,f=r.sum64_lo,d=r.sum64_4_hi,p=r.sum64_4_lo,m=r.sum64_5_hi,g=r.sum64_5_lo,v=i.BlockHash,_=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=_,this.W=new Array(160)}function y(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function x(t,e,r,i,n,s){var a=e&i^~e&s;return a<0&&(a+=4294967296),a}function w(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function E(t,e,r,i,n,s){var a=e&i^e&s^i&s;return a<0&&(a+=4294967296),a}function M(t,e){var r=a(t,e,28)^a(e,t,2)^a(e,t,7);return r<0&&(r+=4294967296),r}function S(t,e){var r=o(t,e,28)^o(e,t,2)^o(e,t,7);return r<0&&(r+=4294967296),r}function A(t,e){var r=a(t,e,14)^a(t,e,18)^a(e,t,9);return r<0&&(r+=4294967296),r}function T(t,e){var r=o(t,e,14)^o(t,e,18)^o(e,t,9);return r<0&&(r+=4294967296),r}function C(t,e){var r=a(t,e,1)^a(t,e,8)^h(t,e,7);return r<0&&(r+=4294967296),r}function D(t,e){var r=o(t,e,1)^o(t,e,8)^u(t,e,7);return r<0&&(r+=4294967296),r}function R(t,e){var r=a(t,e,19)^a(e,t,29)^h(t,e,6);return r<0&&(r+=4294967296),r}function I(t,e){var r=o(t,e,19)^o(e,t,29)^u(t,e,6);return r<0&&(r+=4294967296),r}r.inherits(b,v),t.exports=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(t,e){for(var r=this.W,i=0;i<32;i++)r[i]=t[e+i];for(;i<r.length;i+=2){var n=R(r[i-4],r[i-3]),s=I(r[i-4],r[i-3]),a=r[i-14],o=r[i-13],h=C(r[i-30],r[i-29]),u=D(r[i-30],r[i-29]),l=r[i-32],c=r[i-31];r[i]=d(n,s,a,o,h,u,l,c),r[i+1]=p(n,s,a,o,h,u,l,c)}},b.prototype._update=function(t,e){this._prepareBlock(t,e);var r=this.W,i=this.h[0],s=this.h[1],a=this.h[2],o=this.h[3],h=this.h[4],u=this.h[5],d=this.h[6],p=this.h[7],v=this.h[8],_=this.h[9],b=this.h[10],C=this.h[11],D=this.h[12],R=this.h[13],I=this.h[14],P=this.h[15];n(this.k.length===r.length);for(var N=0;N<r.length;N+=2){var k=I,B=P,L=A(v,_),O=T(v,_),F=y(v,_,b,C,D),U=x(v,_,b,C,D,R),z=this.k[N],G=this.k[N+1],H=r[N],j=r[N+1],V=m(k,B,L,O,F,U,z,G,H,j),W=g(k,B,L,O,F,U,z,G,H,j);k=M(i,s),B=S(i,s),L=w(i,s,a,o,h),O=E(i,s,a,o,h,u);var q=c(k,B,L,O),X=f(k,B,L,O);I=D,P=R,D=b,R=C,b=v,C=_,v=c(d,p,V,W),_=f(p,p,V,W),d=h,p=u,h=a,u=o,a=i,o=s,i=c(V,W,q,X),s=f(V,W,q,X)}l(this.h,0,i,s),l(this.h,2,a,o),l(this.h,4,h,u),l(this.h,6,d,p),l(this.h,8,v,_),l(this.h,10,b,C),l(this.h,12,D,R),l(this.h,14,I,P)},b.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}})),s.register("iFNMe",(function(t,r){var i;e(t.exports,"ripemd160",(()=>i),(t=>i=t));var n=s("332F3"),a=s("gWB3G"),o=n.rotl32,h=n.sum32,u=n.sum32_3,l=n.sum32_4,c=a.BlockHash;function f(){if(!(this instanceof f))return new f;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function d(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function p(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function m(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}n.inherits(f,c),i=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(t,e){for(var r=this.h[0],i=this.h[1],n=this.h[2],s=this.h[3],a=this.h[4],c=r,f=i,y=n,x=s,w=a,E=0;E<80;E++){var M=h(o(l(r,d(E,i,n,s),t[g[E]+e],p(E)),_[E]),a);r=a,a=s,s=o(n,10),n=i,i=M,M=h(o(l(c,d(79-E,f,y,x),t[v[E]+e],m(E)),b[E]),w),c=w,w=x,x=o(y,10),y=f,f=M}M=u(this.h[1],n,x),this.h[1]=u(this.h[2],s,w),this.h[2]=u(this.h[3],a,c),this.h[3]=u(this.h[4],r,f),this.h[4]=u(this.h[0],i,y),this.h[0]=M},f.prototype._digest=function(t){return"hex"===t?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],_=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]})),s.register("eg6uK",(function(t,e){var r=s("332F3"),i=s("7xO1L");function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(e,i))}t.exports=n,n.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),i(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},n.prototype.update=function(t,e){return this.inner.update(t,e),this},n.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}})),s.register("iG5mh",(function(t,e){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}})),s.register("clHeT",(function(t,e){var r=s("g5rlv"),i=s("6Ai7O"),n=s("brS1t"),a=s("3sWIt"),o=s("laKaL"),h=n.assert,u=s("dpPlI"),l=s("lUF90");function c(t){if(!(this instanceof c))return new c(t);"string"==typeof t&&(h(Object.prototype.hasOwnProperty.call(a,t),"Unknown curve "+t),t=a[t]),t instanceof a.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}t.exports=c,c.prototype.keyPair=function(t){return new u(this,t)},c.prototype.keyFromPrivate=function(t,e){return u.fromPrivate(this,t,e)},c.prototype.keyFromPublic=function(t,e){return u.fromPublic(this,t,e)},c.prototype.genKeyPair=function(t){t||(t={});for(var e=new i({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||o(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),s=this.n.sub(new r(2));;){var a=new r(e.generate(n));if(!(a.cmp(s)>0))return a.iaddn(1),this.keyFromPrivate(a)}},c.prototype._truncateToN=function(t,e){var r=8*t.byteLength()-this.n.bitLength();return r>0&&(t=t.ushrn(r)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},c.prototype.sign=function(t,e,n,s){"object"==typeof n&&(s=n,n=null),s||(s={}),e=this.keyFromPrivate(e,n),t=this._truncateToN(new r(t,16));for(var a=this.n.byteLength(),o=e.getPrivate().toArray("be",a),h=t.toArray("be",a),u=new i({hash:this.hash,entropy:o,nonce:h,pers:s.pers,persEnc:s.persEnc||"utf8"}),c=this.n.sub(new r(1)),f=0;;f++){var d=s.k?s.k(f):new r(u.generate(this.n.byteLength()));if(!((d=this._truncateToN(d,!0)).cmpn(1)<=0||d.cmp(c)>=0)){var p=this.g.mul(d);if(!p.isInfinity()){var m=p.getX(),g=m.umod(this.n);if(0!==g.cmpn(0)){var v=d.invm(this.n).mul(g.mul(e.getPrivate()).iadd(t));if(0!==(v=v.umod(this.n)).cmpn(0)){var _=(p.getY().isOdd()?1:0)|(0!==m.cmp(g)?2:0);return s.canonical&&v.cmp(this.nh)>0&&(v=this.n.sub(v),_^=1),new l({r:g,s:v,recoveryParam:_})}}}}}},c.prototype.verify=function(t,e,i,n){t=this._truncateToN(new r(t,16)),i=this.keyFromPublic(i,n);var s=(e=new l(e,"hex")).r,a=e.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o,h=a.invm(this.n),u=h.mul(t).umod(this.n),c=h.mul(s).umod(this.n);return this.curve._maxwellTrick?!(o=this.g.jmulAdd(u,i.getPublic(),c)).isInfinity()&&o.eqXToP(s):!(o=this.g.mulAdd(u,i.getPublic(),c)).isInfinity()&&0===o.getX().umod(this.n).cmp(s)},c.prototype.recoverPubKey=function(t,e,i,n){h((3&i)===i,"The recovery param is more than two bits"),e=new l(e,n);var s=this.n,a=new r(t),o=e.r,u=e.s,c=1&i,f=i>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");o=f?this.curve.pointFromX(o.add(this.curve.n),c):this.curve.pointFromX(o,c);var d=e.r.invm(s),p=s.sub(a).mul(d).umod(s),m=u.mul(d).umod(s);return this.g.mulAdd(p,o,m)},c.prototype.getKeyRecoveryParam=function(t,e,r,i){if(null!==(e=new l(e,i)).recoveryParam)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch(t){continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")}})),s.register("6Ai7O",(function(t,e){var r=s("fSvQP"),i=s("jtggp"),n=s("7xO1L");function a(t){if(!(this instanceof a))return new a(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=i.toArray(t.entropy,t.entropyEnc||"hex"),r=i.toArray(t.nonce,t.nonceEnc||"hex"),s=i.toArray(t.pers,t.persEnc||"hex");n(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,s)}t.exports=a,a.prototype._init=function(t,e,r){var i=t.concat(e).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},a.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},a.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(t,e,r,s){"string"!=typeof e&&(s=r,r=e,e=null),t=i.toArray(t,e),r=i.toArray(r,s),n(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(r||[])),this._reseed=1},a.prototype.generate=function(t,e,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(n=r,r=e,e=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var s=[];s.length<t;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,t);return this._update(r),this._reseed++,i.encode(a,e)}})),s.register("dpPlI",(function(t,e){var r=s("g5rlv"),i=s("brS1t").assert;function n(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}t.exports=n,n.fromPublic=function(t,e,r){return e instanceof n?e:new n(t,{pub:e,pubEnc:r})},n.fromPrivate=function(t,e,r){return e instanceof n?e:new n(t,{priv:e,privEnc:r})},n.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},n.prototype.getPublic=function(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},n.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},n.prototype._importPrivate=function(t,e){this.priv=new r(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},n.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?i(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},n.prototype.derive=function(t){return t.validate()||i(t.validate(),"public point not validated"),t.mul(this.priv).getX()},n.prototype.sign=function(t,e,r){return this.ec.sign(t,this,e,r)},n.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},n.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}})),s.register("lUF90",(function(t,e){var r=s("g5rlv"),i=s("brS1t"),n=i.assert;function a(t,e){if(t instanceof a)return t;this._importDER(t,e)||(n(t.r&&t.s,"Signature without r or s"),this.r=new r(t.r,16),this.s=new r(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function o(){this.place=0}function h(t,e){var r=t[e.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4)return!1;for(var n=0,s=0,a=e.place;s<i;s++,a++)n<<=8,n|=t[a],n>>>=0;return!(n<=127)&&(e.place=a,n)}function u(t){for(var e=0,r=t.length-1;!t[e]&&!(128&t[e+1])&&e<r;)e++;return 0===e?t:t.slice(e)}function l(t,e){if(e<128)t.push(e);else{var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(128|r);--r;)t.push(e>>>(r<<3)&255);t.push(e)}}t.exports=a,a.prototype._importDER=function(t,e){t=i.toArray(t,e);var n=new o;if(48!==t[n.place++])return!1;var s=h(t,n);if(!1===s)return!1;if(s+n.place!==t.length)return!1;if(2!==t[n.place++])return!1;var a=h(t,n);if(!1===a)return!1;var u=t.slice(n.place,a+n.place);if(n.place+=a,2!==t[n.place++])return!1;var l=h(t,n);if(!1===l)return!1;if(t.length!==l+n.place)return!1;var c=t.slice(n.place,l+n.place);if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}return this.r=new r(u),this.s=new r(c),this.recoveryParam=null,!0},a.prototype.toDER=function(t){var e=this.r.toArray(),r=this.s.toArray();for(128&e[0]&&(e=[0].concat(e)),128&r[0]&&(r=[0].concat(r)),e=u(e),r=u(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];l(n,e.length),(n=n.concat(e)).push(2),l(n,r.length);var s=n.concat(r),a=[48];return l(a,s.length),a=a.concat(s),i.encode(a,t)}})),s.register("jVnqQ",(function(t,e){var r=s("fSvQP"),i=s("3sWIt"),n=s("brS1t"),a=n.assert,o=n.parseBytes,h=s("evNSJ"),u=s("9o1wZ");function l(t){if(a("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof l))return new l(t);t=i[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=r.sha512}t.exports=l,l.prototype.sign=function(t,e){t=o(t);var r=this.keyFromSecret(e),i=this.hashInt(r.messagePrefix(),t),n=this.g.mul(i),s=this.encodePoint(n),a=this.hashInt(s,r.pubBytes(),t).mul(r.priv()),h=i.add(a).umod(this.curve.n);return this.makeSignature({R:n,S:h,Rencoded:s})},l.prototype.verify=function(t,e,r){t=o(t),e=this.makeSignature(e);var i=this.keyFromPublic(r),n=this.hashInt(e.Rencoded(),i.pubBytes(),t),s=this.g.mul(e.S());return e.R().add(i.pub().mul(n)).eq(s)},l.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return n.intFromLE(t.digest()).umod(this.curve.n)},l.prototype.keyFromPublic=function(t){return h.fromPublic(this,t)},l.prototype.keyFromSecret=function(t){return h.fromSecret(this,t)},l.prototype.makeSignature=function(t){return t instanceof u?t:new u(this,t)},l.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},l.prototype.decodePoint=function(t){var e=(t=n.parseBytes(t)).length-1,r=t.slice(0,e).concat(-129&t[e]),i=0!=(128&t[e]),s=n.intFromLE(r);return this.curve.pointFromY(s,i)},l.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},l.prototype.decodeInt=function(t){return n.intFromLE(t)},l.prototype.isPoint=function(t){return t instanceof this.pointClass}})),s.register("evNSJ",(function(t,e){var r=s("brS1t"),i=r.assert,n=r.parseBytes,a=r.cachedProperty;function o(t,e){this.eddsa=t,this._secret=n(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=n(e.pub)}o.fromPublic=function(t,e){return e instanceof o?e:new o(t,{pub:e})},o.fromSecret=function(t,e){return e instanceof o?e:new o(t,{secret:e})},o.prototype.secret=function(){return this._secret},a(o,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),a(o,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),a(o,"privBytes",(function(){var t=this.eddsa,e=this.hash(),r=t.encodingLength-1,i=e.slice(0,t.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i})),a(o,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),a(o,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),a(o,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),o.prototype.sign=function(t){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)},o.prototype.verify=function(t,e){return this.eddsa.verify(t,e,this)},o.prototype.getSecret=function(t){return i(this._secret,"KeyPair is public only"),r.encode(this.secret(),t)},o.prototype.getPublic=function(t){return r.encode(this.pubBytes(),t)},t.exports=o})),s.register("9o1wZ",(function(t,e){var r=s("g5rlv"),i=s("brS1t"),n=i.assert,a=i.cachedProperty,o=i.parseBytes;function h(t,e){this.eddsa=t,"object"!=typeof e&&(e=o(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),n(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof r&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}a(h,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),a(h,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),a(h,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),a(h,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),h.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},h.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},t.exports=h})),s.register("hMqfZ",(function(t,e){!function(t,e){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function n(t,e,r){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var a;"object"==typeof t?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:s("4AFFV").Buffer}catch(t){}function o(t,e){var i=t.charCodeAt(e);return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:void r(!1,"Invalid character in "+t)}function h(t,e,r){var i=o(t,r);return r-1>=e&&(i|=o(t,r-1)<<4),i}function u(t,e,i,n){for(var s=0,a=0,o=Math.min(t.length,i),h=e;h<o;h++){var u=t.charCodeAt(h)-48;s*=n,a=u>=49?u-49+10:u>=17?u-17+10:u,r(u>=0&&a<n,"Invalid character"),s+=a}return s}function l(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,e){return t.cmp(e)>0?t:e},n.min=function(t,e){return t.cmp(e)<0?t:e},n.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),r(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,i):(this._parseBase(t,e,n),"le"===i&&this._initArray(this.toArray(),e,i)))},n.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},n.prototype._initArray=function(t,e,i){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,a,o=0;if("be"===i)for(n=t.length-1,s=0;n>=0;n-=3)a=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===i)for(n=0,s=0;n<t.length;n+=3)a=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this._strip()},n.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,s=0,a=0;if("be"===r)for(i=t.length-1;i>=e;i-=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;else for(i=(t.length-e)%2==0?e+1:e;i<t.length;i+=2)n=h(t,e,i)<<s,this.words[a]|=67108863&n,s>=18?(s-=18,a+=1,this.words[a]|=n>>>26):s+=8;this._strip()},n.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var i=0,n=1;n<=67108863;n*=e)i++;i--,n=n/e|0;for(var s=t.length-r,a=s%i,o=Math.min(s,s-a)+r,h=0,l=r;l<o;l+=i)h=u(t,l,l+i,e),this.imuln(n),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(0!==a){var c=1;for(h=u(t,l,t.length,e),l=0;l<a;l++)c*=e;this.imuln(c),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this._strip()},n.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype._move=function(t){l(t,this)},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{n.prototype[Symbol.for("nodejs.util.inspect.custom")]=c}catch(t){n.prototype.inspect=c}else n.prototype.inspect=c;function c(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(t,e){var i;if(e=0|e||1,16===(t=t||10)||"hex"===t){i="";for(var n=0,s=0,a=0;a<this.length;a++){var o=this.words[a],h=(16777215&(o<<n|s)).toString(16);s=o>>>24-n&16777215,(n+=2)>=26&&(n-=26,a--),i=0!==s||a!==this.length-1?f[6-h.length]+h+i:h+i}for(0!==s&&(i=s.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var u=d[t],l=p[t];i="";var c=this.clone();for(c.negative=0;!c.isZero();){var m=c.modrn(l).toString(t);i=(c=c.idivn(l)).isZero()?m+i:f[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16,2)},a&&(n.prototype.toBuffer=function(t,e){return this.toArrayLike(a,t,e)}),n.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function m(t,e,r){r.negative=e.negative^t.negative;var i=t.length+e.length|0;r.length=i,i=i-1|0;var n=0|t.words[0],s=0|e.words[0],a=n*s,o=67108863&a,h=a/67108864|0;r.words[0]=o;for(var u=1;u<i;u++){for(var l=h>>>26,c=67108863&h,f=Math.min(u,e.length-1),d=Math.max(0,u-t.length+1);d<=f;d++){var p=u-d|0;l+=(a=(n=0|t.words[p])*(s=0|e.words[d])+c)/67108864|0,c=67108863&a}r.words[u]=0|c,h=0|l}return 0!==h?r.words[u]=0|h:r.length--,r._strip()}n.prototype.toArrayLike=function(t,e,i){this._strip();var n=this.byteLength(),s=i||Math.max(1,n);r(n<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0");var a=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,s);return this["_toArrayLike"+("le"===e?"LE":"BE")](a,n),a},n.prototype._toArrayLikeLE=function(t,e){for(var r=0,i=0,n=0,s=0;n<this.length;n++){var a=this.words[n]<<s|i;t[r++]=255&a,r<t.length&&(t[r++]=a>>8&255),r<t.length&&(t[r++]=a>>16&255),6===s?(r<t.length&&(t[r++]=a>>24&255),i=0,s=0):(i=a>>>24,s+=2)}if(r<t.length)for(t[r++]=i;r<t.length;)t[r++]=0},n.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,i=0,n=0,s=0;n<this.length;n++){var a=this.words[n]<<s|i;t[r--]=255&a,r>=0&&(t[r--]=a>>8&255),r>=0&&(t[r--]=a>>16&255),6===s?(r>=0&&(t[r--]=a>>24&255),i=0,s=0):(i=a>>>24,s+=2)}if(r>=0)for(t[r--]=i;r>=0;)t[r--]=0},Math.clz32?n.prototype._countBits=function(t){return 32-Math.clz32(t)}:n.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},n.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},n.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},n.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},n.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var i=0;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this._strip()},n.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this._strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,e){r("number"==typeof t&&t>=0);var i=t/26|0,n=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<n:this.words[i]&~(1<<n),this._strip()},n.prototype.iadd=function(t){var e,r,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,i=t):(r=t,i=this);for(var n=0,s=0;s<i.length;s++)e=(0|r.words[s])+(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<r.length;s++)e=(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},n.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,i,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,i=t):(r=t,i=this);for(var s=0,a=0;a<i.length;a++)s=(e=(0|r.words[a])-(0|i.words[a])+s)>>26,this.words[a]=67108863&e;for(;0!==s&&a<r.length;a++)s=(e=(0|r.words[a])+s)>>26,this.words[a]=67108863&e;if(0===s&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,r){var i,n,s,a=t.words,o=e.words,h=r.words,u=0,l=0|a[0],c=8191&l,f=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,g=0|a[2],v=8191&g,_=g>>>13,b=0|a[3],y=8191&b,x=b>>>13,w=0|a[4],E=8191&w,M=w>>>13,S=0|a[5],A=8191&S,T=S>>>13,C=0|a[6],D=8191&C,R=C>>>13,I=0|a[7],P=8191&I,N=I>>>13,k=0|a[8],B=8191&k,L=k>>>13,O=0|a[9],F=8191&O,U=O>>>13,z=0|o[0],G=8191&z,H=z>>>13,j=0|o[1],V=8191&j,W=j>>>13,q=0|o[2],X=8191&q,Y=q>>>13,Z=0|o[3],$=8191&Z,K=Z>>>13,J=0|o[4],Q=8191&J,tt=J>>>13,et=0|o[5],rt=8191&et,it=et>>>13,nt=0|o[6],st=8191&nt,at=nt>>>13,ot=0|o[7],ht=8191&ot,ut=ot>>>13,lt=0|o[8],ct=8191&lt,ft=lt>>>13,dt=0|o[9],pt=8191&dt,mt=dt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(u+(i=Math.imul(c,G))|0)+((8191&(n=(n=Math.imul(c,H))+Math.imul(f,G)|0))<<13)|0;u=((s=Math.imul(f,H))+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(p,G),n=(n=Math.imul(p,H))+Math.imul(m,G)|0,s=Math.imul(m,H);var vt=(u+(i=i+Math.imul(c,V)|0)|0)+((8191&(n=(n=n+Math.imul(c,W)|0)+Math.imul(f,V)|0))<<13)|0;u=((s=s+Math.imul(f,W)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(v,G),n=(n=Math.imul(v,H))+Math.imul(_,G)|0,s=Math.imul(_,H),i=i+Math.imul(p,V)|0,n=(n=n+Math.imul(p,W)|0)+Math.imul(m,V)|0,s=s+Math.imul(m,W)|0;var _t=(u+(i=i+Math.imul(c,X)|0)|0)+((8191&(n=(n=n+Math.imul(c,Y)|0)+Math.imul(f,X)|0))<<13)|0;u=((s=s+Math.imul(f,Y)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(y,G),n=(n=Math.imul(y,H))+Math.imul(x,G)|0,s=Math.imul(x,H),i=i+Math.imul(v,V)|0,n=(n=n+Math.imul(v,W)|0)+Math.imul(_,V)|0,s=s+Math.imul(_,W)|0,i=i+Math.imul(p,X)|0,n=(n=n+Math.imul(p,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var bt=(u+(i=i+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,K)|0)+Math.imul(f,$)|0))<<13)|0;u=((s=s+Math.imul(f,K)|0)+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,i=Math.imul(E,G),n=(n=Math.imul(E,H))+Math.imul(M,G)|0,s=Math.imul(M,H),i=i+Math.imul(y,V)|0,n=(n=n+Math.imul(y,W)|0)+Math.imul(x,V)|0,s=s+Math.imul(x,W)|0,i=i+Math.imul(v,X)|0,n=(n=n+Math.imul(v,Y)|0)+Math.imul(_,X)|0,s=s+Math.imul(_,Y)|0,i=i+Math.imul(p,$)|0,n=(n=n+Math.imul(p,K)|0)+Math.imul(m,$)|0,s=s+Math.imul(m,K)|0;var yt=(u+(i=i+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,tt)|0)+Math.imul(f,Q)|0))<<13)|0;u=((s=s+Math.imul(f,tt)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(A,G),n=(n=Math.imul(A,H))+Math.imul(T,G)|0,s=Math.imul(T,H),i=i+Math.imul(E,V)|0,n=(n=n+Math.imul(E,W)|0)+Math.imul(M,V)|0,s=s+Math.imul(M,W)|0,i=i+Math.imul(y,X)|0,n=(n=n+Math.imul(y,Y)|0)+Math.imul(x,X)|0,s=s+Math.imul(x,Y)|0,i=i+Math.imul(v,$)|0,n=(n=n+Math.imul(v,K)|0)+Math.imul(_,$)|0,s=s+Math.imul(_,K)|0,i=i+Math.imul(p,Q)|0,n=(n=n+Math.imul(p,tt)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,tt)|0;var xt=(u+(i=i+Math.imul(c,rt)|0)|0)+((8191&(n=(n=n+Math.imul(c,it)|0)+Math.imul(f,rt)|0))<<13)|0;u=((s=s+Math.imul(f,it)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(D,G),n=(n=Math.imul(D,H))+Math.imul(R,G)|0,s=Math.imul(R,H),i=i+Math.imul(A,V)|0,n=(n=n+Math.imul(A,W)|0)+Math.imul(T,V)|0,s=s+Math.imul(T,W)|0,i=i+Math.imul(E,X)|0,n=(n=n+Math.imul(E,Y)|0)+Math.imul(M,X)|0,s=s+Math.imul(M,Y)|0,i=i+Math.imul(y,$)|0,n=(n=n+Math.imul(y,K)|0)+Math.imul(x,$)|0,s=s+Math.imul(x,K)|0,i=i+Math.imul(v,Q)|0,n=(n=n+Math.imul(v,tt)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,tt)|0,i=i+Math.imul(p,rt)|0,n=(n=n+Math.imul(p,it)|0)+Math.imul(m,rt)|0,s=s+Math.imul(m,it)|0;var wt=(u+(i=i+Math.imul(c,st)|0)|0)+((8191&(n=(n=n+Math.imul(c,at)|0)+Math.imul(f,st)|0))<<13)|0;u=((s=s+Math.imul(f,at)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(P,G),n=(n=Math.imul(P,H))+Math.imul(N,G)|0,s=Math.imul(N,H),i=i+Math.imul(D,V)|0,n=(n=n+Math.imul(D,W)|0)+Math.imul(R,V)|0,s=s+Math.imul(R,W)|0,i=i+Math.imul(A,X)|0,n=(n=n+Math.imul(A,Y)|0)+Math.imul(T,X)|0,s=s+Math.imul(T,Y)|0,i=i+Math.imul(E,$)|0,n=(n=n+Math.imul(E,K)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,K)|0,i=i+Math.imul(y,Q)|0,n=(n=n+Math.imul(y,tt)|0)+Math.imul(x,Q)|0,s=s+Math.imul(x,tt)|0,i=i+Math.imul(v,rt)|0,n=(n=n+Math.imul(v,it)|0)+Math.imul(_,rt)|0,s=s+Math.imul(_,it)|0,i=i+Math.imul(p,st)|0,n=(n=n+Math.imul(p,at)|0)+Math.imul(m,st)|0,s=s+Math.imul(m,at)|0;var Et=(u+(i=i+Math.imul(c,ht)|0)|0)+((8191&(n=(n=n+Math.imul(c,ut)|0)+Math.imul(f,ht)|0))<<13)|0;u=((s=s+Math.imul(f,ut)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(B,G),n=(n=Math.imul(B,H))+Math.imul(L,G)|0,s=Math.imul(L,H),i=i+Math.imul(P,V)|0,n=(n=n+Math.imul(P,W)|0)+Math.imul(N,V)|0,s=s+Math.imul(N,W)|0,i=i+Math.imul(D,X)|0,n=(n=n+Math.imul(D,Y)|0)+Math.imul(R,X)|0,s=s+Math.imul(R,Y)|0,i=i+Math.imul(A,$)|0,n=(n=n+Math.imul(A,K)|0)+Math.imul(T,$)|0,s=s+Math.imul(T,K)|0,i=i+Math.imul(E,Q)|0,n=(n=n+Math.imul(E,tt)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,tt)|0,i=i+Math.imul(y,rt)|0,n=(n=n+Math.imul(y,it)|0)+Math.imul(x,rt)|0,s=s+Math.imul(x,it)|0,i=i+Math.imul(v,st)|0,n=(n=n+Math.imul(v,at)|0)+Math.imul(_,st)|0,s=s+Math.imul(_,at)|0,i=i+Math.imul(p,ht)|0,n=(n=n+Math.imul(p,ut)|0)+Math.imul(m,ht)|0,s=s+Math.imul(m,ut)|0;var Mt=(u+(i=i+Math.imul(c,ct)|0)|0)+((8191&(n=(n=n+Math.imul(c,ft)|0)+Math.imul(f,ct)|0))<<13)|0;u=((s=s+Math.imul(f,ft)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(F,G),n=(n=Math.imul(F,H))+Math.imul(U,G)|0,s=Math.imul(U,H),i=i+Math.imul(B,V)|0,n=(n=n+Math.imul(B,W)|0)+Math.imul(L,V)|0,s=s+Math.imul(L,W)|0,i=i+Math.imul(P,X)|0,n=(n=n+Math.imul(P,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,i=i+Math.imul(D,$)|0,n=(n=n+Math.imul(D,K)|0)+Math.imul(R,$)|0,s=s+Math.imul(R,K)|0,i=i+Math.imul(A,Q)|0,n=(n=n+Math.imul(A,tt)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,tt)|0,i=i+Math.imul(E,rt)|0,n=(n=n+Math.imul(E,it)|0)+Math.imul(M,rt)|0,s=s+Math.imul(M,it)|0,i=i+Math.imul(y,st)|0,n=(n=n+Math.imul(y,at)|0)+Math.imul(x,st)|0,s=s+Math.imul(x,at)|0,i=i+Math.imul(v,ht)|0,n=(n=n+Math.imul(v,ut)|0)+Math.imul(_,ht)|0,s=s+Math.imul(_,ut)|0,i=i+Math.imul(p,ct)|0,n=(n=n+Math.imul(p,ft)|0)+Math.imul(m,ct)|0,s=s+Math.imul(m,ft)|0;var St=(u+(i=i+Math.imul(c,pt)|0)|0)+((8191&(n=(n=n+Math.imul(c,mt)|0)+Math.imul(f,pt)|0))<<13)|0;u=((s=s+Math.imul(f,mt)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(F,V),n=(n=Math.imul(F,W))+Math.imul(U,V)|0,s=Math.imul(U,W),i=i+Math.imul(B,X)|0,n=(n=n+Math.imul(B,Y)|0)+Math.imul(L,X)|0,s=s+Math.imul(L,Y)|0,i=i+Math.imul(P,$)|0,n=(n=n+Math.imul(P,K)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,K)|0,i=i+Math.imul(D,Q)|0,n=(n=n+Math.imul(D,tt)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,tt)|0,i=i+Math.imul(A,rt)|0,n=(n=n+Math.imul(A,it)|0)+Math.imul(T,rt)|0,s=s+Math.imul(T,it)|0,i=i+Math.imul(E,st)|0,n=(n=n+Math.imul(E,at)|0)+Math.imul(M,st)|0,s=s+Math.imul(M,at)|0,i=i+Math.imul(y,ht)|0,n=(n=n+Math.imul(y,ut)|0)+Math.imul(x,ht)|0,s=s+Math.imul(x,ut)|0,i=i+Math.imul(v,ct)|0,n=(n=n+Math.imul(v,ft)|0)+Math.imul(_,ct)|0,s=s+Math.imul(_,ft)|0;var At=(u+(i=i+Math.imul(p,pt)|0)|0)+((8191&(n=(n=n+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;u=((s=s+Math.imul(m,mt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,i=Math.imul(F,X),n=(n=Math.imul(F,Y))+Math.imul(U,X)|0,s=Math.imul(U,Y),i=i+Math.imul(B,$)|0,n=(n=n+Math.imul(B,K)|0)+Math.imul(L,$)|0,s=s+Math.imul(L,K)|0,i=i+Math.imul(P,Q)|0,n=(n=n+Math.imul(P,tt)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,tt)|0,i=i+Math.imul(D,rt)|0,n=(n=n+Math.imul(D,it)|0)+Math.imul(R,rt)|0,s=s+Math.imul(R,it)|0,i=i+Math.imul(A,st)|0,n=(n=n+Math.imul(A,at)|0)+Math.imul(T,st)|0,s=s+Math.imul(T,at)|0,i=i+Math.imul(E,ht)|0,n=(n=n+Math.imul(E,ut)|0)+Math.imul(M,ht)|0,s=s+Math.imul(M,ut)|0,i=i+Math.imul(y,ct)|0,n=(n=n+Math.imul(y,ft)|0)+Math.imul(x,ct)|0,s=s+Math.imul(x,ft)|0;var Tt=(u+(i=i+Math.imul(v,pt)|0)|0)+((8191&(n=(n=n+Math.imul(v,mt)|0)+Math.imul(_,pt)|0))<<13)|0;u=((s=s+Math.imul(_,mt)|0)+(n>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,i=Math.imul(F,$),n=(n=Math.imul(F,K))+Math.imul(U,$)|0,s=Math.imul(U,K),i=i+Math.imul(B,Q)|0,n=(n=n+Math.imul(B,tt)|0)+Math.imul(L,Q)|0,s=s+Math.imul(L,tt)|0,i=i+Math.imul(P,rt)|0,n=(n=n+Math.imul(P,it)|0)+Math.imul(N,rt)|0,s=s+Math.imul(N,it)|0,i=i+Math.imul(D,st)|0,n=(n=n+Math.imul(D,at)|0)+Math.imul(R,st)|0,s=s+Math.imul(R,at)|0,i=i+Math.imul(A,ht)|0,n=(n=n+Math.imul(A,ut)|0)+Math.imul(T,ht)|0,s=s+Math.imul(T,ut)|0,i=i+Math.imul(E,ct)|0,n=(n=n+Math.imul(E,ft)|0)+Math.imul(M,ct)|0,s=s+Math.imul(M,ft)|0;var Ct=(u+(i=i+Math.imul(y,pt)|0)|0)+((8191&(n=(n=n+Math.imul(y,mt)|0)+Math.imul(x,pt)|0))<<13)|0;u=((s=s+Math.imul(x,mt)|0)+(n>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,i=Math.imul(F,Q),n=(n=Math.imul(F,tt))+Math.imul(U,Q)|0,s=Math.imul(U,tt),i=i+Math.imul(B,rt)|0,n=(n=n+Math.imul(B,it)|0)+Math.imul(L,rt)|0,s=s+Math.imul(L,it)|0,i=i+Math.imul(P,st)|0,n=(n=n+Math.imul(P,at)|0)+Math.imul(N,st)|0,s=s+Math.imul(N,at)|0,i=i+Math.imul(D,ht)|0,n=(n=n+Math.imul(D,ut)|0)+Math.imul(R,ht)|0,s=s+Math.imul(R,ut)|0,i=i+Math.imul(A,ct)|0,n=(n=n+Math.imul(A,ft)|0)+Math.imul(T,ct)|0,s=s+Math.imul(T,ft)|0;var Dt=(u+(i=i+Math.imul(E,pt)|0)|0)+((8191&(n=(n=n+Math.imul(E,mt)|0)+Math.imul(M,pt)|0))<<13)|0;u=((s=s+Math.imul(M,mt)|0)+(n>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,i=Math.imul(F,rt),n=(n=Math.imul(F,it))+Math.imul(U,rt)|0,s=Math.imul(U,it),i=i+Math.imul(B,st)|0,n=(n=n+Math.imul(B,at)|0)+Math.imul(L,st)|0,s=s+Math.imul(L,at)|0,i=i+Math.imul(P,ht)|0,n=(n=n+Math.imul(P,ut)|0)+Math.imul(N,ht)|0,s=s+Math.imul(N,ut)|0,i=i+Math.imul(D,ct)|0,n=(n=n+Math.imul(D,ft)|0)+Math.imul(R,ct)|0,s=s+Math.imul(R,ft)|0;var Rt=(u+(i=i+Math.imul(A,pt)|0)|0)+((8191&(n=(n=n+Math.imul(A,mt)|0)+Math.imul(T,pt)|0))<<13)|0;u=((s=s+Math.imul(T,mt)|0)+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,i=Math.imul(F,st),n=(n=Math.imul(F,at))+Math.imul(U,st)|0,s=Math.imul(U,at),i=i+Math.imul(B,ht)|0,n=(n=n+Math.imul(B,ut)|0)+Math.imul(L,ht)|0,s=s+Math.imul(L,ut)|0,i=i+Math.imul(P,ct)|0,n=(n=n+Math.imul(P,ft)|0)+Math.imul(N,ct)|0,s=s+Math.imul(N,ft)|0;var It=(u+(i=i+Math.imul(D,pt)|0)|0)+((8191&(n=(n=n+Math.imul(D,mt)|0)+Math.imul(R,pt)|0))<<13)|0;u=((s=s+Math.imul(R,mt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(F,ht),n=(n=Math.imul(F,ut))+Math.imul(U,ht)|0,s=Math.imul(U,ut),i=i+Math.imul(B,ct)|0,n=(n=n+Math.imul(B,ft)|0)+Math.imul(L,ct)|0,s=s+Math.imul(L,ft)|0;var Pt=(u+(i=i+Math.imul(P,pt)|0)|0)+((8191&(n=(n=n+Math.imul(P,mt)|0)+Math.imul(N,pt)|0))<<13)|0;u=((s=s+Math.imul(N,mt)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,i=Math.imul(F,ct),n=(n=Math.imul(F,ft))+Math.imul(U,ct)|0,s=Math.imul(U,ft);var Nt=(u+(i=i+Math.imul(B,pt)|0)|0)+((8191&(n=(n=n+Math.imul(B,mt)|0)+Math.imul(L,pt)|0))<<13)|0;u=((s=s+Math.imul(L,mt)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var kt=(u+(i=Math.imul(F,pt))|0)+((8191&(n=(n=Math.imul(F,mt))+Math.imul(U,pt)|0))<<13)|0;return u=((s=Math.imul(U,mt))+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,h[0]=gt,h[1]=vt,h[2]=_t,h[3]=bt,h[4]=yt,h[5]=xt,h[6]=wt,h[7]=Et,h[8]=Mt,h[9]=St,h[10]=At,h[11]=Tt,h[12]=Ct,h[13]=Dt,h[14]=Rt,h[15]=It,h[16]=Pt,h[17]=Nt,h[18]=kt,0!==u&&(h[19]=u,r.length++),r};function v(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var i=0,n=0,s=0;s<r.length-1;s++){var a=n;n=0;for(var o=67108863&i,h=Math.min(s,e.length-1),u=Math.max(0,s-t.length+1);u<=h;u++){var l=s-u,c=(0|t.words[l])*(0|e.words[u]),f=67108863&c;o=67108863&(f=f+o|0),n+=(a=(a=a+(c/67108864|0)|0)+(f>>>26)|0)>>>26,a&=67108863}r.words[s]=o,i=a,a=n}return 0!==i?r.words[s]=i:r.length--,r._strip()}function _(t,e,r){return v(t,e,r)}function b(t,e){this.x=t,this.y=e}Math.imul||(g=m),n.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):r<63?m(this,t,e):r<1024?v(this,t,e):_(this,t,e)},b.prototype.makeRBT=function(t){for(var e=new Array(t),r=n.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,r,t);return e},b.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var i=0,n=0;n<e;n++)i|=(1&t)<<e-n-1,t>>=1;return i},b.prototype.permute=function(t,e,r,i,n,s){for(var a=0;a<s;a++)i[a]=e[t[a]],n[a]=r[t[a]]},b.prototype.transform=function(t,e,r,i,n,s){this.permute(s,t,e,r,i,n);for(var a=1;a<n;a<<=1)for(var o=a<<1,h=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),l=0;l<n;l+=o)for(var c=h,f=u,d=0;d<a;d++){var p=r[l+d],m=i[l+d],g=r[l+d+a],v=i[l+d+a],_=c*g-f*v;v=c*v+f*g,g=_,r[l+d]=p+g,i[l+d]=m+v,r[l+d+a]=p-g,i[l+d+a]=m-v,d!==o&&(_=h*c-u*f,f=h*f+u*c,c=_)}},b.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),i=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+i},b.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var i=0;i<r/2;i++){var n=t[i];t[i]=t[r-i-1],t[r-i-1]=n,n=e[i],e[i]=-e[r-i-1],e[r-i-1]=-n}},b.prototype.normalize13b=function(t,e){for(var r=0,i=0;i<e/2;i++){var n=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+r;t[i]=67108863&n,r=n<67108864?0:n/67108864|0}return t},b.prototype.convert13b=function(t,e,i,n){for(var s=0,a=0;a<e;a++)s+=0|t[a],i[2*a]=8191&s,s>>>=13,i[2*a+1]=8191&s,s>>>=13;for(a=2*e;a<n;++a)i[a]=0;r(0===s),r(0==(-8192&s))},b.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},b.prototype.mulp=function(t,e,r){var i=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(i),s=this.stub(i),a=new Array(i),o=new Array(i),h=new Array(i),u=new Array(i),l=new Array(i),c=new Array(i),f=r.words;f.length=i,this.convert13b(t.words,t.length,a,i),this.convert13b(e.words,e.length,u,i),this.transform(a,s,o,h,i,n),this.transform(u,s,l,c,i,n);for(var d=0;d<i;d++){var p=o[d]*l[d]-h[d]*c[d];h[d]=o[d]*c[d]+h[d]*l[d],o[d]=p}return this.conjugate(o,h,i),this.transform(o,h,f,s,i,n),this.conjugate(f,s,i),this.normalize13b(f,i),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},n.prototype.mul=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},n.prototype.mulf=function(t){var e=new n(null);return e.words=new Array(this.length+t.length),_(this,t,e)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){var e=t<0;e&&(t=-t),r("number"==typeof t),r(t<67108864);for(var i=0,n=0;n<this.length;n++){var s=(0|this.words[n])*t,a=(67108863&s)+(67108863&i);i>>=26,i+=s/67108864|0,i+=a>>>26,this.words[n]=67108863&a}return 0!==i&&(this.words[n]=i,this.length++),e?this.ineg():this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var i=r/26|0,n=r%26;e[r]=t.words[i]>>>n&1}return e}(t);if(0===e.length)return new n(1);for(var r=this,i=0;i<e.length&&0===e[i];i++,r=r.sqr());if(++i<e.length)for(var s=r.sqr();i<e.length;i++,s=s.sqr())0!==e[i]&&(r=r.mul(s));return r},n.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var e,i=t%26,n=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var a=0;for(e=0;e<this.length;e++){var o=this.words[e]&s,h=(0|this.words[e])-o<<i;this.words[e]=h|a,a=o>>>26-i}a&&(this.words[e]=a,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this._strip()},n.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,e,i){var n;r("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,a=Math.min((t-s)/26,this.length),o=67108863^67108863>>>s<<s,h=i;if(n-=a,n=Math.max(0,n),h){for(var u=0;u<a;u++)h.words[u]=this.words[u];h.length=a}if(0===a);else if(this.length>a)for(this.length-=a,u=0;u<this.length;u++)this.words[u]=this.words[u+a];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=n);u--){var c=0|this.words[u];this.words[u]=l<<26-s|c>>>s,l=c&o}return h&&0!==l&&(h.words[h.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(t,e,i){return r(0===this.negative),this.iushrn(t,e,i)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,n=1<<e;return!(this.length<=i)&&!!(this.words[i]&n)},n.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this._strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},n.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,e,i){var n,s,a=t.length+i;this._expand(a);var o=0;for(n=0;n<t.length;n++){s=(0|this.words[n+i])+o;var h=(0|t.words[n])*e;o=((s-=67108863&h)>>26)-(h/67108864|0),this.words[n+i]=67108863&s}for(;n<this.length-i;n++)o=(s=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&s;if(0===o)return this._strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(s=-(0|this.words[n])+o)>>26,this.words[n]=67108863&s;return this.negative=1,this._strip()},n.prototype._wordDiv=function(t,e){var r=(this.length,t.length),i=this.clone(),s=t,a=0|s.words[s.length-1];0!==(r=26-this._countBits(a))&&(s=s.ushln(r),i.iushln(r),a=0|s.words[s.length-1]);var o,h=i.length-s.length;if("mod"!==e){(o=new n(null)).length=h+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var l=i.clone()._ishlnsubmul(s,1,h);0===l.negative&&(i=l,o&&(o.words[h]=1));for(var c=h-1;c>=0;c--){var f=67108864*(0|i.words[s.length+c])+(0|i.words[s.length+c-1]);for(f=Math.min(f/a|0,67108863),i._ishlnsubmul(s,f,c);0!==i.negative;)f--,i.negative=0,i._ishlnsubmul(s,1,c),i.isZero()||(i.negative^=1);o&&(o.words[c]=f)}return o&&o._strip(),i._strip(),"div"!==e&&0!==r&&i.iushrn(r),{div:o||null,mod:i}},n.prototype.divmod=function(t,e,i){return r(!t.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===t.negative?(o=this.neg().divmod(t,e),"mod"!==e&&(s=o.div.neg()),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.iadd(t)),{div:s,mod:a}):0===this.negative&&0!==t.negative?(o=this.divmod(t.neg(),e),"mod"!==e&&(s=o.div.neg()),{div:s,mod:o.mod}):0!=(this.negative&t.negative)?(o=this.neg().divmod(t.neg(),e),"div"!==e&&(a=o.mod.neg(),i&&0!==a.negative&&a.isub(t)),{div:o.div,mod:a}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new n(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modrn(t.words[0]))}:this._wordDiv(t,e);var s,a,o},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),n=t.andln(1),s=r.cmp(i);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},n.prototype.modrn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var i=67108864%t,n=0,s=this.length-1;s>=0;s--)n=(i*n+(0|this.words[s]))%t;return e?-n:n},n.prototype.modn=function(t){return this.modrn(t)},n.prototype.idivn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var i=0,n=this.length-1;n>=0;n--){var s=(0|this.words[n])+67108864*i;this.words[n]=s/t|0,i=s%t}return this._strip(),e?this.ineg():this},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s=new n(1),a=new n(0),o=new n(0),h=new n(1),u=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++u;for(var l=i.clone(),c=e.clone();!e.isZero();){for(var f=0,d=1;0==(e.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(e.iushrn(f);f-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(l),a.isub(c)),s.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(o.isOdd()||h.isOdd())&&(o.iadd(l),h.isub(c)),o.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),s.isub(o),a.isub(h)):(i.isub(e),o.isub(s),h.isub(a))}return{a:o,b:h,gcd:i.iushln(u)}},n.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s,a=new n(1),o=new n(0),h=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,l=1;0==(e.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(e.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);for(var c=0,f=1;0==(i.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);e.cmp(i)>=0?(e.isub(i),a.isub(o)):(i.isub(e),o.isub(a))}return(s=0===e.cmpn(1)?a:o).cmpn(0)<0&&s.iadd(t),s},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var i=0;e.isEven()&&r.isEven();i++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var s=e;e=r,r=s}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(i)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){r("number"==typeof t);var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var s=n,a=i;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this._strip(),this.length>1)e=1;else{i&&(t=-t),r(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],n=0|t.words[r];if(i!==n){i<n?e=-1:i>n&&(e=1);break}}return e},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new A(t)},n.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function x(t,e){this.name=t,this.p=new n(e,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function M(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(t){if("string"==typeof t){var e=n._prime(t);this.m=e.p,this.prime=e}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function T(t){A.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}x.prototype._tmp=function(){var t=new n(null);return t.words=new Array(Math.ceil(this.n/13)),t},x.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},x.prototype.split=function(t,e){t.iushrn(this.n,0,e)},x.prototype.imulK=function(t){return t.imul(this.k)},i(w,x),w.prototype.split=function(t,e){for(var r=4194303,i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=s&r,n=10;n<t.length;n++){var a=0|t.words[n];t.words[n-10]=(a&r)<<4|s>>>22,s=a}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},w.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var i=0|t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(E,x),i(M,x),i(S,x),S.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var i=19*(0|t.words[r])+e,n=67108863&i;i>>>=26,t.words[r]=n,e=i}return 0!==e&&(t.words[t.length++]=e),t},n._prime=function(t){if(y[t])return y[t];var e;if("k256"===t)e=new w;else if("p224"===t)e=new E;else if("p192"===t)e=new M;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new S}return y[t]=e,e},A.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},A.prototype._verify2=function(t,e){r(0==(t.negative|e.negative),"red works only with positives"),r(t.red&&t.red===e.red,"red works only with red numbers")},A.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(l(t,t.umod(this.m)._forceRed(this)),t)},A.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},A.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},A.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},A.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},A.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},A.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},A.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},A.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},A.prototype.isqr=function(t){return this.imul(t,t.clone())},A.prototype.sqr=function(t){return this.mul(t,t)},A.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(r(e%2==1),3===e){var i=this.m.add(new n(1)).iushrn(2);return this.pow(t,i)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new n(1).toRed(this),h=o.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new n(2*l*l).toRed(this);0!==this.pow(l,u).cmp(h);)l.redIAdd(h);for(var c=this.pow(l,s),f=this.pow(t,s.addn(1).iushrn(1)),d=this.pow(t,s),p=a;0!==d.cmp(o);){for(var m=d,g=0;0!==m.cmp(o);g++)m=m.redSqr();r(g<p);var v=this.pow(c,new n(1).iushln(p-g-1));f=f.redMul(v),c=v.redSqr(),d=d.redMul(c),p=g}return f},A.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},A.prototype.pow=function(t,e){if(e.isZero())return new n(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new n(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var s=r[0],a=0,o=0,h=e.bitLength()%26;for(0===h&&(h=26),i=e.length-1;i>=0;i--){for(var u=e.words[i],l=h-1;l>=0;l--){var c=u>>l&1;s!==r[0]&&(s=this.sqr(s)),0!==c||0!==a?(a<<=1,a|=c,(4===++o||0===i&&0===l)&&(s=this.mul(s,r[a]),o=0,a=0)):o=0}h=26}return s},A.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},A.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},n.mont=function(t){return new T(t)},i(T,A),T.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},T.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},T.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},T.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new n(0)._forceRed(this);var r=t.mul(e),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):s.cmpn(0)<0&&(a=s.iadd(this.m)),a._forceRed(this)},T.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t,this)})),s.register("8sncL",(function(t,e){var r=s("6vNa5"),i=s("bbc25"),n=s("4Uusr"),a=s("enuUj"),o=s("wQ7R3"),h=s("k0Rto").Buffer;function u(t){var e;"object"!=typeof t||h.isBuffer(t)||(e=t.passphrase,t=t.key),"string"==typeof t&&(t=h.from(t));var s,u,l=n(t,e),c=l.tag,f=l.data;switch(c){case"CERTIFICATE":u=r.certificate.decode(f,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(u||(u=r.PublicKey.decode(f,"der")),s=u.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPublicKey.decode(u.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return u.subjectPrivateKey=u.subjectPublicKey,{type:"ec",data:u};case"1.2.840.10040.4.1":return u.algorithm.params.pub_key=r.DSAparam.decode(u.subjectPublicKey.data,"der"),{type:"dsa",data:u.algorithm.params};default:throw new Error("unknown key id "+s)}case"ENCRYPTED PRIVATE KEY":f=function(t,e){var r=t.algorithm.decrypt.kde.kdeparams.salt,n=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),s=i[t.algorithm.decrypt.cipher.algo.join(".")],u=t.algorithm.decrypt.cipher.iv,l=t.subjectPrivateKey,c=parseInt(s.split("-")[1],10)/8,f=o.pbkdf2Sync(e,r,n,c,"sha1"),d=a.createDecipheriv(s,f,u),p=[];return p.push(d.update(l)),p.push(d.final()),h.concat(p)}(f=r.EncryptedPrivateKey.decode(f,"der"),e);case"PRIVATE KEY":switch(s=(u=r.PrivateKey.decode(f,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPrivateKey.decode(u.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:u.algorithm.curve,privateKey:r.ECPrivateKey.decode(u.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return u.algorithm.params.priv_key=r.DSAparam.decode(u.subjectPrivateKey,"der"),{type:"dsa",params:u.algorithm.params};default:throw new Error("unknown key id "+s)}case"RSA PUBLIC KEY":return r.RSAPublicKey.decode(f,"der");case"RSA PRIVATE KEY":return r.RSAPrivateKey.decode(f,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:r.DSAPrivateKey.decode(f,"der")};case"EC PRIVATE KEY":return{curve:(f=r.ECPrivateKey.decode(f,"der")).parameters.value,privateKey:f.privateKey};default:throw new Error("unknown key type "+c)}}t.exports=u,u.signature=r.signature})),s.register("6vNa5",(function(t,r){var i,n,a,o,h,u,l,c,f,d;e(t.exports,"certificate",(()=>i),(t=>i=t)),e(t.exports,"RSAPrivateKey",(()=>n),(t=>n=t)),e(t.exports,"RSAPublicKey",(()=>a),(t=>a=t)),e(t.exports,"PublicKey",(()=>o),(t=>o=t)),e(t.exports,"PrivateKey",(()=>h),(t=>h=t)),e(t.exports,"EncryptedPrivateKey",(()=>u),(t=>u=t)),e(t.exports,"DSAPrivateKey",(()=>l),(t=>l=t)),e(t.exports,"DSAparam",(()=>c),(t=>c=t)),e(t.exports,"ECPrivateKey",(()=>f),(t=>f=t)),e(t.exports,"signature",(()=>d),(t=>d=t));var p=s("f6ATU");i=s("8mCBH");var m=p.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));n=m;var g=p.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));a=g;var v=p.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(_),this.key("subjectPublicKey").bitstr())}));o=v;var _=p.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),b=p.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(_),this.key("subjectPrivateKey").octstr())}));h=b;var y=p.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));u=y;var x=p.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));l=x,c=p.define("DSAparam",(function(){this.int()}));var w=p.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(E),this.key("publicKey").optional().explicit(1).bitstr())}));f=w;var E=p.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));d=p.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))})),s.register("f6ATU",(function(t,e){const r=t.exports;r.bignum=s("g5rlv"),r.define=s("bzTok").define,r.base=s("50MJM"),r.constants=s("eOu52"),r.decoders=s("185bd"),r.encoders=s("2FRn8")})),s.register("bzTok",(function(t,e){var r=s("2FRn8"),i=s("185bd"),n=s("6cuMU");function a(t,e){this.name=t,this.body=e,this.decoders={},this.encoders={}}t.exports.define=function(t,e){return new a(t,e)},a.prototype._createNamed=function(t){const e=this.name;function r(t){this._initNamed(t,e)}return n(r,t),r.prototype._initNamed=function(e,r){t.call(this,e,r)},new r(this)},a.prototype._getDecoder=function(t){return t=t||"der",this.decoders.hasOwnProperty(t)||(this.decoders[t]=this._createNamed(i[t])),this.decoders[t]},a.prototype.decode=function(t,e,r){return this._getDecoder(e).decode(t,r)},a.prototype._getEncoder=function(t){return t=t||"der",this.encoders.hasOwnProperty(t)||(this.encoders[t]=this._createNamed(r[t])),this.encoders[t]},a.prototype.encode=function(t,e,r){return this._getEncoder(e).encode(t,r)}})),s.register("2FRn8",(function(t,e){const r=t.exports;r.der=s("g9EHu"),r.pem=s("b1Fvj")})),s.register("g9EHu",(function(t,e){var r=s("6cuMU"),i=s("eoLdT").Buffer,n=s("kNfRa"),a=s("5L1HU");function o(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new h,this.tree._init(t.body)}function h(t){n.call(this,"der",t)}function u(t){return t<10?"0"+t:t}t.exports=o,o.prototype.encode=function(t,e){return this.tree._encode(t,e).join()},r(h,n),h.prototype._encodeComposite=function(t,e,r,n){const s=function(t,e,r,i){let n;"seqof"===t?t="seq":"setof"===t&&(t="set");if(a.tagByName.hasOwnProperty(t))n=a.tagByName[t];else{if("number"!=typeof t||(0|t)!==t)return i.error("Unknown tag: "+t);n=t}if(n>=31)return i.error("Multi-octet tag encoding unsupported");e||(n|=32);return n|=a.tagClassByName[r||"universal"]<<6,n}(t,e,r,this.reporter);if(n.length<128){const t=i.alloc(2);return t[0]=s,t[1]=n.length,this._createEncoderBuffer([t,n])}let o=1;for(let t=n.length;t>=256;t>>=8)o++;const h=i.alloc(2+o);h[0]=s,h[1]=128|o;for(let t=1+o,e=n.length;e>0;t--,e>>=8)h[t]=255&e;return this._createEncoderBuffer([h,n])},h.prototype._encodeStr=function(t,e){if("bitstr"===e)return this._createEncoderBuffer([0|t.unused,t.data]);if("bmpstr"===e){const e=i.alloc(2*t.length);for(let r=0;r<t.length;r++)e.writeUInt16BE(t.charCodeAt(r),2*r);return this._createEncoderBuffer(e)}return"numstr"===e?this._isNumstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===e?this._isPrintstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(e)||"objDesc"===e?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: "+e+" unsupported")},h.prototype._encodeObjid=function(t,e,r){if("string"==typeof t){if(!e)return this.reporter.error("string objid given, but no values map found");if(!e.hasOwnProperty(t))return this.reporter.error("objid not found in values map");t=e[t].split(/[\s.]+/g);for(let e=0;e<t.length;e++)t[e]|=0}else if(Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]|=0}if(!Array.isArray(t))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(t));if(!r){if(t[1]>=40)return this.reporter.error("Second objid identifier OOB");t.splice(0,2,40*t[0]+t[1])}let n=0;for(let e=0;e<t.length;e++){let r=t[e];for(n++;r>=128;r>>=7)n++}const s=i.alloc(n);let a=s.length-1;for(let e=t.length-1;e>=0;e--){let r=t[e];for(s[a--]=127&r;(r>>=7)>0;)s[a--]=128|127&r}return this._createEncoderBuffer(s)},h.prototype._encodeTime=function(t,e){let r;const i=new Date(t);return"gentime"===e?r=[u(i.getUTCFullYear()),u(i.getUTCMonth()+1),u(i.getUTCDate()),u(i.getUTCHours()),u(i.getUTCMinutes()),u(i.getUTCSeconds()),"Z"].join(""):"utctime"===e?r=[u(i.getUTCFullYear()%100),u(i.getUTCMonth()+1),u(i.getUTCDate()),u(i.getUTCHours()),u(i.getUTCMinutes()),u(i.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+e+" time is not supported yet"),this._encodeStr(r,"octstr")},h.prototype._encodeNull=function(){return this._createEncoderBuffer("")},h.prototype._encodeInt=function(t,e){if("string"==typeof t){if(!e)return this.reporter.error("String int or enum given, but no values map");if(!e.hasOwnProperty(t))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(t));t=e[t]}if("number"!=typeof t&&!i.isBuffer(t)){const e=t.toArray();!t.sign&&128&e[0]&&e.unshift(0),t=i.from(e)}if(i.isBuffer(t)){let e=t.length;0===t.length&&e++;const r=i.alloc(e);return t.copy(r),0===t.length&&(r[0]=0),this._createEncoderBuffer(r)}if(t<128)return this._createEncoderBuffer(t);if(t<256)return this._createEncoderBuffer([0,t]);let r=1;for(let e=t;e>=256;e>>=8)r++;const n=new Array(r);for(let e=n.length-1;e>=0;e--)n[e]=255&t,t>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(i.from(n))},h.prototype._encodeBool=function(t){return this._createEncoderBuffer(t?255:0)},h.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getEncoder("der").tree},h.prototype._skipDefault=function(t,e,r){const i=this._baseState;let n;if(null===i.default)return!1;const s=t.join();if(void 0===i.defaultBuffer&&(i.defaultBuffer=this._encodeValue(i.default,e,r).join()),s.length!==i.defaultBuffer.length)return!1;for(n=0;n<s.length;n++)if(s[n]!==i.defaultBuffer[n])return!1;return!0}})),s.register("eoLdT",(function(t,e){var r,i=s("9Mq5w"),n=s("awmEs"),a=n.Buffer,o={};for(r in n)n.hasOwnProperty(r)&&"SlowBuffer"!==r&&"Buffer"!==r&&(o[r]=n[r]);var h=o.Buffer={};for(r in a)a.hasOwnProperty(r)&&"allocUnsafe"!==r&&"allocUnsafeSlow"!==r&&(h[r]=a[r]);if(o.Buffer.prototype=a.prototype,h.from&&h.from!==Uint8Array.from||(h.from=function(t,e,r){if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof t);if(t&&void 0===t.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);return a(t,e,r)}),h.alloc||(h.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError('The "size" argument must be of type number. Received type '+typeof t);if(t<0||t>=2147483648)throw new RangeError('The value "'+t+'" is invalid for option "size"');var i=a(t);return e&&0!==e.length?"string"==typeof r?i.fill(e,r):i.fill(e):i.fill(0),i}),!o.kStringMaxLength)try{o.kStringMaxLength=i.binding("buffer").kStringMaxLength}catch(t){}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),t.exports=o})),s.register("kNfRa",(function(t,e){var r=s("9DVK2").Reporter,i=s("iVkdG").EncoderBuffer,n=s("iVkdG").DecoderBuffer,a=s("7xO1L");const o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],h=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o);function u(t,e,r){const i={};this._baseState=i,i.name=r,i.enc=t,i.parent=e||null,i.children=null,i.tag=null,i.args=null,i.reverseArgs=null,i.choice=null,i.optional=!1,i.any=!1,i.obj=!1,i.use=null,i.useDecoder=null,i.key=null,i.default=null,i.explicit=null,i.implicit=null,i.contains=null,i.parent||(i.children=[],this._wrap())}t.exports=u;const l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];u.prototype.clone=function(){const t=this._baseState,e={};l.forEach((function(r){e[r]=t[r]}));const r=new this.constructor(e.parent);return r._baseState=e,r},u.prototype._wrap=function(){const t=this._baseState;h.forEach((function(e){this[e]=function(){const r=new this.constructor(this);return t.children.push(r),r[e].apply(r,arguments)}}),this)},u.prototype._init=function(t){const e=this._baseState;a(null===e.parent),t.call(this),e.children=e.children.filter((function(t){return t._baseState.parent===this}),this),a.equal(e.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function(t){const e=this._baseState,r=t.filter((function(t){return t instanceof this.constructor}),this);t=t.filter((function(t){return!(t instanceof this.constructor)}),this),0!==r.length&&(a(null===e.children),e.children=r,r.forEach((function(t){t._baseState.parent=this}),this)),0!==t.length&&(a(null===e.args),e.args=t,e.reverseArgs=t.map((function(t){if("object"!=typeof t||t.constructor!==Object)return t;const e={};return Object.keys(t).forEach((function(r){r==(0|r)&&(r|=0);const i=t[r];e[i]=r})),e})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(t){u.prototype[t]=function(){const e=this._baseState;throw new Error(t+" not implemented for encoding: "+e.enc)}})),o.forEach((function(t){u.prototype[t]=function(){const e=this._baseState,r=Array.prototype.slice.call(arguments);return a(null===e.tag),e.tag=t,this._useArgs(r),this}})),u.prototype.use=function(t){a(t);const e=this._baseState;return a(null===e.use),e.use=t,this},u.prototype.optional=function(){return this._baseState.optional=!0,this},u.prototype.def=function(t){const e=this._baseState;return a(null===e.default),e.default=t,e.optional=!0,this},u.prototype.explicit=function(t){const e=this._baseState;return a(null===e.explicit&&null===e.implicit),e.explicit=t,this},u.prototype.implicit=function(t){const e=this._baseState;return a(null===e.explicit&&null===e.implicit),e.implicit=t,this},u.prototype.obj=function(){const t=this._baseState,e=Array.prototype.slice.call(arguments);return t.obj=!0,0!==e.length&&this._useArgs(e),this},u.prototype.key=function(t){const e=this._baseState;return a(null===e.key),e.key=t,this},u.prototype.any=function(){return this._baseState.any=!0,this},u.prototype.choice=function(t){const e=this._baseState;return a(null===e.choice),e.choice=t,this._useArgs(Object.keys(t).map((function(e){return t[e]}))),this},u.prototype.contains=function(t){const e=this._baseState;return a(null===e.use),e.contains=t,this},u.prototype._decode=function(t,e){const r=this._baseState;if(null===r.parent)return t.wrapResult(r.children[0]._decode(t,e));let i,s=r.default,a=!0,o=null;if(null!==r.key&&(o=t.enterKey(r.key)),r.optional){let i=null;if(null!==r.explicit?i=r.explicit:null!==r.implicit?i=r.implicit:null!==r.tag&&(i=r.tag),null!==i||r.any){if(a=this._peekTag(t,i,r.any),t.isError(a))return a}else{const i=t.save();try{null===r.choice?this._decodeGeneric(r.tag,t,e):this._decodeChoice(t,e),a=!0}catch(t){a=!1}t.restore(i)}}if(r.obj&&a&&(i=t.enterObject()),a){if(null!==r.explicit){const e=this._decodeTag(t,r.explicit);if(t.isError(e))return e;t=e}const i=t.offset;if(null===r.use&&null===r.choice){let e;r.any&&(e=t.save());const i=this._decodeTag(t,null!==r.implicit?r.implicit:r.tag,r.any);if(t.isError(i))return i;r.any?s=t.raw(e):t=i}if(e&&e.track&&null!==r.tag&&e.track(t.path(),i,t.length,"tagged"),e&&e.track&&null!==r.tag&&e.track(t.path(),t.offset,t.length,"content"),r.any||(s=null===r.choice?this._decodeGeneric(r.tag,t,e):this._decodeChoice(t,e)),t.isError(s))return s;if(r.any||null!==r.choice||null===r.children||r.children.forEach((function(r){r._decode(t,e)})),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){const i=new n(s);s=this._getUse(r.contains,t._reporterState.obj)._decode(i,e)}}return r.obj&&a&&(s=t.leaveObject(i)),null===r.key||null===s&&!0!==a?null!==o&&t.exitKey(o):t.leaveKey(o,r.key,s),s},u.prototype._decodeGeneric=function(t,e,r){const i=this._baseState;return"seq"===t||"set"===t?null:"seqof"===t||"setof"===t?this._decodeList(e,t,i.args[0],r):/str$/.test(t)?this._decodeStr(e,t,r):"objid"===t&&i.args?this._decodeObjid(e,i.args[0],i.args[1],r):"objid"===t?this._decodeObjid(e,null,null,r):"gentime"===t||"utctime"===t?this._decodeTime(e,t,r):"null_"===t?this._decodeNull(e,r):"bool"===t?this._decodeBool(e,r):"objDesc"===t?this._decodeStr(e,t,r):"int"===t||"enum"===t?this._decodeInt(e,i.args&&i.args[0],r):null!==i.use?this._getUse(i.use,e._reporterState.obj)._decode(e,r):e.error("unknown tag: "+t)},u.prototype._getUse=function(t,e){const r=this._baseState;return r.useDecoder=this._use(t,e),a(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},u.prototype._decodeChoice=function(t,e){const r=this._baseState;let i=null,n=!1;return Object.keys(r.choice).some((function(s){const a=t.save(),o=r.choice[s];try{const r=o._decode(t,e);if(t.isError(r))return!1;i={type:s,value:r},n=!0}catch(e){return t.restore(a),!1}return!0}),this),n?i:t.error("Choice not matched")},u.prototype._createEncoderBuffer=function(t){return new i(t,this.reporter)},u.prototype._encode=function(t,e,r){const i=this._baseState;if(null!==i.default&&i.default===t)return;const n=this._encodeValue(t,e,r);return void 0===n||this._skipDefault(n,e,r)?void 0:n},u.prototype._encodeValue=function(t,e,i){const n=this._baseState;if(null===n.parent)return n.children[0]._encode(t,e||new r);let s=null;if(this.reporter=e,n.optional&&void 0===t){if(null===n.default)return;t=n.default}let a=null,o=!1;if(n.any)s=this._createEncoderBuffer(t);else if(n.choice)s=this._encodeChoice(t,e);else if(n.contains)a=this._getUse(n.contains,i)._encode(t,e),o=!0;else if(n.children)a=n.children.map((function(r){if("null_"===r._baseState.tag)return r._encode(null,e,t);if(null===r._baseState.key)return e.error("Child should have a key");const i=e.enterKey(r._baseState.key);if("object"!=typeof t)return e.error("Child expected, but input is not object");const n=r._encode(t[r._baseState.key],e,t);return e.leaveKey(i),n}),this).filter((function(t){return t})),a=this._createEncoderBuffer(a);else if("seqof"===n.tag||"setof"===n.tag){if(!n.args||1!==n.args.length)return e.error("Too many args for : "+n.tag);if(!Array.isArray(t))return e.error("seqof/setof, but data is not Array");const r=this.clone();r._baseState.implicit=null,a=this._createEncoderBuffer(t.map((function(r){const i=this._baseState;return this._getUse(i.args[0],t)._encode(r,e)}),r))}else null!==n.use?s=this._getUse(n.use,i)._encode(t,e):(a=this._encodePrimitive(n.tag,t),o=!0);if(!n.any&&null===n.choice){const t=null!==n.implicit?n.implicit:n.tag,r=null===n.implicit?"universal":"context";null===t?null===n.use&&e.error("Tag could be omitted only for .use()"):null===n.use&&(s=this._encodeComposite(t,o,r,a))}return null!==n.explicit&&(s=this._encodeComposite(n.explicit,!1,"context",s)),s},u.prototype._encodeChoice=function(t,e){const r=this._baseState,i=r.choice[t.type];return i||a(!1,t.type+" not found in "+JSON.stringify(Object.keys(r.choice))),i._encode(t.value,e)},u.prototype._encodePrimitive=function(t,e){const r=this._baseState;if(/str$/.test(t))return this._encodeStr(e,t);if("objid"===t&&r.args)return this._encodeObjid(e,r.reverseArgs[0],r.args[1]);if("objid"===t)return this._encodeObjid(e,null,null);if("gentime"===t||"utctime"===t)return this._encodeTime(e,t);if("null_"===t)return this._encodeNull();if("int"===t||"enum"===t)return this._encodeInt(e,r.args&&r.reverseArgs[0]);if("bool"===t)return this._encodeBool(e);if("objDesc"===t)return this._encodeStr(e,t);throw new Error("Unsupported tag: "+t)},u.prototype._isNumstr=function(t){return/^[0-9 ]*$/.test(t)},u.prototype._isPrintstr=function(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(t)}})),s.register("9DVK2",(function(t,r){var i;e(t.exports,"Reporter",(()=>i),(t=>i=t));var n=s("6cuMU");function a(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}function o(t,e){this.path=t,this.rethrow(e)}i=a,a.prototype.isError=function(t){return t instanceof o},a.prototype.save=function(){const t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}},a.prototype.restore=function(t){const e=this._reporterState;e.obj=t.obj,e.path=e.path.slice(0,t.pathLen)},a.prototype.enterKey=function(t){return this._reporterState.path.push(t)},a.prototype.exitKey=function(t){const e=this._reporterState;e.path=e.path.slice(0,t-1)},a.prototype.leaveKey=function(t,e,r){const i=this._reporterState;this.exitKey(t),null!==i.obj&&(i.obj[e]=r)},a.prototype.path=function(){return this._reporterState.path.join("/")},a.prototype.enterObject=function(){const t=this._reporterState,e=t.obj;return t.obj={},e},a.prototype.leaveObject=function(t){const e=this._reporterState,r=e.obj;return e.obj=t,r},a.prototype.error=function(t){let e;const r=this._reporterState,i=t instanceof o;if(e=i?t:new o(r.path.map((function(t){return"["+JSON.stringify(t)+"]"})).join(""),t.message||t,t.stack),!r.options.partial)throw e;return i||r.errors.push(e),e},a.prototype.wrapResult=function(t){const e=this._reporterState;return e.options.partial?{result:this.isError(t)?null:t,errors:e.errors}:t},n(o,Error),o.prototype.rethrow=function(t){if(this.message=t+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,o),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}})),s.register("iVkdG",(function(t,r){var i,n;e(t.exports,"DecoderBuffer",(()=>i),(t=>i=t)),e(t.exports,"EncoderBuffer",(()=>n),(t=>n=t));var a=s("6cuMU"),o=s("9DVK2").Reporter,h=s("eoLdT").Buffer;function u(t,e){o.call(this,e),h.isBuffer(t)?(this.base=t,this.offset=0,this.length=t.length):this.error("Input not Buffer")}function l(t,e){if(Array.isArray(t))this.length=0,this.value=t.map((function(t){return l.isEncoderBuffer(t)||(t=new l(t,e)),this.length+=t.length,t}),this);else if("number"==typeof t){if(!(0<=t&&t<=255))return e.error("non-byte EncoderBuffer value");this.value=t,this.length=1}else if("string"==typeof t)this.value=t,this.length=h.byteLength(t);else{if(!h.isBuffer(t))return e.error("Unsupported type: "+typeof t);this.value=t,this.length=t.length}}a(u,o),i=u,u.isDecoderBuffer=function(t){if(t instanceof u)return!0;return"object"==typeof t&&h.isBuffer(t.base)&&"DecoderBuffer"===t.constructor.name&&"number"==typeof t.offset&&"number"==typeof t.length&&"function"==typeof t.save&&"function"==typeof t.restore&&"function"==typeof t.isEmpty&&"function"==typeof t.readUInt8&&"function"==typeof t.skip&&"function"==typeof t.raw},u.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},u.prototype.restore=function(t){const e=new u(this.base);return e.offset=t.offset,e.length=this.offset,this.offset=t.offset,o.prototype.restore.call(this,t.reporter),e},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(t){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(t||"DecoderBuffer overrun")},u.prototype.skip=function(t,e){if(!(this.offset+t<=this.length))return this.error(e||"DecoderBuffer overrun");const r=new u(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+t,this.offset+=t,r},u.prototype.raw=function(t){return this.base.slice(t?t.offset:this.offset,this.length)},n=l,l.isEncoderBuffer=function(t){if(t instanceof l)return!0;return"object"==typeof t&&"EncoderBuffer"===t.constructor.name&&"number"==typeof t.length&&"function"==typeof t.join},l.prototype.join=function(t,e){return t||(t=h.alloc(this.length)),e||(e=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(r){r.join(t,e),e+=r.length})):("number"==typeof this.value?t[e]=this.value:"string"==typeof this.value?t.write(this.value,e):h.isBuffer(this.value)&&this.value.copy(t,e),e+=this.length)),t}})),s.register("5L1HU",(function(t,r){var i,n,s,a;function o(t){const e={};return Object.keys(t).forEach((function(r){(0|r)==r&&(r|=0);const i=t[r];e[i]=r})),e}e(t.exports,"tagClass",(()=>i),(t=>i=t)),e(t.exports,"tagClassByName",(()=>n),(t=>n=t)),e(t.exports,"tag",(()=>s),(t=>s=t)),e(t.exports,"tagByName",(()=>a),(t=>a=t)),n=o(i={0:"universal",1:"application",2:"context",3:"private"}),a=o(s={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"})})),s.register("b1Fvj",(function(t,e){var r=s("6cuMU"),i=s("g9EHu");function n(t){i.call(this,t),this.enc="pem"}r(n,i),t.exports=n,n.prototype.encode=function(t,e){const r=i.prototype.encode.call(this,t).toString("base64"),n=["-----BEGIN "+e.label+"-----"];for(let t=0;t<r.length;t+=64)n.push(r.slice(t,t+64));return n.push("-----END "+e.label+"-----"),n.join("\n")}})),s.register("185bd",(function(t,e){const r=t.exports;r.der=s("kEqVM"),r.pem=s("jSQYT")})),s.register("kEqVM",(function(t,e){var r=s("6cuMU"),i=s("g5rlv"),n=s("iVkdG").DecoderBuffer,a=s("kNfRa"),o=s("5L1HU");function h(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new u,this.tree._init(t.body)}function u(t){a.call(this,"der",t)}function l(t,e){let r=t.readUInt8(e);if(t.isError(r))return r;const i=o.tagClass[r>>6],n=0==(32&r);if(31==(31&r)){let i=r;for(r=0;128==(128&i);){if(i=t.readUInt8(e),t.isError(i))return i;r<<=7,r|=127&i}}else r&=31;return{cls:i,primitive:n,tag:r,tagStr:o.tag[r]}}function c(t,e,r){let i=t.readUInt8(r);if(t.isError(i))return i;if(!e&&128===i)return null;if(0==(128&i))return i;const n=127&i;if(n>4)return t.error("length octect is too long");i=0;for(let e=0;e<n;e++){i<<=8;const e=t.readUInt8(r);if(t.isError(e))return e;i|=e}return i}t.exports=h,h.prototype.decode=function(t,e){return n.isDecoderBuffer(t)||(t=new n(t,e)),this.tree._decode(t,e)},r(u,a),u.prototype._peekTag=function(t,e,r){if(t.isEmpty())return!1;const i=t.save(),n=l(t,'Failed to peek tag: "'+e+'"');return t.isError(n)?n:(t.restore(i),n.tag===e||n.tagStr===e||n.tagStr+"of"===e||r)},u.prototype._decodeTag=function(t,e,r){const i=l(t,'Failed to decode tag of "'+e+'"');if(t.isError(i))return i;let n=c(t,i.primitive,'Failed to get length of "'+e+'"');if(t.isError(n))return n;if(!r&&i.tag!==e&&i.tagStr!==e&&i.tagStr+"of"!==e)return t.error('Failed to match tag: "'+e+'"');if(i.primitive||null!==n)return t.skip(n,'Failed to match body of: "'+e+'"');const s=t.save(),a=this._skipUntilEnd(t,'Failed to skip indefinite length body: "'+this.tag+'"');return t.isError(a)?a:(n=t.offset-s.offset,t.restore(s),t.skip(n,'Failed to match body of: "'+e+'"'))},u.prototype._skipUntilEnd=function(t,e){for(;;){const r=l(t,e);if(t.isError(r))return r;const i=c(t,r.primitive,e);if(t.isError(i))return i;let n;if(n=r.primitive||null!==i?t.skip(i):this._skipUntilEnd(t,e),t.isError(n))return n;if("end"===r.tagStr)break}},u.prototype._decodeList=function(t,e,r,i){const n=[];for(;!t.isEmpty();){const e=this._peekTag(t,"end");if(t.isError(e))return e;const s=r.decode(t,"der",i);if(t.isError(s)&&e)break;n.push(s)}return n},u.prototype._decodeStr=function(t,e){if("bitstr"===e){const e=t.readUInt8();return t.isError(e)?e:{unused:e,data:t.raw()}}if("bmpstr"===e){const e=t.raw();if(e.length%2==1)return t.error("Decoding of string type: bmpstr length mismatch");let r="";for(let t=0;t<e.length/2;t++)r+=String.fromCharCode(e.readUInt16BE(2*t));return r}if("numstr"===e){const e=t.raw().toString("ascii");return this._isNumstr(e)?e:t.error("Decoding of string type: numstr unsupported characters")}if("octstr"===e)return t.raw();if("objDesc"===e)return t.raw();if("printstr"===e){const e=t.raw().toString("ascii");return this._isPrintstr(e)?e:t.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(e)?t.raw().toString():t.error("Decoding of string type: "+e+" unsupported")},u.prototype._decodeObjid=function(t,e,r){let i;const n=[];let s=0,a=0;for(;!t.isEmpty();)a=t.readUInt8(),s<<=7,s|=127&a,0==(128&a)&&(n.push(s),s=0);128&a&&n.push(s);const o=n[0]/40|0,h=n[0]%40;if(i=r?n:[o,h].concat(n.slice(1)),e){let t=e[i.join(" ")];void 0===t&&(t=e[i.join(".")]),void 0!==t&&(i=t)}return i},u.prototype._decodeTime=function(t,e){const r=t.raw().toString();let i,n,s,a,o,h;if("gentime"===e)i=0|r.slice(0,4),n=0|r.slice(4,6),s=0|r.slice(6,8),a=0|r.slice(8,10),o=0|r.slice(10,12),h=0|r.slice(12,14);else{if("utctime"!==e)return t.error("Decoding "+e+" time is not supported yet");i=0|r.slice(0,2),n=0|r.slice(2,4),s=0|r.slice(4,6),a=0|r.slice(6,8),o=0|r.slice(8,10),h=0|r.slice(10,12),i=i<70?2e3+i:1900+i}return Date.UTC(i,n-1,s,a,o,h,0)},u.prototype._decodeNull=function(){return null},u.prototype._decodeBool=function(t){const e=t.readUInt8();return t.isError(e)?e:0!==e},u.prototype._decodeInt=function(t,e){const r=t.raw();let n=new i(r);return e&&(n=e[n.toString(10)]||n),n},u.prototype._use=function(t,e){return"function"==typeof t&&(t=t(e)),t._getDecoder("der").tree}})),s.register("jSQYT",(function(t,e){var r=s("6cuMU"),i=s("eoLdT").Buffer,n=s("kEqVM");function a(t){n.call(this,t),this.enc="pem"}r(a,n),t.exports=a,a.prototype.decode=function(t,e){const r=t.toString().split(/[\r\n]+/g),s=e.label.toUpperCase(),a=/^-----(BEGIN|END) ([^-]+)-----$/;let o=-1,h=-1;for(let t=0;t<r.length;t++){const e=r[t].match(a);if(null!==e&&e[2]===s){if(-1!==o){if("END"!==e[1])break;h=t;break}if("BEGIN"!==e[1])break;o=t}}if(-1===o||-1===h)throw new Error("PEM section not found for: "+s);const u=r.slice(o+1,h).join("");u.replace(/[^a-z0-9+/=]+/gi,"");const l=i.from(u,"base64");return n.prototype.decode.call(this,l,e)}})),s.register("50MJM",(function(t,e){const r=t.exports;r.Reporter=s("9DVK2").Reporter,r.DecoderBuffer=s("iVkdG").DecoderBuffer,r.EncoderBuffer=s("iVkdG").EncoderBuffer,r.Node=s("kNfRa")})),s.register("eOu52",(function(t,e){const r=t.exports;r._reverse=function(t){const e={};return Object.keys(t).forEach((function(r){(0|r)==r&&(r|=0);const i=t[r];e[i]=r})),e},r.der=s("5L1HU")})),s.register("8mCBH",(function(t,e){var r=s("f6ATU"),i=r.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),n=r.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),a=r.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),o=r.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())})),h=r.define("RelativeDistinguishedName",(function(){this.setof(n)})),u=r.define("RDNSequence",(function(){this.seqof(h)})),l=r.define("Name",(function(){this.choice({rdnSequence:this.use(u)})})),c=r.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))})),f=r.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),d=r.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(l),this.key("validity").use(c),this.key("subject").use(l),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(f).optional())})),p=r.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(d),this.key("signatureAlgorithm").use(a),this.key("signatureValue").bitstr())}));t.exports=p})),s.register("bbc25",(function(t,e){t.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')})),s.register("4Uusr",(function(t,e){var r=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,n=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,a=s("afScy"),o=s("enuUj"),h=s("k0Rto").Buffer;t.exports=function(t,e){var s,u=t.toString(),l=u.match(r);if(l){var c="aes"+l[1],f=h.from(l[2],"hex"),d=h.from(l[3].replace(/[\r\n]/g,""),"base64"),p=a(e,f.slice(0,8),parseInt(l[1],10)).key,m=[],g=o.createDecipheriv(c,p,f);m.push(g.update(d)),m.push(g.final()),s=h.concat(m)}else{var v=u.match(n);s=h.from(v[2].replace(/[\r\n]/g,""),"base64")}return{tag:u.match(i)[1],data:s}}})),s.register("1zkIO",(function(t,e){t.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')})),s.register("1O2UL",(function(t,e){var r=s("k0Rto").Buffer,i=s("hMqfZ"),n=s("dEDF4").ec,a=s("8sncL"),o=s("1zkIO");function h(t,e){if(t.cmpn(0)<=0)throw new Error("invalid sig");if(t.cmp(e)>=e)throw new Error("invalid sig")}t.exports=function(t,e,s,u,l){var c=a(s);if("ec"===c.type){if("ecdsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");return function(t,e,r){var i=o[r.data.algorithm.curve.join(".")];if(!i)throw new Error("unknown curve "+r.data.algorithm.curve.join("."));var s=new n(i),a=r.data.subjectPrivateKey.data;return s.verify(e,t,a)}(t,e,c)}if("dsa"===c.type){if("dsa"!==u)throw new Error("wrong public key type");return function(t,e,r){var n=r.data.p,s=r.data.q,o=r.data.g,u=r.data.pub_key,l=a.signature.decode(t,"der"),c=l.s,f=l.r;h(c,s),h(f,s);var d=i.mont(n),p=c.invm(s),m=o.toRed(d).redPow(new i(e).mul(p).mod(s)).fromRed().mul(u.toRed(d).redPow(f.mul(p).mod(s)).fromRed()).mod(n).mod(s);return 0===m.cmp(f)}(t,e,c)}if("rsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");e=r.concat([l,e]);for(var f=c.modulus.byteLength(),d=[1],p=0;e.length+d.length+2<f;)d.push(255),p++;d.push(0);for(var m=-1;++m<e.length;)d.push(e[m]);d=r.from(d);var g=i.mont(c.modulus);t=(t=new i(t).toRed(g)).redPow(new i(c.publicExponent)),t=r.from(t.fromRed().toArray());var v=p<8?1:0;for(f=Math.min(t.length,d.length),t.length!==d.length&&(v=1),m=-1;++m<f;)v|=t[m]^d[m];return 0===v}})),s.register("1R43x",(function(t,e){var r=s("awmEs").Buffer,i=s("dEDF4"),n=s("g5rlv");t.exports=function(t){return new o(t)};var a={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(t){this.curveType=a[t],this.curveType||(this.curveType={name:t}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function h(t,e,i){Array.isArray(t)||(t=t.toArray());var n=new r(t);if(i&&n.length<i){var s=new r(i-n.length);s.fill(0),n=r.concat([s,n])}return e?n.toString(e):n}a.p224=a.secp224r1,a.p256=a.secp256r1=a.prime256v1,a.p192=a.secp192r1=a.prime192v1,a.p384=a.secp384r1,a.p521=a.secp521r1,o.prototype.generateKeys=function(t,e){return this.keys=this.curve.genKeyPair(),this.getPublicKey(t,e)},o.prototype.computeSecret=function(t,e,i){return e=e||"utf8",r.isBuffer(t)||(t=new r(t,e)),h(this.curve.keyFromPublic(t).getPublic().mul(this.keys.getPrivate()).getX(),i,this.curveType.byteLength)},o.prototype.getPublicKey=function(t,e){var r=this.keys.getPublic("compressed"===e,!0);return"hybrid"===e&&(r[r.length-1]%2?r[0]=7:r[0]=6),h(r,t)},o.prototype.getPrivateKey=function(t){return h(this.keys.getPrivate(),t)},o.prototype.setPublicKey=function(t,e){return e=e||"utf8",r.isBuffer(t)||(t=new r(t,e)),this.keys._importPublic(t),this},o.prototype.setPrivateKey=function(t,e){e=e||"utf8",r.isBuffer(t)||(t=new r(t,e));var i=new n(t);return i=i.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(i),this}})),s.register("8oudU",(function(t,r){var i,n,a,o;e(t.exports,"publicEncrypt",(()=>i),(t=>i=t)),e(t.exports,"privateDecrypt",(()=>n),(t=>n=t)),e(t.exports,"privateEncrypt",(()=>a),(t=>a=t)),e(t.exports,"publicDecrypt",(()=>o),(t=>o=t)),i=s("8czDH"),n=s("dyX7s"),a=function(t,e){return i(t,e,!0)},o=function(t,e){return n(t,e,!0)}})),s.register("8czDH",(function(t,e){var r=s("8sncL"),i=s("1oa4b"),n=s("eRLLs"),a=s("gd7QM"),o=s("ehVLm"),h=s("g5rlv"),u=s("3ppIS"),l=s("7wEKJ"),c=s("k0Rto").Buffer;t.exports=function(t,e,s){var f;f=t.padding?t.padding:s?1:4;var d,p=r(t);if(4===f)d=function(t,e){var r=t.modulus.byteLength(),s=e.length,u=n("sha1").update(c.alloc(0)).digest(),l=u.length,f=2*l;if(s>r-f-2)throw new Error("message too long");var d=c.alloc(r-s-f-2),p=r-l-1,m=i(l),g=o(c.concat([u,d,c.alloc(1,1),e],p),a(m,p)),v=o(m,a(g,l));return new h(c.concat([c.alloc(1),v,g],r))}(p,e);else if(1===f)d=function(t,e,r){var n,s=e.length,a=t.modulus.byteLength();if(s>a-11)throw new Error("message too long");n=r?c.alloc(a-s-3,255):function(t){var e,r=c.allocUnsafe(t),n=0,s=i(2*t),a=0;for(;n<t;)a===s.length&&(s=i(2*t),a=0),(e=s[a++])&&(r[n++]=e);return r}(a-s-3);return new h(c.concat([c.from([0,r?1:2]),n,c.alloc(1),e],a))}(p,e,s);else{if(3!==f)throw new Error("unknown padding");if((d=new h(e)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return s?l(d,p):u(d,p)}})),s.register("gd7QM",(function(t,e){var r=s("eRLLs"),i=s("k0Rto").Buffer;function n(t){var e=i.allocUnsafe(4);return e.writeUInt32BE(t,0),e}t.exports=function(t,e){for(var s,a=i.alloc(0),o=0;a.length<e;)s=n(o++),a=i.concat([a,r("sha1").update(t).update(s).digest()]);return a.slice(0,e)}})),s.register("ehVLm",(function(t,e){t.exports=function(t,e){for(var r=t.length,i=-1;++i<r;)t[i]^=e[i];return t}})),s.register("3ppIS",(function(t,e){var r=s("g5rlv"),i=s("k0Rto").Buffer;t.exports=function(t,e){return i.from(t.toRed(r.mont(e.modulus)).redPow(new r(e.publicExponent)).fromRed().toArray())}})),s.register("dyX7s",(function(t,e){var r=s("8sncL"),i=s("gd7QM"),n=s("ehVLm"),a=s("g5rlv"),o=s("7wEKJ"),h=s("eRLLs"),u=s("3ppIS"),l=s("k0Rto").Buffer;t.exports=function(t,e,s){var c;c=t.padding?t.padding:s?1:4;var f,d=r(t),p=d.modulus.byteLength();if(e.length>p||new a(e).cmp(d.modulus)>=0)throw new Error("decryption error");f=s?u(new a(e),d):o(e,d);var m=l.alloc(p-f.length);if(f=l.concat([m,f],p),4===c)return function(t,e){var r=t.modulus.byteLength(),s=h("sha1").update(l.alloc(0)).digest(),a=s.length;if(0!==e[0])throw new Error("decryption error");var o=e.slice(1,a+1),u=e.slice(a+1),c=n(o,i(u,a)),f=n(u,i(c,r-a-1));if(function(t,e){t=l.from(t),e=l.from(e);var r=0,i=t.length;t.length!==e.length&&(r++,i=Math.min(t.length,e.length));var n=-1;for(;++n<i;)r+=t[n]^e[n];return r}(s,f.slice(0,a)))throw new Error("decryption error");var d=a;for(;0===f[d];)d++;if(1!==f[d++])throw new Error("decryption error");return f.slice(d)}(d,f);if(1===c)return function(t,e,r){var i=e.slice(0,2),n=2,s=0;for(;0!==e[n++];)if(n>=e.length){s++;break}var a=e.slice(2,n-1);("0002"!==i.toString("hex")&&!r||"0001"!==i.toString("hex")&&r)&&s++;a.length<8&&s++;if(s)throw new Error("decryption error");return e.slice(n)}(0,f,s);if(3===c)return f;throw new Error("unknown padding")}})),s.register("bxyoK",(function(r,i){var n,a;e(r.exports,"randomFill",(()=>n),(t=>n=t)),e(r.exports,"randomFillSync",(()=>a),(t=>a=t));var o=s("9Mq5w");function h(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var u=s("k0Rto"),l=(s("1oa4b"),u.Buffer),c=u.kMaxLength,f=t.crypto||t.msCrypto,d=Math.pow(2,32)-1;function p(t,e){if("number"!=typeof t||t!=t)throw new TypeError("offset must be a number");if(t>d||t<0)throw new TypeError("offset must be a uint32");if(t>c||t>e)throw new RangeError("offset out of range")}function m(t,e,r){if("number"!=typeof t||t!=t)throw new TypeError("size must be a number");if(t>d||t<0)throw new TypeError("size must be a uint32");if(t+e>r||t>c)throw new RangeError("buffer too small")}function g(t,e,r,i){var n=t.buffer,s=new Uint8Array(n,e,r);if(f.getRandomValues(s),!i)return t;o.nextTick((function(){i(null,t)}))}f&&f.getRandomValues?(n=function(e,r,i,n){if(!(l.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof r)n=r,r=0,i=e.length;else if("function"==typeof i)n=i,i=e.length-r;else if("function"!=typeof n)throw new TypeError('"cb" argument must be a function');return p(r,e.length),m(i,r,e.length),g(e,r,i,n)},a=function(e,r,i){void 0===r&&(r=0);if(!(l.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');p(r,e.length),void 0===i&&(i=e.length-r);return m(i,r,e.length),g(e,r,i)}):(n=h,a=h)}));var a=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(a||{}),o=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(o||{}),h=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(h||{}),u=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(u||{}),l=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(l||{}),c=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(c||{}),f=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(f||{}),d=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(d||{}),p=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(p||{}),m=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(m||{}),g=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(g||{}),v=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(v||{}),_=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(_||{}),b=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(b||{}),y=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(y||{}),x=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(x||{}),w=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(w||{}),E=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(E||{}),M=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(M||{});const S={ADAPTER:{createCanvas:(t,e)=>{const r=document.createElement("canvas");return r.width=t,r.height=e,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var A=/iPhone/i,T=/iPod/i,C=/iPad/i,D=/\biOS-universal(?:.+)Mac\b/i,R=/\bAndroid(?:.+)Mobile\b/i,I=/Android/i,P=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,N=/Silk/i,k=/Windows Phone/i,B=/\bWindows(?:.+)ARM\b/i,L=/BlackBerry/i,O=/BB10/i,F=/Opera Mini/i,U=/\b(CriOS|Chrome)(?:.+)Mobile/i,z=/Mobile(?:.+)Firefox\b/i,G=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function H(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,i=r.split("[FBAN");void 0!==i[1]&&(r=i[0]),void 0!==(i=r.split("Twitter"))[1]&&(r=i[0]);var n=function(t){return function(e){return e.test(t)}}(r),s={apple:{phone:n(A)&&!n(k),ipod:n(T),tablet:!n(A)&&(n(C)||G(e))&&!n(k),universal:n(D),device:(n(A)||n(T)||n(C)||n(D)||G(e))&&!n(k)},amazon:{phone:n(P),tablet:!n(P)&&n(N),device:n(P)||n(N)},android:{phone:!n(k)&&n(P)||!n(k)&&n(R),tablet:!n(k)&&!n(P)&&!n(R)&&(n(N)||n(I)),device:!n(k)&&(n(P)||n(N)||n(R)||n(I))||n(/\bokhttp\b/i)},windows:{phone:n(k),tablet:n(B),device:n(k)||n(B)},other:{blackberry:n(L),blackberry10:n(O),opera:n(F),firefox:n(z),chrome:n(U),device:n(L)||n(O)||n(F)||n(z)||n(U)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const j=(H.default??H)(globalThis.navigator);var V={};e(V,"isMobile",(()=>j)),e(V,"EventEmitter",(()=>r(W))),e(V,"earcut",(()=>r(rt))),e(V,"url",(()=>Xt)),e(V,"path",(()=>$t)),e(V,"sayHello",(()=>te)),e(V,"skipHello",(()=>Qt)),e(V,"isWebGLSupported",(()=>re)),e(V,"hex2rgb",(()=>ke)),e(V,"hex2string",(()=>Be)),e(V,"rgb2hex",(()=>Oe)),e(V,"string2hex",(()=>Le)),e(V,"correctBlendMode",(()=>Ue)),e(V,"premultiplyBlendMode",(()=>Fe)),e(V,"premultiplyRgba",(()=>ze)),e(V,"premultiplyTint",(()=>Ge)),e(V,"premultiplyTintToRgba",(()=>He)),e(V,"DATA_URI",(()=>je)),e(V,"createIndicesForQuads",(()=>Ve)),e(V,"getBufferType",(()=>We)),e(V,"interleaveTypedArrays",(()=>Xe)),e(V,"isPow2",(()=>Ze)),e(V,"log2",(()=>$e)),e(V,"nextPow2",(()=>Ye)),e(V,"removeItems",(()=>Ke)),e(V,"sign",(()=>Je)),e(V,"uid",(()=>tr)),e(V,"deprecation",(()=>Jt)),e(V,"BoundingBox",(()=>rr)),e(V,"BaseTextureCache",(()=>sr)),e(V,"ProgramCache",(()=>ir)),e(V,"TextureCache",(()=>nr)),e(V,"clearTextureCache",(()=>or)),e(V,"destroyTextureCache",(()=>ar)),e(V,"CanvasRenderTarget",(()=>hr)),e(V,"getCanvasBoundingBox",(()=>cr)),e(V,"trimCanvas",(()=>fr)),e(V,"decomposeDataUri",(()=>dr)),e(V,"determineCrossOrigin",(()=>mr)),e(V,"getResolutionOfUrl",(()=>gr)),S.RETINA_PREFIX=/@([0-9\.]+)x/,S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var W={},q=Object.prototype.hasOwnProperty,X="~";function Y(){}function Z(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function $(t,e,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new Z(r,i||t,n),a=X?X+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function K(t,e){0==--t._eventsCount?t._events=new Y:delete t._events[e]}function J(){this._events=new Y,this._eventsCount=0}Object.create&&(Y.prototype=Object.create(null),(new Y).__proto__||(X=!1)),J.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)q.call(t,e)&&r.push(X?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},J.prototype.listeners=function(t){var e=X?X+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,s=new Array(n);i<n;i++)s[i]=r[i].fn;return s},J.prototype.listenerCount=function(t){var e=X?X+t:t,r=this._events[e];return r?r.fn?1:r.length:0},J.prototype.emit=function(t,e,r,i,n,s){var a=X?X+t:t;if(!this._events[a])return!1;var o,h,u=this._events[a],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,i),!0;case 5:return u.fn.call(u.context,e,r,i,n),!0;case 6:return u.fn.call(u.context,e,r,i,n,s),!0}for(h=1,o=new Array(l-1);h<l;h++)o[h-1]=arguments[h];u.fn.apply(u.context,o)}else{var c,f=u.length;for(h=0;h<f;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),l){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,i);break;default:if(!o)for(c=1,o=new Array(l-1);c<l;c++)o[c-1]=arguments[c];u[h].fn.apply(u[h].context,o)}}return!0},J.prototype.on=function(t,e,r){return $(this,t,e,r,!1)},J.prototype.once=function(t,e,r){return $(this,t,e,r,!0)},J.prototype.removeListener=function(t,e,r,i){var n=X?X+t:t;if(!this._events[n])return this;if(!e)return K(this,n),this;var s=this._events[n];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||K(this,n);else{for(var a=0,o=[],h=s.length;a<h;a++)(s[a].fn!==e||i&&!s[a].once||r&&s[a].context!==r)&&o.push(s[a]);o.length?this._events[n]=1===o.length?o[0]:o:K(this,n)}return this},J.prototype.removeAllListeners=function(t){var e;return t?(e=X?X+t:t,this._events[e]&&K(this,e)):(this._events=new Y,this._eventsCount=0),this},J.prototype.off=J.prototype.removeListener,J.prototype.addListener=J.prototype.on,J.prefixed=X,J.EventEmitter=J,W=J;var Q,tt,et,rt={};function it(t,e,r){r=r||2;var i,n,s,a,o,h,u,l=e&&e.length,c=l?e[0]*r:t.length,f=nt(t,0,c,r,!0),d=[];if(!f||f.next===f.prev)return d;if(l&&(f=function(t,e,r,i){var n,s,a,o=[];for(n=0,s=e.length;n<s;n++)(a=nt(t,e[n]*i,n<s-1?e[n+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),o.push(mt(a));for(o.sort(ct),n=0;n<o.length;n++)r=ft(o[n],r);return r}(t,e,f,r)),t.length>80*r){i=s=t[0],n=a=t[1];for(var p=r;p<c;p+=r)(o=t[p])<i&&(i=o),(h=t[p+1])<n&&(n=h),o>s&&(s=o),h>a&&(a=h);u=0!==(u=Math.max(s-i,a-n))?32767/u:0}return at(f,d,r,i,n,u,0),d}function nt(t,e,r,i,n){var s,a;if(n===Ct(t,e,r,i)>0)for(s=e;s<r;s+=i)a=St(s,t[s],t[s+1],a);else for(s=r-i;s>=e;s-=i)a=St(s,t[s],t[s+1],a);return a&&bt(a,a.next)&&(At(a),a=a.next),a}function st(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!bt(i,i.next)&&0!==_t(i.prev,i,i.next))i=i.next;else{if(At(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function at(t,e,r,i,n,s,a){if(t){!a&&s&&function(t,e,r,i){var n=t;do{0===n.z&&(n.z=pt(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,s,a,o,h,u=1;do{for(r=t,t=null,s=null,a=0;r;){for(a++,i=r,o=0,e=0;e<u&&(o++,i=i.nextZ);e++);for(h=u;o>0||h>0&&i;)0!==o&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;r=i}s.nextZ=null,u*=2}while(a>1)}(n)}(t,i,n,s);for(var o,h,u=t;t.prev!==t.next;)if(o=t.prev,h=t.next,s?ht(t,i,n,s):ot(t))e.push(o.i/r|0),e.push(t.i/r|0),e.push(h.i/r|0),At(t),t=h.next,u=h.next;else if((t=h)===u){a?1===a?at(t=ut(st(t),e,r),e,r,i,n,s,2):2===a&&lt(t,e,r,i,n,s):at(st(t),e,r,i,n,s,1);break}}}function ot(t){var e=t.prev,r=t,i=t.next;if(_t(e,r,i)>=0)return!1;for(var n=e.x,s=r.x,a=i.x,o=e.y,h=r.y,u=i.y,l=n<s?n<a?n:a:s<a?s:a,c=o<h?o<u?o:u:h<u?h:u,f=n>s?n>a?n:a:s>a?s:a,d=o>h?o>u?o:u:h>u?h:u,p=i.next;p!==e;){if(p.x>=l&&p.x<=f&&p.y>=c&&p.y<=d&&gt(n,o,s,h,a,u,p.x,p.y)&&_t(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function ht(t,e,r,i){var n=t.prev,s=t,a=t.next;if(_t(n,s,a)>=0)return!1;for(var o=n.x,h=s.x,u=a.x,l=n.y,c=s.y,f=a.y,d=o<h?o<u?o:u:h<u?h:u,p=l<c?l<f?l:f:c<f?c:f,m=o>h?o>u?o:u:h>u?h:u,g=l>c?l>f?l:f:c>f?c:f,v=pt(d,p,e,r,i),_=pt(m,g,e,r,i),b=t.prevZ,y=t.nextZ;b&&b.z>=v&&y&&y.z<=_;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==n&&b!==a&&gt(o,l,h,c,u,f,b.x,b.y)&&_t(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,y.x>=d&&y.x<=m&&y.y>=p&&y.y<=g&&y!==n&&y!==a&&gt(o,l,h,c,u,f,y.x,y.y)&&_t(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;b&&b.z>=v;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==n&&b!==a&&gt(o,l,h,c,u,f,b.x,b.y)&&_t(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;y&&y.z<=_;){if(y.x>=d&&y.x<=m&&y.y>=p&&y.y<=g&&y!==n&&y!==a&&gt(o,l,h,c,u,f,y.x,y.y)&&_t(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function ut(t,e,r){var i=t;do{var n=i.prev,s=i.next.next;!bt(n,s)&&yt(n,i,i.next,s)&&Et(n,s)&&Et(s,n)&&(e.push(n.i/r|0),e.push(i.i/r|0),e.push(s.i/r|0),At(i),At(i.next),i=t=s),i=i.next}while(i!==t);return st(i)}function lt(t,e,r,i,n,s){var a=t;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&vt(a,o)){var h=Mt(a,o);return a=st(a,a.next),h=st(h,h.next),at(a,e,r,i,n,s,0),void at(h,e,r,i,n,s,0)}o=o.next}a=a.next}while(a!==t)}function ct(t,e){return t.x-e.x}function ft(t,e){var r=function(t,e){var r,i=e,n=t.x,s=t.y,a=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var o=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>a&&(a=o,r=i.x<i.next.x?i:i.next,o===n))return r}i=i.next}while(i!==e);if(!r)return null;var h,u=r,l=r.x,c=r.y,f=1/0;i=r;do{n>=i.x&&i.x>=l&&n!==i.x&&gt(s<c?n:a,s,l,c,s<c?a:n,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(n-i.x),Et(i,t)&&(h<f||h===f&&(i.x>r.x||i.x===r.x&&dt(r,i)))&&(r=i,f=h)),i=i.next}while(i!==u);return r}(t,e);if(!r)return e;var i=Mt(r,t);return st(i,i.next),st(r,r.next)}function dt(t,e){return _t(t.prev,t,e.prev)<0&&_t(e.next,t,t.next)<0}function pt(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mt(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function gt(t,e,r,i,n,s,a,o){return(n-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(r-a)*(e-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function vt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&yt(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(Et(t,e)&&Et(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)&&(_t(t.prev,t,e.prev)||_t(t,e.prev,e))||bt(t,e)&&_t(t.prev,t,t.next)>0&&_t(e.prev,e,e.next)>0)}function _t(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function bt(t,e){return t.x===e.x&&t.y===e.y}function yt(t,e,r,i){var n=wt(_t(t,e,r)),s=wt(_t(t,e,i)),a=wt(_t(r,i,t)),o=wt(_t(r,i,e));return n!==s&&a!==o||(!(0!==n||!xt(t,r,e))||(!(0!==s||!xt(t,i,e))||(!(0!==a||!xt(r,t,i))||!(0!==o||!xt(r,e,i)))))}function xt(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function wt(t){return t>0?1:t<0?-1:0}function Et(t,e){return _t(t.prev,t,t.next)<0?_t(t,e,t.next)>=0&&_t(t,t.prev,e)>=0:_t(t,e,t.prev)<0||_t(t,t.next,e)<0}function Mt(t,e){var r=new Tt(t.i,t.x,t.y),i=new Tt(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function St(t,e,r,i){var n=new Tt(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function At(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Tt(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ct(t,e,r,i){for(var n=0,s=e,a=r-i;s<r;s+=i)n+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return n}(rt=it).default=it,it.deviation=function(t,e,r,i){var n=e&&e.length,s=n?e[0]*r:t.length,a=Math.abs(Ct(t,0,s,r));if(n)for(var o=0,h=e.length;o<h;o++){var u=e[o]*r,l=o<h-1?e[o+1]*r:t.length;a-=Math.abs(Ct(t,u,l,r))}var c=0;for(o=0;o<i.length;o+=3){var f=i[o]*r,d=i[o+1]*r,p=i[o+2]*r;c+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},it.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var a=0;a<e;a++)r.vertices.push(t[n][s][a]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r};var Dt,Rt=s("iuZoh");function It(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}Dt={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}},Q=qt,tt=function(t,e){return qt(t,!1,!0).resolve(e)},et=function(t){Dt.isString(t)&&(t=qt(t));return t instanceof It?t.format():It.prototype.format.call(t)};var Pt,Nt,kt=/^([a-z0-9.+-]+:)/i,Bt=/:[0-9]*$/,Lt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ot=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Ft=["'"].concat(Ot),Ut=["%","/","?",";","#"].concat(Ft),zt=["/","?","#"],Gt=/^[+a-z0-9A-Z_-]{0,63}$/,Ht=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jt={javascript:!0,"javascript:":!0},Vt={javascript:!0,"javascript:":!0},Wt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function qt(t,e,r){if(t&&Dt.isObject(t)&&t instanceof It)return t;var i=new It;return i.parse(t,e,r),i}Pt=s("bu5IZ"),Nt=s("4gCs1"),It.prototype.parse=function(t,e,r){if(!Dt.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),n=-1!==i&&i<t.indexOf("#")?"?":"#",s=t.split(n);s[0]=s[0].replace(/\\/g,"/");var a=t=s.join(n);if(a=a.trim(),!r&&1===t.split("#").length){var o=Lt.exec(a);if(o)return this.path=a,this.href=a,this.pathname=o[1],o[2]?(this.search=o[2],this.query=e?Pt(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=kt.exec(a);if(h){var u=(h=h[0]).toLowerCase();this.protocol=u,a=a.substr(h.length)}if(r||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===a.substr(0,2);!l||h&&Vt[h]||(a=a.substr(2),this.slashes=!0)}if(!Vt[h]&&(l||h&&!Wt[h])){for(var c,f,d=-1,p=0;p<zt.length;p++){-1!==(m=a.indexOf(zt[p]))&&(-1===d||m<d)&&(d=m)}-1!==(f=-1===d?a.lastIndexOf("@"):a.lastIndexOf("@",d))&&(c=a.slice(0,f),a=a.slice(f+1),this.auth=decodeURIComponent(c)),d=-1;for(p=0;p<Ut.length;p++){var m;-1!==(m=a.indexOf(Ut[p]))&&(-1===d||m<d)&&(d=m)}-1===d&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var v=this.hostname.split(/\./),_=(p=0,v.length);p<_;p++){var b=v[p];if(b&&!b.match(Gt)){for(var y="",x=0,w=b.length;x<w;x++)b.charCodeAt(x)>127?y+="x":y+=b[x];if(!y.match(Gt)){var E=v.slice(0,p),M=v.slice(p+1),S=b.match(Ht);S&&(E.push(S[1]),M.unshift(S[2])),M.length&&(a="/"+M.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Rt.toASCII(this.hostname));var A=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+A,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!jt[u])for(p=0,_=Ft.length;p<_;p++){var C=Ft[p];if(-1!==a.indexOf(C)){var D=encodeURIComponent(C);D===C&&(D=escape(C)),a=a.split(C).join(D)}}var R=a.indexOf("#");-1!==R&&(this.hash=a.substr(R),a=a.slice(0,R));var I=a.indexOf("?");if(-1!==I?(this.search=a.substr(I),this.query=a.substr(I+1),e&&(this.query=Pt(this.query)),a=a.slice(0,I)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Wt[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var P=this.search||"";this.path=A+P}return this.href=this.format(),this},It.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&Dt.isObject(this.query)&&Object.keys(this.query).length&&(s=Nt(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Wt[e])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),e+n+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+i},It.prototype.resolve=function(t){return this.resolveObject(qt(t,!1,!0)).format()},It.prototype.resolveObject=function(t){if(Dt.isString(t)){var e=new It;e.parse(t,!1,!0),t=e}for(var r=new It,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];r[s]=this[s]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),o=0;o<a.length;o++){var h=a[o];"protocol"!==h&&(r[h]=t[h])}return Wt[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Wt[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];r[c]=t[c]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||Vt[t.protocol])r.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var d=r.pathname||"",p=r.search||"";r.path=d+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||m||r.host&&t.pathname,_=v,b=r.pathname&&r.pathname.split("/")||[],y=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!Wt[r.protocol]);if(y&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),v=v&&(""===f[0]||""===b[0])),g)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),r.search=t.search,r.query=t.query;else if(!Dt.isNullOrUndefined(t.search)){if(y)r.hostname=r.host=b.shift(),(S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift());return r.search=t.search,r.query=t.query,Dt.isNull(r.pathname)&&Dt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=b.slice(-1)[0],w=(r.host||t.host||b.length>1)&&("."===x||".."===x)||""===x,E=0,M=b.length;M>=0;M--)"."===(x=b[M])?b.splice(M,1):".."===x?(b.splice(M,1),E++):E&&(b.splice(M,1),E--);if(!v&&!_)for(;E--;E)b.unshift("..");!v||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),w&&"/"!==b.join("/").substr(-1)&&b.push("");var S,A=""===b[0]||b[0]&&"/"===b[0].charAt(0);y&&(r.hostname=r.host=A?"":b.length?b.shift():"",(S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift()));return(v=v||r.host&&b.length)&&!A&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),Dt.isNull(r.pathname)&&Dt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},It.prototype.parseHost=function(){var t=this.host,e=Bt.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const Xt={parse:Q,format:et,resolve:tt};function Yt(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Zt(t){return t.split("?")[0].split("#")[0]}const $t={toPosix(t){return e="\\",r="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),r);var e,r},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){Yt(t),t=this.toPosix(t);let e="";const r=/^file:\/\/\//.exec(t),i=/^[^/:]+:\/\//.exec(t),n=/^[^/:]+:\//.exec(t);if(r||i||n){const s=r?.[0]||i?.[0]||n?.[0];e=s,t=t.slice(s.length)}return e},toAbsolute(t,e,r){if(this.isDataUrl(t))return t;const i=Zt(this.toPosix(e??S.ADAPTER.getBaseUrl())),n=Zt(this.toPosix(r??this.rootname(i)));if(Yt(t),(t=this.toPosix(t)).startsWith("/"))return $t.join(n,t.slice(1));return this.isAbsolute(t)?t:this.join(i,t)},normalize(t){if(Yt(t=this.toPosix(t)),0===t.length)return".";let e="";const r=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const i=t.endsWith("/");return(t=function(t,e){let r="",i=0,n=-1,s=0,a=-1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(47===a)break;a=47}if(47===a){if(n===o-1||1===s);else if(n!==o-1&&2===s){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){const t=r.lastIndexOf("/");if(t!==r.length-1){-1===t?(r="",i=0):(r=r.slice(0,t),i=r.length-1-r.lastIndexOf("/")),n=o,s=0;continue}}else if(2===r.length||1===r.length){r="",i=0,n=o,s=0;continue}e&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${t.slice(n+1,o)}`:r=t.slice(n+1,o),i=o-n-1;n=o,s=0}else 46===a&&-1!==s?++s:s=-1}return r}(t,!1)).length>0&&i&&(t+="/"),r?`/${t}`:e+t},isAbsolute(t){return Yt(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let r=0;r<t.length;++r){const i=t[r];if(Yt(i),i.length>0)if(void 0===e)e=i;else{const n=t[r-1]??"";this.extname(n)?e+=`/../${i}`:e+=`/${i}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(Yt(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const r=47===e;let i=-1,n=!0;const s=this.getProtocol(t),a=t;for(let r=(t=t.slice(s.length)).length-1;r>=1;--r)if(e=t.charCodeAt(r),47===e){if(!n){i=r;break}}else n=!1;return-1===i?r?"/":this.isUrl(a)?s+t:s:r&&1===i?"//":s+t.slice(0,i)},rootname(t){Yt(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const r=t.indexOf("/",e.length);e=-1!==r?t.slice(0,r):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){Yt(t),e&&Yt(e),t=Zt(this.toPosix(t));let r,i=0,n=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(r=t.length-1;r>=0;--r){const h=t.charCodeAt(r);if(47===h){if(!s){i=r+1;break}}else-1===o&&(s=!1,o=r+1),a>=0&&(h===e.charCodeAt(a)?-1==--a&&(n=r):(a=-1,n=o))}return i===n?n=o:-1===n&&(n=t.length),t.slice(i,n)}for(r=t.length-1;r>=0;--r)if(47===t.charCodeAt(r)){if(!s){i=r+1;break}}else-1===n&&(s=!1,n=r+1);return-1===n?"":t.slice(i,n)},extname(t){Yt(t);let e=-1,r=0,i=-1,n=!0,s=0;for(let a=(t=Zt(this.toPosix(t))).length-1;a>=0;--a){const o=t.charCodeAt(a);if(47!==o)-1===i&&(n=!1,i=a+1),46===o?-1===e?e=a:1!==s&&(s=1):-1!==e&&(s=-1);else if(!n){r=a+1;break}}return-1===e||-1===i||0===s||1===s&&e===i-1&&e===r+1?"":t.slice(e,i)},parse(t){Yt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let r=(t=Zt(this.toPosix(t))).charCodeAt(0);const i=this.isAbsolute(t);let n;e.root=this.rootname(t),n=i||this.hasProtocol(t)?1:0;let s=-1,a=0,o=-1,h=!0,u=t.length-1,l=0;for(;u>=n;--u)if(r=t.charCodeAt(u),47!==r)-1===o&&(h=!1,o=u+1),46===r?-1===s?s=u:1!==l&&(l=1):-1!==s&&(l=-1);else if(!h){a=u+1;break}return-1===s||-1===o||0===l||1===l&&s===o-1&&s===a+1?-1!==o&&(e.base=e.name=0===a&&i?t.slice(1,o):t.slice(a,o)):(0===a&&i?(e.name=t.slice(1,s),e.base=t.slice(1,o)):(e.name=t.slice(a,s),e.base=t.slice(a,o)),e.ext=t.slice(s,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"},Kt={};function Jt(t,e,r=3){if(Kt[e])return;let i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(i=i.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(i))),Kt[e]=!0}function Qt(){Jt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function te(){Jt("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}let ee;function re(){return void 0===ee&&(ee=function(){const t={stencil:!0,failIfMajorPerformanceCaveat:S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!S.ADAPTER.getWebGLRenderingContext())return!1;const e=S.ADAPTER.createCanvas();let r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);const i=!!r?.getContextAttributes()?.stencil;if(r){const t=r.getExtension("WEBGL_lose_context");t&&t.loseContext()}return r=null,i}catch(t){return!1}}()),ee}var ie,ne={grad:.9,turn:360,rad:360/(2*Math.PI)},se=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},ae=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},oe=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),t>r?r:t>e?t:e},he=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},ue=function(t){return{r:oe(t.r,0,255),g:oe(t.g,0,255),b:oe(t.b,0,255),a:oe(t.a)}},le=function(t){return{r:ae(t.r),g:ae(t.g),b:ae(t.b),a:ae(t.a,3)}},ce=/^#([0-9a-f]{3,8})$/i,fe=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},de=function(t){var e=t.r,r=t.g,i=t.b,n=t.a,s=Math.max(e,r,i),a=s-Math.min(e,r,i),o=a?s===e?(r-i)/a:s===r?2+(i-e)/a:4+(e-r)/a:0;return{h:60*(o<0?o+6:o),s:s?a/s*100:0,v:s/255*100,a:n}},pe=function(t){var e=t.h,r=t.s,i=t.v,n=t.a;e=e/360*6,r/=100,i/=100;var s=Math.floor(e),a=i*(1-r),o=i*(1-(e-s)*r),h=i*(1-(1-e+s)*r),u=s%6;return{r:255*[i,o,a,a,h,i][u],g:255*[h,i,i,o,a,a][u],b:255*[a,a,h,i,i,o][u],a:n}},me=function(t){return{h:he(t.h),s:oe(t.s,0,100),l:oe(t.l,0,100),a:oe(t.a)}},ge=function(t){return{h:ae(t.h),s:ae(t.s),l:ae(t.l),a:ae(t.a,3)}},ve=function(t){var e,r,i;return pe((r=(e=t).s,{h:e.h,s:(r*=((i=e.l)<50?i:100-i)/100)>0?2*r/(i+r)*100:0,v:i+r,a:e.a}))},_e=function(t){var e,r,i,n;return{h:(e=de(t)).h,s:(n=(200-(r=e.s))*(i=e.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:e.a}},be=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ye=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,we=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ee={string:[[function(t){var e=ce.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?ae(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?ae(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=xe.exec(t)||we.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:ue({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=be.exec(t)||ye.exec(t);if(!e)return null;var r,i,n=me({h:(r=e[1],i=e[2],void 0===i&&(i="deg"),Number(r)*(ne[i]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return ve(n)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,i=t.b,n=t.a,s=void 0===n?1:n;return se(e)&&se(r)&&se(i)?ue({r:Number(e),g:Number(r),b:Number(i),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,r=t.s,i=t.l,n=t.a,s=void 0===n?1:n;if(!se(e)||!se(r)||!se(i))return null;var a=me({h:Number(e),s:Number(r),l:Number(i),a:Number(s)});return ve(a)},"hsl"],[function(t){var e=t.h,r=t.s,i=t.v,n=t.a,s=void 0===n?1:n;if(!se(e)||!se(r)||!se(i))return null;var a=function(t){return{h:he(t.h),s:oe(t.s,0,100),v:oe(t.v,0,100),a:oe(t.a)}}({h:Number(e),s:Number(r),v:Number(i),a:Number(s)});return pe(a)},"hsv"]]},Me=function(t,e){for(var r=0;r<e.length;r++){var i=e[r][0](t);if(i)return[i,e[r][1]]}return[null,void 0]},Se=function(t){return"string"==typeof t?Me(t.trim(),Ee.string):"object"==typeof t&&null!==t?Me(t,Ee.object):[null,void 0]},Ae=function(t,e){var r=_e(t);return{h:r.h,s:oe(r.s+100*e,0,100),l:r.l,a:r.a}},Te=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Ce=function(t,e){var r=_e(t);return{h:r.h,s:r.s,l:oe(r.l+100*e,0,100),a:r.a}},De=function(){function t(t){this.parsed=Se(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return ae(Te(this.rgba),2)},t.prototype.isDark=function(){return Te(this.rgba)<.5},t.prototype.isLight=function(){return Te(this.rgba)>=.5},t.prototype.toHex=function(){var t,e,r,i,n,s;return e=(t=le(this.rgba)).r,r=t.g,i=t.b,s=(n=t.a)<1?fe(ae(255*n)):"","#"+fe(e)+fe(r)+fe(i)+s},t.prototype.toRgb=function(){return le(this.rgba)},t.prototype.toRgbString=function(){var t,e,r,i,n;return e=(t=le(this.rgba)).r,r=t.g,i=t.b,(n=t.a)<1?"rgba("+e+", "+r+", "+i+", "+n+")":"rgb("+e+", "+r+", "+i+")"},t.prototype.toHsl=function(){return ge(_e(this.rgba))},t.prototype.toHslString=function(){var t,e,r,i,n;return e=(t=ge(_e(this.rgba))).h,r=t.s,i=t.l,(n=t.a)<1?"hsla("+e+", "+r+"%, "+i+"%, "+n+")":"hsl("+e+", "+r+"%, "+i+"%)"},t.prototype.toHsv=function(){var t;return t=de(this.rgba),{h:ae(t.h),s:ae(t.s),v:ae(t.v),a:ae(t.a,3)}},t.prototype.invert=function(){var t;return Re({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a})},t.prototype.saturate=function(t){return void 0===t&&(t=.1),Re(Ae(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),Re(Ae(this.rgba,-t))},t.prototype.grayscale=function(){return Re(Ae(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),Re(Ce(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),Re(Ce(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){var e;return"number"==typeof t?Re({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ae(this.rgba.a,3)},t.prototype.hue=function(t){var e=_e(this.rgba);return"number"==typeof t?Re({h:t,s:e.s,l:e.l,a:e.a}):ae(e.h)},t.prototype.isEqual=function(t){return this.toHex()===Re(t).toHex()},t}(),Re=function(t){return t instanceof De?t:new De(t)},Ie=[];ie=[function(t,e){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var s={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var n,a,o=i[this.toHex()];if(o)return o;if(null==e?void 0:e.closest){var h=this.toRgb(),u=1/0,l="black";if(!s.length)for(var c in r)s[c]=new t(r[c]).toRgb();for(var f in r){var d=(n=h,a=s[f],Math.pow(n.r-a.r,2)+Math.pow(n.g-a.g,2)+Math.pow(n.b-a.b,2));d<u&&(u=d,l=f)}return l}},e.string.push([function(e){var i=e.toLowerCase(),n="transparent"===i?"#0000":r[i];return n?new t(n).toRgb():null},"name"])}],ie.forEach((function(t){Ie.indexOf(t)<0&&(t(De,Ee),Ie.push(t))}));const Pe=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Pe)this._value=t._value,this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");this._value!==t&&(this.normalize(t),this._value=t)}}get value(){return this._value}toRgba(){const[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,i]=this._components;return(t=t??[])[0]=Math.round(255*e),t[1]=Math.round(255*r),t[2]=Math.round(255*i),t}toRgbArray(t){t=t??[];const[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(t){const[e,r,i,n]=Pe.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t){if(1===t)return(255*t<<24)+this._int;if(0===t)return 0;let e=this._int>>16&255,r=this._int>>8&255,i=255&this._int;return e=e*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(255*t<<24)+(e<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=t,this}round(t){const[e,r,i]=this._components;return this._components.set([Math.min(255,e/t*t),Math.min(255,r/t*t),Math.min(255,i/t*t)]),this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,r,i,n]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}normalize(t){let e;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){e=[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255,1]}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4&&t.every((t=>t<=1&&t>=0))){const[r,i,n,s=1]=t;e=[r,i,n,s]}else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4){const[r,i,n,s=255]=t;e=[r/255,i/255,n/255,s/255]}else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const e=Pe.HEX_PATTERN.exec(t);e&&(t=`#${e[2]}`)}const r=Re(t);if(r.isValid()){const{r:t,g:i,b:n,a:s}=r.rgba;e=[t/255,i/255,n/255,s]}}if(!e)throw new Error(`Unable to convert color ${t}`);this._components.set(e),this.refreshInt()}refreshInt(){const[t,e,r]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*r|0)}};let Ne=Pe;function ke(t,e=[]){return Jt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Ne.shared.setValue(t).toRgbArray(e)}function Be(t){return Jt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ne.shared.setValue(t).toHex()}function Le(t){return Jt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),Ne.shared.setValue(t).toNumber()}function Oe(t){return Jt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ne.shared.setValue(t).toNumber()}Ne.shared=new Pe,Ne.temp=new Pe,Ne.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;const Fe=function(){const t=[],e=[];for(let r=0;r<32;r++)t[r]=r,e[r]=r;t[u.NORMAL_NPM]=u.NORMAL,t[u.ADD_NPM]=u.ADD,t[u.SCREEN_NPM]=u.SCREEN,e[u.NORMAL]=u.NORMAL_NPM,e[u.ADD]=u.ADD_NPM,e[u.SCREEN]=u.SCREEN_NPM;const r=[];return r.push(e),r.push(t),r}();function Ue(t,e){return Fe[e?1:0][t]}function ze(t,e,r,i=!0){return Jt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),Ne.shared.setValue(t).premultiply(e,i).toArray(r??new Float32Array(4))}function Ge(t,e){return Jt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),Ne.shared.setValue(t).toPremultiplied(e)}function He(t,e,r,i=!0){return Jt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),Ne.shared.setValue(t).premultiply(e,i).toArray(r??new Float32Array(4))}const je=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function Ve(t,e=null){const r=6*t;if((e=e||new Uint16Array(r)).length!==r)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${r}`);for(let t=0,i=0;t<r;t+=6,i+=4)e[t+0]=i+0,e[t+1]=i+1,e[t+2]=i+2,e[t+3]=i+0,e[t+4]=i+2,e[t+5]=i+3;return e}function We(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}const qe={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Xe(t,e){let r=0,i=0;const n={};for(let n=0;n<t.length;n++)i+=e[n],r+=t[n].length;const s=new ArrayBuffer(4*r);let a=null,o=0;for(let r=0;r<t.length;r++){const h=e[r],u=t[r],l=We(u);n[l]||(n[l]=new qe[l](s)),a=n[l];for(let t=0;t<u.length;t++){a[(t/h|0)*i+o+t%h]=u[t]}o+=h}return new Float32Array(s)}function Ye(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Ze(t){return!(t&t-1||!t)}function $e(t){let e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,r=((t>>>=r)>15?1:0)<<2,e|=r,r=((t>>>=r)>3?1:0)<<1,e|=r,e|(t>>>=r)>>1}function Ke(t,e,r){const i=t.length;let n;if(e>=i||0===r)return;const s=i-(r=e+r>i?i-e:r);for(n=e;n<s;++n)t[n]=t[n+r];t.length=s}function Je(t){return 0===t?0:t<0?-1:1}let Qe=0;function tr(){return++Qe}const er=class{constructor(t,e,r,i){this.left=t,this.top=e,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let rr=er;rr.EMPTY=new er(0,0,0,0);const ir={},nr=Object.create(null),sr=Object.create(null);function ar(){let t;for(t in nr)nr[t].destroy();for(t in sr)sr[t].destroy()}function or(){let t;for(t in nr)delete nr[t];for(t in sr)delete sr[t]}class hr{constructor(t,e,r){this._canvas=S.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||S.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function ur(t,e,r){for(let i=0,n=4*r*e;i<e;++i,n+=4)if(0!==t[n+3])return!1;return!0}function lr(t,e,r,i,n){const s=4*e;for(let e=i,a=i*s+4*r;e<=n;++e,a+=s)if(0!==t[a+3])return!1;return!0}function cr(t){const{width:e,height:r}=t,i=t.getContext("2d",{willReadFrequently:!0});if(null===i)throw new TypeError("Failed to get canvas 2D context");const n=i.getImageData(0,0,e,r).data;let s=0,a=0,o=e-1,h=r-1;for(;a<r&&ur(n,e,a);)++a;if(a===r)return rr.EMPTY;for(;ur(n,e,h);)--h;for(;lr(n,e,s,a,h);)++s;for(;lr(n,e,o,a,h);)--o;return++o,++h,new rr(s,a,o,h)}function fr(t){const e=cr(t),{width:r,height:i}=e;let n=null;if(!e.isEmpty()){const s=t.getContext("2d");if(null===s)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(e.left,e.top,r,i)}return{width:r,height:i,data:n}}function dr(t){const e=je.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}let pr;function mr(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,pr||(pr=document.createElement("a")),pr.href=t;const r=Xt.parse(pr.href),i=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&i&&r.protocol===e.protocol?"":"anonymous"}function gr(t,e=1){const r=S.RETINA_PREFIX?.exec(t);return r?parseFloat(r[1]):e}var vr=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(vr||{});const _r=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},br=(t,e)=>_r(t).priority??e,yr={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(_r).forEach((t=>{t.type.forEach((e=>this._removeHandlers[e]?.(t)))})),this},add(...t){return t.map(_r).forEach((t=>{t.type.forEach((e=>{const r=this._addHandlers,i=this._queue;r[e]?r[e](t):(i[e]=i[e]||[],i[e].push(t))}))})),this},handle(t,e,r){const i=this._addHandlers,n=this._removeHandlers;if(i[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);i[t]=e,n[t]=r;const s=this._queue;return s[t]&&(s[t].forEach((t=>e(t))),delete s[t]),this},handleByMap(t,e){return this.handle(t,(t=>{e[t.name]=t.ref}),(t=>{delete e[t.name]}))},handleByList(t,e,r=-1){return this.handle(t,(t=>{e.includes(t.ref)||(e.push(t.ref),e.sort(((t,e)=>br(e,r)-br(t,r))))}),(t=>{const r=e.indexOf(t.ref);-1!==r&&e.splice(r,1)}))}};class xr{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const wr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Er(t){let e="";for(let r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+=`if(test == ${r}.0){}`);return e}function Mr(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const r=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=wr.replace(/%forloop%/gi,Er(t));if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}class Sr{constructor(){this.data=0,this.blendMode=u.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==u.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Sr;return t.depthTest=!1,t.blend=!0,t}}const Ar=[];function Tr(t,e){if(!t)return null;let r="";if("string"==typeof t){const e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);e&&(r=e[1].toLowerCase())}for(let i=Ar.length-1;i>=0;--i){const n=Ar[i];if(n.test&&n.test(t,r))return new n(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Cr{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,r,i,n,s,a,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:u}=this;this._aliasCount++;for(let l=0,c=u.length;l<c;l++)u[l][h](t,e,r,i,n,s,a,o);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(Cr.prototype,{dispatch:{value:Cr.prototype.emit},run:{value:Cr.prototype.emit}});class Dr{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Cr("setRealSize"),this.onUpdate=new Cr("update"),this.onError=new Cr("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Rr extends Dr{constructor(t,e){const{width:r,height:i}=e||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=t}upload(t,e,r){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_.UNPACK);const n=e.realWidth,s=e.realHeight;return r.width===n&&r.height===s?i.texSubImage2D(e.target,0,0,0,n,s,e.format,r.type,this.data):(r.width=n,r.height=s,i.texImage2D(e.target,0,r.internalFormat,n,s,0,e.format,r.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const Ir={scaleMode:m.NEAREST,format:c.RGBA,alphaMode:_.NPM},Pr=class extends(r(W)){constructor(t=null,e=null){super(),e=Object.assign({},Pr.defaultOptions,e);const{alphaMode:r,mipmap:i,anisotropicLevel:n,scaleMode:s,width:a,height:o,wrapMode:h,format:u,type:l,target:c,resolution:f,resourceOptions:d}=e;!t||t instanceof Dr||((t=Tr(t,d)).internal=!0),this.resolution=f||S.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((o||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=h,this._scaleMode=s,this.format=u,this.type=l,this.target=c,this.alphaMode=r,this.uid=tr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&o>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this}setSize(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)}setRealSize(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ze(this.realWidth)&&Ze(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete sr[this.cacheId],delete nr[this.cacheId],this.cacheId=null),this.dispose(),Pr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,r=S.STRICT_TEXTURE_CACHE){const i="string"==typeof t;let n=null;if(i)n=t;else{if(!t._pixiId){const r=e?.pixiIdPrefix||"pixiid";t._pixiId=`${r}_${tr()}`}n=t._pixiId}let s=sr[n];if(i&&r&&!s)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return s||(s=new Pr(t,e),s.cacheId=n,Pr.addToCache(s,n)),s}static fromBuffer(t,e,r,i){t=t||new Float32Array(e*r*4);const n=new Rr(t,{width:e,height:r}),s=t instanceof Float32Array?d.FLOAT:d.UNSIGNED_BYTE;return new Pr(n,Object.assign({},Ir,i||{width:e,height:r,type:s}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),sr[e]&&sr[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),sr[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=sr[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete sr[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete sr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let Nr=Pr;Nr.defaultOptions={mipmap:v.POW2,anisotropicLevel:0,scaleMode:m.LINEAR,wrapMode:g.CLAMP,alphaMode:_.UNPACK,target:f.TEXTURE_2D,format:c.RGBA,type:d.UNSIGNED_BYTE},Nr._globalBatch=0;class kr{constructor(){this.texArray=null,this.blend=0,this.type=l.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Br=0;class Lr{constructor(t,e=!0,r=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Br++,this.disposeRunner=new Cr("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?M.ELEMENT_ARRAY_BUFFER:M.ARRAY_BUFFER}get index(){return this.type===M.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Lr(t)}}class Or{constructor(t,e=0,r=!1,i=d.FLOAT,n,s,a,o=1){this.buffer=t,this.size=e,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=a,this.divisor=o}destroy(){this.buffer=null}static from(t,e,r,i,n){return new Or(t,e,r,i,n)}}const Fr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Ur(t,e){let r=0,i=0;const n={};for(let n=0;n<t.length;n++)i+=e[n],r+=t[n].length;const s=new ArrayBuffer(4*r);let a=null,o=0;for(let r=0;r<t.length;r++){const h=e[r],u=t[r],l=We(u);n[l]||(n[l]=new Fr[l](s)),a=n[l];for(let t=0;t<u.length;t++){a[(t/h|0)*i+o+t%h]=u[t]}o+=h}return new Float32Array(s)}const zr={5126:4,5123:2,5121:1};let Gr=0;const Hr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};class jr{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Gr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Cr("disposeGeometry"),this.refCount=0}addAttribute(t,e,r=0,i=!1,n,s,a,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Lr||(e instanceof Array&&(e=new Float32Array(e)),e=new Lr(e));const h=t.split("|");if(h.length>1){for(let t=0;t<h.length;t++)this.addAttribute(h[t],e,r,i,n);return this}let u=this.buffers.indexOf(e);return-1===u&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new Or(u,r,i,n,s,a,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Lr||(t instanceof Array&&(t=new Uint16Array(t)),t=new Lr(t)),t.type=M.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],e=[],r=new Lr;let i;for(i in this.attributes){const r=this.attributes[i],n=this.buffers[r.buffer];t.push(n.data),e.push(r.size*zr[r.type]/4),r.buffer=0}for(r.data=Ur(t,e),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new jr;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Lr(this.buffers[e].data.slice(0));for(const e in this.attributes){const r=this.attributes[e];t.attributes[e]=new Or(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=M.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new jr,r=[],i=[],n=[];let s;for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)i[t]=i[t]||0,i[t]+=s.buffers[t].data.length,n[t]=0}for(let t=0;t<s.buffers.length;t++)r[t]=new(Hr[We(s.buffers[t].data)])(i[t]),e.buffers[t]=new Lr(r[t]);for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)r[t].set(s.buffers[t].data,n[t]),n[t]+=s.buffers[t].data.length}if(e.attributes=s.attributes,s.indexBuffer){e.indexBuffer=e.buffers[s.buffers.indexOf(s.indexBuffer)],e.indexBuffer.type=M.ELEMENT_ARRAY_BUFFER;let r=0,i=0,n=0,a=0;for(let t=0;t<s.buffers.length;t++)if(s.buffers[t]!==s.indexBuffer){a=t;break}for(const t in s.attributes){const e=s.attributes[t];(0|e.buffer)===a&&(i+=e.size*zr[e.type]/4)}for(let s=0;s<t.length;s++){const o=t[s].indexBuffer.data;for(let t=0;t<o.length;t++)e.indexBuffer.data[t+n]+=r;r+=t[s].buffers[a].data.length/i,n+=o.length}}return e}}class Vr extends jr{constructor(t=!1){super(),this._buffer=new Lr(null,t,!1),this._indexBuffer=new Lr(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,d.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,d.FLOAT).addAttribute("aColor",this._buffer,4,!0,d.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,d.FLOAT).addIndex(this._indexBuffer)}}const Wr=2*Math.PI,qr=180/Math.PI,Xr=Math.PI/180;var Yr=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(Yr||{});class Zr{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Zr(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const $r=[new Zr,new Zr,new Zr,new Zr];class Kr{constructor(t=0,e=0,r=0,i=0){this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i),this.type=Yr.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Kr(0,0,0,0)}clone(){return new Kr(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const r=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>r}const r=this.left,i=this.right,n=this.top,s=this.bottom;if(i<=r||s<=n)return!1;const a=$r[0].set(t.left,t.top),o=$r[1].set(t.left,t.bottom),h=$r[2].set(t.right,t.top),u=$r[3].set(t.right,t.bottom);if(h.x<=a.x||o.y<=a.y)return!1;const l=Math.sign(e.a*e.d-e.b*e.c);if(0===l)return!1;if(e.apply(a,a),e.apply(o,o),e.apply(h,h),e.apply(u,u),Math.max(a.x,o.x,h.x,u.x)<=r||Math.min(a.x,o.x,h.x,u.x)>=i||Math.max(a.y,o.y,h.y,u.y)<=n||Math.min(a.y,o.y,h.y,u.y)>=s)return!1;const c=l*(o.y-a.y),f=l*(a.x-o.x),d=c*r+f*n,p=c*i+f*n,m=c*r+f*s,g=c*i+f*s;if(Math.max(d,p,m,g)<=c*a.x+f*a.y||Math.min(d,p,m,g)>=c*u.x+f*u.y)return!1;const v=l*(a.y-h.y),_=l*(h.x-a.x),b=v*r+_*n,y=v*i+_*n,x=v*r+_*s,w=v*i+_*s;return!(Math.max(b,y,x,w)<=v*a.x+_*a.y||Math.min(b,y,x,w)>=v*u.x+_*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Jr{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.radius=r,this.type=Yr.CIRC}clone(){return new Jr(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-t,n=this.y-e;return i*=i,n*=n,i+n<=r}getBounds(){return new Kr(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Qr{constructor(t=0,e=0,r=0,i=0){this.x=t,this.y=e,this.width=r,this.height=i,this.type=Yr.ELIP}clone(){return new Qr(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let r=(t-this.x)/this.width,i=(e-this.y)/this.height;return r*=r,i*=i,r+i<=1}getBounds(){return new Kr(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class ti{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let r=0,i=e.length;r<i;r++)t.push(e[r].x,e[r].y);e=t}this.points=e,this.type=Yr.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new ti(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let r=!1;const i=this.points.length/2;for(let n=0,s=i-1;n<i;s=n++){const i=this.points[2*n],a=this.points[2*n+1],o=this.points[2*s],h=this.points[2*s+1];a>e!=h>e&&t<(e-a)/(h-a)*(o-i)+i&&(r=!r)}return r}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((t,e)=>`${t}, ${e}`),"")}]`}}class ei{constructor(t=0,e=0,r=0,i=0,n=20){this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n,this.type=Yr.RREC}clone(){return new ei(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let i=t-(this.x+r),n=e-(this.y+r);const s=r*r;if(i*i+n*n<=s)return!0;if(i=t-(this.x+this.width-r),i*i+n*n<=s)return!0;if(n=e-(this.y+this.height-r),i*i+n*n<=s)return!0;if(i=t-(this.x+r),i*i+n*n<=s)return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class ri{constructor(t=1,e=0,r=0,i=1,n=0,s=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,i,n,s){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=s,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new Zr;const r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e}applyInverse(t,e){e=e||new Zr;const r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,s=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=s*e-this.ty*r,this.ty=s*r+this.ty*e,this}append(t){const e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this}setTransform(t,e,r,i,n,s,a,o,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-o)*s,this.d=Math.cos(a-o)*s,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,r=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,i=this.c,n=this.d,s=t.pivot,a=-Math.atan2(-i,n),o=Math.atan2(r,e),h=Math.abs(a+o);return h<1e-5||Math.abs(Wr-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=o),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(s.x*e+s.y*i),t.position.y=this.ty+(s.x*r+s.y*n),t}invert(){const t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,s=t*i-e*r;return this.a=i/s,this.b=-e/s,this.c=-r/s,this.d=t/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(t*this.ty-e*n)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new ri;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new ri}static get TEMP_MATRIX(){return new ri}}const ii=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ni=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],si=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ai=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],oi=[],hi=[],ui=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];oi.push(e);for(let r=0;r<16;r++){const i=ui(ii[t]*ii[r]+si[t]*ni[r]),n=ui(ni[t]*ii[r]+ai[t]*ni[r]),s=ui(ii[t]*si[r]+si[t]*ai[r]),a=ui(ni[t]*si[r]+ai[t]*ai[r]);for(let t=0;t<16;t++)if(ii[t]===i&&ni[t]===n&&si[t]===s&&ai[t]===a){e.push(t);break}}}for(let t=0;t<16;t++){const e=new ri;e.set(ii[t],ni[t],si[t],ai[t],0,0),hi.push(e)}}();const li={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>ii[t],uY:t=>ni[t],vX:t=>si[t],vY:t=>ai[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>oi[t][e],sub:(t,e)=>oi[t][li.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?li.S:li.N:2*Math.abs(e)<=Math.abs(t)?t>0?li.E:li.W:e>0?t>0?li.SE:li.SW:t>0?li.NE:li.NW,matrixAppendRotationInv:(t,e,r=0,i=0)=>{const n=hi[li.inv(e)];n.tx=r,n.ty=i,t.append(n)}};class ci{constructor(t,e,r=0,i=0){this._x=r,this._y=i,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new ci(t,e,this._x,this._y)}set(t=0,e=t){return this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const fi=class{constructor(){this.worldTransform=new ri,this.localTransform=new ri,this.position=new ci(this.onChange,this,0,0),this.scale=new ci(this.onChange,this,1,1),this.pivot=new ci(this.onChange,this,0,0),this.skew=new ci(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const r=t.worldTransform,i=this.worldTransform;i.a=e.a*r.a+e.b*r.c,i.b=e.a*r.b+e.b*r.d,i.c=e.c*r.a+e.d*r.c,i.d=e.c*r.b+e.d*r.d,i.tx=e.tx*r.a+e.ty*r.c+r.tx,i.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let di=fi;di.IDENTITY=new fi;function pi(t,e,r){const i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}function mi(t){const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=!1;return e}function gi(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return mi(2*e);case"bvec3":return mi(3*e);case"bvec4":return mi(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const vi=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,e)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],_i={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},bi={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function yi(t,e){const r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const i in t.uniforms){const n=e[i];if(!n){t.uniforms[i]?.group&&(t.uniforms[i].ubo?r.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');\n                    `):r.push(`\n                        renderer.shader.syncUniformGroup(uv.${i}, syncData);\n                    `));continue}const s=t.uniforms[i];let a=!1;for(let t=0;t<vi.length;t++)if(vi[t].test(n,s)){r.push(vi[t].code(i,s)),a=!0;break}if(!a){const t=(1!==n.size||n.isArray?bi:_i)[n.type].replace("location",`ud["${i}"].location`);r.push(`\n            cu = ud["${i}"];\n            cv = cu.value;\n            v = uv["${i}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",r.join("\n"))}const xi={};let wi,Ei=xi;function Mi(){if(Ei===xi||Ei?.isContextLost()){const t=S.ADAPTER.createCanvas();let e;S.PREFER_ENV>=a.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Ei=e}return Ei}function Si(){if(!wi){wi=x.MEDIUM;const t=Mi();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);wi=e.precision?x.HIGH:x.MEDIUM}}return wi}function Ai(t,e){const r=t.getShaderSource(e).split("\n").map(((t,e)=>`${e}: ${t}`)),i=t.getShaderInfoLog(e),n=i.split("\n"),s={},a=n.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||s[t])&&(s[t]=!0,!0))),o=[""];a.forEach((t=>{r[t-1]=`%c${r[t-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const h=r.join("\n");o[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function Ti(t,e,r,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||Ai(t,r),t.getShaderParameter(i,t.COMPILE_STATUS)||Ai(t,i),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}const Ci={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Di(t){return Ci[t]}let Ri=null;const Ii={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Pi(t,e){if(!Ri){const e=Object.keys(Ii);Ri={};for(let r=0;r<e.length;++r){const i=e[r];Ri[t[i]]=Ii[i]}}return Ri[e]}function Ni(t,e,r){if("precision"!==t.substring(0,9)){let i=e;return e===x.HIGH&&r!==x.HIGH&&(i=x.MEDIUM),`precision ${i} float;\n${t}`}return r!==x.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let ki;function Bi(){if("boolean"==typeof ki)return ki;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");ki=!0===t({a:"b"},"a","b")}catch(t){ki=!1}return ki}let Li=0;const Oi={},Fi=class{constructor(t,e,r="pixi-shader",i={}){this.extra={},this.id=Li++,this.vertexSrc=t||Fi.defaultVertexSrc,this.fragmentSrc=e||Fi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),Oi[r]?(Oi[r]++,r+=`-${Oi[r]}`):Oi[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}\n${this.fragmentSrc}`,this.vertexSrc=Ni(this.vertexSrc,Fi.defaultVertexPrecision,x.HIGH),this.fragmentSrc=Ni(this.fragmentSrc,Fi.defaultFragmentPrecision,Si())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(t,e,r){const i=t+e;let n=ir[i];return n||(ir[i]=n=new Fi(t,e,r)),n}};let Ui=Fi;Ui.defaultVertexPrecision=x.HIGH,Ui.defaultFragmentPrecision=j.apple.device?x.HIGH:x.MEDIUM;let zi=0;class Gi{constructor(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=zi++,this.static=!!e,this.ubo=!!r,t instanceof Lr?(this.buffer=t,this.buffer.type=M.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Lr(new Float32Array(1)),this.buffer.type=M.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new Gi(e,r)}static from(t,e,r){return new Gi(t,e,r)}static uboFrom(t,e){return new Gi(t,e??!0,!0)}}class Hi{constructor(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Gi?e:new Gi(e):new Gi({}),this.disposeRunner=new Cr("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const r in e.uniforms){const i=e.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,r){const i=Ui.from(t,e);return new Hi(i,r)}}class ji{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const e=new Int32Array(t);for(let r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=Gi.from({uSamplers:e},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ui(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new ri,default:this.defaultGroupCache[t]};return new Hi(this.programCache[t],e)}generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+=`if(vTextureId < ${r}.5)`),e+="\n{",e+=`\n\tcolor = texture2D(uSamplers[${r}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}class Vi{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Wi(t){let e=!0;const r=S.ADAPTER.getNavigator();if(j.tablet||j.phone){if(j.apple.device){const t=r.userAgent.match(/OS (\d+)_(\d+)?/);if(t){parseInt(t[1],10)<11&&(e=!1)}}if(j.android.device){const t=r.userAgent.match(/Android\s([0-9.]*)/);if(t){parseInt(t[1],10)<7&&(e=!1)}}}return e?t:4}class qi{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}const Xi=class extends qi{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Vr,this.vertexSize=6,this.state=Sr.for2d(),this.size=4*Xi.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Wi(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!j.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Jt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:t=Xi.defaultVertexSrc,fragment:e=Xi.defaultFragmentTemplate}={}){this.shaderGenerator=new ji(t,e)}contextChange(){const t=this.renderer.gl;S.PREFER_ENV===a.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Xi.defaultMaxTextures),this.maxTextures=Mr(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=Xi,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;t.length<r;)t.push(new kr);for(;e.length<i;)e.push(new Vi);for(let t=0;t<this.maxTextures;t++)this._tempBoundTextures[t]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,r=Xi._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count;let a=++Nr._globalBatch,o=0,h=r[0],u=0;i.copyBoundTextures(n,e);for(let l=0;l<this._bufferSize;++l){const c=t[l];t[l]=null,c._batchEnabled!==a&&(h.count>=e&&(i.boundArray(h,n,a,e),this.buildDrawCalls(h,u,l),u=l,h=r[++o],++a),c._batchEnabled=a,c.touched=s,h.elements[h.count++]=c)}h.count>0&&(i.boundArray(h,n,a,e),this.buildDrawCalls(h,u,this._bufferSize),++o,++a);for(let t=0;t<n.length;t++)n[t]=null;Nr._globalBatch=a}buildDrawCalls(t,e,r){const{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:s,vertexSize:a}=this,o=Xi._drawCallPool;let h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=o[h];c.start=this._iIndex,c.texArray=t;for(let f=e;f<r;++f){const r=i[f],d=r._texture.baseTexture,p=Fe[d.alphaMode?1:0][r.blendMode];i[f]=null,e<f&&c.blend!==p&&(c.size=l-c.start,e=f,c=o[++h],c.texArray=t,c.start=l),this.packInterleavedGeometry(r,n,s,u,l),u+=r.vertexData.length/2*a,l+=r.indices.length,c.blend=p}e<r&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l}bindAndClearTexArray(t){const e=this.renderer.texture;for(let r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:r}=this;Xi.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:r}=this.renderer,i=Xi._drawCallPool;let n=null;for(let s=0;s<t;s++){const{texArray:t,type:a,size:o,start:h,blend:u}=i[s];n!==t&&(n=t,this.bindAndClearTexArray(t)),this.state.blendMode=u,r.set(this.state),e.drawElements(a,o,e.UNSIGNED_SHORT,2*h)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Xi.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Ye(Math.ceil(t/8)),r=$e(e),i=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new xr(i*this.vertexSize*4)),n}getIndexBuffer(t){const e=Ye(Math.ceil(t/12)),r=$e(e),i=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n}packInterleavedGeometry(t,e,r,i,n){const{uint32View:s,float32View:a}=e,o=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),d=Ne.shared.setValue(t._tintRGB).toPremultiplied(f);for(let t=0;t<l.length;t+=2)a[i++]=l[t],a[i++]=l[t+1],a[i++]=h[t],a[i++]=h[t+1],s[i++]=d,a[i++]=c;for(let t=0;t<u.length;t++)r[n++]=o+u[t]}};let Yi=Xi;Yi.defaultBatchSize=4096,Yi.extension={name:"batch",type:vr.RendererPlugin},Yi._drawCallPool=[],Yi._textureArrayPool=[],yr.add(Yi);const Zi=class extends Hi{constructor(t,e,r){super(Ui.from(t||Zi.defaultVertexSrc,e||Zi.defaultFragmentSrc),r),this.padding=0,this.resolution=Zi.defaultResolution,this.multisample=Zi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Sr}apply(t,e,r,i,n){t.applyFilter(this,e,r,i)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};let $i=Zi;$i.defaultResolution=1,$i.defaultMultisample=E.NONE;class Ki{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ne(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:r,backgroundAlpha:i}=t,n=r??e;void 0!==n&&(this.color=n),this.alpha=i}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Ki.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Ki.extension={type:[vr.RendererSystem,vr.CanvasRendererSystem],name:"background"},yr.add(Ki);class Ji{constructor(t){this.renderer=t,this.emptyRenderer=new qi(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:r}=this.renderer.texture;for(let i=e-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)}boundArray(t,e,r,i){const{elements:n,ids:s,count:a}=t;let o=0;for(let t=0;t<a;t++){const a=n[t],h=a._batchLocation;if(h>=0&&h<i&&e[h]===a)s[t]=h;else for(;o<i;){const i=e[o];if(!i||i._batchEnabled!==r||i._batchLocation!==o){s[t]=o,a._batchLocation=o,e[o]=a;break}o++}}}destroy(){this.renderer=null}}Ji.extension={type:vr.RendererSystem,name:"batch"},yr.add(Ji);let Qi=0;class tn{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Qi++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,r=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Qi++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let r;if(S.PREFER_ENV>=a.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}tn.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},tn.extension={type:vr.RendererSystem,name:"context"},yr.add(tn);class en extends Rr{upload(t,e,r){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_.UNPACK);const n=e.realWidth,s=e.realHeight;return r.width===n&&r.height===s?i.texSubImage2D(e.target,0,0,0,n,s,e.format,r.type,this.data):(r.width=n,r.height=s,i.texImage2D(e.target,0,r.internalFormat,n,s,0,e.format,r.type,this.data)),!0}}class rn{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Cr("disposeFramebuffer"),this.multisample=E.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Nr(null,{scaleMode:m.NEAREST,resolution:1,mipmap:v.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Nr(new en(null,{width:this.width,height:this.height}),{scaleMode:m.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:v.OFF,format:c.DEPTH_COMPONENT,type:d.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class nn extends Nr{constructor(t={}){if("number"==typeof t){t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=E.NONE),super(null,t),this.mipmap=v.OFF,this.valid=!0,this._clear=new Ne([0,0,0,0]),this.framebuffer=new rn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class sn extends Dr{constructor(t){const e=t;super(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,r){void 0!==r||e.startsWith("data:")?!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous"):t.crossOrigin=mr(e)}upload(t,e,r,i){const n=t.gl,s=e.realWidth,a=e.realHeight;if(i=i||this.source,"undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if("undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement&&i.readyState<=1&&0===i.buffered.length)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===_.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||r.width!==s||r.height!==a?(r.width=s,r.height=a,n.texImage2D(e.target,0,r.internalFormat,e.format,r.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,r.type,i),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(e,r),super.update()}dispose(){this.source=null}}class an extends sn{constructor(t,e){if(e=e||{},"string"==typeof t){const r=new Image;sn.crossOrigin(r,t,e.crossorigin),r.src=t,t=r}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??S.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(((t,e)=>{const r=this.source;this.url=r.src;const i=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?t(this.process()):t(this))};r.complete&&r.src?i():(r.onload=i,r.onerror=t=>{e(t),this.onError.emit(t)})}))),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,r=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then((t=>t.blob())).then((r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===_.UNPACK?"premultiply":"none"}))).then((t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(t,e,r){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,r,this.bitmap),!this.preserveBitmap){let t=!0;const i=e._glTextures;for(const n in i){const s=i[n];if(s!==r&&s.dirtyId!==e.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return"undefined"!=typeof HTMLImageElement&&("string"==typeof t||t instanceof HTMLImageElement)}}class on{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,r){const i=e.width,n=e.height;if(r){const e=t.width/2/i,s=t.height/2/n,a=t.x/i+e,o=t.y/n+s;r=li.add(r,li.NW),this.x0=a+e*li.uX(r),this.y0=o+s*li.uY(r),r=li.add(r,2),this.x1=a+e*li.uX(r),this.y1=o+s*li.uY(r),r=li.add(r,2),this.x2=a+e*li.uX(r),this.y2=o+s*li.uY(r),r=li.add(r,2),this.x3=a+e*li.uX(r),this.y3=o+s*li.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const hn=new on;function un(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class ln extends(r(W)){constructor(t,e,r,i,n,s,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Kr(0,0,1,1)),t instanceof ln&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=i,this.valid=!1,this._uvs=hn,this.uvMatrix=null,this.orig=r||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Zr(s.x,s.y):new Zr(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;t?.url&&nr[t.url]&&ln.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ln.removeFromCache(this),this.textureCacheIds=null}clone(){const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),r=new ln(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===hn&&(this._uvs=new on),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},r=S.STRICT_TEXTURE_CACHE){const i="string"==typeof t;let n=null;if(i)n=t;else if(t instanceof Nr){if(!t.cacheId){const r=e?.pixiIdPrefix||"pixiid";t.cacheId=`${r}-${tr()}`,Nr.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const r=e?.pixiIdPrefix||"pixiid";t._pixiId=`${r}_${tr()}`}n=t._pixiId}let s=nr[n];if(i&&r&&!s)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return s||t instanceof Nr?!s&&t instanceof Nr&&(s=new ln(t),ln.addToCache(s,n)):(e.resolution||(e.resolution=gr(t)),s=new ln(new Nr(t,e)),s.baseTexture.cacheId=n,Nr.addToCache(s.baseTexture,n),ln.addToCache(s,n)),s}static fromURL(t,e){const r=Object.assign({autoLoad:!1},e?.resourceOptions),i=ln.from(t,Object.assign({resourceOptions:r},e),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then((()=>Promise.resolve(i)))}static fromBuffer(t,e,r,i){return new ln(Nr.fromBuffer(t,e,r,i))}static fromLoader(t,e,r,i){const n=new Nr(t,Object.assign({scaleMode:Nr.defaultOptions.scaleMode,resolution:gr(e)},i)),{resource:s}=n;s instanceof an&&(s.url=e);const a=new ln(n);return r||(r=e),Nr.addToCache(a.baseTexture,r),ln.addToCache(a,r),r!==e&&(Nr.addToCache(a.baseTexture,e),ln.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise((t=>{a.baseTexture.once("loaded",(()=>t(a)))}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),nr[e]&&nr[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),nr[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=nr[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete nr[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)nr[t.textureCacheIds[e]]===t&&delete nr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:r,width:i,height:n}=t,s=e+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(s||a){const t=s&&a?"and":"or",o=`X: ${e} + ${i} = ${e+i} > ${this.baseTexture.width}`,h=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${o} ${t} ${h}`)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ln._EMPTY||(ln._EMPTY=new ln(new Nr),un(ln._EMPTY),un(ln._EMPTY.baseTexture)),ln._EMPTY}static get WHITE(){if(!ln._WHITE){const t=S.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),ln._WHITE=new ln(Nr.from(t)),un(ln._WHITE),un(ln._WHITE.baseTexture)}return ln._WHITE}}class cn extends ln{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,r=!0){const i=this.baseTexture.resolution,n=Math.round(t*i)/i,s=Math.round(e*i)/i;this.valid=n>0&&s>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=s,r&&this.baseTexture.resize(n,s),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new cn(new nn(t))}}class fn{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,r=E.NONE){const i=new nn(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new cn(i)}getOptimalTexture(t,e,r=1,i=E.NONE){let n;t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?n=i>1?-i:-1:(n=((65535&(t=Ye(t)))<<16|65535&(e=Ye(e)))>>>0,i>1&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]);let s=this.texturePool[n].pop();return s||(s=this.createTexture(t,e,i)),s.filterPoolKey=n,s.setResolution(r),s}getFilterTexture(t,e,r){const i=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||E.NONE);return i.filterFrame=t.filterFrame,i}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const t in this.texturePool){const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}fn.SCREEN_KEY=-1;class dn extends jr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class pn extends jr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Lr(this.vertices),this.uvBuffer=new Lr(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class mn{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=E.NONE,this.sourceFrame=new Kr,this.destinationFrame=new Kr,this.bindingSourceFrame=new Kr,this.bindingDestinationFrame=new Kr,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const gn=[new Zr,new Zr,new Zr,new Zr],vn=new ri;class _n{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new fn,this.statePool=[],this.quad=new dn,this.quadUv=new pn,this.tempRect=new Kr,this.activeState={},this.globalUniforms=new Gi({outputFrame:new Kr,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new mn,s=this.renderer.renderTexture;let a=e[0].resolution,o=e[0].multisample,h=e[0].padding,u=e[0].autoFit,l=e[0].legacy??!0;for(let t=1;t<e.length;t++){const r=e[t];a=Math.min(a,r.resolution),o=Math.min(o,r.multisample),h=this.useMaxPadding?Math.max(h,r.padding):h+r.padding,u=u&&r.autoFit,l=l||(r.legacy??!0)}1===i.length&&(this.defaultFilterStack[0].renderTexture=s.current),i.push(n),n.resolution=a,n.multisample=o,n.legacy=l,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(h);const c=this.tempRect.copyFrom(s.sourceFrame);r.projection.transform&&this.transformAABB(vn.copyFrom(r.projection.transform).invert(),c),u?(n.sourceFrame.fit(c),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(c)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,o),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(s.sourceFrame),n.bindingDestinationFrame.copyFrom(s.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,s.bind(n.renderTexture,n.sourceFrame,f),r.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;const i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;const n=i.inputSize,s=i.inputPixel,a=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=Math.round(n[0]*e.resolution),s[1]=Math.round(n[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],a[0]=.5*s[2],a[1]=.5*s[3],a[2]=e.sourceFrame.width*n[2]-.5*s[2],a[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){const t=i.filterArea;t[0]=e.destinationFrame.width,t[1]=e.destinationFrame.height,t[2]=e.sourceFrame.x,t[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,e.renderTexture,o.renderTexture,b.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let t=e.renderTexture,i=this.getOptimalFilterTexture(t.width,t.height,e.resolution);i.filterFrame=t.filterFrame;let n=0;for(n=0;n<r.length-1;++n){1===n&&e.multisample>1&&(i=this.getOptimalFilterTexture(t.width,t.height,e.resolution),i.filterFrame=t.filterFrame),r[n].apply(this,t,i,b.CLEAR,e);const s=t;t=i,i=s}r[n].apply(this,t,o.renderTexture,b.BLEND,e),n>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(i)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=b.CLEAR){const{renderTexture:r,state:i}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){const e=this.tempRect;e.x=0,e.y=0,e.width=t.filterFrame.width,e.height=t.filterFrame.height,r.bind(t,t.filterFrame,e)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=1&i.stateId||this.forceClear;(e===b.CLEAR||e===b.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,r,i){const n=this.renderer;n.state.set(t.state),this.bindAndClear(r,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(l.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(l.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:n}=e._texture,s=t.set(i.width,0,0,i.height,r.x,r.y),a=e.worldTransform.copyTo(ri.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/n.width,1/n.height),s.translate(e.anchor.x,e.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,r=1,i=E.NONE){return this.texturePool.getOptimalTexture(t,e,r,i)}getFilterTexture(t,e,r){if("number"==typeof t){const r=t;t=e,e=r}t=t||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||E.NONE);return i.filterFrame=t.filterFrame,i}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const r=gn[0],i=gn[1],n=gn[2],s=gn[3];r.set(e.left,e.top),i.set(e.left,e.bottom),n.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(r,r),t.apply(i,i),t.apply(n,n),t.apply(s,s);const a=Math.min(r.x,i.x,n.x,s.x),o=Math.min(r.y,i.y,n.y,s.y),h=Math.max(r.x,i.x,n.x,s.x),u=Math.max(r.y,i.y,n.y,s.y);e.x=a,e.y=o,e.width=h-a,e.height=u-o}roundFrame(t,e,r,i,n){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(n){const{a:t,b:e,c:r,d:i}=n;if((Math.abs(e)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4))return}(n=n?vn.copyFrom(n):vn.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}_n.extension={type:vr.RendererSystem,name:"filter"},yr.add(_n);class bn{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=E.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const yn=new Kr;class xn{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new rn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Kr,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;S.PREFER_ENV===a.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=t=>e.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,r=0){const{gl:i}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=r),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){const r=t.colorTextures[e];this.renderer.texture.unbind(r.parentTextureArray||r)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const t=e.width>>r,i=e.height>>r,n=t/e.width;this.setViewport(e.x*n,e.y*n,t,i)}else{const e=t.width>>r,i=t.height>>r;this.setViewport(0,0,e,i)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,r,i){const n=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),i=Math.round(i),n.width===r&&n.height===i&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=r,n.height=i,this.gl.viewport(t,e,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,r,i,n=h.COLOR|h.DEPTH){const{gl:s}=this;s.clearColor(t,e,r,i),s.clear(n)}initFramebuffer(t){const{gl:e}=this,r=new bn(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r}resizeFramebuffer(t){const{gl:e}=this,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const i=t.colorTextures;let n=i.length;e.drawBuffers||(n=Math.min(n,1));for(let s=0;s<n;s++){const n=i[s],a=n.parentTextureArray||n;this.renderer.texture.bind(a,0),0===s&&r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let s=n.length;r.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let o=0;o<s;o++){const s=n[o],h=s.parentTextureArray||s;this.renderer.texture.bind(h,0),0===o&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+o,s.target,h._glTextures[this.CONTEXT_UID].texture,e),a.push(r.COLOR_ATTACHMENT0+o))}if(a.length>1&&r.drawBuffers(a),t.depthTexture){if(this.writeDepthTexture){const i=t.depthTexture;this.renderer.texture.bind(i,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,i._glTextures[this.CONTEXT_UID].texture,e)}}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i.stencil))}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let r=E.NONE;if(t<=1||null===e)return r;for(let i=0;i<e.length;i++)if(e[i]<=t){r=e[i];break}return 1===r&&(r=E.NONE),r}blit(t,e,r){const{current:i,renderer:n,gl:s,CONTEXT_UID:a}=this;if(2!==n.context.webGLVersion)return;if(!i)return;const o=i.glFramebuffers[a];if(!o)return;if(!t){if(!o.msaaBuffer)return;const e=i.colorTextures[0];if(!e)return;o.blitFramebuffer||(o.blitFramebuffer=new rn(i.width,i.height),o.blitFramebuffer.addColorTexture(0,e)),(t=o.blitFramebuffer).colorTextures[0]!==e&&(t.colorTextures[0]=e,t.dirtyId++,t.dirtyFormat++),t.width===i.width&&t.height===i.height||(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}e||((e=yn).width=i.width,e.height=i.height),r||(r=e);const h=e.width===r.width&&e.height===r.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,o.framebuffer),s.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,s.COLOR_BUFFER_BIT,h?s.NEAREST:s.LINEAR)}disposeFramebuffer(t,e){const r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const r=t.width,i=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,r,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Kr}destroy(){this.renderer=null}}xn.extension={type:vr.RendererSystem,name:"framebuffer"},yr.add(xn);const wn={5126:4,5123:2,5121:1};class En{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){let e=this.renderer.context.extensions.vertexArrayObject;S.PREFER_ENV===a.WEBGL_LEGACY&&(e=null),e?(t.createVertexArray=()=>e.createVertexArrayOES(),t.bindVertexArray=t=>e.bindVertexArrayOES(t),t.deleteVertexArray=t=>e.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==e.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,r)=>e.vertexAttribDivisorANGLE(t,r),t.drawElementsInstanced=(t,r,i,n,s)=>e.drawElementsInstancedANGLE(t,r,i,n,s),t.drawArraysInstanced=(t,r,i,n)=>e.drawArraysInstancedANGLE(t,r,i,n)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:r}=this;let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);const s=i[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?r.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let r=0;r<t.buffers.length;r++){const i=t.buffers[r];e.update(i)}}checkCompatibility(t,e){const r=t.attributes,i=e.attributeData;for(const t in i)if(!r[t])throw new Error(`shader and geometry incompatible, geometry missing the "${t}" attribute`)}getSignature(t,e){const r=t.attributes,i=e.attributeData,n=["g",t.id];for(const t in r)i[t]&&n.push(t,i[t].location);return n.join("-")}initGeometryVao(t,e,r=!0){const i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const o=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID];let u=h[o];if(u)return h[a.id]=u,u;const l=t.buffers,c=t.attributes,f={},d={};for(const t in l)f[t]=0,d[t]=0;for(const t in c)!c[t].size&&a.attributeData[t]?c[t].size=a.attributeData[t].size:c[t].size||console.warn(`PIXI Geometry attribute '${t}' size cannot be determined (likely the bound shader does not have the attribute)`),f[c[t].buffer]+=c[t].size*wn[c[t].type];for(const t in c){const e=c[t],r=e.size;void 0===e.stride&&(f[e.buffer]===r*wn[e.type]?e.stride=0:e.stride=f[e.buffer]),void 0===e.start&&(e.start=d[e.buffer],d[e.buffer]+=r*wn[e.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(let t=0;t<l.length;t++){const e=l[t];s.bind(e),r&&e._glBuffers[n].refCount++}return this.activateVao(t,a),h[a.id]=u,h[o]=u,i.bindVertexArray(null),s.unbind(M.ARRAY_BUFFER),u}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers,s=this.renderer?.buffer;if(t.disposeRunner.remove(this),r){if(s)for(let t=0;t<n.length;t++){const r=n[t]._glBuffers[this.CONTEXT_UID];r&&(r.refCount--,0!==r.refCount||e||s.dispose(n[t],e))}if(!e)for(const t in r)if("g"===t[0]){const e=r[t];this._activeVao===e&&this.unbind(),i.deleteVertexArray(e)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)}activateVao(t,e){const r=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,s=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let o=null;for(const t in a){const h=a[t],u=s[h.buffer],l=u._glBuffers[i];if(e.attributeData[t]){o!==l&&(n.bind(u),o=l);const i=e.attributeData[t].location;if(r.enableVertexAttribArray(i),r.vertexAttribPointer(i,h.size,h.type||r.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(i,h.divisor)}}}}draw(t,e,r,i){const{gl:n}=this,s=this._activeGeometry;if(s.indexBuffer){const a=s.indexBuffer.data.BYTES_PER_ELEMENT,o=2===a?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,o,(r||0)*a,i||1):n.drawElements(t,e||s.indexBuffer.data.length,o,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,r,e||s.getSize(),i||1):n.drawArrays(t,r,e||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}En.extension={type:vr.RendererSystem,name:"geometry"},yr.add(En);const Mn=new ri;class Sn{constructor(t,e){this._texture=t,this.mapCoord=new ri,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){void 0===e&&(e=t);const r=this.mapCoord;for(let i=0;i<t.length;i+=2){const n=t[i],s=t[i+1];e[i]=n*r.a+s*r.c+r.tx,e[i+1]=n*r.b+s*r.d+r.ty}return e}update(t){const e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const i=e.orig,n=e.trim;n&&(Mn.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Mn));const s=e.baseTexture,a=this.uClampFrame,o=this.clampMargin/s.resolution,h=this.clampOffset;return a[0]=(e._frame.x+o+h)/s.width,a[1]=(e._frame.y+o+h)/s.height,a[2]=(e._frame.x+e._frame.width-o+h)/s.width,a[3]=(e._frame.y+e._frame.height-o+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0}}class An extends $i{constructor(t,e,r){let i=null;"string"!=typeof t&&void 0===e&&void 0===r&&(i=t,t=void 0,e=void 0,r=void 0),super(t||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",e||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r),this.maskSprite=i,this.maskMatrix=new ri}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,r,i){const n=this._maskSprite,s=n._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Sn(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,r,i))}}class Tn{constructor(t=null){this.type=w.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=$i.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=w.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Cn{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let r=e;if(!r.isMaskData){const t=this.maskDataPool.pop()||new Tn;t.pooled=!0,t.maskObject=e,r=t}const i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==w.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case w.SCISSOR:this.renderer.scissor.push(r);break;case w.STENCIL:this.renderer.stencil.push(r);break;case w.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case w.COLOR:this.pushColorMask(r)}r.type===w.SPRITE&&this.maskStack.push(r)}pop(t){const e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case w.SCISSOR:this.renderer.scissor.pop(e);break;case w.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case w.SPRITE:this.popSpriteMask(e);break;case w.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===w.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=w.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=w.SCISSOR:t.type=w.STENCIL:t.type=w.COLOR}pushSpriteMask(t){const{maskObject:e}=t,r=t._target;let i=t._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new An]));const n=this.renderer,s=n.renderTexture;let a,o;if(s.current){const e=s.current;a=t.resolution||e.resolution,o=t.multisample??e.multisample}else a=t.resolution||n.resolution,o=t.multisample??n.multisample;i[0].resolution=a,i[0].multisample=o,i[0].maskSprite=e;const h=r.filterArea;r.filterArea=e.getBounds(!0),n.filter.push(r,i),r.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}popColorMask(t){const e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}destroy(){this.renderer=null}}Cn.extension={type:vr.RendererSystem,name:"mask"},yr.add(Cn);class Dn{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,r=this.getStackLength();this.maskStack=t;const i=this.getStackLength();i!==r&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Rn=new ri,In=[],Pn=class extends Dn{constructor(t){super(t),this.glConst=S.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:r}=t,{renderer:i}=this,n=i.renderTexture,s=r.getBounds(!0,In.pop()??new Kr);this.roundFrameToPixels(s,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:r,c:i,d:n}=t;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect())return!1;if(Pn.isMatrixRotated(e.worldTransform))return!1;if(Pn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const r=t._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(t,e,r,i,n){Pn.isMatrixRotated(n)||((n=n?Rn.copyFrom(n):Rn.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,t),t.fit(i),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&In.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let Nn=Pn;Nn.extension={type:vr.RendererSystem,name:"scissor"},yr.add(Nn);class kn extends Dn{constructor(t){super(t),this.glConst=S.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:r}=this.renderer,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;0!==n&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==n&&(t._colorMask=n,r.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))),this._useCurrent()}pop(t){const e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;0!==i&&(r._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(r._colorMask=i,e.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}kn.extension={type:vr.RendererSystem,name:"stencil"},yr.add(kn);class Bn{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(Jt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract)},prepare:{enumerable:!1,get:()=>(Jt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare)},interaction:{enumerable:!1,get:()=>(Jt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events)}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Bn.extension={type:[vr.RendererSystem,vr.CanvasRendererSystem],name:"_plugin"},yr.add(Bn);class Ln{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ri,this.transform=null}update(t,e,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,r,i){const n=this.projectionMatrix,s=i?-1:1;n.identity(),n.a=1/e.width*2,n.d=s*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-s-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Ln.extension={type:vr.RendererSystem,name:"projection"},yr.add(Ln);const On=new di;class Fn{constructor(t){this.renderer=t,this._tempMatrix=new ri}generateTexture(t,e){const{region:r,...i}=e||{},n=r||t.getLocalBounds(null,!0);0===n.width&&(n.width=1),0===n.height&&(n.height=1);const s=cn.create({width:n.width,height:n.height,...i});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=On,this.renderer.render(t,{renderTexture:s,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,s}destroy(){}}Fn.extension={type:[vr.RendererSystem,vr.CanvasRendererSystem],name:"textureGenerator"},yr.add(Fn);const Un=new Kr,zn=new Kr;class Gn{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Kr,this.destinationFrame=new Kr,this.viewportFrame=new Kr}bind(t=null,e,r){const i=this.renderer;let n,s,a;this.current=t,t?(n=t.baseTexture,a=n.resolution,e||(Un.width=t.frame.width,Un.height=t.frame.height,e=Un),r||(zn.x=t.frame.x,zn.y=t.frame.y,zn.width=e.width,zn.height=e.height,r=zn),s=n.framebuffer):(a=i.resolution,e||(Un.width=i._view.screen.width,Un.height=i._view.screen.height,e=Un),r||((r=Un).width=e.width,r.height=e.height));const o=this.viewportFrame;o.x=r.x*a,o.y=r.y*a,o.width=r.width*a,o.height=r.height*a,t||(o.y=i.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(s,o),this.renderer.projection.update(r,e,a,!s),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)}clear(t,e){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=t?Ne.shared.setValue(t):r,n=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==s.width||n.height!==s.height;if(a){let{x:t,y:e,width:r,height:i}=this.viewportFrame;t=Math.round(t),e=Math.round(e),r=Math.round(r),i=Math.round(i),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,e,r,i)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Gn.extension={type:vr.RendererSystem,name:"renderTexture"},yr.add(Gn);class Hn{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function jn(t,e){const r={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const i=e.getActiveAttrib(t,n);if(i.name.startsWith("gl_"))continue;const s=Pi(e,i.type),a={type:s,name:i.name,size:Di(s),location:e.getAttribLocation(t,i.name)};r[i.name]=a}return r}function Vn(t,e){const r={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const i=e.getActiveUniform(t,n),s=i.name.replace(/\[.*?\]$/,""),a=!!i.name.match(/\[.*?\]$/),o=Pi(e,i.type);r[s]={name:s,index:n,type:o,size:i.size,isArray:a,value:gi(o,i.size)}}return r}function Wn(t,e){const r=pi(t,t.VERTEX_SHADER,e.vertexSrc),i=pi(t,t.FRAGMENT_SHADER,e.fragmentSrc),n=t.createProgram();t.attachShader(n,r),t.attachShader(n,i);const s=e.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(n,s.names,"separate"===s.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||Ti(t,n,r,i),e.attributeData=jn(n,t),e.uniformData=Vn(n,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const r=Object.keys(e.attributeData);r.sort(((t,e)=>t>e?1:-1));for(let i=0;i<r.length;i++)e.attributeData[r[i]].location=i,t.bindAttribLocation(n,i,r[i]);t.linkProgram(n)}t.deleteShader(r),t.deleteShader(i);const a={};for(const r in e.uniformData){const i=e.uniformData[r];a[r]={location:t.getUniformLocation(n,r),value:gi(i.type,i.size)}}return new Hn(n,a)}function qn(t,e,r,i,n){r.buffer.update(n)}const Xn={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Yn={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Zn(t,e){if(!t.autoManage)return{size:0,syncFunc:qn};const r=function(t,e){const r=[];for(const i in t)e[i]&&r.push(e[i]);return r.sort(((t,e)=>t.index-e.index)),r}(t.uniforms,e),{uboElements:i,size:n}=function(t){const e=t.map((t=>({data:t,offset:0,dataLen:0,dirty:0})));let r=0,i=0,n=0;for(let t=0;t<e.length;t++){const s=e[t];if(r=Yn[s.data.type],s.data.size>1&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,i%r!=0&&i<16){const t=i%r%16;i+=t,n+=t}i+r>16?(n=16*Math.ceil(n/16),s.offset=n,n+=r,i=r):(s.offset=n,i+=r,n+=r)}return n=16*Math.ceil(n/16),{uboElements:e,size:n}}(r),s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let e=0;e<i.length;e++){const r=i[e],n=t.uniforms[r.data.name],a=r.data.name;let o=!1;for(let t=0;t<vi.length;t++){const e=vi[t];if(e.codeUbo&&e.test(r.data,n)){s.push(`offset = ${r.offset/4};`,vi[t].codeUbo(r.data.name,n)),o=!0;break}}if(!o)if(r.data.size>1){const t=Di(r.data.type),e=Math.max(Yn[r.data.type]/16,1),i=t/e,n=(4-i%4)%4;s.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${r.data.size*e}; i++)\n                {\n                    for(var j = 0; j < ${i}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${n};\n                }\n\n                `)}else{const t=Xn[r.data.type];s.push(`\n                cv = ud.${a}.value;\n                v = uv.${a};\n                offset = ${r.offset/4};\n                ${t};\n                `)}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}let $n=0;const Kn={textureCount:0,uboCount:0};class Jn{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=$n++}systemCheck(){if(!Bi())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),e||(Kn.textureCount=0,Kn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Kn)),i}setUniforms(t){const e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)}syncUniformGroup(t,e){const r=this.getGlProgram();t.static&&t.dirtyId===r.uniformDirtyGroups[t.id]||(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))}syncUniforms(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=yi(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const r=this.getGlProgram();if(!t.static||0!==t.dirtyId||!r.uniformGroups[t.id]){t.dirtyId=0;const i=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),i(r.uniformData,t.uniforms,this.renderer,Kn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])}createSyncBufferGroup(t,e,r){const{gl:i}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const s=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[s];if(a||(a=this._uboCache[s]=Zn(t,this.shader.program.uniformData)),t.autoManage){const e=new Float32Array(a.size/4);t.buffer.update(e)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,r){const i=t.uniforms,n=[`${r}-`];for(const t in i)n.push(t),e[t]&&n.push(e[t].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,r=t.program,i=Wn(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Jn.extension={type:vr.RendererSystem,name:"shader"},yr.add(Jn);class Qn{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.1 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}function ts(t,e=[]){return e[u.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.ADD]=[t.ONE,t.ONE],e[u.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.NONE]=[0,0],e[u.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[u.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[u.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[u.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[u.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[u.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[u.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[u.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[u.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[u.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[u.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}Qn.defaultOptions={hello:!1},Qn.extension={type:[vr.RendererSystem,vr.CanvasRendererSystem],name:"startup"},yr.add(Qn);const es=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=u.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Sr,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=ts(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,r=0;for(;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(es.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(es.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let rs=es;rs.extension={type:vr.RendererSystem,name:"state"},yr.add(rs);class is extends(r(W)){constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter((e=>t.systems[e])),r=[...e,...Object.keys(t.systems).filter((t=>!e.includes(t)))];for(const e of r)this.addSystem(t.systems[e],e)}addRunners(...t){t.forEach((t=>{this.runners[t]=new Cr(t)}))}addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const t in this.runners)this.runners[t].add(r);return this}emitWithCustomOptions(t,e){const r=Object.keys(this._systemsHash);t.items.forEach((i=>{const n=r.find((t=>this._systemsHash[t]===i));i[t.name](e[n])}))}destroy(){Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash={}}}const ns=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=ns.defaultMaxIdle,this.checkCountMax=ns.defaultCheckCountMax,this.mode=ns.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==y.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let r=!1;for(let i=0;i<e.length;i++){const n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,r=!0)}if(r){let t=0;for(let r=0;r<e.length;r++)null!==e[r]&&(e[t++]=e[r]);e.length=t}}unload(t){const e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let e=t.children.length-1;e>=0;e--)this.unload(t.children[e])}destroy(){this.renderer=null}};let ss=ns;ss.defaultMode=y.AUTO,ss.defaultMaxIdle=3600,ss.defaultCheckCountMax=600,ss.extension={type:vr.RendererSystem,name:"textureGC"},yr.add(ss);class as{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=d.UNSIGNED_BYTE,this.internalFormat=c.RGBA,this.samplerType=0}}function os(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[d.UNSIGNED_BYTE]:{[c.RGBA]:t.RGBA8,[c.RGB]:t.RGB8,[c.RG]:t.RG8,[c.RED]:t.R8,[c.RGBA_INTEGER]:t.RGBA8UI,[c.RGB_INTEGER]:t.RGB8UI,[c.RG_INTEGER]:t.RG8UI,[c.RED_INTEGER]:t.R8UI,[c.ALPHA]:t.ALPHA,[c.LUMINANCE]:t.LUMINANCE,[c.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[d.BYTE]:{[c.RGBA]:t.RGBA8_SNORM,[c.RGB]:t.RGB8_SNORM,[c.RG]:t.RG8_SNORM,[c.RED]:t.R8_SNORM,[c.RGBA_INTEGER]:t.RGBA8I,[c.RGB_INTEGER]:t.RGB8I,[c.RG_INTEGER]:t.RG8I,[c.RED_INTEGER]:t.R8I},[d.UNSIGNED_SHORT]:{[c.RGBA_INTEGER]:t.RGBA16UI,[c.RGB_INTEGER]:t.RGB16UI,[c.RG_INTEGER]:t.RG16UI,[c.RED_INTEGER]:t.R16UI,[c.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[d.SHORT]:{[c.RGBA_INTEGER]:t.RGBA16I,[c.RGB_INTEGER]:t.RGB16I,[c.RG_INTEGER]:t.RG16I,[c.RED_INTEGER]:t.R16I},[d.UNSIGNED_INT]:{[c.RGBA_INTEGER]:t.RGBA32UI,[c.RGB_INTEGER]:t.RGB32UI,[c.RG_INTEGER]:t.RG32UI,[c.RED_INTEGER]:t.R32UI,[c.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[d.INT]:{[c.RGBA_INTEGER]:t.RGBA32I,[c.RGB_INTEGER]:t.RGB32I,[c.RG_INTEGER]:t.RG32I,[c.RED_INTEGER]:t.R32I},[d.FLOAT]:{[c.RGBA]:t.RGBA32F,[c.RGB]:t.RGB32F,[c.RG]:t.RG32F,[c.RED]:t.R32F,[c.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[d.HALF_FLOAT]:{[c.RGBA]:t.RGBA16F,[c.RGB]:t.RGB16F,[c.RG]:t.RG16F,[c.RED]:t.R16F},[d.UNSIGNED_SHORT_5_6_5]:{[c.RGB]:t.RGB565},[d.UNSIGNED_SHORT_4_4_4_4]:{[c.RGBA]:t.RGBA4},[d.UNSIGNED_SHORT_5_5_5_1]:{[c.RGBA]:t.RGB5_A1},[d.UNSIGNED_INT_2_10_10_10_REV]:{[c.RGBA]:t.RGB10_A2,[c.RGBA_INTEGER]:t.RGB10_A2UI},[d.UNSIGNED_INT_10F_11F_11F_REV]:{[c.RGB]:t.R11F_G11F_B10F},[d.UNSIGNED_INT_5_9_9_9_REV]:{[c.RGB]:t.RGB9_E5},[d.UNSIGNED_INT_24_8]:{[c.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[d.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[c.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[d.UNSIGNED_BYTE]:{[c.RGBA]:t.RGBA,[c.RGB]:t.RGB,[c.ALPHA]:t.ALPHA,[c.LUMINANCE]:t.LUMINANCE,[c.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[d.UNSIGNED_SHORT_5_6_5]:{[c.RGB]:t.RGB},[d.UNSIGNED_SHORT_4_4_4_4]:{[c.RGBA]:t.RGBA},[d.UNSIGNED_SHORT_5_5_5_1]:{[c.RGBA]:t.RGBA}},e}class hs{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Nr,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=os(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let t=0;t<e;t++)this.boundTextures[t]=null;this.emptyTextures={};const r=new as(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new as(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let e=0;e<6;e++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let t=0;t<this.boundTextures.length;t++)this.bind(null,t)}bind(t,e=0){const{gl:r}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<r.length;t++)r[t]===this.unknownTexture&&this.bind(null,t)}for(let i=0;i<r.length;i++)r[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[i]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let r=t-1;r>=0;--r){const t=e[r];if(t){t._glTextures[i].samplerType!==p.FLOAT&&this.renderer.texture.unbind(t)}}}initTexture(t){const e=new as(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,2===this.webGLVersion&&t.type===d.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const r=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(r,t,e))e.samplerType!==p.FLOAT&&(this.hasIntegerTextures=!0);else{const i=t.realWidth,n=t.realHeight,s=r.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,s.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:r}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const e=this.managedTextures.indexOf(t);-1!==e&&Ke(this.managedTextures,e,1)}}updateTextureStyle(t){const e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==v.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=g.CLAMP,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const r=this.gl;if(e.mipmap&&t.mipmap!==v.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===m.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const e=this.renderer.context.extensions.anisotropicFiltering;if(e&&t.anisotropicLevel>0&&t.scaleMode===m.LINEAR){const i=Math.min(t.anisotropicLevel,r.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,e.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===m.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===m.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}hs.extension={type:vr.RendererSystem,name:"texture"},yr.add(hs);class us{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,i=t._glTransformFeedbacks[r]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:r,renderer:i}=this;e&&i.shader.bind(e),r.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:r,CONTEXT_UID:i}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[i]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let n=0;n<t.buffers.length;n++){const s=t.buffers[n];s&&(r.buffer.update(s),s._glBuffers[i].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,n,s._glBuffers[i].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const r=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let r=0;r<t.buffers.length;r++){const i=t.buffers[r];if(!i)continue;const s=i._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0!==s.refCount||e||n.dispose(i,e))}r&&(e||i.deleteTransformFeedback(r),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}us.extension={type:vr.RendererSystem,name:"transformFeedback"},yr.add(us);class ls{constructor(t){this.renderer=t}init(t){this.screen=new Kr(0,0,t.width,t.height),this.element=t.view||S.ADAPTER.createCanvas(),this.resolution=t.resolution||S.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}ls.defaultOptions={width:800,height:600,resolution:S.RESOLUTION,autoDensity:!1},ls.extension={type:[vr.RendererSystem,vr.CanvasRendererSystem],name:"_view"},yr.add(ls),S.PREFER_ENV=a.WEBGL2,S.STRICT_TEXTURE_CACHE=!1,S.RENDER_OPTIONS={...tn.defaultOptions,...Ki.defaultOptions,...ls.defaultOptions,...Qn.defaultOptions},Object.defineProperties(S,{WRAP_MODE:{get:()=>Nr.defaultOptions.wrapMode,set(t){Jt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Nr.defaultOptions.wrapMode=t}},SCALE_MODE:{get:()=>Nr.defaultOptions.scaleMode,set(t){Jt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Nr.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get:()=>Nr.defaultOptions.mipmap,set(t){Jt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Nr.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get:()=>Nr.defaultOptions.anisotropicLevel,set(t){Jt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Nr.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get:()=>(Jt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),$i.defaultResolution),set(t){$i.defaultResolution=t}},FILTER_MULTISAMPLE:{get:()=>(Jt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),$i.defaultMultisample),set(t){$i.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get:()=>Yi.defaultMaxTextures,set(t){Jt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Yi.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get:()=>Yi.defaultBatchSize,set(t){Jt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Yi.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get:()=>Yi.canUploadSameBuffer,set(t){Jt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Yi.canUploadSameBuffer=t}},GC_MODE:{get:()=>ss.defaultMode,set(t){Jt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ss.defaultMode=t}},GC_MAX_IDLE:{get:()=>ss.defaultMaxIdle,set(t){Jt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ss.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get:()=>ss.defaultCheckCountMax,set(t){Jt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ss.defaultCheckCountMax=t}},PRECISION_VERTEX:{get:()=>Ui.defaultVertexPrecision,set(t){Jt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ui.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get:()=>Ui.defaultFragmentPrecision,set(t){Jt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ui.defaultFragmentPrecision=t}}});var cs=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(cs||{});class fs{constructor(t,e=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=i}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const ds=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new fs(null,null,1/0),this.deltaMS=1/ds.targetFPMS,this.elapsedMS=1/ds.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=cs.NORMAL){return this._addListener(new fs(t,e,r))}addOnce(t,e,r=cs.NORMAL){return this._addListener(new fs(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ds.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,ds.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ds._shared){const t=ds._shared=new ds;t.autoStart=!0,t._protected=!0}return ds._shared}static get system(){if(!ds._system){const t=ds._system=new ds;t.autoStart=!0,t._protected=!0}return ds._system}};let ps=ds;ps.targetFPMS=.06,Object.defineProperties(S,{TARGET_FPMS:{get:()=>ps.targetFPMS,set(t){Jt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ps.targetFPMS=t}}});class ms{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,cs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ps.shared:new ps,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}ms.extension=vr.Application,yr.add(ms);const gs=[];function vs(t){for(const e of gs)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}yr.handleByList(vr.Renderer,gs);const _s="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class bs{constructor(t){this.renderer=t}contextChange(t){let e;if(1===this.renderer.context.webGLVersion){const r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{const r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}e>=E.HIGH?this.multisample=E.HIGH:e>=E.MEDIUM?this.multisample=E.MEDIUM:e>=E.LOW?this.multisample=E.LOW:this.multisample=E.NONE}destroy(){}}bs.extension={type:vr.RendererSystem,name:"_multisample"},yr.add(bs);class ys{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class xs{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,i=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,r){const{gl:i,CONTEXT_UID:n}=this;r=r||0;const s=t._glBuffers[n]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,s.buffer,256*r,256)}update(t){const{gl:e,CONTEXT_UID:r}=this,i=t._glBuffers[r]||this.createGLBuffer(t);if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(e||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:r}=this;return t._glBuffers[e]=new ys(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}xs.extension={type:vr.RendererSystem,name:"buffer"},yr.add(xs);class ws{constructor(t){this.renderer=t}render(t,e){const r=this.renderer;let i,n,s,a;if(e&&(i=e.renderTexture,n=e.clear,s=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!i,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=s,!r.context.isLost){if(i||(this.lastObjectRendered=t),!a){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}r.renderTexture.bind(i),r.batch.currentRenderer.start(),(n??r.background.clearBeforeRender)&&r.renderTexture.clear(),t.render(r),r.batch.currentRenderer.flush(),i&&(e.blit&&r.framebuffer.blit(),i.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ws.extension={type:vr.RendererSystem,name:"objectRenderer"},yr.add(ws);const Es=class extends is{constructor(t){super(),this.type=o.WEBGL,t=Object.assign({},S.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Gi({projectionMatrix:new ri},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Es.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(Jt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=Es.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return!t?.forceCanvas&&re()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Jt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Jt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Jt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Jt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Jt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Jt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Jt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Jt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let Ms=Es;Ms.extension={type:vr.Renderer,priority:1},Ms.__plugins={},Ms.__systems={},yr.handleByMap(vr.RendererPlugin,Ms.__plugins),yr.handleByMap(vr.RendererSystem,Ms.__systems),yr.add(Ms);class Ss extends Dr{constructor(t,e){const{width:r,height:i}=e||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let e=0;e<t;e++){const t=new Nr;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof Dr?this.addResourceAt(t[r],r):this.addResourceAt(Tr(t[r],e),r))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map((t=>t.resource)).filter((t=>t)).map((t=>t.load()));return this._load=Promise.all(t).then((()=>{const{realWidth:t,realHeight:e}=this.items[0];return this.resize(t,e),Promise.resolve(this)})),this._load}}const As=class extends Ss{constructor(t,e){const{width:r,height:i,autoLoad:n,linkBaseTexture:s}=e||{};if(t&&t.length!==As.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:r,height:i});for(let t=0;t<As.SIDES;t++)this.items[t].target=f.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=!1!==s,t&&this.initFromArray(t,e),!1!==n&&this.load()}bind(t){super.bind(t),t.target=f.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=f.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,r){const i=this.itemDirtyIds;for(let n=0;n<As.SIDES;n++){const s=this.items[n];(i[n]<s.dirtyId||r.dirtyId<e.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,r),i[n]=s.dirtyId):i[n]<-1&&(t.gl.texImage2D(s.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),i[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===As.SIDES}};let Ts=As;Ts.SIDES=6;class Cs extends sn{constructor(t,e){let r,i;e=e||{},"string"==typeof t?(r=Cs.EMPTY,i=t):(r=t,i=null),super(r),this.url=i,this.crossOrigin=e.crossOrigin??!0,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(t,e)=>{if(null!==this.url)try{const e=await S.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await e.blob();if(this.destroyed)return;const i=await createImageBitmap(r,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===_.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=i,this.update(),t(this)}catch(t){if(this.destroyed)return;e(t),this.onError.emit(t)}else t(this)}))),this._load}upload(t,e,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),super.upload(t,e,r)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){return Cs._EMPTY=Cs._EMPTY??S.ADAPTER.createCanvas(0,0),Cs._EMPTY}}const Ds=class extends sn{constructor(t,e){e=e||{},super(S.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},Ds.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const t=new Image;sn.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,r=t.height;if(!e||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=e*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*e,n=this._overrideHeight||this._overrideWidth/e*r),i=Math.round(i),n=Math.round(n);const s=this.source;s.width=i,s.height=n,s._pixiId=`canvas_${tr()}`,s.getContext("2d").drawImage(t,0,0,e,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(t){const e=Ds.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return"svg"===e||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&Ds.SVG_XML.test(t)}};let Rs=Ds;Rs.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Rs.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Is=class extends sn{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]);const i=t[0].src||t[0];sn.crossOrigin(r,i,e.crossorigin);for(let e=0;e<t.length;++e){const i=document.createElement("source");let{src:n,mime:s}=t[e];n=n||t[e];const a=n.split("?").shift().toLowerCase(),o=a.slice(a.lastIndexOf(".")+1);s=s||Is.MIME_TYPES[o]||`video/${o}`,i.src=n,i.type=s,r.appendChild(i)}t=r}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}update(t=0){if(!this.destroyed){const t=ps.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e=>{this.valid?e(this):(this._resolve=e,t.load())})),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(ps.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(ps.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(ps.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(ps.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(ps.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Is.TYPES.includes(e)}};let Ps=Is;Ps.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Ps.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},Ar.push(Cs,an,class extends sn{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}},Ps,Rs,Rr,Ts,class extends Ss{constructor(t,e){const{width:r,height:i}=e||{};let n,s;Array.isArray(t)?(n=t,s=t.length):s=t,super(s,{width:r,height:i}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}bind(t){super.bind(t),t.target=f.TEXTURE_2D_ARRAY}upload(t,e,r){const{length:i,itemDirtyIds:n,items:s}=this,{gl:a}=t;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,e.format,r.type,null);for(let t=0;t<i;t++){const i=s[t];n[t]<i.dirtyId&&(n[t]=i.dirtyId,i.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,t,i.resource.width,i.resource.height,1,e.format,r.type,i.resource.source))}return!0}});class Ns{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Kr.EMPTY:((t=t||new Kr(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:r,b:i,c:n,d:s,tx:a,ty:o}=t,h=r*e.x+n*e.y+a,u=i*e.x+s*e.y+o;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=t[0],a=t[1];e=s<e?s:e,r=a<r?a:r,i=s>i?s:i,n=a>n?a:n,s=t[2],a=t[3],e=s<e?s:e,r=a<r?a:r,i=s>i?s:i,n=a>n?a:n,s=t[4],a=t[5],e=s<e?s:e,r=a<r?a:r,i=s>i?s:i,n=a>n?a:n,s=t[6],a=t[7],e=s<e?s:e,r=a<r?a:r,i=s>i?s:i,n=a>n?a:n,this.minX=e,this.minY=r,this.maxX=i,this.maxY=n}addFrame(t,e,r,i,n){this.addFrameMatrix(t.worldTransform,e,r,i,n)}addFrameMatrix(t,e,r,i,n){const s=t.a,a=t.b,o=t.c,h=t.d,u=t.tx,l=t.ty;let c=this.minX,f=this.minY,d=this.maxX,p=this.maxY,m=s*e+o*r+u,g=a*e+h*r+l;c=m<c?m:c,f=g<f?g:f,d=m>d?m:d,p=g>p?g:p,m=s*i+o*r+u,g=a*i+h*r+l,c=m<c?m:c,f=g<f?g:f,d=m>d?m:d,p=g>p?g:p,m=s*e+o*n+u,g=a*e+h*n+l,c=m<c?m:c,f=g<f?g:f,d=m>d?m:d,p=g>p?g:p,m=s*i+o*n+u,g=a*i+h*n+l,c=m<c?m:c,f=g<f?g:f,d=m>d?m:d,p=g>p?g:p,this.minX=c,this.minY=f,this.maxX=d,this.maxY=p}addVertexData(t,e,r){let i=this.minX,n=this.minY,s=this.maxX,a=this.maxY;for(let o=e;o<r;o+=2){const e=t[o],r=t[o+1];i=e<i?e:i,n=r<n?r:n,s=e>s?e:s,a=r>a?r:a}this.minX=i,this.minY=n,this.maxX=s,this.maxY=a}addVertices(t,e,r,i){this.addVerticesMatrix(t.worldTransform,e,r,i)}addVerticesMatrix(t,e,r,i,n=0,s=n){const a=t.a,o=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;let f=this.minX,d=this.minY,p=this.maxX,m=this.maxY;for(let t=r;t<i;t+=2){const r=e[t],i=e[t+1],g=a*r+h*i+l,v=u*i+o*r+c;f=Math.min(f,g-n),p=Math.max(p,g+n),d=Math.min(d,v-s),m=Math.max(m,v+s)}this.minX=f,this.minY=d,this.maxX=p,this.maxY=m}addBounds(t){const e=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const r=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=n&&i<=s){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=r<t?r:t,this.minY=i<e?i:e,this.maxX=n>a?n:a,this.maxY=s>o?s:o}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const r=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=n&&i<=s){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=r<t?r:t,this.minY=i<e?i:e,this.maxX=n>a?n:a,this.maxY=s>o?s:o}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,r,i,n,s){t-=n,e-=s,r+=n,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i}}class ks extends V.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new di,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Ns,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let r=0;r<e.length;++r){const i=e[r];Object.defineProperty(ks.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Kr),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Kr),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Ns);const e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-n,s}toGlobal(t,e,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,r,i){return e&&(t=e.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,r=1,i=1,n=0,s=0,a=0,o=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=a,this.pivot.x=o,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Bs),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*qr}set angle(t){this.transform.rotation=t*Xr}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class Bs extends ks{constructor(){super(...arguments),this.sortDirty=null}}ks.prototype.displayObjectUpdateTransform=ks.prototype.updateTransform;const Ls=new ri;function Os(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const Fs=class extends ks{constructor(){super(),this.children=[],this.sortableChildren=Fs.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const r=this.getChildIndex(t),i=this.getChildIndex(e);this.children[r]=e,this.children[i]=t,this.onChildrenChange(r<i?r:i)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const r=this.getChildIndex(t);V.removeItems(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],r=this.children.indexOf(e);if(-1===r)return null;e.parent=null,e.transform._parentID=-1,V.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,V.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const r=t,i=e-r;let n;if(i>0&&i<=e){n=this.children.splice(r,i);for(let t=0;t<n.length;++t)n[t].parent=null,n[t].transform&&(n[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<n.length;++t)n[t].emit("removed",this),this.emit("childRemoved",n[t],this,t);return n}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,r=this.children.length;e<r;++e){const r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Os),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const r=super.getLocalBounds(t);if(!e)for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==Fs.prototype._render&&(r=this.getBounds(!0));const n=t.projection.transform;if(n&&(i?(i=Ls.copyFrom(i),i.prepend(n)):i=n),r&&e.intersects(r,i))this._render(t);else if(this.cullArea)return;for(let e=0,r=this.children.length;e<r;++e){const r=this.children[e],i=r.cullable;r.cullable=i||!this.cullArea,r.render(t),r.cullable=i}}render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<e.length;t++)e[t].enabled&&this._enabledFilters.push(e[t])}const i=e&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==w.NONE));if(i&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}i&&t.batch.flush(),r&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:t?.children,r=this.removeChildren(0,this.children.length);if(e)for(let e=0;e<r.length;++e)r[e].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}};let Us=Fs;Us.defaultSortableChildren=!1,Us.prototype.containerUpdateTransform=Us.prototype.updateTransform,Object.defineProperties(S,{SORTABLE_CHILDREN:{get:()=>Us.defaultSortableChildren,set(t){V.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Us.defaultSortableChildren=t}}});const zs=new Zr,Gs=new Uint16Array([0,1,2,0,2,3]);class Hs extends Us{constructor(t){super(),this._anchor=new ci(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ne(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=u.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||ln.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Gs,this.pluginName="batch",this.isSprite=!0,this._roundPixels=S.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=V.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=V.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,a=e.tx,o=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor;let f=0,d=0,p=0,m=0;if(u?(d=u.x-c._x*l.width,f=d+u.width,m=u.y-c._y*l.height,p=m+u.height):(d=-c._x*l.width,f=d+l.width,m=-c._y*l.height,p=m+l.height),h[0]=r*d+n*m+a,h[1]=s*m+i*d+o,h[2]=r*f+n*m+a,h[3]=s*m+i*f+o,h[4]=r*f+n*p+a,h[5]=s*p+i*f+o,h[6]=r*d+n*p+a,h[7]=s*p+i*d+o,this._roundPixels){const t=S.RESOLUTION;for(let e=0;e<h.length;++e)h[e]=Math.round(h[e]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,a=n.b,o=n.c,h=n.d,u=n.tx,l=n.ty,c=-i._x*r.width,f=c+r.width,d=-i._y*r.height,p=d+r.height;e[0]=s*c+o*d+u,e[1]=h*d+a*c+l,e[2]=s*f+o*d+u,e[3]=h*d+a*f+l,e[4]=s*f+o*p+u,e[5]=h*p+a*f+l,e[6]=s*c+o*p+u,e[7]=h*p+a*c+l}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new Ns),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Kr),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,zs);const e=this._texture.orig.width,r=this._texture.orig.height,i=-e*this.anchor.x;let n=0;return zs.x>=i&&zs.x<i+e&&(n=-r*this.anchor.y,zs.y>=n&&zs.y<n+r)}destroy(t){super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const r=t instanceof ln?t:ln.from(t,e);return new Hs(r)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=V.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=V.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ln.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const js=new ri;ks.prototype._cacheAsBitmap=!1,ks.prototype._cacheData=null,ks.prototype._cacheAsBitmapResolution=null,ks.prototype._cacheAsBitmapMultisample=null;class Vs{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(ks.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Vs),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),ks.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},ks.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(null,!0).clone();if(this.filters?.length){const t=this.filters[0].padding;r.pad(t)}r.ceil(S.RESOLUTION);const i=t.renderTexture.current,n=t.renderTexture.sourceFrame.clone(),s=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,o=cn.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${V.uid()}`;this._cacheData.textureCacheId=h,Nr.addToCache(o.baseTexture,h),ln.addToCache(o,h);const u=this.transform.localTransform.copyTo(js).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:o,clear:!0,transform:u,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,n,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const l=new Hs(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-r.x/r.width,l.anchor.y=-r.y/r.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=l.containsPoint.bind(l)},ks.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},ks.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;const e=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;const i=t.canvasContext.activeContext,n=t._projTransform;e.ceil(S.RESOLUTION);const s=cn.create({width:e.width,height:e.height}),a=`cacheAsBitmap_${V.uid()}`;this._cacheData.textureCacheId=a,Nr.addToCache(s.baseTexture,a),ln.addToCache(s,a);const o=js;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:s,clear:!0,transform:o,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const h=new Hs(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)},ks.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ks.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ks.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Nr.removeFromCache(this._cacheData.textureCacheId),ln.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ks.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},ks.prototype.name=null,Us.prototype.getChildByName=function(t,e){for(let e=0,r=this.children.length;e<r;e++)if(this.children[e].name===t)return this.children[e];if(e)for(let e=0,r=this.children.length;e<r;e++){const r=this.children[e];if(!r.getChildByName)continue;const i=r.getChildByName(t,!0);if(i)return i}return null},ks.prototype.getGlobalPosition=function(t=new Zr,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};const Ws={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},qs=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function Xs(t){const e=Ws[t],r=e.length;let i=qs,n="";let s;for(let i=0;i<t;i++){let a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());s=i,i>=r&&(s=t-i-1),a=a.replace("%value%",e[s].toString()),n+=a,n+="\n"}return i=i.replace("%blur%",n),i=i.replace("%size%",t.toString()),i}function Ys(t,e){const r=Math.ceil(t/2);let i,n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";i=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let e=0;e<t;e++){let t=i.replace("%index%",e.toString());t=t.replace("%sampleIndex%",e-(r-1)+".0"),s+=t,s+="\n"}return n=n.replace("%blur%",s),n=n.replace("%size%",t.toString()),n}class Zs extends $i{constructor(t,e=8,r=4,i=$i.defaultResolution,n=5){super(Ys(n,t),Xs(n)),this.horizontal=t,this.resolution=i,this._quality=0,this.quality=r,this.blur=e}apply(t,e,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,i);else{const n=t.getFilterTexture(),s=t.renderer;let a=e,o=n;this.state.blend=!1,t.applyFilter(this,a,o,b.CLEAR);for(let e=1;e<this.passes-1;e++){t.bindAndClear(a,b.BLIT),this.uniforms.uSampler=o;const e=o;o=a,a=e,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,r,i),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class $s extends $i{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(_s,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",t),this.alpha=1}_loadMatrix(t,e=!1){let r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}tint(t,e){const[r,i,n]=Ne.shared.setValue(t).toArray(),s=[r,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(s,e)}greyscale(t,e){const r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,e){t=(t||0)/180*Math.PI;const r=Math.cos(t),i=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),a=[r+(1-r)*n,n*(1-r)-s*i,n*(1-r)+s*i,0,0,n*(1-r)+s*i,r+n*(1-r),n*(1-r)-s*i,0,0,n*(1-r)-s*i,n*(1-r)+s*i,r+n*(1-r),0,0,0,0,0,1,0];this._loadMatrix(a,e)}contrast(t,e){const r=(t||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const r=2*t/3+1,i=-.5*(r-1),n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,e,r,i,n){t=t||.2,e=e||.15,r=r||16770432,i=i||3375104;const s=Ne.shared,[a,o,h]=s.setValue(r).toArray(),[u,l,c]=s.setValue(i).toArray(),f=[.3,.59,.11,0,0,a,o,h,t,0,u,l,c,e,0,a-u,o-l,h-c,0,0];this._loadMatrix(f,n)}night(t,e){const r=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}predator(t,e){const r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}$s.prototype.grayscale=$s.prototype.greyscale;class Ks extends $i{constructor(t=.5,e=Math.random()){super(_s,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Js={AlphaFilter:class extends $i{constructor(t=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}},BlurFilter:class extends $i{constructor(t=8,e=4,r=$i.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Zs(!0,t,e,r,i),this.blurYFilter=new Zs(!1,t,e,r,i),this.resolution=r,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,r,i){const n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){const n=t.getFilterTexture();this.blurXFilter.apply(t,e,n,b.CLEAR),this.blurYFilter.apply(t,n,r,i),t.returnFilterTexture(n)}else s?this.blurYFilter.apply(t,e,r,i):this.blurXFilter.apply(t,e,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}},BlurFilterPass:Zs,ColorMatrixFilter:$s,DisplacementFilter:class extends $i{constructor(t,e){const r=new ri;t.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=r,null==e&&(e=20),this.scale=new Zr(e,e)}apply(t,e,r,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==a&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,r,i)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}},FXAAFilter:class extends $i{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:Ks};Object.entries(Js).forEach((([t,e])=>{Object.defineProperty(Js,t,{get:()=>(V.deprecation("7.1.0",`filters.${t} has moved to ${t}`),e)})}));const Qs=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){!this.tickerAdded&&this.domElement&&(ps.system.add(this.tickerUpdate,this,cs.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ps.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}};class ta{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ta.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Zr,this.page=new Zr,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,r,i,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class ea extends ta{constructor(){super(...arguments),this.client=new Zr,this.movement=new Zr,this.offset=new Zr,this.global=new Zr,this.screen=new Zr}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,r,i,n,s,a,o,h,u,l,c,f,d,p){throw new Error("Method not implemented.")}}class ra extends ea{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class ia extends ea{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}ia.DOM_DELTA_PIXEL=0,ia.DOM_DELTA_LINE=1,ia.DOM_DELTA_PAGE=2;const na=new Zr,sa=new Zr;class aa{constructor(t){this.dispatch=new V.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._collectInteractiveElements=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(((t,e)=>t.priority-e.priority))}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let r=0,i=e.length;r<i;r++)e[r].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Qs.pauseUpdate=!0;const r=this.hitTestRecursive(this.rootTarget,this.rootTarget.eventMode,na.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,n=r.length-1;i<n;i++)if(t.currentTarget=r[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(t.currentTarget=r[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,r=this._allInteractiveElements){if(0===r.length)return;t.eventPhase=t.BUBBLING_PHASE;const i=Array.isArray(e)?e:[e];for(let e=r.length-1;e>=0;e--)i.forEach((i=>{t.currentTarget=r[e],this.notifyTarget(t,i)}))}propagationPath(t){const e=[t];for(let r=0;r<2048&&t!==this.rootTarget;r++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,r,i,n){if(n(t,r))return null;if("dynamic"!==t.eventMode&&"dynamic"!==e||(Qs.pauseUpdate=!1),t.interactiveChildren&&t.children){const s=t.children;for(let a=s.length-1;a>=0;a--){const o=s[a],h=this.hitTestRecursive(o,this._isInteractive(e)?e:o.eventMode,r,i,n);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const e=t.isInteractive();if((h.length>0||e)&&(this._collectInteractiveElements&&e&&this._allInteractiveElements.push(t),h.push(t)),this._collectInteractiveElements&&0===this._hitElements.length&&(this._hitElements=h),!this._collectInteractiveElements)return h}}}const s=this._isInteractive(e),a=t.isInteractive();return this._collectInteractiveElements&&(s&&a&&this._allInteractiveElements.push(t),this._hitElements.length>0)?null:s&&i(t,r)?a?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}hitPruneFn(t,e){if(!t||t.isMask||!t.visible||!t.renderable)return!0;if("none"===t.eventMode)return!0;if("passive"===t.eventMode&&!t.interactiveChildren)return!0;if(t.isMask)return!0;if(this._collectInteractiveElements)return!1;if(t.hitArea&&(t.worldTransform.applyInverse(e,sa),!t.hitArea.contains(sa.x,sa.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!r.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return"passive"!==t.eventMode&&(!!t.hitArea||!!t.containsPoint&&t.containsPoint(e))}notifyTarget(t,e){const r=`on${e=e??t.type}`;t.currentTarget[r]?.(t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._collectInteractiveElements=!0;const e=this.createPointerEvent(t);this._collectInteractiveElements=!1;const r="mouse"===e.pointerType||"pen"===e.pointerType,i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&n!==e.target){const i="mousemove"===t.type?"mouseout":"pointerout",s=this.createPointerEvent(t,i,n);if(this.dispatchEvent(s,"pointerout"),r&&this.dispatchEvent(s,"mouseout"),!e.composedPath().includes(n)){const i=this.createPointerEvent(t,"pointerleave",n);for(i.eventPhase=i.AT_TARGET;i.target&&!e.composedPath().includes(i.target);)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseleave"),i.target=i.target.parent;this.freeEvent(i)}this.freeEvent(s)}if(n!==e.target){const i="mousemove"===t.type?"mouseover":"pointerover",s=this.clonePointerEvent(e,i);this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover");let a=n?.parent;for(;a&&a!==this.rootTarget.parent&&a!==e.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const t=this.clonePointerEvent(e,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==n&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),r&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(s)}const s=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?s.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&s.push("globalpointermove"),"touch"===e.pointerType&&(this.moveOnAll?s.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&s.push("globaltouchmove")),r&&(this.moveOnAll?s.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&s.push("globalmousemove"),this.cursor=e.target?.cursor),s.length>0&&this.all(e,s),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),r=this.createPointerEvent(t),i="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=r.target?.cursor);const n=this.clonePointerEvent(r,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId);if(e.overTargets){const r="mouse"===t.pointerType||"pen"===t.pointerType,i=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout");const s=this.createPointerEvent(t,"pointerleave",i);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),r&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(s)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=performance.now(),r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){const t=2===r.button;this.dispatchEvent(r,t?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[t.button]);let s=n;if(n&&!r.composedPath().includes(n)){let e=n;for(;e&&!r.composedPath().includes(e);){if(r.currentTarget=e,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){const t=2===r.button;this.notifyTarget(r,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete i.pressTargetsByButton[t.button],s=e}if(s){const n=this.clonePointerEvent(r,"click");n.target=s,n.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:n.target,timeStamp:e});const a=i.clicksByButton[t.button];if(a.target===n.target&&e-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=n.target,a.timeStamp=e,n.detail=a.clickCount,"mouse"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightclick":"click")}else"touch"===n.pointerType&&this.dispatchEvent(n,"tap");this.dispatchEvent(n,"pointertap"),this.freeEvent(n)}this.freeEvent(r)}mapPointerUpOutside(t){if(!(t instanceof ra))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),r=this.findMountedTarget(e.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(r){let n=r;for(;n;)i.currentTarget=n,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?this.notifyTarget(i,"touchendoutside"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof ia))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let r=1;r<t.length&&t[r].parent===e;r++)e=t[r];return e}createPointerEvent(t,e,r){const i=this.allocateEvent(ra);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],"string"==typeof e&&(i.type=e),i}createWheelEvent(t){const e=this.allocateEvent(ia);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const r=this.allocateEvent(ra);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=e??r.type,r}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ra&&e instanceof ra&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof ea&&e instanceof ea&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const r=t.currentTarget._events[e];if(r&&t.currentTarget.isInteractive())if("fn"in r)r.once&&t.currentTarget.removeListener(e,r.fn,void 0,!0),r.fn.call(r.context,t);else for(let i=0,n=r.length;i<n&&!t.propagationImmediatelyStopped;i++)r[i].once&&t.currentTarget.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,t)}}const oa={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},ha=class{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new aa(null),Qs.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ra(null),this.rootWheelEvent=new ia(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...ha.defaultEventFeatures},{set:(t,e,r)=>("globalMove"===e&&(this.rootBoundary.enableGlobalMoveEvents=r),t[e]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:r}=this.renderer;this.setTargetElement(e),this.resolution=r,ha._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.domElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.domElement.style,r)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized){(t.cancelable||!("cancelable"in t))&&t.preventDefault()}for(let t=0,r=e.length;t<r;t++){const r=e[t],i=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;Qs.pointerMoved();const e=this.normalizeToPointerData(t);for(let t=0,r=e.length;t<r;t++){const r=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const r=e!==this.domElement?"outside":"",i=this.normalizeToPointerData(t);for(let t=0,e=i.length;t<e;t++){const e=this.bootstrapEvent(this.rootPointerEvent,i[t]);e.type+=r,this.rootBoundary.mapEvent(e)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);for(let t=0,r=e.length;t<r;t++){const r=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Qs.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Qs.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Qs.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,r){let i;i=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const n=1/this.resolution;t.x=(e-i.left)*(this.domElement.width/i.width)*n,t.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let r=0,i=t.changedTouches.length;r<i;r++){const i=t.changedTouches[r];void 0===i.button&&(i.button=0),void 0===i.buttons&&(i.buttons=1),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=t.type,e.push(i)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{const r=t;void 0===r.isPrimary&&(r.isPrimary=!0),void 0===r.width&&(r.width=1),void 0===r.height&&(r.height=1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="mouse"),void 0===r.pointerId&&(r.pointerId=1),void 0===r.pressure&&(r.pressure=.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=oa[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};let ua=ha;function la(t){return"dynamic"===t||"static"===t}ua.extension={name:"events",type:[vr.RendererSystem,vr.CanvasRendererSystem]},ua.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},yr.add(ua);const ca={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??la(ua.defaultEventMode)},set interactive(t){Jt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ua.defaultEventMode},set eventMode(t){this._internalInteractive=la(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,r){const i="function"==typeof e?void 0:e;t="boolean"==typeof r&&r||"object"==typeof r&&r.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.on(t,e,i)},removeEventListener(t,e,r){const i="function"==typeof e?void 0:e;t="boolean"==typeof r&&r||"object"==typeof r&&r.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof ta))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};ks.mixin(ca);ks.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class fa{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(V.isMobile.tablet||V.isMobile.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let t=0;t<e.length;t++)this.updateAccessibleObjects(e[t])}update(){const t=performance.now();if(V.isMobile.android.device&&t<this.androidUpdateCount)return;if(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen)return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:r,width:i,height:n}=this.renderer.view.getBoundingClientRect(),{width:s,height:a,resolution:o}=this.renderer,h=i/s*o,u=n/a*o;let l=this.div;l.style.left=`${e}px`,l.style.top=`${r}px`,l.style.width=`${s}px`,l.style.height=`${a}px`;for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.renderId!==this.renderId)e._accessibleActive=!1,V.removeItems(this.children,t,1),this.div.removeChild(e._accessibleDiv),this.pool.push(e._accessibleDiv),e._accessibleDiv=null,t--;else{l=e._accessibleDiv;let t=e.hitArea;const r=e.worldTransform;e.hitArea?(l.style.left=(r.tx+t.x*r.a)*h+"px",l.style.top=(r.ty+t.y*r.d)*u+"px",l.style.width=t.width*r.a*h+"px",l.style.height=t.height*r.d*u+"px"):(t=e.getBounds(),this.capHitArea(t),l.style.left=t.x*h+"px",l.style.top=t.y*u+"px",l.style.width=t.width*h+"px",l.style.height=t.height*u+"px",l.title!==e.accessibleTitle&&null!==e.accessibleTitle&&(l.title=e.accessibleTitle),l.getAttribute("aria-label")!==e.accessibleHint&&null!==e.accessibleHint&&l.setAttribute("aria-label",e.accessibleHint)),e.accessibleTitle===l.title&&e.tabIndex===l.tabIndex||(l.title=e.accessibleTitle,l.tabIndex=e.tabIndex,this.debug&&this.updateDebugHTML(l))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:r}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>r&&(t.height=r-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:r}=t.target,i=this.renderer.events.rootBoundary,n=Object.assign(new ta(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,e.forEach((t=>i.dispatchEvent(n,t)))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}fa.extension={name:"accessibility",type:[vr.RendererPlugin,vr.CanvasRendererPlugin]},yr.add(fa);const da=class{constructor(t){this.stage=new Us,t=Object.assign({forceCanvas:!1},t),this.renderer=vs(t),da._plugins.forEach((e=>{e.init.call(this,t)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const r=da._plugins.slice(0);r.reverse(),r.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let pa=da;pa._plugins=[],yr.handleByList(vr.Application,pa._plugins);class ma{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:i}=this._resizeTo;t=r,e=i}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ma.extension=vr.Application,yr.add(ma);const ga={loader:vr.LoadParser,resolver:vr.ResolveParser,cache:vr.CacheParser,detection:vr.DetectionParser};yr.handle(vr.Asset,(t=>{const e=t.ref;Object.entries(ga).filter((([t])=>!!e[t])).forEach((([t,r])=>yr.add(Object.assign(e[t],{extension:e[t].extension??r}))))}),(t=>{const e=t.ref;Object.keys(ga).filter((t=>!!e[t])).forEach((t=>yr.remove(e[t])))}));class va{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function _a(t,e){if(Array.isArray(e)){for(const r of e)if(t.startsWith(`data:${r}`))return!0;return!1}return t.startsWith(`data:${e}`)}function ba(t,e){const r=t.split("?")[0],i=V.path.extname(r).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const ya=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map((t=>"string"==typeof t?e(t):t)):t),xa=(t,e)=>{const r=e.split("?")[1];return r&&(t+=`?${r}`),t};function wa(t,e,r,i,n){const s=e[r];for(let a=0;a<s.length;a++){const o=s[a];r<e.length-1?wa(t.replace(i[r],o),e,r+1,i,n):n.push(t.replace(i[r],o))}}function Ea(t){const e=t.match(/\{(.*?)\}/g),r=[];if(e){const i=[];e.forEach((t=>{const e=t.substring(1,t.length-1).split(",");i.push(e)})),wa(t,i,0,e,r)}else r.push(t);return r}const Ma=t=>!Array.isArray(t);const Sa=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=ya(t);let i;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];if(n.test(e)){i=n.getCacheableAssets(r,e);break}}i||(i={},r.forEach((t=>{i[t]=e})));const n=Object.keys(i),s={cacheKeys:n,keys:r};if(r.forEach((t=>{this._cacheMap.set(t,s)})),n.forEach((t=>{this._cache.has(t)&&this._cache.get(t)!==e&&console.warn("[Cache] already has key:",t),this._cache.set(t,i[t])})),e instanceof ln){const t=e;r.forEach((e=>{t.baseTexture!==ln.EMPTY.baseTexture&&Nr.addToCache(t.baseTexture,e),ln.addToCache(t,e)}))}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t))return void console.warn(`[Assets] Asset id ${t} was not found in the Cache`);const e=this._cacheMap.get(t);e.cacheKeys.forEach((t=>{this._cache.delete(t)})),e.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}};class Aa{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{let i=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let r=0;r<this.parsers.length;r++){const i=this.parsers[r];if(i.load&&i.test?.(t,e,this)){n=i;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(t,e,this),r.parser=n;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];n.parse&&n.parse&&await(n.testParse?.(i,e,this))&&(i=await n.parse(i,e,this)||i,r.parser=n)}return i})(),r}async load(t,e){this._parsersValidated||this._validateParsers();let r=0;const i={},n=Ma(t),s=ya(t,(t=>({src:t}))),a=s.length,o=s.map((async t=>{const n=V.path.toAbsolute(t.src);if(!i[t.src])try{this.promiseCache[n]||(this.promiseCache[n]=this._getLoadPromiseAndParser(n,t)),i[t.src]=await this.promiseCache[n].promise,e&&e(++r/a)}catch(e){throw delete this.promiseCache[n],delete i[t.src],new Error(`[Loader.load] Failed to load ${n}.\n${e}`)}}));return await Promise.all(o),n?i[s[0].src]:i}async unload(t){const e=ya(t,(t=>({src:t}))).map((async t=>{const e=V.path.toAbsolute(t.src),r=this.promiseCache[e];if(r){const i=await r.promise;r.parser?.unload?.(i,t,this),delete this.promiseCache[e]}}));await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e})),{})}}var Ta=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(Ta||{});const Ca={extension:{type:vr.LoadParser,priority:Ta.Low},name:"loadJson",test:t=>_a(t,"application/json")||ba(t,".json"),async load(t){const e=await S.ADAPTER.fetch(t);return await e.json()}};yr.add(Ca);const Da={name:"loadTxt",extension:{type:vr.LoadParser,priority:Ta.Low},test:t=>_a(t,"text/plain")||ba(t,".txt"),async load(t){const e=await S.ADAPTER.fetch(t);return await e.text()}};yr.add(Da);const Ra=["normal","bold","100","200","300","400","500","600","700","800","900"],Ia=[".ttf",".otf",".woff",".woff2"],Pa=["font/ttf","font/otf","font/woff","font/woff2"];const Na={extension:{type:vr.LoadParser,priority:Ta.Low},name:"loadWebFont",test:t=>_a(t,Pa)||ba(t,Ia),async load(t,e){const r=S.ADAPTER.getFontFaceSet();if(r){const i=[],n=e.data?.family??function(t){const e=V.path.extname(t);return V.path.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ")}(t),s=e.data?.weights?.filter((t=>Ra.includes(t)))??["normal"],a=e.data??{};for(let e=0;e<s.length;e++){const o=s[e],h=new FontFace(n,`url(${encodeURI(t)})`,{...a,weight:o});await h.load(),r.add(h),i.push(h)}return 1===i.length?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>S.ADAPTER.getFontFaceSet().delete(t)))}};yr.add(Na);let ka,Ba=0;const La={id:"checkImageBitmap",code:"\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    "},Oa={id:"loadImageBitmap",code:"\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };"};let Fa;const Ua=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const e=URL.createObjectURL(new Blob([La.code],{type:"application/javascript"})),r=new Worker(e);r.addEventListener("message",(i=>{r.terminate(),URL.revokeObjectURL(e),t(i.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===ka&&(ka=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<ka&&(Fa||(Fa=URL.createObjectURL(new Blob([Oa.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Fa),t.addEventListener("message",(t=>{this.complete(t.data),this.returnWorker(t.target),this.next()}))),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise(((r,i)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:i})}));return this.next(),r}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),r=e.id;this.resolveHash[Ba]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Ba++,id:r})}};function za(t,e,r){const i=new ln(t);return i.baseTexture.on("dispose",(()=>{delete e.promiseCache[r]})),i}const Ga=[".jpeg",".jpg",".png",".webp",".avif"],Ha=["image/jpeg","image/png","image/webp","image/avif"];const ja={name:"loadTextures",extension:{type:vr.LoadParser,priority:Ta.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>_a(t,Ha)||ba(t,Ga),async load(t,e,r){let i=null;i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Ua.isImageBitmapSupported()?await Ua.loadImageBitmap(t):await async function(t){const e=await S.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const r=await e.blob();return await createImageBitmap(r)}(t):await new Promise((e=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=t,i.complete?e(i):i.onload=()=>{e(i)}}));const n=new Nr(i,{resolution:V.getResolutionOfUrl(t),...e.data});return n.resource.src=t,za(n,r,t)},unload(t){t.destroy(!0)}};yr.add(ja);const Va={extension:{type:vr.LoadParser,priority:Ta.High},name:"loadSVG",test:t=>_a(t,"image/svg+xml")||ba(t,".svg"),testParse:async t=>Rs.test(t),async parse(t,e,r){const i=new Rs(t,e?.data?.resourceOptions),n=new Nr(i,{resolution:V.getResolutionOfUrl(t),...e?.data});n.resource.src=t;const s=za(n,r,t);return e?.data?.resourceOptions?.autoLoad||await i.load(),s},load:async(t,e)=>(await S.ADAPTER.fetch(t)).text(),unload:ja.unload};yr.add(Va);class Wa{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,e){const r=[];Array.isArray(e)?e.forEach((e=>{if("string"==typeof e.name){const i=this._createBundleAssetId(t,e.name);r.push(i),this.add([e.name,i],e.srcs,e.data)}else{const i=e.name.map((e=>this._createBundleAssetId(t,e)));i.forEach((t=>{r.push(t)})),this.add([...e.name,...i],e.srcs)}})):Object.keys(e).forEach((i=>{r.push(this._createBundleAssetId(t,i)),this.add([i,this._createBundleAssetId(t,i)],e[i])})),this._bundles[t]=r}add(t,e,r){const i=ya(t);i.forEach((t=>{this.hasKey(t)&&console.warn(`[Resolver] already has key: ${t} overwriting`)})),Array.isArray(e)||(e="string"==typeof e?Ea(e):[e]);const n=e.map((t=>{let e=t;if("string"==typeof t){let r=!1;for(let i=0;i<this._parsers.length;i++){const n=this._parsers[i];if(n.test(t)){e=n.parse(t),r=!0;break}}r||(e={src:t})}return e.format||(e.format=e.src.split(".").pop()),e.alias||(e.alias=i),(this._basePath||this._rootPath)&&(e.src=V.path.toAbsolute(e.src,this._basePath,this._rootPath)),e.src=this._appendDefaultSearchParams(e.src),e.data=e.data??r,e}));i.forEach((t=>{this._assetMap[t]=n}))}resolveBundle(t){const e=Ma(t);t=ya(t);const r={};return t.forEach((t=>{const e=this._bundles[t];if(e){const i=this.resolve(e),n={};for(const e in i){const r=i[e];n[this._extractAssetIdFromBundle(t,e)]=r}r[t]=n}})),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const r in e)t[r]=e[r].src;return t}return e.src}resolve(t){const e=Ma(t);t=ya(t);const r={};return t.forEach((t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const r=this._getPreferredOrder(e),i=e[0];r?.priority.forEach((t=>{r.params[t].forEach((r=>{const i=e.filter((e=>!!e[t]&&e[t]===r));i.length&&(e=i)}))})),this._resolverHash[t]=e[0]??i}else{let e=t;(this._basePath||this._rootPath)&&(e=V.path.toAbsolute(e,this._basePath,this._rootPath)),e=this._appendDefaultSearchParams(e),this._resolverHash[t]={src:e}}r[t]=this._resolverHash[t]})),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],r=this._preferredOrder.find((t=>t.params.format.includes(e.format)));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;return`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`}}const qa=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Wa,this.loader=new Aa,this.cache=Sa,this._backgroundLoader=new va(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,r="number"==typeof e?[e]:e;let i=[];if(t.texturePreference?.format){const e=t.texturePreference?.format;i="string"==typeof e?[e]:e;for(const t of this._detections)await t.test()||(i=await t.remove(i))}else for(const t of this._detections)await t.test()&&(i=await t.add(i));this.resolver.prefer({params:{format:i,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,r){this.resolver.add(t,e,r)}async load(t,e){this._initialized||await this.init();const r=Ma(t),i=ya(t).map((t=>"string"!=typeof t?(this.resolver.add(t.src,t),t.src):(this.resolver.hasKey(t)||this.resolver.add(t,t),t))),n=this.resolver.resolve(i),s=await this._mapLoadToResolve(n,e);return r?s[i[0]]:s}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;"string"==typeof t&&(r=!0,t=[t]);const i=this.resolver.resolveBundle(t),n={},s=Object.keys(i);let a=0,o=0;const h=()=>{e?.(++a/o)},u=s.map((t=>{const e=i[t];return o+=Object.keys(e).length,this._mapLoadToResolve(e,h).then((e=>{n[t]=e}))}));return await Promise.all(u),r?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return Sa.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=Sa.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=Object.values(t),i=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(r,e);this._backgroundLoader.active=!0;const s={};return r.forEach(((t,e)=>{const r=n[t.src],a=[t.src];t.alias&&a.push(...t.alias),s[i[e]]=r,Sa.set(a,r)})),s}async unload(t){this._initialized||await this.init();const e=ya(t).map((t=>"string"!=typeof t?t.src:t)),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=ya(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map((t=>this._unloadFromResolved(e[t])));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach((t=>{Sa.remove(t.src)})),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return ja.config.preferWorkers}set preferWorkers(t){Jt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach((e=>{e.config&&Object.keys(e.config).filter((e=>e in t)).forEach((r=>{e.config[r]=t[r]}))}))}};yr.handleByList(vr.LoadParser,qa.loader.parsers).handleByList(vr.ResolveParser,qa.resolver.parsers).handleByList(vr.CacheParser,qa.cache.parsers).handleByList(vr.DetectionParser,qa.detections);const Xa={extension:vr.CacheParser,test:t=>Array.isArray(t)&&t.every((t=>t instanceof ln)),getCacheableAssets:(t,e)=>{const r={};return t.forEach((t=>{e.forEach(((e,i)=>{r[t+(0===i?"":i+1)]=e}))})),r}};yr.add(Xa);const Ya={extension:{type:vr.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await S.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))},add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))};yr.add(Ya);const Za={extension:{type:vr.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await S.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))},add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))};yr.add(Za);const $a=["png","jpg","jpeg"],Ka={extension:{type:vr.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...$a],remove:async t=>t.filter((t=>!$a.includes(t)))};yr.add(Ka);const Ja={extension:vr.ResolveParser,test:ja.test,parse:t=>({resolution:parseFloat(S.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})};yr.add(Ja);var Qa=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(Qa||{});const to={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let eo,ro;function io(){ro={s3tc:eo.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:eo.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:eo.getExtension("WEBGL_compressed_texture_etc"),etc1:eo.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:eo.getExtension("WEBGL_compressed_texture_pvrtc")||eo.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:eo.getExtension("WEBGL_compressed_texture_atc"),astc:eo.getExtension("WEBGL_compressed_texture_astc")}}const no={extension:{type:vr.DetectionParser,priority:2},test:async()=>{const t=S.ADAPTER.createCanvas().getContext("webgl");return t?(eo=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{ro||io();const e=[];for(const t in ro){ro[t]&&e.push(t)}return[...e,...t]},remove:async t=>(ro||io(),t.filter((t=>!(t in ro))))};yr.add(no);class so extends Rr{constructor(t,e={width:1,height:1,autoLoad:!0}){let r,i;"string"==typeof t?(r=t,i=new Uint8Array):(r=null,i=t),super(i,e),this.origin=r,this.buffer=i?new xr(i):null,this.origin&&!1!==e.autoLoad&&this.load(),i?.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const t=await fetch(this.origin),e=await t.blob(),r=await e.arrayBuffer();return this.data=new Uint32Array(r),this.buffer=new xr(r),this.loaded=!0,this.onBlobLoaded(r),this.update(),this}}class ao extends so{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=ao._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||ao._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,r){const i=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let t=0,e=this.levels;t<e;t++){const{levelID:e,levelWidth:r,levelHeight:n,levelBuffer:s}=this._levelBuffers[t];i.compressedTexImage2D(i.TEXTURE_2D,e,this.format,r,n,0,s)}return!0}onBlobLoaded(){this._levelBuffers=ao._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,r,i,n,s,a){const o=new Array(r);let h=t.byteOffset,u=s,l=a,c=u+i-1&~(i-1),f=l+n-1&~(n-1),d=c*f*to[e];for(let s=0;s<r;s++)o[s]={levelID:s,levelWidth:r>1?u:c,levelHeight:r>1?l:f,levelBuffer:new Uint8Array(t.buffer,h,d)},h+=d,u=u>>1||1,l=l>>1||1,c=u+i-1&~(i-1),f=l+n-1&~(n-1),d=c*f*to[e];return o}}const oo=124,ho=3,uo=4,lo=7,co=19,fo=2,po=0,mo=1,go=2,vo=3;const _o={827611204:Qa.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:Qa.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:Qa.COMPRESSED_RGBA_S3TC_DXT5_EXT},bo={70:Qa.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Qa.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Qa.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Qa.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Qa.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Qa.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Qa.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Qa.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Qa.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function yo(t){const e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,oo/Uint32Array.BYTES_PER_ELEMENT),i=r[ho],n=r[uo],s=r[lo],a=new Uint32Array(t,co*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),o=a[1];if(4&o){const r=a[fo];if(808540228!==r){const e=_o[r],a=new Uint8Array(t,128);return[new ao(a,{format:e,width:n,height:i,levels:s})]}const o=128,h=new Uint32Array(e.buffer,o,20/Uint32Array.BYTES_PER_ELEMENT),u=h[po],l=h[mo],c=h[go],f=h[vo],d=bo[u];if(void 0===d)throw new Error(`DDSParser cannot parse texture data with DXGI format ${u}`);if(4===c)throw new Error("DDSParser does not support cubemap textures");if(6===l)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,m=148;if(1===f)p.push(new Uint8Array(t,m));else{const e=to[d];let r=0,a=n,o=i;for(let t=0;t<s;t++){r+=Math.max(1,a+3&-4)*Math.max(1,o+3&-4)*e,a>>>=1,o>>>=1}let h=m;for(let e=0;e<f;e++)p.push(new Uint8Array(t,h,r)),h+=r}return p.map((t=>new ao(t,{format:d,width:n,height:i,levels:s})))}if(64&o)throw new Error("DDSParser does not support uncompressed texture data.");if(512&o)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&o)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&o)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}const xo=[171,75,84,88,32,49,49,187,13,10,26,10],wo=12,Eo=16,Mo=24,So=28,Ao=36,To=40,Co=44,Do=48,Ro=52,Io=56,Po=60,No={[d.UNSIGNED_BYTE]:1,[d.UNSIGNED_SHORT]:2,[d.INT]:4,[d.UNSIGNED_INT]:4,[d.FLOAT]:4,[d.HALF_FLOAT]:8},ko={[c.RGBA]:4,[c.RGB]:3,[c.RG]:2,[c.RED]:1,[c.LUMINANCE]:1,[c.LUMINANCE_ALPHA]:2,[c.ALPHA]:1},Bo={[d.UNSIGNED_SHORT_4_4_4_4]:2,[d.UNSIGNED_SHORT_5_5_5_1]:2,[d.UNSIGNED_SHORT_5_6_5]:2};function Lo(t,e,r=!1){const i=new DataView(e);if(!function(t,e){for(let r=0;r<xo.length;r++)if(e.getUint8(r)!==xo[r])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,i))return null;const n=67305985===i.getUint32(wo,!0),s=i.getUint32(Eo,n),a=i.getUint32(Mo,n),o=i.getUint32(So,n),h=i.getUint32(Ao,n),u=i.getUint32(To,n)||1,l=i.getUint32(Co,n)||1,c=i.getUint32(Do,n)||1,f=i.getUint32(Ro,n),p=i.getUint32(Io,n),m=i.getUint32(Po,n);if(0===u||1!==l)throw new Error("Only 2D textures are supported");if(1!==f)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");const g=h+3&-4,v=u+3&-4,_=new Array(c);let b,y=h*u;if(0===s&&(y=g*v),b=0!==s?No[s]?No[s]*ko[a]:Bo[s]:to[o],void 0===b)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const x=r?function(t,e,r){const i=new Map;let n=0;for(;n<e;){const s=t.getUint32(64+n,r),a=64+n+4,o=3-(s+3)%4;if(0===s||s>e-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<s&&0!==t.getUint8(a+h);h++);if(-1===h){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=(new TextDecoder).decode(new Uint8Array(t.buffer,a,h)),l=new DataView(t.buffer,a+h+1,s-h-1);i.set(u,l),n+=4+s+o}return i}(i,m,n):null;let w=y*b,E=h,M=u,S=g,A=v,T=64+m;for(let t=0;t<p;t++){const r=i.getUint32(T,n);let a=T+4;for(let r=0;r<c;r++){let i=_[r];i||(i=_[r]=new Array(p)),i[t]={levelID:t,levelWidth:p>1||0!==s?E:S,levelHeight:p>1||0!==s?M:A,levelBuffer:new Uint8Array(e,a,w)},a+=w}T+=r+4,T=T%4!=0?T+4-T%4:T,E=E>>1||1,M=M>>1||1,S=E+4-1&-4,A=M+4-1&-4,w=S*A*b}return 0!==s?{uncompressed:_.map((t=>{let e=t[0].levelBuffer,r=!1;return s===d.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):s===d.UNSIGNED_INT?(r=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):s===d.INT&&(r=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new Rr(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:s,format:r?Oo(a):a}})),kvData:x}:{compressed:_.map((t=>new ao(null,{format:o,width:h,height:u,levels:p,levelBuffers:t}))),kvData:x}}function Oo(t){switch(t){case c.RGBA:return c.RGBA_INTEGER;case c.RGB:return c.RGB_INTEGER;case c.RG:return c.RG_INTEGER;case c.RED:return c.RED_INTEGER;default:return t}}const Fo={extension:{type:vr.LoadParser,priority:Ta.High},name:"loadDDS",test:t=>ba(t,".dds"),async load(t,e,r){const i=await S.ADAPTER.fetch(t),n=yo(await i.arrayBuffer()).map((i=>za(new Nr(i,{mipmap:v.OFF,alphaMode:_.NO_PREMULTIPLIED_ALPHA,resolution:V.getResolutionOfUrl(t),...e.data}),r,t)));return 1===n.length?n[0]:n},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};yr.add(Fo);const Uo={extension:{type:vr.LoadParser,priority:Ta.High},name:"loadKTX",test:t=>ba(t,".ktx"),async load(t,e,r){const i=await S.ADAPTER.fetch(t),n=await i.arrayBuffer(),{compressed:s,uncompressed:a,kvData:o}=Lo(t,n),h=s??a,u={mipmap:v.OFF,alphaMode:_.NO_PREMULTIPLIED_ALPHA,resolution:V.getResolutionOfUrl(t),...e.data},l=h.map((e=>{h===a&&Object.assign(u,{type:e.type,format:e.format});const i=new Nr(e,u);return i.ktxKeyValueData=o,za(i,r,t)}));return 1===l.length?l[0]:l},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};yr.add(Uo);const zo={extension:vr.ResolveParser,test:t=>{const e=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:t=>{if("ktx"===t.split("?")[0].split(".").pop()){const e=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(e.some((e=>t.endsWith(e))))return{resolution:parseFloat(S.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e.find((e=>t.endsWith(e))),src:t}}return{resolution:parseFloat(S.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t}}};yr.add(zo);const Go=new Kr,Ho=class{constructor(t){this.renderer=t}async image(t,e,r){const i=new Image;return i.src=await this.base64(t,e,r),i}async base64(t,e,r){const i=this.canvas(t);if(void 0!==i.toDataURL)return i.toDataURL(e,r);if(void 0!==i.convertToBlob){const t=await i.convertToBlob({type:e,quality:r});return await new Promise((e=>{const r=new FileReader;r.onload=()=>e(r.result),r.readAsDataURL(t)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:r,width:i,height:n,flipY:s}=this._rawPixels(t,e);let a=new V.CanvasRenderTarget(i,n,1);const o=a.context.getImageData(0,0,i,n);if(Ho.arrayPostDivide(r,o.data),a.context.putImageData(o,0,0),s){const t=new V.CanvasRenderTarget(a.width,a.height,1);t.context.scale(1,-1),t.context.drawImage(a.canvas,0,-n),a.destroy(),a=t}return a.canvas}pixels(t,e){const{pixels:r}=this._rawPixels(t,e);return Ho.arrayPostDivide(r,r),r}_rawPixels(t,e){const r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n,s=!1,a=!1;if(t)if(t instanceof cn)n=t;else{const e=r.context.webGLVersion>=2?r.multisample:E.NONE;if(n=r.generateTexture(t,{multisample:e}),e!==E.NONE){const t=cn.create({width:n.width,height:n.height});r.framebuffer.bind(n.framebuffer),r.framebuffer.blit(t.framebuffer),r.framebuffer.bind(),n.destroy(!0),n=t}a=!0}n?(i=n.baseTexture.resolution,e=e??n.frame,s=!1,r.renderTexture.bind(n)):(i=r.resolution,e||((e=Go).width=r.width,e.height=r.height),s=!0,r.renderTexture.bind());const o=Math.round(e.width*i),h=Math.round(e.height*i),u=new Uint8Array(4*o*h),l=r.gl;return l.readPixels(Math.round(e.x*i),Math.round(e.y*i),o,h,l.RGBA,l.UNSIGNED_BYTE,u),a&&n?.destroy(!0),{pixels:u,width:o,height:h,flipY:s}}destroy(){this.renderer=null}static arrayPostDivide(t,e){for(let r=0;r<t.length;r+=4){const i=e[r+3]=t[r+3];0!==i?(e[r]=Math.round(Math.min(255*t[r]/i,255)),e[r+1]=Math.round(Math.min(255*t[r+1]/i,255)),e[r+2]=Math.round(Math.min(255*t[r+2]/i,255))):(e[r]=t[r],e[r+1]=t[r+1],e[r+2]=t[r+2])}}};let jo=Ho;jo.extension={name:"extract",type:vr.RendererSystem},yr.add(jo);const Vo={build(t){const e=t.points;let r,i,n,s,a,o;if(t.type===Yr.CIRC){const e=t.shape;r=e.x,i=e.y,a=o=e.radius,n=s=0}else if(t.type===Yr.ELIP){const e=t.shape;r=e.x,i=e.y,a=e.width,o=e.height,n=s=0}else{const e=t.shape,h=e.width/2,u=e.height/2;r=e.x+h,i=e.y+u,a=o=Math.max(0,Math.min(e.radius,Math.min(h,u))),n=h-a,s=u-o}if(!(a>=0&&o>=0&&n>=0&&s>=0))return void(e.length=0);const h=Math.ceil(2.3*Math.sqrt(a+o)),u=8*h+(n?4:0)+(s?4:0);if(e.length=u,0===u)return;if(0===h)return e.length=8,e[0]=e[6]=r+n,e[1]=e[3]=i+s,e[2]=e[4]=r-n,void(e[5]=e[7]=i-s);let l=0,c=4*h+(n?2:0)+2,f=c,d=u;{const t=n+a,o=s,h=r+t,u=r-t,p=i+o;if(e[l++]=h,e[l++]=p,e[--c]=p,e[--c]=u,s){const t=i-o;e[f++]=u,e[f++]=t,e[--d]=t,e[--d]=h}}for(let t=1;t<h;t++){const u=Math.PI/2*(t/h),p=n+Math.cos(u)*a,m=s+Math.sin(u)*o,g=r+p,v=r-p,_=i+m,b=i-m;e[l++]=g,e[l++]=_,e[--c]=_,e[--c]=v,e[f++]=v,e[f++]=b,e[--d]=b,e[--d]=g}{const t=s+o,a=r+n,h=r-n,u=i+t,c=i-t;e[l++]=a,e[l++]=u,e[--d]=c,e[--d]=a,n&&(e[l++]=h,e[l++]=u,e[--d]=c,e[--d]=h)}},triangulate(t,e){const r=t.points,i=e.points,n=e.indices;if(0===r.length)return;let s=i.length/2;const a=s;let o,h;if(t.type!==Yr.RREC){const e=t.shape;o=e.x,h=e.y}else{const e=t.shape;o=e.x+e.width/2,h=e.y+e.height/2}const u=t.matrix;i.push(t.matrix?u.a*o+u.c*h+u.tx:o,t.matrix?u.b*o+u.d*h+u.ty:h),s++,i.push(r[0],r[1]);for(let t=2;t<r.length;t+=2)i.push(r[t],r[t+1]),n.push(s++,a,s);n.push(a+1,a,s)}};function Wo(t,e=!1){const r=t.length;if(r<6)return;let i=0;for(let e=0,n=t[r-2],s=t[r-1];e<r;e+=2){const r=t[e],a=t[e+1];i+=(r-n)*(a+s),n=r,s=a}if(!e&&i>0||e&&i<=0){const e=r/2;for(let i=e+e%2;i<r;i+=2){const e=r-i-2,n=r-i-1,s=i,a=i+1;[t[e],t[s]]=[t[s],t[e]],[t[n],t[a]]=[t[a],t[n]]}}}const qo={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let r=t.points;const i=t.holes,n=e.points,s=e.indices;if(r.length>=6){Wo(r,!1);const t=[];for(let e=0;e<i.length;e++){const n=i[e];Wo(n.points,!0),t.push(r.length/2),r=r.concat(n.points)}const e=V.earcut(r,t,2);if(!e)return;const a=n.length/2;for(let t=0;t<e.length;t+=3)s.push(e[t]+a),s.push(e[t+1]+a),s.push(e[t+2]+a);for(let t=0;t<r.length;t++)n.push(r[t])}}},Xo={build(t){const e=t.shape,r=e.x,i=e.y,n=e.width,s=e.height,a=t.points;a.length=0,n>=0&&s>=0&&a.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate(t,e){const r=t.points,i=e.points;if(0===r.length)return;const n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},Yo={build(t){Vo.build(t)},triangulate(t,e){Vo.triangulate(t,e)}};var Zo=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Zo||{}),$o=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))($o||{});const Ko={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},Jo=Ko;class Qo{static curveTo(t,e,r,i,n,s){const a=s[s.length-2],o=s[s.length-1]-e,h=a-t,u=i-e,l=r-t,c=Math.abs(o*l-h*u);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;const f=o*o+h*h,d=u*u+l*l,p=o*u+h*l,m=n*Math.sqrt(f)/c,g=n*Math.sqrt(d)/c,v=m*p/f,_=g*p/d,b=m*l+g*h,y=m*u+g*o,x=h*(g+v),w=o*(g+v),E=l*(m+_),M=u*(m+_);return{cx:b+t,cy:y+e,radius:n,startAngle:Math.atan2(w-y,x-b),endAngle:Math.atan2(M-y,E-b),anticlockwise:h*u>l*o}}static arc(t,e,r,i,n,s,a,o,h){const u=a-s,l=Ko._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/Wr)),c=u/(2*l),f=2*c,d=Math.cos(c),p=Math.sin(c),m=l-1,g=m%1/m;for(let t=0;t<=m;++t){const e=c+s+f*(t+g*t),a=Math.cos(e),o=-Math.sin(e);h.push((d*a+p*o)*n+r,(d*-o+p*a)*n+i)}}}class th{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class eh{static curveLength(t,e,r,i,n,s,a,o){let h=0,u=0,l=0,c=0,f=0,d=0,p=0,m=0,g=0,v=0,_=0,b=t,y=e;for(let x=1;x<=10;++x)u=x/10,l=u*u,c=l*u,f=1-u,d=f*f,p=d*f,m=p*t+3*d*u*r+3*f*l*n+c*a,g=p*e+3*d*u*i+3*f*l*s+c*o,v=b-m,_=y-g,b=m,y=g,h+=Math.sqrt(v*v+_*_);return h}static curveTo(t,e,r,i,n,s,a){const o=a[a.length-2],h=a[a.length-1];a.length-=2;const u=Ko._segmentsCount(eh.curveLength(o,h,t,e,r,i,n,s));let l=0,c=0,f=0,d=0,p=0;a.push(o,h);for(let m=1,g=0;m<=u;++m)g=m/u,l=1-g,c=l*l,f=c*l,d=g*g,p=d*g,a.push(f*o+3*c*g*t+3*l*d*r+p*n,f*h+3*c*g*e+3*l*d*i+p*s)}}function rh(t,e,r,i,n,s,a,o){let h,u;a?(h=i,u=-r):(h=-i,u=r);const l=t-r*n+h,c=e-i*n+u,f=t+r*s+h,d=e+i*s+u;return o.push(l,c,f,d),2}function ih(t,e,r,i,n,s,a,o){const h=r-t,u=i-e;let l=Math.atan2(h,u),c=Math.atan2(n-t,s-e);o&&l<c?l+=2*Math.PI:!o&&l>c&&(c+=2*Math.PI);let f=l;const d=c-l,p=Math.abs(d),m=Math.sqrt(h*h+u*u),g=1+(15*p*Math.sqrt(m)/Math.PI>>0),v=d/g;if(f+=v,o){a.push(t,e,r,i);for(let r=1,i=f;r<g;r++,i+=v)a.push(t,e,t+Math.sin(i)*m,e+Math.cos(i)*m);a.push(t,e,n,s)}else{a.push(r,i,t,e);for(let r=1,i=f;r<g;r++,i+=v)a.push(t+Math.sin(i)*m,e+Math.cos(i)*m,t,e);a.push(n,s,t,e)}return 2*g}function nh(t,e){t.lineStyle.native?function(t,e){let r=0;const i=t.shape,n=t.points||i.points,s=i.type!==Yr.POLY||i.closeStroke;if(0===n.length)return;const a=e.points,o=e.indices,h=n.length/2,u=a.length/2;let l=u;for(a.push(n[0],n[1]),r=1;r<h;r++)a.push(n[2*r],n[2*r+1]),o.push(l,l+1),l++;s&&o.push(l,u)}(t,e):function(t,e){const r=t.shape;let i=t.points||r.points.slice();const n=e.closePointEps;if(0===i.length)return;const s=t.lineStyle,a=new Zr(i[0],i[1]),o=new Zr(i[i.length-2],i[i.length-1]),h=r.type!==Yr.POLY||r.closeStroke,u=Math.abs(a.x-o.x)<n&&Math.abs(a.y-o.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),o.set(i[i.length-2],i[i.length-1]));const t=.5*(a.x+o.x),e=.5*(o.y+a.y);i.unshift(t,e),i.push(t,e)}const l=e.points,c=i.length/2;let f=i.length;const d=l.length/2,p=s.width/2,m=p*p,g=s.miterLimit*s.miterLimit;let v=i[0],_=i[1],b=i[2],y=i[3],x=0,w=0,E=-(_-y),M=v-b,S=0,A=0,T=Math.sqrt(E*E+M*M);E/=T,M/=T,E*=p,M*=p;const C=s.alignment,D=2*(1-C),R=2*C;h||(s.cap===$o.ROUND?f+=ih(v-E*(D-R)*.5,_-M*(D-R)*.5,v-E*D,_-M*D,v+E*R,_+M*R,l,!0)+2:s.cap===$o.SQUARE&&(f+=rh(v,_,E,M,D,R,!0,l))),l.push(v-E*D,_-M*D,v+E*R,_+M*R);for(let t=1;t<c-1;++t){v=i[2*(t-1)],_=i[2*(t-1)+1],b=i[2*t],y=i[2*t+1],x=i[2*(t+1)],w=i[2*(t+1)+1],E=-(_-y),M=v-b,T=Math.sqrt(E*E+M*M),E/=T,M/=T,E*=p,M*=p,S=-(y-w),A=b-x,T=Math.sqrt(S*S+A*A),S/=T,A/=T,S*=p,A*=p;const e=b-v,r=_-y,n=b-x,a=w-y,o=e*n+r*a,h=r*n-a*e,u=h<0;if(Math.abs(h)<.001*Math.abs(o)){l.push(b-E*D,y-M*D,b+E*R,y+M*R),o>=0&&(s.join===Zo.ROUND?f+=ih(b,y,b-E*D,y-M*D,b-S*D,y-A*D,l,!1)+4:f+=2,l.push(b-S*R,y-A*R,b+S*D,y+A*D));continue}const c=(-E+v)*(-M+y)-(-E+b)*(-M+_),d=(-S+x)*(-A+y)-(-S+b)*(-A+w),C=(e*d-n*c)/h,I=(a*c-r*d)/h,P=(C-b)*(C-b)+(I-y)*(I-y),N=b+(C-b)*D,k=y+(I-y)*D,B=b-(C-b)*R,L=y-(I-y)*R,O=u?D:R,F=P<=Math.min(e*e+r*r,n*n+a*a)+O*O*m;let U=s.join;if(U===Zo.MITER&&P/m>g&&(U=Zo.BEVEL),F)switch(U){case Zo.MITER:l.push(N,k,B,L);break;case Zo.BEVEL:u?l.push(N,k,b+E*R,y+M*R,N,k,b+S*R,y+A*R):l.push(b-E*D,y-M*D,B,L,b-S*D,y-A*D,B,L),f+=2;break;case Zo.ROUND:u?(l.push(N,k,b+E*R,y+M*R),f+=ih(b,y,b+E*R,y+M*R,b+S*R,y+A*R,l,!0)+4,l.push(N,k,b+S*R,y+A*R)):(l.push(b-E*D,y-M*D,B,L),f+=ih(b,y,b-E*D,y-M*D,b-S*D,y-A*D,l,!1)+4,l.push(b-S*D,y-A*D,B,L))}else{switch(l.push(b-E*D,y-M*D,b+E*R,y+M*R),U){case Zo.MITER:u?l.push(B,L,B,L):l.push(N,k,N,k),f+=2;break;case Zo.ROUND:f+=u?ih(b,y,b+E*R,y+M*R,b+S*R,y+A*R,l,!0)+2:ih(b,y,b-E*D,y-M*D,b-S*D,y-A*D,l,!1)+2}l.push(b-S*D,y-A*D,b+S*R,y+A*R),f+=2}}v=i[2*(c-2)],_=i[2*(c-2)+1],b=i[2*(c-1)],y=i[2*(c-1)+1],E=-(_-y),M=v-b,T=Math.sqrt(E*E+M*M),E/=T,M/=T,E*=p,M*=p,l.push(b-E*D,y-M*D,b+E*R,y+M*R),h||(s.cap===$o.ROUND?f+=ih(b-E*(D-R)*.5,y-M*(D-R)*.5,b-E*D,y-M*D,b+E*R,y+M*R,l,!1)+2:s.cap===$o.SQUARE&&(f+=rh(b,y,E,M,D,R,!1,l)));const I=e.indices,P=Ko.epsilon*Ko.epsilon;for(let t=d;t<f+d-2;++t)v=l[2*t],_=l[2*t+1],b=l[2*(t+1)],y=l[2*(t+1)+1],x=l[2*(t+2)],w=l[2*(t+2)+1],Math.abs(v*(y-w)+b*(w-_)+x*(_-y))<P||I.push(t,t+1,t+2)}(t,e)}class sh{static curveLength(t,e,r,i,n,s){const a=t-2*r+n,o=e-2*i+s,h=2*r-2*t,u=2*i-2*e,l=4*(a*a+o*o),c=4*(a*h+o*u),f=h*h+u*u,d=2*Math.sqrt(l+c+f),p=Math.sqrt(l),m=2*l*p,g=2*Math.sqrt(f),v=c/p;return(m*d+p*c*(d-g)+(4*f*l-c*c)*Math.log((2*p+v+d)/(v+g)))/(4*m)}static curveTo(t,e,r,i,n){const s=n[n.length-2],a=n[n.length-1],o=Ko._segmentsCount(sh.curveLength(s,a,t,e,r,i));let h=0,u=0;for(let l=1;l<=o;++l){const c=l/o;h=s+(t-s)*c,u=a+(e-a)*c,n.push(h+(t+(r-t)*c-h)*c,u+(e+(i-e)*c-u)*c)}}}const ah={[Yr.POLY]:qo,[Yr.CIRC]:Vo,[Yr.ELIP]:Vo,[Yr.RECT]:Xo,[Yr.RREC]:Yo},oh=[],hh=[];class uh{constructor(t,e=null,r=null,i=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type}clone(){return new uh(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const lh=new Zr,ch=class extends Vr{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Ns,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),hh.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),oh.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,i=null){const n=new uh(t,e,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new uh(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const i=e[r];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,lh):lh.copyFrom(t),i.shape.contains(lh.x,lh.y)))){let t=!1;if(i.holes)for(let e=0;e<i.holes.length;e++){if(i.holes[e].shape.contains(lh.x,lh.y)){t=!0;break}}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let r=null,i=null;this.batches.length>0&&(r=this.batches[this.batches.length-1],i=r.style);for(let n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;const s=e[n],a=s.fillStyle,o=s.lineStyle;ah[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(a.visible||o.visible)&&this.processHoles(s.holes);for(let e=0;e<2;e++){const n=0===e?a:o;if(!n.visible)continue;const h=n.texture.baseTexture,u=this.indices.length,l=this.points.length/2;h.wrapMode=g.REPEAT,0===e?this.processFill(s):this.processLine(s);const c=this.points.length/2-l;0!==c&&(r&&!this._compareStyles(i,n)&&(r.end(u,l),r=null),r||(r=oh.pop()||new th,r.begin(n,u,l),this.batches.push(r),i=n),this.addUvs(this.points,t,n.texture,l,c,n.matrix))}}const n=this.indices.length,s=this.points.length/2;if(r&&r.end(n,s),0===this.batches.length)return void(this.batchable=!0);const a=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],r=e.fillStyle,i=e.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,r=t.length;e<r;e++){const r=t[e];for(let t=0;t<r.size;t++){const e=r.start+t;this.indicesUint16[e]=this.indicesUint16[e]-r.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*ch.BATCHABLE_SIZE}buildDrawCalls(){let t=++Nr._globalBatch;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),hh.push(this.drawCalls[t]);this.drawCalls.length=0;const e=this.colors,r=this.textureIds;let i=hh.pop();i||(i=new kr,i.texArray=new Vi),i.texArray.count=0,i.start=0,i.size=0,i.type=l.TRIANGLES;let n=0,s=null,a=0,o=!1,h=l.TRIANGLES,u=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){const f=this.batches[c],d=8,p=f.style,m=p.texture.baseTexture;o!==!!p.native&&(o=!!p.native,h=o?l.LINES:l.TRIANGLES,s=null,n=d,t++),s!==m&&(s=m,m._batchEnabled!==t&&(n===d&&(t++,n=0,i.size>0&&(i=hh.pop(),i||(i=new kr,i.texArray=new Vi),this.drawCalls.push(i)),i.start=u,i.size=0,i.texArray.count=0,i.type=h),m.touched=1,m._batchEnabled=t,m._batchLocation=n,m.wrapMode=g.REPEAT,i.texArray.elements[i.texArray.count++]=m,n++)),i.size+=f.size,u+=f.size,a=m._batchLocation,this.addColors(e,p.color,p.alpha,f.attribSize,f.attribStart),this.addTextureIds(r,a,f.attribSize,f.attribStart)}Nr._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(12*t.length),s=new Float32Array(n),a=new Uint32Array(n);let o=0;for(let n=0;n<t.length/2;n++)s[o++]=t[2*n],s[o++]=t[2*n+1],s[o++]=e[2*n],s[o++]=e[2*n+1],a[o++]=r[n],s[o++]=i[n];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){if(t.holes.length)qo.triangulate(t,this);else{ah[t.type].triangulate(t,this)}}processLine(t){nh(t,this);for(let e=0;e<t.holes.length;e++)nh(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e];ah[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const i=t[2*r],n=t[2*r+1];t[2*r]=e.a*i+e.c*n+e.tx,t[2*r+1]=e.b*i+e.d*n+e.ty}}addColors(t,e,r,i,n=0){const s=Ne.shared.setValue(e).toLittleEndianNumber(),a=Ne.shared.setValue(s).toPremultiplied(r);t.length=Math.max(t.length,n+i);for(let e=0;e<i;e++)t[n+e]=a}addTextureIds(t,e,r,i=0){t.length=Math.max(t.length,i+r);for(let n=0;n<r;n++)t[i+n]=e}addUvs(t,e,r,i,n,s=null){let a=0;const o=e.length,h=r.frame;for(;a<n;){let r=t[2*(i+a)],n=t[2*(i+a)+1];if(s){const t=s.a*r+s.c*n+s.tx;n=s.b*r+s.d*n+s.ty,r=t}a++,e.push(r/h.width,n/h.height)}const u=r.baseTexture;(h.width<u.width||h.height<u.height)&&this.adjustUvs(e,r,o,n)}adjustUvs(t,e,r,i){const n=e.baseTexture,s=1e-6,a=r+2*i,o=e.frame,h=o.width/n.width,u=o.height/n.height;let l=o.x/o.width,c=o.y/o.height,f=Math.floor(t[r]+s),d=Math.floor(t[r+1]+s);for(let e=r+2;e<a;e+=2)f=Math.min(f,Math.floor(t[e]+s)),d=Math.min(d,Math.floor(t[e+1]+s));l-=f,c-=d;for(let e=r;e<a;e+=2)t[e]=(t[e]+l)*h,t[e+1]=(t[e+1]+c)*u}};let fh=ch;fh.BATCHABLE_SIZE=100;class dh{constructor(){this.color=16777215,this.alpha=1,this.texture=ln.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new dh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=ln.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ph extends dh{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=$o.BUTT,this.join=Zo.MITER,this.miterLimit=10}clone(){const t=new ph;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const mh={},gh=class extends Us{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new dh,this._lineStyle=new ph,this._matrix=null,this._holeMode=!1,this.state=Sr.for2d(),this._geometry=t||new fh,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Ne(16777215),this.blendMode=u.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new gh(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r,i=.5,n=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:r,alignment:i,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:ln.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:$o.BUTT,join:Zo.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.width>0&&t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:r},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new ti,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new ti,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return i===t&&n===e||r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,i){this._initCurve();const n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),sh.curveTo(t,e,r,i,n),this}bezierCurveTo(t,e,r,i,n,s){return this._initCurve(),eh.curveTo(t,e,r,i,n,s,this.currentPath.points),this}arcTo(t,e,r,i,n){this._initCurve(t,e);const s=this.currentPath.points,a=Qo.curveTo(t,e,r,i,n,s);if(a){const{cx:t,cy:e,radius:r,startAngle:i,endAngle:n,anticlockwise:s}=a;this.arc(t,e,r,i,n,s)}return this}arc(t,e,r,i,n,s=!1){if(i===n)return this;!s&&n<=i?n+=Wr:s&&i<=n&&(i+=Wr);if(0===n-i)return this;const a=t+Math.cos(i)*r,o=e+Math.sin(i)*r,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const t=Math.abs(u[u.length-2]-a),e=Math.abs(u[u.length-1]-o);t<h&&e<h||u.push(a,o)}else this.moveTo(a,o),u=this.currentPath.points;return Qo.arc(a,o,t,e,r,i,n,s,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:ln.WHITE,color:t,alpha:e})}normalizeColor(t){const e=Ne.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:ln.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const r=t.alpha>0;return r?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:r},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,i){return this.drawShape(new Kr(t,e,r,i))}drawRoundedRect(t,e,r,i,n){return this.drawShape(new ei(t,e,r,i,n))}drawCircle(t,e,r){return this.drawShape(new Jr(t,e,r))}drawEllipse(t,e,r,i){return this.drawShape(new Qr(t,e,r,i))}drawPolygon(...t){let e,r=!0;const i=t[0];i.points?(r=i.closeStroke,e=i.points):e=Array.isArray(t[0])?t[0]:t;const n=new ti(e);return n.closeStroke=r,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Yr.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let i=0;i<r;i++){const r=t.batches[i],n=r.style.color,s=new Float32Array(this.vertexData.buffer,8*r.attribStart,2*r.attribSize),a=new Float32Array(t.uvsFloat32.buffer,8*r.attribStart,2*r.attribSize),o={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*r.start,r.size),uvs:a,_batchRGB:Ne.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=o}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t),r=this._geometry,i=this.worldAlpha,n=e.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,Ne.shared.setValue(this._tintColor).multiply([i,i,i]).setAlpha(i).toArray(n.tint),t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(let e=0,i=s.length;e<i;e++)this._renderDrawCallDirect(t,r.drawCalls[e])}_renderDrawCallDirect(t,e){const{texArray:r,type:i,size:n,start:s}=e,a=r.count;for(let e=0;e<a;e++)t.texture.bind(r.elements[e],e);t.geometry.draw(i,n,s)}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;if(!e){if(!mh[r]){const{maxTextures:e}=t.plugins[r],i=new Int32Array(e);for(let t=0;t<e;t++)i[t]=t;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new ri,default:Gi.from({uSamplers:i},!0)},s=t.plugins[r]._shader.program;mh[r]=new Hi(s,n)}e=mh[r]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:i,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,r,i,n)}containsPoint(t){return this.worldTransform.applyInverse(t,gh._TEMP_POINT),this._geometry.containsPoint(gh._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=Ne.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,s=e.d,a=e.tx,o=e.ty,h=this._geometry.points,u=this.vertexData;let l=0;for(let t=0;t<h.length;t+=2){const e=h[t],c=h[t+1];u[l++]=r*e+n*c+a,u[l++]=s*c+i*e+o}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let vh=gh;vh.curves=Ko,vh._TEMP_POINT=new Zr;const _h={buildPoly:qo,buildCircle:Vo,buildRectangle:Xo,buildRoundedRectangle:Yo,buildLine:nh,ArcUtils:Qo,BezierUtils:eh,QuadraticUtils:sh,BatchPart:th,FILL_COMMANDS:ah,BATCH_POOL:oh,DRAW_CALL_POOL:hh};class bh{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const yh=new Zr,xh=new ti,wh=class extends Us{constructor(t,e,r,i=l.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=r||Sr.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=S.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===l.TRIANGLES&&e.length<2*wh.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;const i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const i=this.transform.worldTransform,n=i.a,s=i.b,a=i.c,o=i.d,h=i.tx,u=i.ty,l=this.vertexData;for(let t=0;t<l.length/2;t++){const r=e[2*t],i=e[2*t+1];l[2*t]=n*r+a*i+h,l[2*t+1]=s*r+o*i+u}if(this._roundPixels){const t=S.RESOLUTION;for(let e=0;e<l.length;++e)l[e]=Math.round(l[e]*t)/t}this.vertexDirty=r}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new bh(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,yh);const e=this.geometry.getBuffer("aVertexPosition").data,r=xh.points,i=this.geometry.getIndex().data,n=i.length,s=4===this.drawMode?3:1;for(let t=0;t+2<n;t+=s){const n=2*i[t],s=2*i[t+1],a=2*i[t+2];if(r[0]=e[n],r[1]=e[n+1],r[2]=e[s],r[3]=e[s+1],r[4]=e[a],r[5]=e[a+1],xh.contains(yh.x,yh.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Eh=wh;Eh.BATCHABLE_SIZE=100;class Mh extends jr{constructor(t,e,r){super();const i=new Lr(t),n=new Lr(e,!0),s=new Lr(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,d.FLOAT).addAttribute("aTextureCoord",n,2,!1,d.FLOAT).addIndex(s),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class Sh extends Hi{constructor(t,e){const r={uSampler:t,alpha:1,uTextureMatrix:ri.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(r,e.uniforms),super(e.program||Ui.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r),this._colorDirty=!1,this.uvMatrix=new Sn(t),this.batchable=void 0===e.program,this.pluginName=e.pluginName,this._tintColor=new Ne(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;Ne.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Ah{constructor(t,e,r){this.geometry=new jr,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let i=t[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||d.FLOAT,offset:i.offset},e[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Lr(V.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let t=0;t<this.dynamicProperties.length;++t){const r=this.dynamicProperties[t];r.offset=e,e+=r.size,this.dynamicStride+=r.size}const r=new ArrayBuffer(this.size*this.dynamicStride*16);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Lr(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let t=0;t<this.staticProperties.length;++t){const e=this.staticProperties[t];e.offset=i,i+=e.size,this.staticStride+=e.size}const n=new ArrayBuffer(this.size*this.staticStride*16);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Lr(this.staticData,!0,!1);for(let e=0;e<this.dynamicProperties.length;++e){const r=this.dynamicProperties[e];t.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===d.UNSIGNED_BYTE,r.type,4*this.dynamicStride,4*r.offset)}for(let e=0;e<this.staticProperties.length;++e){const r=this.staticProperties[e];t.addAttribute(r.attributeName,this.staticBuffer,0,r.type===d.UNSIGNED_BYTE,r.type,4*this.staticStride,4*r.offset)}}uploadDynamic(t,e,r){for(let i=0;i<this.dynamicProperties.length;i++){const n=this.dynamicProperties[i];n.uploadFunction(t,e,r,n.type===d.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,r){for(let i=0;i<this.staticProperties.length;i++){const n=this.staticProperties[i];n.uploadFunction(t,e,r,n.type===d.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class Th extends qi{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new ri,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:d.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Hi.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=Sr.for2d()}render(t){const e=t.children,r=t._maxSize,i=t._batchSize,n=this.renderer;let s=e.length;if(0===s)return;s>r&&!t.autoResize&&(s=r);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const o=e[0]._texture.baseTexture,h=o.alphaMode>0;this.state.blendMode=V.correctBlendMode(t.blendMode,h),n.state.set(this.state);const u=n.gl,l=t.worldTransform.copyTo(this.tempMatrix);l.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=l.toArray(!0),this.shader.uniforms.uColor=Ne.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);let c=!1;for(let r=0,o=0;r<s;r+=i,o+=1){let h=s-r;h>i&&(h=i),o>=a.length&&a.push(this._generateOneMoreBuffer(t));const l=a[o];l.uploadDynamic(e,r,h);const f=t._bufferUpdateIDs[o]||0;c=c||l._updateID<f,c&&(l._updateID=t._updateID,l.uploadStatic(e,r,h)),n.geometry.bind(l.geometry),u.drawElements(u.TRIANGLES,6*h,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],r=t._maxSize,i=t._batchSize,n=t._properties;for(let t=0;t<r;t+=i)e.push(new Ah(this.properties,n,i));return e}_generateOneMoreBuffer(t){const e=t._batchSize,r=t._properties;return new Ah(this.properties,r,e)}uploadVertices(t,e,r,i,n,s){let a=0,o=0,h=0,u=0;for(let l=0;l<r;++l){const r=t[e+l],c=r._texture,f=r.scale.x,d=r.scale.y,p=c.trim,m=c.orig;p?(o=p.x-r.anchor.x*m.width,a=o+p.width,u=p.y-r.anchor.y*m.height,h=u+p.height):(a=m.width*(1-r.anchor.x),o=m.width*-r.anchor.x,h=m.height*(1-r.anchor.y),u=m.height*-r.anchor.y),i[s]=o*f,i[s+1]=u*d,i[s+n]=a*f,i[s+n+1]=u*d,i[s+2*n]=a*f,i[s+2*n+1]=h*d,i[s+3*n]=o*f,i[s+3*n+1]=h*d,s+=4*n}}uploadPosition(t,e,r,i,n,s){for(let a=0;a<r;a++){const r=t[e+a].position;i[s]=r.x,i[s+1]=r.y,i[s+n]=r.x,i[s+n+1]=r.y,i[s+2*n]=r.x,i[s+2*n+1]=r.y,i[s+3*n]=r.x,i[s+3*n+1]=r.y,s+=4*n}}uploadRotation(t,e,r,i,n,s){for(let a=0;a<r;a++){const r=t[e+a].rotation;i[s]=r,i[s+n]=r,i[s+2*n]=r,i[s+3*n]=r,s+=4*n}}uploadUvs(t,e,r,i,n,s){for(let a=0;a<r;++a){const r=t[e+a]._texture._uvs;r?(i[s]=r.x0,i[s+1]=r.y0,i[s+n]=r.x1,i[s+n+1]=r.y1,i[s+2*n]=r.x2,i[s+2*n+1]=r.y2,i[s+3*n]=r.x3,i[s+3*n+1]=r.y3,s+=4*n):(i[s]=0,i[s+1]=0,i[s+n]=0,i[s+n+1]=0,i[s+2*n]=0,i[s+2*n+1]=0,i[s+3*n]=0,i[s+3*n+1]=0,s+=4*n)}}uploadTint(t,e,r,i,n,s){for(let a=0;a<r;++a){const r=t[e+a],o=Ne.shared.setValue(r._tintRGB).toPremultiplied(r.alpha);i[s]=o,i[s+n]=o,i[s+2*n]=o,i[s+3*n]=o,s+=4*n}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Th.extension={name:"particle",type:vr.RendererPlugin},yr.add(Th);var Ch=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(Ch||{});const Dh={willReadFrequently:!0},Rh=class{static get experimentalLetterSpacingSupported(){let t=Rh._experimentalLetterSpacingSupported;if(void 0!==t){const e=S.ADAPTER.getCanvasRenderingContext2D().prototype;t=Rh._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,r,i,n,s,a,o,h){this.text=t,this.style=e,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=h}static measureText(t,e,r,i=Rh._canvas){r=null==r?e.wordWrap:r;const n=e.toFontString(),s=Rh.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);const a=i.getContext("2d",Dh);a.font=n;const o=(r?Rh.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),h=new Array(o.length);let u=0;for(let t=0;t<o.length;t++){const r=Rh._measureText(o[t],e.letterSpacing,a);h[t]=r,u=Math.max(u,r)}let l=u+e.strokeThickness;e.dropShadow&&(l+=e.dropShadowDistance);const c=e.lineHeight||s.fontSize+e.strokeThickness;let f=Math.max(c,s.fontSize+2*e.strokeThickness)+(o.length-1)*(c+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new Rh(t,e,l,f,o,h,c+e.leading,u,s)}static _measureText(t,e,r){let i=!1;Rh.experimentalLetterSpacingSupported&&(Rh.experimentalLetterSpacing?(r.letterSpacing=`${e}px`,r.textLetterSpacing=`${e}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let n=r.measureText(t).width;return n>0&&(i?n-=e:n+=(Rh.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,r=Rh._canvas){const i=r.getContext("2d",Dh);let n=0,s="",a="";const o=Object.create(null),{letterSpacing:h,whiteSpace:u}=e,l=Rh.collapseSpaces(u),c=Rh.collapseNewlines(u);let f=!l;const d=e.wordWrapWidth+h,p=Rh.tokenize(t);for(let t=0;t<p.length;t++){let r=p[t];if(Rh.isNewline(r)){if(!c){a+=Rh.addLine(s),f=!l,s="",n=0;continue}r=" "}if(l){const t=Rh.isBreakingSpace(r),e=Rh.isBreakingSpace(s[s.length-1]);if(t&&e)continue}const u=Rh.getFromCache(r,h,o,i);if(u>d)if(""!==s&&(a+=Rh.addLine(s),s="",n=0),Rh.canBreakWords(r,e.breakWords)){const t=Rh.wordWrapSplit(r);for(let u=0;u<t.length;u++){let l=t[u],c=l,p=1;for(;t[u+p];){const i=t[u+p];if(Rh.canBreakChars(c,i,r,u,e.breakWords))break;l+=i,c=i,p++}u+=p-1;const m=Rh.getFromCache(l,h,o,i);m+n>d&&(a+=Rh.addLine(s),f=!1,s="",n=0),s+=l,n+=m}}else{s.length>0&&(a+=Rh.addLine(s),s="",n=0);const e=t===p.length-1;a+=Rh.addLine(r,!e),f=!1,s="",n=0}else u+n>d&&(f=!1,a+=Rh.addLine(s),s="",n=0),(s.length>0||!Rh.isBreakingSpace(r)||f)&&(s+=r,n+=u)}return a+=Rh.addLine(s,!1),a}static addLine(t,e=!0){return t=Rh.trimRight(t),t=e?`${t}\n`:t}static getFromCache(t,e,r,i){let n=r[t];return"number"!=typeof n&&(n=Rh._measureText(t,e,i)+e,r[t]=n),n}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;e>=0;e--){const r=t[e];if(!Rh.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&Rh._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return"string"==typeof t&&Rh._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let r="";if("string"!=typeof t)return e;for(let i=0;i<t.length;i++){const n=t[i],s=t[i+1];Rh.isBreakingSpace(n,s)||Rh.isNewline(n)?(""!==r&&(e.push(r),r=""),e.push(n)):r+=n}return""!==r&&e.push(r),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,r,i,n){return!0}static wordWrapSplit(t){return Rh.graphemeSegmenter(t)}static measureFont(t){if(Rh._fonts[t])return Rh._fonts[t];const e={ascent:0,descent:0,fontSize:0},r=Rh._canvas,i=Rh._context;i.font=t;const n=Rh.METRICS_STRING+Rh.BASELINE_SYMBOL,s=Math.ceil(i.measureText(n).width);let a=Math.ceil(i.measureText(Rh.BASELINE_SYMBOL).width);const o=Math.ceil(Rh.HEIGHT_MULTIPLIER*a);if(a=a*Rh.BASELINE_MULTIPLIER|0,0===s||0===o)return Rh._fonts[t]=e,e;r.width=s,r.height=o,i.fillStyle="#f00",i.fillRect(0,0,s,o),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,a);const h=i.getImageData(0,0,s,o).data,u=h.length,l=4*s;let c=0,f=0,d=!1;for(c=0;c<a;++c){for(let t=0;t<l;t+=4)if(255!==h[f+t]){d=!0;break}if(d)break;f+=l}for(e.ascent=a-c,f=u-l,d=!1,c=o;c>a;--c){for(let t=0;t<l;t+=4)if(255!==h[f+t]){d=!0;break}if(d)break;f-=l}return e.descent=c-a,e.fontSize=e.ascent+e.descent,Rh._fonts[t]=e,e}static clearMetrics(t=""){t?delete Rh._fonts[t]:Rh._fonts={}}static get _canvas(){if(!Rh.__canvas){let t;try{const e=new OffscreenCanvas(0,0);if(e.getContext("2d",Dh)?.measureText)return Rh.__canvas=e,e;t=S.ADAPTER.createCanvas()}catch(e){t=S.ADAPTER.createCanvas()}t.width=t.height=10,Rh.__canvas=t}return Rh.__canvas}static get _context(){return Rh.__context||(Rh.__context=Rh._canvas.getContext("2d",Dh)),Rh.__context}};let Ih=Rh;Ih.METRICS_STRING="|ÉqÅ",Ih.BASELINE_SYMBOL="M",Ih.BASELINE_MULTIPLIER=1.4,Ih.HEIGHT_MULTIPLIER=2,Ih.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map((t=>t.segment))}return t=>[...t]})(),Ih.experimentalLetterSpacing=!1,Ih._fonts={},Ih._newlines=[10,13],Ih._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const Ph=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Nh=class{constructor(t){this.styleID=0,this.reset(),Lh(this,t,t)}clone(){const t={};return Lh(t,this,Nh.defaultStyle),new Nh(t)}reset(){Lh(this,Nh.defaultStyle,Nh.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=Bh(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=Bh(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=Bh(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let r=e[t].trim();/([\"\'])[^\'\"]+\1/.test(r)||Ph.includes(r)||(r=`"${r}"`),e[t]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};let kh=Nh;function Bh(t){const e=Ne.shared;return Array.isArray(t)?t.map((t=>e.setValue(t).toHex())):e.setValue(t).toHex()}function Lh(t,e,r){for(const i in r)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}kh.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ch.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};const Oh={texture:!0,children:!1,baseTexture:!0},Fh=class extends Hs{constructor(t,e,r){let i=!1;r||(r=S.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;const n=ln.from(r);n.orig=new Kr,n.trim=new Kr,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=Fh.defaultResolution??S.RESOLUTION,this._autoResolution=Fh.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return Ih.experimentalLetterSpacing}static set experimentalLetterSpacing(t){V.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Ih.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const r=this.context,i=Ih.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,s=i.height,a=i.lines,o=i.lineHeight,h=i.lineWidths,u=i.maxLineWidth,l=i.fontProperties;let c,f;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),r.scale(this._resolution,this._resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.lineWidth=e.strokeThickness,r.textBaseline=e.textBaseline,r.lineJoin=e.lineJoin,r.miterLimit=e.miterLimit;const d=e.dropShadow?2:1;for(let t=0;t<d;++t){const n=e.dropShadow&&0===t,d=n?Math.ceil(Math.max(1,s)+2*e.padding):0,p=d*this._resolution;if(n){r.fillStyle="black",r.strokeStyle="black";const t=e.dropShadowColor,i=e.dropShadowBlur*this._resolution,n=e.dropShadowDistance*this._resolution;r.shadowColor=Ne.shared.setValue(t).setAlpha(e.dropShadowAlpha).toRgbaString(),r.shadowBlur=i,r.shadowOffsetX=Math.cos(e.dropShadowAngle)*n,r.shadowOffsetY=Math.sin(e.dropShadowAngle)*n+p}else r.fillStyle=this._generateFillStyle(e,a,i),r.strokeStyle=e.stroke,r.shadowColor="black",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;let m=(o-l.fontSize)/2;o-l.fontSize<0&&(m=0);for(let t=0;t<a.length;t++)c=e.strokeThickness/2,f=e.strokeThickness/2+t*o+l.ascent+m,"right"===e.align?c+=u-h[t]:"center"===e.align&&(c+=(u-h[t])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[t],c+e.padding,f+e.padding-d,!0),e.fill&&this.drawLetterSpacing(a[t],c+e.padding,f+e.padding-d)}this.updateTexture()}drawLetterSpacing(t,e,r,i=!1){const n=this._style.letterSpacing;let s=!1;if(Ih.experimentalLetterSpacingSupported&&(Ih.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===n||s)return void(i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r));let a=e;const o=Ih.graphemeSegmenter(t);let h=this.context.measureText(t).width,u=0;for(let t=0;t<o.length;++t){const e=o[t];i?this.context.strokeText(e,a,r):this.context.fillText(e,a,r);let s="";for(let e=t+1;e<o.length;++e)s+=o[e];u=this.context.measureText(s).width,a+=h-u+n,h=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const e=V.trimCanvas(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}const e=this._texture,r=this._style,i=r.trim?0:r.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-2*i,e.orig.height=e._frame.height-2*i,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,r){const i=t.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];let n;const s=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,o=this.canvas.width/this._resolution-s-2*a,h=this.canvas.height/this._resolution-s-2*a,u=i.slice(),l=t.fillGradientStops.slice();if(!l.length){const t=u.length+1;for(let e=1;e<t;++e)l.push(e/t)}if(u.unshift(i[0]),l.unshift(0),u.push(i[i.length-1]),l.push(1),t.fillGradientType===Ch.LINEAR_VERTICAL){n=this.context.createLinearGradient(o/2,a,o/2,h+a);const i=r.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<e.length;t++){const s=r.lineHeight*(t-1)+i,a=r.lineHeight*t;let o=a;t>0&&s>a&&(o=(a+s)/2);const c=a+i,f=r.lineHeight*(t+1);let d=c;t+1<e.length&&f<c&&(d=(c+f)/2);const p=(d-o)/h;for(let t=0;t<u.length;t++){let e=0;e="number"==typeof l[t]?l[t]:t/u.length;let r=Math.min(1,Math.max(0,o/h+e*p));r=Number(r.toFixed(5)),n.addColorStop(r,u[t])}}}else{n=this.context.createLinearGradient(a,h/2,o+a,h/2);const t=u.length+1;let e=1;for(let r=0;r<u.length;r++){let i;i="number"==typeof l[r]?l[r]:e/t,n.addColorStop(i,u[r]),e++}}return n}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Oh,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=V.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=V.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},this._style=t instanceof kh?t:new kh(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let Uh=Fh;Uh.defaultAutoResolution=!0;class zh{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Gh(t,e){let r=!1;if(t?._textures?.length)for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof ln){const n=t._textures[i].baseTexture;e.includes(n)||(e.push(n),r=!0)}return r}function Hh(t,e){if(t.baseTexture instanceof Nr){const r=t.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function jh(t,e){if(t._texture&&t._texture instanceof ln){const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Vh(t,e){return e instanceof Uh&&(e.updateText(!0),!0)}function Wh(t,e){if(e instanceof kh){const t=e.toFontString();return Ih.measureFont(t),!0}return!1}function qh(t,e){if(t instanceof Uh){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const r=t._texture.baseTexture;return e.includes(r)||e.push(r),!0}return!1}function Xh(t,e){return t instanceof kh&&(e.includes(t)||e.push(t),!0)}const Yh=class{constructor(t){this.limiter=new zh(Yh.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(qh),this.registerFindHook(Xh),this.registerFindHook(Gh),this.registerFindHook(Hh),this.registerFindHook(jh),this.registerUploadHook(Vh),this.registerUploadHook(Wh)}upload(t){return new Promise((e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,ps.system.addOnce(this.tick,this,cs.UTILITY))):e()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)ps.system.addOnce(this.tick,this,cs.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,r=t.length;e<r;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,r=this.addHooks.length;e<r&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Us)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&ps.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Zh=Yh;function $h(t,e){return e instanceof Nr&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Kh(t,e){if(!(e instanceof vh))return!1;const{geometry:r}=e;e.finishPoly(),r.updateBatches();const{batches:i}=r;for(let e=0;e<i.length;e++){const{texture:r}=i[e].style;r&&$h(t,r.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function Jh(t,e){return t instanceof vh&&(e.push(t),!0)}Zh.uploadsPerFrame=4,Object.defineProperties(S,{UPLOADS_PER_FRAME:{get:()=>Zh.uploadsPerFrame,set(t){V.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Zh.uploadsPerFrame=t}}});class Qh extends Zh{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(Jh),this.registerUploadHook($h),this.registerUploadHook(Kh)}}Qh.extension={name:"prepare",type:vr.RendererSystem},yr.add(Qh);new Zr;var tu="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const eu=new ri;class ru extends qi{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new pn,this.state=Sr.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Hi.from(tu,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?Hi.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):Hi.from(tu,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)}render(t){const e=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;i=r.uvs,i[0]=i[6]=-n,i[1]=i[3]=-s,i[2]=i[4]=1-n,i[5]=i[7]=1-s,r.invalidate();const a=t._texture,o=a.baseTexture,h=o.alphaMode>0,u=t.tileTransform.localTransform,l=t.uvMatrix;let c=o.isPowerOfTwo&&a.frame.width===o.width&&a.frame.height===o.height;c&&(o._glTextures[e.CONTEXT_UID]?c=o.wrapMode!==g.CLAMP:o.wrapMode===g.CLAMP&&(o.wrapMode=g.REPEAT));const f=c?this.simpleShader:this.shader,d=a.width,p=a.height,m=t._width,v=t._height;eu.set(u.a*d/m,u.b*d/v,u.c*p/m,u.d*p/v,u.tx/m,u.ty/v),eu.invert(),c?eu.prepend(l.mapCoord):(f.uniforms.uMapCoord=l.mapCoord.toArray(!0),f.uniforms.uClampFrame=l.uClampFrame,f.uniforms.uClampOffset=l.uClampOffset),f.uniforms.uTransform=eu.toArray(!0),f.uniforms.uColor=Ne.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(r),this.state.blendMode=V.correctBlendMode(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}ru.extension={name:"tilingSprite",type:vr.RendererPlugin},yr.add(ru);const iu=class{constructor(t,e,r=null){this.linkedSheets=[],this._texture=t instanceof ln?t:null,this.baseTexture=t instanceof Nr?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let r=V.getResolutionOfUrl(t,null);return null===r&&(r=parseFloat(e??"1")),1!==r&&this.baseTexture.setResolution(r),r}parse(){return new Promise((t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=iu.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(t){let e=t;const r=iu.BATCH_SIZE;for(;e-t<r&&e<this._frameKeys.length;){const t=this._frameKeys[e],r=this._frames[t],i=r.frame;if(i){let e=null,n=null;const s=!1!==r.trimmed&&r.sourceSize?r.sourceSize:r.frame,a=new Kr(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);e=r.rotated?new Kr(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.h)/this.resolution,Math.floor(i.w)/this.resolution):new Kr(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution),!1!==r.trimmed&&r.spriteSourceSize&&(n=new Kr(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution)),this.textures[t]=new ln(this.baseTexture,e,a,n,r.rotated?2:0,r.anchor,r.borders),ln.addToCache(this.textures[t],t)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const i=t[e][r];this.animations[e].push(this.textures[i])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*iu.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*iu.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let nu=iu;nu.BATCH_SIZE=1e3;const su=["jpg","png","jpeg","avif","webp"];function au(t,e,r){const i={};if(t.forEach((t=>{i[t]=e})),Object.keys(e.textures).forEach((t=>{i[t]=e.textures[t]})),!r){const r=V.path.dirname(t[0]);e.linkedSheets.forEach(((t,n)=>{const s=au([`${r}/${e.data.meta.related_multi_packs[n]}`],t,!0);Object.assign(i,s)}))}return i}const ou={extension:vr.Asset,cache:{test:t=>t instanceof nu,getCacheableAssets:(t,e)=>au(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),r=e.pop(),i=e.pop();return"json"===r&&su.includes(i)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(S.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:vr.LoadParser,priority:Ta.Normal},testParse:async(t,e)=>".json"===V.path.extname(e.src).toLowerCase()&&!!t.frames,async parse(t,e,r){let i=V.path.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+t.meta.image;n=xa(n,e.src);const s=(await r.load([n]))[n],a=new nu(s.baseTexture,t,e.src);await a.parse();const o=t?.meta?.related_multi_packs;if(Array.isArray(o)){const t=[];for(const n of o){if("string"!=typeof n)continue;let s=i+n;e.data?.ignoreMultiPack||(s=xa(s,e.src),t.push(r.load({src:s,data:{ignoreMultiPack:!0}})))}const n=await Promise.all(t);a.linkedSheets=n,n.forEach((t=>{t.linkedSheets=[a].concat(a.linkedSheets.filter((e=>e!==t)))}))}return a},unload(t){t.destroy(!0)}}};yr.add(ou);class hu{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class uu{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const i=e[t].match(/^[a-z]+/gm)[0],n=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const t in n){const e=n[t].split("="),r=e[0],i=e[1].replace(/"/gm,""),a=parseFloat(i),o=isNaN(a)?i:a;s[r]=o}r[i].push(s)}const i=new hu;return r.info.forEach((t=>i.info.push({face:t.face,size:parseInt(t.size,10)}))),r.common.forEach((t=>i.common.push({lineHeight:parseInt(t.lineHeight,10)}))),r.page.forEach((t=>i.page.push({id:parseInt(t.id,10),file:t.file}))),r.char.forEach((t=>i.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)}))),r.kerning.forEach((t=>i.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)}))),r.distanceField.forEach((t=>i.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType}))),i}}class lu{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const e=new hu,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField");for(let t=0;t<r.length;t++)e.info.push({face:r[t].getAttribute("face"),size:parseInt(r[t].getAttribute("size"),10)});for(let t=0;t<i.length;t++)e.common.push({lineHeight:parseInt(i[t].getAttribute("lineHeight"),10)});for(let t=0;t<n.length;t++)e.page.push({id:parseInt(n[t].getAttribute("id"),10)||0,file:n[t].getAttribute("file")});for(let t=0;t<s.length;t++){const r=s[t];e.char.push({id:parseInt(r.getAttribute("id"),10),page:parseInt(r.getAttribute("page"),10)||0,x:parseInt(r.getAttribute("x"),10),y:parseInt(r.getAttribute("y"),10),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10),xoffset:parseInt(r.getAttribute("xoffset"),10),yoffset:parseInt(r.getAttribute("yoffset"),10),xadvance:parseInt(r.getAttribute("xadvance"),10)})}for(let t=0;t<a.length;t++)e.kerning.push({first:parseInt(a[t].getAttribute("first"),10),second:parseInt(a[t].getAttribute("second"),10),amount:parseInt(a[t].getAttribute("amount"),10)});for(let t=0;t<o.length;t++)e.distanceField.push({fieldType:o[t].getAttribute("fieldType"),distanceRange:parseInt(o[t].getAttribute("distanceRange"),10)});return e}}class cu{static test(t){return!("string"!=typeof t||!t.includes("<font>"))&&lu.test(S.ADAPTER.parseXML(t))}static parse(t){return lu.parse(S.ADAPTER.parseXML(t))}}const fu=[uu,lu,cu];function du(t){for(let e=0;e<fu.length;e++)if(fu[e].test(t))return fu[e];return null}function pu(t,e,r,i,n,s){const a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let o;const h=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,l=t.width/i-h-2*u,c=t.height/i-h-2*u,f=a.slice(),d=r.fillGradientStops.slice();if(!d.length){const t=f.length+1;for(let e=1;e<t;++e)d.push(e/t)}if(f.unshift(a[0]),d.unshift(0),f.push(a[a.length-1]),d.push(1),r.fillGradientType===Ch.LINEAR_VERTICAL){o=e.createLinearGradient(l/2,u,l/2,c+u);let t=0;const i=(s.fontProperties.fontSize+r.strokeThickness)/c;for(let e=0;e<n.length;e++){const r=s.lineHeight*e;for(let e=0;e<f.length;e++){let n=0;n="number"==typeof d[e]?d[e]:e/f.length;const s=r/c+n*i;let a=Math.max(t,s);a=Math.min(a,1),o.addColorStop(a,f[e]),t=a}}}else{o=e.createLinearGradient(u,c/2,l+u,c/2);const t=f.length+1;let r=1;for(let e=0;e<f.length;e++){let i;i="number"==typeof d[e]?d[e]:r/t,o.addColorStop(i,f[e]),r++}}return o}function mu(t,e,r,i,n,s,a){const o=r.text,h=r.fontProperties;e.translate(i,n),e.scale(s,s);const u=a.strokeThickness/2,l=-a.strokeThickness/2;if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=pu(t,e,a,s,[o],r),e.strokeStyle=a.stroke,a.dropShadow){const t=a.dropShadowColor,r=a.dropShadowBlur*s,i=a.dropShadowDistance*s;e.shadowColor=Ne.shared.setValue(t).setAlpha(a.dropShadowAlpha).toRgbaString(),e.shadowBlur=r,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*i,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*i}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(o,u,l+r.lineHeight-h.descent),a.fill&&e.fillText(o,u,l+r.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function gu(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function vu(t){return Array.from?Array.from(t):t.split("")}function _u(t){"string"==typeof t&&(t=[t]);const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];if(Array.isArray(i)){if(2!==i.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const t=i[0].charCodeAt(0),r=i[1].charCodeAt(0);if(r<t)throw new Error("[BitmapFont]: Invalid character range.");for(let i=t,n=r;i<=n;i++)e.push(String.fromCharCode(i))}else e.push(...vu(i))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const bu=class{constructor(t,e,r){const[i]=t.info,[n]=t.common,[s]=t.page,[a]=t.distanceField,o=V.getResolutionOfUrl(s.file),h={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/o,this.chars={},this.pageTextures=h;for(let r=0;r<t.page.length;r++){const{id:i,file:n}=t.page[r];h[i]=e instanceof Array?e[r]:e[n],a?.fieldType&&"none"!==a.fieldType&&(h[i].baseTexture.alphaMode=_.NO_PREMULTIPLIED_ALPHA,h[i].baseTexture.mipmap=v.OFF)}for(let e=0;e<t.char.length;e++){const{id:r,page:i}=t.char[e];let{x:n,y:s,width:a,height:u,xoffset:l,yoffset:c,xadvance:f}=t.char[e];n/=o,s/=o,a/=o,u/=o,l/=o,c/=o,f/=o;const d=new Kr(n+h[i].frame.x/o,s+h[i].frame.y/o,a,u);this.chars[r]={xOffset:l,yOffset:c,xAdvance:f,kerning:{},texture:new ln(h[i].baseTexture,d),page:i}}for(let e=0;e<t.kerning.length;e++){let{first:r,second:i,amount:n}=t.kerning[e];r/=o,i/=o,n/=o,this.chars[i]&&(this.chars[i].kerning[r]=n)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,r){let i;if(t instanceof hu)i=t;else{const e=du(t);if(!e)throw new Error("Unrecognized data format for font.");i=e.parse(t)}e instanceof ln&&(e=[e]);const n=new bu(i,e,r);return bu.available[n.font]=n,n}static uninstall(t){const e=bu.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete bu.available[t]}static from(t,e,r){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:n,resolution:s,textureWidth:a,textureHeight:o,...h}=Object.assign({},bu.defaultOptions,r),u=_u(i),l=e instanceof kh?e:new kh(e),c=a,f=new hu;f.info[0]={face:l.fontFamily,size:l.fontSize},f.common[0]={lineHeight:l.fontSize};let d,p,m,g=0,v=0,_=0;const b=[],y=[];for(let t=0;t<u.length;t++){d||(d=S.ADAPTER.createCanvas(),d.width=a,d.height=o,p=d.getContext("2d"),m=new Nr(d,{resolution:s,...h}),b.push(m),y.push(new ln(m)),f.page.push({id:y.length-1,file:""}));const e=u[t],r=Ih.measureText(e,l,!1,d),i=r.width,x=Math.ceil(r.height),w=Math.ceil(("italic"===l.fontStyle?2:1)*i);if(v>=o-x*s){if(0===v)throw new Error(`[BitmapFont] textureHeight ${o}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${e}')`);--t,d=null,p=null,m=null,v=0,g=0,_=0;continue}if(_=Math.max(x+r.fontProperties.descent,_),w*s+g>=c){if(0===g)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${l.fontFamily}', fontSize: ${l.fontSize}px, char: '${e}')`);--t,v+=_*s,v=Math.ceil(v),g=0,_=0;continue}mu(d,p,r,g,v,s,l);const E=gu(r.text);f.char.push({id:E,page:y.length-1,x:g/s,y:v/s,width:w,height:x,xoffset:0,yoffset:0,xadvance:i-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0)}),g+=(w+2*n)*s,g=Math.ceil(g)}for(let t=0,e=u.length;t<e;t++){const r=u[t];for(let t=0;t<e;t++){const e=u[t],i=p.measureText(r).width,n=p.measureText(e).width,s=p.measureText(r+e).width-(i+n);s&&f.kerning.push({first:gu(r),second:gu(e),amount:s})}}const x=new bu(f,y,!0);return void 0!==bu.available[t]&&bu.uninstall(t),bu.available[t]=x,x}};let yu=bu;yu.ALPHA=[["a","z"],["A","Z"]," "],yu.NUMERIC=[["0","9"]],yu.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],yu.ASCII=[[" ","~"]],yu.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:bu.ALPHANUMERIC},yu.available={};const xu=[],wu=[],Eu=[],Mu=class extends Us{constructor(t,e={}){super();const{align:r,tint:i,maxWidth:n,letterSpacing:s,fontName:a,fontSize:o}=Object.assign({},Mu.styleDefaults,e);if(!yu.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new Ne(i),this._font=void 0,this._fontName=a,this._fontSize=o,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new ci((()=>{this.dirty=!0}),this,0,0),this._roundPixels=S.ROUND_PIXELS,this.dirty=!0,this._resolution=S.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=yu.available[this._fontName],e=this.fontSize,r=e/t.size,i=new Zr,n=[],s=[],a=[],o=vu(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*t.size/e,l="none"===t.distanceFieldType?xu:wu;let c=null,f=0,d=0,p=0,m=-1,g=0,v=0,_=0,b=0;for(let e=0;e<o.length;e++){const r=o[e],u=gu(r);if(/(?:\s)/.test(r)&&(m=e,g=f,b++),"\r"===r||"\n"===r){s.push(f),a.push(-1),d=Math.max(d,f),++p,++v,i.x=0,i.y+=t.lineHeight,c=null,b=0;continue}const l=t.chars[u];if(!l)continue;c&&l.kerning[c]&&(i.x+=l.kerning[c]);const y=Eu.pop()||{texture:ln.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Zr};y.texture=l.texture,y.line=p,y.charCode=u,y.position.x=Math.round(i.x+l.xOffset+this._letterSpacing/2),y.position.y=Math.round(i.y+l.yOffset),y.prevSpaces=b,n.push(y),f=y.position.x+Math.max(l.xAdvance-l.xOffset,l.texture.orig.width),i.x+=l.xAdvance+this._letterSpacing,_=Math.max(_,l.yOffset+l.texture.height),c=u,-1!==m&&h>0&&i.x>h&&(++v,V.removeItems(n,1+m-v,1+e-m),e=m,m=-1,s.push(g),a.push(n.length>0?n[n.length-1].prevSpaces:0),d=Math.max(d,g),p++,i.x=0,i.y+=t.lineHeight,c=null,b=0)}const y=o[o.length-1];"\r"!==y&&"\n"!==y&&(/(?:\s)/.test(y)&&(f=g),s.push(f),d=Math.max(d,f),a.push(-1));const x=[];for(let t=0;t<=p;t++){let e=0;"right"===this._align?e=d-s[t]:"center"===this._align?e=(d-s[t])/2:"justify"===this._align&&(e=a[t]<0?0:(d-s[t])/a[t]),x.push(e)}const w=n.length,E={},M=[],S=this._activePagesMeshData;l.push(...S);for(let e=0;e<w;e++){const r=n[e].texture,i=r.baseTexture.uid;if(!E[i]){let e=l.pop();if(!e){const r=new Mh;let i,n;"none"===t.distanceFieldType?(i=new Sh(ln.EMPTY),n=u.NORMAL):(i=new Sh(ln.EMPTY,{program:Ui.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),n=u.NORMAL_NPM);const s=new Eh(r,i);s.blendMode=n,e={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:s,vertices:null,uvs:null,indices:null}}e.index=0,e.indexCount=0,e.vertexCount=0,e.uvsCount=0,e.total=0;const{_textureCache:n}=this;n[i]=n[i]||new ln(r.baseTexture),e.mesh.texture=n[i],e.mesh.tint=this._tintColor.value,M.push(e),E[i]=e}E[i].total++}for(let t=0;t<S.length;t++)M.includes(S[t])||this.removeChild(S[t].mesh);for(let t=0;t<M.length;t++)M[t].mesh.parent!==this&&this.addChild(M[t].mesh);this._activePagesMeshData=M;for(const t in E){const e=E[t],r=e.total;if(!(e.indices?.length>6*r)||e.vertices.length<2*Eh.BATCHABLE_SIZE)e.vertices=new Float32Array(8*r),e.uvs=new Float32Array(8*r),e.indices=new Uint16Array(6*r);else{const t=e.total,r=e.vertices;for(let e=8*t;e<r.length;e++)r[e]=0}e.mesh.size=6*r}for(let t=0;t<w;t++){const e=n[t];let i=e.position.x+x[e.line]*("justify"===this._align?e.prevSpaces:1);this._roundPixels&&(i=Math.round(i));const s=i*r,a=e.position.y*r,o=e.texture,h=E[o.baseTexture.uid],u=o.frame,l=o._uvs,c=h.index++;h.indices[6*c+0]=0+4*c,h.indices[6*c+1]=1+4*c,h.indices[6*c+2]=2+4*c,h.indices[6*c+3]=0+4*c,h.indices[6*c+4]=2+4*c,h.indices[6*c+5]=3+4*c,h.vertices[8*c+0]=s,h.vertices[8*c+1]=a,h.vertices[8*c+2]=s+u.width*r,h.vertices[8*c+3]=a,h.vertices[8*c+4]=s+u.width*r,h.vertices[8*c+5]=a+u.height*r,h.vertices[8*c+6]=s,h.vertices[8*c+7]=a+u.height*r,h.uvs[8*c+0]=l.x0,h.uvs[8*c+1]=l.y0,h.uvs[8*c+2]=l.x1,h.uvs[8*c+3]=l.y1,h.uvs[8*c+4]=l.x2,h.uvs[8*c+5]=l.y2,h.uvs[8*c+6]=l.x3,h.uvs[8*c+7]=l.y3}this._textWidth=d*r,this._textHeight=(i.y+t.lineHeight)*r;for(const t in E){const e=E[t];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;const r=this._textWidth*this.anchor.x,i=this._textHeight*this.anchor.y;for(let n=0;n<e.total;n++)e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i}this._maxLineHeight=_*r;const i=e.mesh.geometry.getBuffer("aVertexPosition"),n=e.mesh.geometry.getBuffer("aTextureCoord"),s=e.mesh.geometry.getIndex();i.data=e.vertices,n.data=e.uvs,s.data=e.indices,i.update(),n.update(),s.update()}for(let t=0;t<n.length;t++)Eu.push(n[t]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:r,size:i}=yu.available[this._fontName];if("none"!==r){const{a:r,b:n,c:s,d:a}=this.worldTransform,o=Math.sqrt(r*r+n*n),h=Math.sqrt(s*s+a*a),u=(Math.abs(o)+Math.abs(h))/2,l=this.fontSize/i,c=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=u*e*l*c}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=yu.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!yu.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??yu.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,r="none"===yu.available[this._fontName].distanceFieldType?xu:wu;r.push(...this._activePagesMeshData);for(const t of this._activePagesMeshData)this.removeChild(t.mesh);this._activePagesMeshData=[],r.filter((t=>e[t.mesh.texture.baseTexture.uid])).forEach((t=>{t.mesh.texture=ln.EMPTY}));for(const t in e){e[t].destroy(),delete e[t]}this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};Mu.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const Su=[".xml",".fnt"],Au={extension:{type:vr.LoadParser,priority:Ta.Normal},name:"loadBitmapFont",test:t=>Su.includes(V.path.extname(t).toLowerCase()),testParse:async t=>uu.test(t)||cu.test(t),async parse(t,e,r){const i=uu.test(t)?uu.parse(t):cu.parse(t),{src:n}=e,{page:s}=i,a=[];for(let t=0;t<s.length;++t){const e=s[t].file;let r=V.path.join(V.path.dirname(n),e);r=xa(r,n),a.push(r)}const o=await r.load(a),h=a.map((t=>o[t]));return yu.install(i,h,!0)},load:async(t,e)=>(await S.ADAPTER.fetch(t)).text(),unload(t){t.destroy()}};yr.add(Au);const Tu=class extends kh{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Tu(Object.keys(Tu.defaultOptions).reduce(((e,r)=>({...e,[r]:t[r]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Tu.availableFonts[t.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:r}=Tu;if(r[t]){const e=r[t];return this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return S.ADAPTER.fetch(t).then((t=>t.blob())).then((async t=>new Promise(((e,r)=>{const i=URL.createObjectURL(t),n=new FileReader;n.onload=()=>e([i,n.result]),n.onerror=r,n.readAsDataURL(t)})))).then((async([i,n])=>{const s=Object.assign({family:V.path.basename(t,V.path.extname(t)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);r[t]=s,this._fonts.push(s),this.styleID++;const a=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style});s.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...t){const e=t.filter((t=>!this._overrides.includes(t)));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter((t=>this._overrides.includes(t)));e.length>0&&(this._overrides=this._overrides.filter((t=>!e.includes(t))),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((t,e)=>`${t}\n            @font-face {\n                font-family: "${e.family}";\n                src: url('${e.dataSrc}');\n                font-weight: ${e.weight};\n                font-style: ${e.style}; \n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=V.rgb2hex(t)),"number"==typeof t?V.hex2string(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(255*e|0).toString(16).padStart(2,"0"));const n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,Tu.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise((t=>setTimeout(t,100))):Promise.resolve()}get isSafari(){const{userAgent:t}=S.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Cu=Tu;Cu.availableFonts={},Cu.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Du=class extends Hs{constructor(t="",e={}){super(ln.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const r=new Image,i=ln.from(r,{scaleMode:S.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Kr,i.trim=new Kr,this.texture=i;const n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),o=document.createElementNS(n,"foreignObject"),h=document.createElementNS(s,"div"),u=document.createElementNS(s,"style");o.setAttribute("width","10000"),o.setAttribute("height","10000"),o.style.overflow="hidden",a.appendChild(o),this.maxWidth=Du.defaultMaxWidth,this.maxHeight=Du.defaultMaxHeight,this._domElement=h,this._styleElement=u,this._svgRoot=a,this._foreignObject=o,this._foreignObject.appendChild(u),this._foreignObject.appendChild(h),this._image=r,this._loadImage=new Image,this._autoResolution=Du.defaultAutoResolution,this._resolution=Du.defaultResolution??S.RESOLUTION,this.text=t,this.style=e}measureText(t){const{text:e,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const s=Math.min(this.maxWidth,Math.ceil(n.width)),a=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",a.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+2*r.padding,height:a+2*r.padding}}async updateText(t=!0){const{style:e,_image:r,_loadImage:i}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:s}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,s)),this._loading||(this._loading=!0,await new Promise((t=>{i.onload=async()=>{await e.onBeforeDraw(),this._loading=!1,r.src=i.src,i.onload=null,i.src="",this.updateTexture(),t()};const n=(new XMLSerializer).serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(n)}`})))}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:r,resolution:i}=this,{padding:n}=t,{baseTexture:s}=e;e.trim.width=e._frame.width=r.width/i,e.trim.height=e._frame.height=r.height/i,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-2*n,e.orig.height=e._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(r.width,r.height,i),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Du.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=e,this._svgRoot?.remove(),this._svgRoot=e,this._domElement?.remove(),this._domElement=e,this._foreignObject?.remove(),this._foreignObject=e,this._styleElement?.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=V.sign(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=V.sign(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof Cu?(this.ownsStyle=!1,this._style=t):t instanceof kh?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Cu.from(t)):(this.ownsStyle=!0,this._style=new Cu(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let Ru=Du;Ru.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Ru.defaultMaxWidth=2024,Ru.defaultMaxHeight=2024,Ru.defaultAutoResolution=!0;
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const Iu="148",Pu=100,Nu=301,ku=302,Bu=303,Lu=304,Ou=306,Fu=1e3,Uu=1001,zu=1002,Gu=1003,Hu=1004,ju=1005,Vu=1006,Wu=1008,qu=1009,Xu=1014,Yu=1015,Zu=1016,$u=1020,Ku=1023,Ju=1026,Qu=1027,tl=33776,el=33777,rl=33778,il=33779,nl=2300,sl=2301,al=2302,ol=2400,hl=2401,ul=2402,ll=3e3,cl=3001,fl="srgb",dl="srgb-linear",pl=7680,ml=35044,gl="300 es",vl=1035;class _l{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const r=this._listeners[t];if(void 0!==r){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const r=e.slice(0);for(let e=0,i=r.length;e<i;e++)r[e].call(this,t);t.target=null}}}const bl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const yl=Math.PI/180,xl=180/Math.PI;function wl(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(bl[255&t]+bl[t>>8&255]+bl[t>>16&255]+bl[t>>24&255]+"-"+bl[255&e]+bl[e>>8&255]+"-"+bl[e>>16&15|64]+bl[e>>24&255]+"-"+bl[63&r|128]+bl[r>>8&255]+"-"+bl[r>>16&255]+bl[r>>24&255]+bl[255&i]+bl[i>>8&255]+bl[i>>16&255]+bl[i>>24&255]).toLowerCase()}function El(t,e,r){return Math.max(e,Math.min(r,t))}function Ml(t,e){return(t%e+e)%e}function Sl(t,e,r){return(1-r)*t+r*e}function Al(t){return 0==(t&t-1)&&0!==t}function Tl(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Cl(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Dl(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}class Rl{constructor(t=0,e=0){Rl.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),n=this.x-t.x,s=this.y-t.y;return this.x=n*r-s*i+t.x,this.y=n*i+s*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Il{constructor(){Il.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,r,i,n,s,a,o,h){const u=this.elements;return u[0]=t,u[1]=i,u[2]=a,u[3]=e,u[4]=n,u[5]=o,u[6]=r,u[7]=s,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,n=this.elements,s=r[0],a=r[3],o=r[6],h=r[1],u=r[4],l=r[7],c=r[2],f=r[5],d=r[8],p=i[0],m=i[3],g=i[6],v=i[1],_=i[4],b=i[7],y=i[2],x=i[5],w=i[8];return n[0]=s*p+a*v+o*y,n[3]=s*m+a*_+o*x,n[6]=s*g+a*b+o*w,n[1]=h*p+u*v+l*y,n[4]=h*m+u*_+l*x,n[7]=h*g+u*b+l*w,n[2]=c*p+f*v+d*y,n[5]=c*m+f*_+d*x,n[8]=c*g+f*b+d*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=t[8];return e*s*u-e*a*h-r*n*u+r*a*o+i*n*h-i*s*o}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=t[8],l=u*s-a*h,c=a*o-u*n,f=h*n-s*o,d=e*l+r*c+i*f;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const p=1/d;return t[0]=l*p,t[1]=(i*h-u*r)*p,t[2]=(a*r-i*s)*p,t[3]=c*p,t[4]=(u*e-i*o)*p,t[5]=(i*n-a*e)*p,t[6]=f*p,t[7]=(r*o-h*e)*p,t[8]=(s*e-r*n)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,n,s,a){const o=Math.cos(n),h=Math.sin(n);return this.set(r*o,r*h,-r*(o*s+h*a)+s+t,-i*h,i*o,-i*(-h*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Pl.makeScale(t,e)),this}rotate(t){return this.premultiply(Pl.makeRotation(-t)),this}translate(t,e){return this.premultiply(Pl.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<9;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Pl=new Il;function Nl(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function kl(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Bl(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ll(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const Ol={[fl]:{[dl]:Bl},[dl]:{[fl]:Ll}},Fl={legacyMode:!0,get workingColorSpace(){return dl},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,r){if(this.legacyMode||e===r||!e||!r)return t;if(Ol[e]&&void 0!==Ol[e][r]){const i=Ol[e][r];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},Ul={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zl={r:0,g:0,b:0},Gl={h:0,s:0,l:0},Hl={h:0,s:0,l:0};function jl(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function Vl(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class Wl{constructor(t,e,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=fl){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Fl.toWorkingColorSpace(this,e),this}setRGB(t,e,r,i=Fl.workingColorSpace){return this.r=t,this.g=e,this.b=r,Fl.toWorkingColorSpace(this,i),this}setHSL(t,e,r,i=Fl.workingColorSpace){if(t=Ml(t,1),e=El(e,0,1),r=El(r,0,1),0===e)this.r=this.g=this.b=r;else{const i=r<=.5?r*(1+e):r+e-r*e,n=2*r-i;this.r=jl(n,i,t+1/3),this.g=jl(n,i,t),this.b=jl(n,i,t-1/3)}return Fl.toWorkingColorSpace(this,i),this}setStyle(t,e=fl){function r(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const n=i[1],s=i[2];switch(n){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,Fl.toWorkingColorSpace(this,e),r(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,Fl.toWorkingColorSpace(this,e),r(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const i=parseFloat(t[1])/360,n=parseFloat(t[2])/100,s=parseFloat(t[3])/100;return r(t[4]),this.setHSL(i,n,s,e)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],r=t.length;if(3===r)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,Fl.toWorkingColorSpace(this,e),this;if(6===r)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,Fl.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=fl){const r=Ul[t.toLowerCase()];return void 0!==r?this.setHex(r,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Bl(t.r),this.g=Bl(t.g),this.b=Bl(t.b),this}copyLinearToSRGB(t){return this.r=Ll(t.r),this.g=Ll(t.g),this.b=Ll(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=fl){return Fl.fromWorkingColorSpace(Vl(this,zl),t),El(255*zl.r,0,255)<<16^El(255*zl.g,0,255)<<8^El(255*zl.b,0,255)<<0}getHexString(t=fl){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Fl.workingColorSpace){Fl.fromWorkingColorSpace(Vl(this,zl),e);const r=zl.r,i=zl.g,n=zl.b,s=Math.max(r,i,n),a=Math.min(r,i,n);let o,h;const u=(a+s)/2;if(a===s)o=0,h=0;else{const t=s-a;switch(h=u<=.5?t/(s+a):t/(2-s-a),s){case r:o=(i-n)/t+(i<n?6:0);break;case i:o=(n-r)/t+2;break;case n:o=(r-i)/t+4}o/=6}return t.h=o,t.s=h,t.l=u,t}getRGB(t,e=Fl.workingColorSpace){return Fl.fromWorkingColorSpace(Vl(this,zl),e),t.r=zl.r,t.g=zl.g,t.b=zl.b,t}getStyle(t=fl){return Fl.fromWorkingColorSpace(Vl(this,zl),t),t!==fl?`color(${t} ${zl.r} ${zl.g} ${zl.b})`:`rgb(${255*zl.r|0},${255*zl.g|0},${255*zl.b|0})`}offsetHSL(t,e,r){return this.getHSL(Gl),Gl.h+=t,Gl.s+=e,Gl.l+=r,this.setHSL(Gl.h,Gl.s,Gl.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this}lerpHSL(t,e){this.getHSL(Gl),t.getHSL(Hl);const r=Sl(Gl.h,Hl.h,e),i=Sl(Gl.s,Hl.s,e),n=Sl(Gl.l,Hl.l,e);return this.setHSL(r,i,n),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let ql;Wl.NAMES=Ul;class Xl{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===ql&&(ql=kl("canvas")),ql.width=t.width,ql.height=t.height;const r=ql.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),e=ql}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=kl("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),n=i.data;for(let t=0;t<n.length;t++)n[t]=255*Bl(n[t]/255);return r.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Bl(e[t]/255)):e[t]=Bl(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class Yl{constructor(t=null){this.isSource=!0,this.uuid=wl(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,r=i.length;e<r;e++)i[e].isDataTexture?t.push(Zl(i[e].image)):t.push(Zl(i[e]))}else t=Zl(i);r.url=t}return e||(t.images[this.uuid]=r),r}}function Zl(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Xl.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let $l=0;class Kl extends _l{constructor(t=Kl.DEFAULT_IMAGE,e=Kl.DEFAULT_MAPPING,r=1001,i=1001,n=1006,s=1008,a=1023,o=1009,h=Kl.DEFAULT_ANISOTROPY,u=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$l++}),this.uuid=wl(),this.name="",this.source=new Yl(t),this.mipmaps=[],this.mapping=e,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Rl(0,0),this.repeat=new Rl(1,1),this.center=new Rl(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Il,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),e||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Fu:t.x=t.x-Math.floor(t.x);break;case Uu:t.x=t.x<0?0:1;break;case zu:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Fu:t.y=t.y-Math.floor(t.y);break;case Uu:t.y=t.y<0?0:1;break;case zu:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}Kl.DEFAULT_IMAGE=null,Kl.DEFAULT_MAPPING=300,Kl.DEFAULT_ANISOTROPY=1;class Jl{constructor(t=0,e=0,r=0,i=1){Jl.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,n=this.w,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*e+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*e+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*e+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,n;const s=.01,a=.1,o=t.elements,h=o[0],u=o[4],l=o[8],c=o[1],f=o[5],d=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(u-c)<s&&Math.abs(l-p)<s&&Math.abs(d-m)<s){if(Math.abs(u+c)<a&&Math.abs(l+p)<a&&Math.abs(d+m)<a&&Math.abs(h+f+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(h+1)/2,o=(f+1)/2,v=(g+1)/2,_=(u+c)/4,b=(l+p)/4,y=(d+m)/4;return t>o&&t>v?t<s?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(t),i=_/r,n=b/r):o>v?o<s?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(o),r=_/i,n=y/i):v<s?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(v),r=b/n,i=y/n),this.set(r,i,n,e),this}let v=Math.sqrt((m-d)*(m-d)+(l-p)*(l-p)+(c-u)*(c-u));return Math.abs(v)<.001&&(v=1),this.x=(m-d)/v,this.y=(l-p)/v,this.z=(c-u)/v,this.w=Math.acos((h+f+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ql extends _l{constructor(t=1,e=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Jl(0,0,t,e),this.scissorTest=!1,this.viewport=new Jl(0,0,t,e);const i={width:t,height:e,depth:1};this.texture=new Kl(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:Vu,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(t,e,r=1){this.width===t&&this.height===e&&this.depth===r||(this.width=t,this.height=e,this.depth=r,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new Yl(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class tc extends Kl{constructor(t=null,e=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:r,depth:i},this.magFilter=Gu,this.minFilter=Gu,this.wrapR=Uu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ec extends Kl{constructor(t=null,e=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:r,depth:i},this.magFilter=Gu,this.minFilter=Gu,this.wrapR=Uu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class rc{constructor(t=0,e=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=i}static slerpFlat(t,e,r,i,n,s,a){let o=r[i+0],h=r[i+1],u=r[i+2],l=r[i+3];const c=n[s+0],f=n[s+1],d=n[s+2],p=n[s+3];if(0===a)return t[e+0]=o,t[e+1]=h,t[e+2]=u,void(t[e+3]=l);if(1===a)return t[e+0]=c,t[e+1]=f,t[e+2]=d,void(t[e+3]=p);if(l!==p||o!==c||h!==f||u!==d){let t=1-a;const e=o*c+h*f+u*d+l*p,r=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const n=Math.sqrt(i),s=Math.atan2(n,e*r);t=Math.sin(t*s)/n,a=Math.sin(a*s)/n}const n=a*r;if(o=o*t+c*n,h=h*t+f*n,u=u*t+d*n,l=l*t+p*n,t===1-a){const t=1/Math.sqrt(o*o+h*h+u*u+l*l);o*=t,h*=t,u*=t,l*=t}}t[e]=o,t[e+1]=h,t[e+2]=u,t[e+3]=l}static multiplyQuaternionsFlat(t,e,r,i,n,s){const a=r[i],o=r[i+1],h=r[i+2],u=r[i+3],l=n[s],c=n[s+1],f=n[s+2],d=n[s+3];return t[e]=a*d+u*l+o*f-h*c,t[e+1]=o*d+u*c+h*l-a*f,t[e+2]=h*d+u*f+a*c-o*l,t[e+3]=u*d-a*l-o*c-h*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const r=t._x,i=t._y,n=t._z,s=t._order,a=Math.cos,o=Math.sin,h=a(r/2),u=a(i/2),l=a(n/2),c=o(r/2),f=o(i/2),d=o(n/2);switch(s){case"XYZ":this._x=c*u*l+h*f*d,this._y=h*f*l-c*u*d,this._z=h*u*d+c*f*l,this._w=h*u*l-c*f*d;break;case"YXZ":this._x=c*u*l+h*f*d,this._y=h*f*l-c*u*d,this._z=h*u*d-c*f*l,this._w=h*u*l+c*f*d;break;case"ZXY":this._x=c*u*l-h*f*d,this._y=h*f*l+c*u*d,this._z=h*u*d+c*f*l,this._w=h*u*l-c*f*d;break;case"ZYX":this._x=c*u*l-h*f*d,this._y=h*f*l+c*u*d,this._z=h*u*d-c*f*l,this._w=h*u*l+c*f*d;break;case"YZX":this._x=c*u*l+h*f*d,this._y=h*f*l+c*u*d,this._z=h*u*d-c*f*l,this._w=h*u*l-c*f*d;break;case"XZY":this._x=c*u*l-h*f*d,this._y=h*f*l-c*u*d,this._z=h*u*d+c*f*l,this._w=h*u*l+c*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],n=e[8],s=e[1],a=e[5],o=e[9],h=e[2],u=e[6],l=e[10],c=r+a+l;if(c>0){const t=.5/Math.sqrt(c+1);this._w=.25/t,this._x=(u-o)*t,this._y=(n-h)*t,this._z=(s-i)*t}else if(r>a&&r>l){const t=2*Math.sqrt(1+r-a-l);this._w=(u-o)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(n+h)/t}else if(a>l){const t=2*Math.sqrt(1+a-r-l);this._w=(n-h)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(o+u)/t}else{const t=2*Math.sqrt(1+l-r-a);this._w=(s-i)/t,this._x=(n+h)/t,this._y=(o+u)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(El(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(0===r)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,n=t._z,s=t._w,a=e._x,o=e._y,h=e._z,u=e._w;return this._x=r*u+s*a+i*h-n*o,this._y=i*u+s*o+n*a-r*h,this._z=n*u+s*h+r*o-i*a,this._w=s*u-r*a-i*o-n*h,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const r=this._x,i=this._y,n=this._z,s=this._w;let a=s*t._w+r*t._x+i*t._y+n*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;const o=1-a*a;if(o<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*r+e*this._x,this._y=t*i+e*this._y,this._z=t*n+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(o),u=Math.atan2(h,a),l=Math.sin((1-e)*u)/h,c=Math.sin(e*u)/h;return this._w=s*l+this._w*c,this._x=r*l+this._x*c,this._y=i*l+this._y*c,this._z=n*l+this._z*c,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=Math.random(),e=Math.sqrt(1-t),r=Math.sqrt(t),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(i),r*Math.sin(n),r*Math.cos(n),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ic{constructor(t=0,e=0,r=0){ic.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return void 0===r&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(sc.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(sc.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[3]*r+n[6]*i,this.y=n[1]*e+n[4]*r+n[7]*i,this.z=n[2]*e+n[5]*r+n[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,n=t.elements,s=1/(n[3]*e+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*e+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*e+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*e+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,n=t.x,s=t.y,a=t.z,o=t.w,h=o*e+s*i-a*r,u=o*r+a*e-n*i,l=o*i+n*r-s*e,c=-n*e-s*r-a*i;return this.x=h*o+c*-n+u*-a-l*-s,this.y=u*o+c*-s+l*-n-h*-a,this.z=l*o+c*-a+h*-s-u*-n,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,n=t.elements;return this.x=n[0]*e+n[4]*r+n[8]*i,this.y=n[1]*e+n[5]*r+n[9]*i,this.z=n[2]*e+n[6]*r+n[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,n=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return nc.copy(this).projectOnVector(t),this.sub(nc)}reflect(t){return this.sub(nc.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(El(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,r=Math.sqrt(1-t**2);return this.x=r*Math.cos(e),this.y=r*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const nc=new ic,sc=new rc;class ac{constructor(t=new ic(1/0,1/0,1/0),e=new ic(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,h=t.length;o<h;o+=3){const h=t[o],u=t[o+1],l=t[o+2];h<e&&(e=h),u<r&&(r=u),l<i&&(i=l),h>n&&(n=h),u>s&&(s=u),l>a&&(a=l)}return this.min.set(e,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(t){let e=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,h=t.count;o<h;o++){const h=t.getX(o),u=t.getY(o),l=t.getZ(o);h<e&&(e=h),u<r&&(r=u),l<i&&(i=l),h>n&&(n=h),u>s&&(s=u),l>a&&(a=l)}return this.min.set(e,r,i),this.max.set(n,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=hc.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(void 0!==r)if(e&&null!=r.attributes&&void 0!==r.attributes.position){const e=r.attributes.position;for(let r=0,i=e.count;r<i;r++)hc.fromBufferAttribute(e,r).applyMatrix4(t.matrixWorld),this.expandByPoint(hc)}else null===r.boundingBox&&r.computeBoundingBox(),uc.copy(r.boundingBox),uc.applyMatrix4(t.matrixWorld),this.union(uc);const i=t.children;for(let t=0,r=i.length;t<r;t++)this.expandByObject(i[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,hc),hc.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(vc),_c.subVectors(this.max,vc),lc.subVectors(t.a,vc),cc.subVectors(t.b,vc),fc.subVectors(t.c,vc),dc.subVectors(cc,lc),pc.subVectors(fc,cc),mc.subVectors(lc,fc);let e=[0,-dc.z,dc.y,0,-pc.z,pc.y,0,-mc.z,mc.y,dc.z,0,-dc.x,pc.z,0,-pc.x,mc.z,0,-mc.x,-dc.y,dc.x,0,-pc.y,pc.x,0,-mc.y,mc.x,0];return!!xc(e,lc,cc,fc,_c)&&(e=[1,0,0,0,1,0,0,0,1],!!xc(e,lc,cc,fc,_c)&&(bc.crossVectors(dc,pc),e=[bc.x,bc.y,bc.z],xc(e,lc,cc,fc,_c)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return hc.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(hc).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(oc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),oc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),oc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),oc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),oc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),oc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),oc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),oc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(oc)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const oc=[new ic,new ic,new ic,new ic,new ic,new ic,new ic,new ic],hc=new ic,uc=new ac,lc=new ic,cc=new ic,fc=new ic,dc=new ic,pc=new ic,mc=new ic,vc=new ic,_c=new ic,bc=new ic,yc=new ic;function xc(t,e,r,i,n){for(let s=0,a=t.length-3;s<=a;s+=3){yc.fromArray(t,s);const a=n.x*Math.abs(yc.x)+n.y*Math.abs(yc.y)+n.z*Math.abs(yc.z),o=e.dot(yc),h=r.dot(yc),u=i.dot(yc);if(Math.max(-Math.max(o,h,u),Math.min(o,h,u))>a)return!1}return!0}const wc=new ac,Ec=new ic,Mc=new ic;class Sc{constructor(t=new ic,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;void 0!==e?r.copy(e):wc.setFromPoints(t).getCenter(r);let i=0;for(let e=0,n=t.length;e<n;e++)i=Math.max(i,r.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Ec.subVectors(t,this.center);const e=Ec.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),r=.5*(t-this.radius);this.center.addScaledVector(Ec,r/t),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(Mc.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Ec.copy(t.center).add(Mc)),this.expandByPoint(Ec.copy(t.center).sub(Mc))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ac=new ic,Tc=new ic,Cc=new ic,Dc=new ic,Rc=new ic,Ic=new ic,Pc=new ic;class Nc{constructor(t=new ic,e=new ic(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Ac)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Ac.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Ac.copy(this.direction).multiplyScalar(e).add(this.origin),Ac.distanceToSquared(t))}distanceSqToSegment(t,e,r,i){Tc.copy(t).add(e).multiplyScalar(.5),Cc.copy(e).sub(t).normalize(),Dc.copy(this.origin).sub(Tc);const n=.5*t.distanceTo(e),s=-this.direction.dot(Cc),a=Dc.dot(this.direction),o=-Dc.dot(Cc),h=Dc.lengthSq(),u=Math.abs(1-s*s);let l,c,f,d;if(u>0)if(l=s*o-a,c=s*a-o,d=n*u,l>=0)if(c>=-d)if(c<=d){const t=1/u;l*=t,c*=t,f=l*(l+s*c+2*a)+c*(s*l+c+2*o)+h}else c=n,l=Math.max(0,-(s*c+a)),f=-l*l+c*(c+2*o)+h;else c=-n,l=Math.max(0,-(s*c+a)),f=-l*l+c*(c+2*o)+h;else c<=-d?(l=Math.max(0,-(-s*n+a)),c=l>0?-n:Math.min(Math.max(-n,-o),n),f=-l*l+c*(c+2*o)+h):c<=d?(l=0,c=Math.min(Math.max(-n,-o),n),f=c*(c+2*o)+h):(l=Math.max(0,-(s*n+a)),c=l>0?n:Math.min(Math.max(-n,-o),n),f=-l*l+c*(c+2*o)+h);else c=s>0?-n:n,l=Math.max(0,-(s*c+a)),f=-l*l+c*(c+2*o)+h;return r&&r.copy(this.direction).multiplyScalar(l).add(this.origin),i&&i.copy(Cc).multiplyScalar(c).add(Tc),f}intersectSphere(t,e){Ac.subVectors(t.center,this.origin);const r=Ac.dot(this.direction),i=Ac.dot(Ac)-r*r,n=t.radius*t.radius;if(i>n)return null;const s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null}intersectPlane(t,e){const r=this.distanceToPlane(t);return null===r?null:this.at(r,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let r,i,n,s,a,o;const h=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,c=this.origin;return h>=0?(r=(t.min.x-c.x)*h,i=(t.max.x-c.x)*h):(r=(t.max.x-c.x)*h,i=(t.min.x-c.x)*h),u>=0?(n=(t.min.y-c.y)*u,s=(t.max.y-c.y)*u):(n=(t.max.y-c.y)*u,s=(t.min.y-c.y)*u),r>s||n>i?null:((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),l>=0?(a=(t.min.z-c.z)*l,o=(t.max.z-c.z)*l):(a=(t.max.z-c.z)*l,o=(t.min.z-c.z)*l),r>o||a>i?null:((a>r||r!=r)&&(r=a),(o<i||i!=i)&&(i=o),i<0?null:this.at(r>=0?r:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,Ac)}intersectTriangle(t,e,r,i,n){Rc.subVectors(e,t),Ic.subVectors(r,t),Pc.crossVectors(Rc,Ic);let s,a=this.direction.dot(Pc);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Dc.subVectors(this.origin,t);const o=s*this.direction.dot(Ic.crossVectors(Dc,Ic));if(o<0)return null;const h=s*this.direction.dot(Rc.cross(Dc));if(h<0)return null;if(o+h>a)return null;const u=-s*Dc.dot(Pc);return u<0?null:this.at(u/a,n)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class kc{constructor(){kc.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,r,i,n,s,a,o,h,u,l,c,f,d,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=i,g[1]=n,g[5]=s,g[9]=a,g[13]=o,g[2]=h,g[6]=u,g[10]=l,g[14]=c,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new kc).fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,i=1/Bc.setFromMatrixColumn(t,0).length(),n=1/Bc.setFromMatrixColumn(t,1).length(),s=1/Bc.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=0,e[8]=r[8]*s,e[9]=r[9]*s,e[10]=r[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,i=t.y,n=t.z,s=Math.cos(r),a=Math.sin(r),o=Math.cos(i),h=Math.sin(i),u=Math.cos(n),l=Math.sin(n);if("XYZ"===t.order){const t=s*u,r=s*l,i=a*u,n=a*l;e[0]=o*u,e[4]=-o*l,e[8]=h,e[1]=r+i*h,e[5]=t-n*h,e[9]=-a*o,e[2]=n-t*h,e[6]=i+r*h,e[10]=s*o}else if("YXZ"===t.order){const t=o*u,r=o*l,i=h*u,n=h*l;e[0]=t+n*a,e[4]=i*a-r,e[8]=s*h,e[1]=s*l,e[5]=s*u,e[9]=-a,e[2]=r*a-i,e[6]=n+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*u,r=o*l,i=h*u,n=h*l;e[0]=t-n*a,e[4]=-s*l,e[8]=i+r*a,e[1]=r+i*a,e[5]=s*u,e[9]=n-t*a,e[2]=-s*h,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*u,r=s*l,i=a*u,n=a*l;e[0]=o*u,e[4]=i*h-r,e[8]=t*h+n,e[1]=o*l,e[5]=n*h+t,e[9]=r*h-i,e[2]=-h,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,r=s*h,i=a*o,n=a*h;e[0]=o*u,e[4]=n-t*l,e[8]=i*l+r,e[1]=l,e[5]=s*u,e[9]=-a*u,e[2]=-h*u,e[6]=r*l+i,e[10]=t-n*l}else if("XZY"===t.order){const t=s*o,r=s*h,i=a*o,n=a*h;e[0]=o*u,e[4]=-l,e[8]=h*u,e[1]=t*l+n,e[5]=s*u,e[9]=r*l-i,e[2]=i*l-r,e[6]=a*u,e[10]=n*l+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Oc,t,Fc)}lookAt(t,e,r){const i=this.elements;return Gc.subVectors(t,e),0===Gc.lengthSq()&&(Gc.z=1),Gc.normalize(),Uc.crossVectors(r,Gc),0===Uc.lengthSq()&&(1===Math.abs(r.z)?Gc.x+=1e-4:Gc.z+=1e-4,Gc.normalize(),Uc.crossVectors(r,Gc)),Uc.normalize(),zc.crossVectors(Gc,Uc),i[0]=Uc.x,i[4]=zc.x,i[8]=Gc.x,i[1]=Uc.y,i[5]=zc.y,i[9]=Gc.y,i[2]=Uc.z,i[6]=zc.z,i[10]=Gc.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,n=this.elements,s=r[0],a=r[4],o=r[8],h=r[12],u=r[1],l=r[5],c=r[9],f=r[13],d=r[2],p=r[6],m=r[10],g=r[14],v=r[3],_=r[7],b=r[11],y=r[15],x=i[0],w=i[4],E=i[8],M=i[12],S=i[1],A=i[5],T=i[9],C=i[13],D=i[2],R=i[6],I=i[10],P=i[14],N=i[3],k=i[7],B=i[11],L=i[15];return n[0]=s*x+a*S+o*D+h*N,n[4]=s*w+a*A+o*R+h*k,n[8]=s*E+a*T+o*I+h*B,n[12]=s*M+a*C+o*P+h*L,n[1]=u*x+l*S+c*D+f*N,n[5]=u*w+l*A+c*R+f*k,n[9]=u*E+l*T+c*I+f*B,n[13]=u*M+l*C+c*P+f*L,n[2]=d*x+p*S+m*D+g*N,n[6]=d*w+p*A+m*R+g*k,n[10]=d*E+p*T+m*I+g*B,n[14]=d*M+p*C+m*P+g*L,n[3]=v*x+_*S+b*D+y*N,n[7]=v*w+_*A+b*R+y*k,n[11]=v*E+_*T+b*I+y*B,n[15]=v*M+_*C+b*P+y*L,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],n=t[12],s=t[1],a=t[5],o=t[9],h=t[13],u=t[2],l=t[6],c=t[10],f=t[14];return t[3]*(+n*o*l-i*h*l-n*a*c+r*h*c+i*a*f-r*o*f)+t[7]*(+e*o*f-e*h*c+n*s*c-i*s*f+i*h*u-n*o*u)+t[11]*(+e*h*l-e*a*f-n*s*l+r*s*f+n*a*u-r*h*u)+t[15]*(-i*a*u-e*o*l+e*a*c+i*s*l-r*s*c+r*o*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],s=t[4],a=t[5],o=t[6],h=t[7],u=t[8],l=t[9],c=t[10],f=t[11],d=t[12],p=t[13],m=t[14],g=t[15],v=l*m*h-p*c*h+p*o*f-a*m*f-l*o*g+a*c*g,_=d*c*h-u*m*h-d*o*f+s*m*f+u*o*g-s*c*g,b=u*p*h-d*l*h+d*a*f-s*p*f-u*a*g+s*l*g,y=d*l*o-u*p*o-d*a*c+s*p*c+u*a*m-s*l*m,x=e*v+r*_+i*b+n*y;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return t[0]=v*w,t[1]=(p*c*n-l*m*n-p*i*f+r*m*f+l*i*g-r*c*g)*w,t[2]=(a*m*n-p*o*n+p*i*h-r*m*h-a*i*g+r*o*g)*w,t[3]=(l*o*n-a*c*n-l*i*h+r*c*h+a*i*f-r*o*f)*w,t[4]=_*w,t[5]=(u*m*n-d*c*n+d*i*f-e*m*f-u*i*g+e*c*g)*w,t[6]=(d*o*n-s*m*n-d*i*h+e*m*h+s*i*g-e*o*g)*w,t[7]=(s*c*n-u*o*n+u*i*h-e*c*h-s*i*f+e*o*f)*w,t[8]=b*w,t[9]=(d*l*n-u*p*n-d*r*f+e*p*f+u*r*g-e*l*g)*w,t[10]=(s*p*n-d*a*n+d*r*h-e*p*h-s*r*g+e*a*g)*w,t[11]=(u*a*n-s*l*n-u*r*h+e*l*h+s*r*f-e*a*f)*w,t[12]=y*w,t[13]=(u*p*i-d*l*i+d*r*c-e*p*c-u*r*m+e*l*m)*w,t[14]=(d*a*i-s*p*i-d*r*o+e*p*o+s*r*m-e*a*m)*w,t[15]=(s*l*i-u*a*i+u*r*o-e*l*o-s*r*c+e*a*c)*w,this}scale(t){const e=this.elements,r=t.x,i=t.y,n=t.z;return e[0]*=r,e[4]*=i,e[8]*=n,e[1]*=r,e[5]*=i,e[9]*=n,e[2]*=r,e[6]*=i,e[10]*=n,e[3]*=r,e[7]*=i,e[11]*=n,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),n=1-r,s=t.x,a=t.y,o=t.z,h=n*s,u=n*a;return this.set(h*s+r,h*a-i*o,h*o+i*a,0,h*a+i*o,u*a+r,u*o-i*s,0,h*o-i*a,u*o+i*s,n*o*o+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,i,n,s){return this.set(1,r,n,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,n=e._x,s=e._y,a=e._z,o=e._w,h=n+n,u=s+s,l=a+a,c=n*h,f=n*u,d=n*l,p=s*u,m=s*l,g=a*l,v=o*h,_=o*u,b=o*l,y=r.x,x=r.y,w=r.z;return i[0]=(1-(p+g))*y,i[1]=(f+b)*y,i[2]=(d-_)*y,i[3]=0,i[4]=(f-b)*x,i[5]=(1-(c+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(d+_)*w,i[9]=(m-v)*w,i[10]=(1-(c+p))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;let n=Bc.set(i[0],i[1],i[2]).length();const s=Bc.set(i[4],i[5],i[6]).length(),a=Bc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),t.x=i[12],t.y=i[13],t.z=i[14],Lc.copy(this);const o=1/n,h=1/s,u=1/a;return Lc.elements[0]*=o,Lc.elements[1]*=o,Lc.elements[2]*=o,Lc.elements[4]*=h,Lc.elements[5]*=h,Lc.elements[6]*=h,Lc.elements[8]*=u,Lc.elements[9]*=u,Lc.elements[10]*=u,e.setFromRotationMatrix(Lc),r.x=n,r.y=s,r.z=a,this}makePerspective(t,e,r,i,n,s){const a=this.elements,o=2*n/(e-t),h=2*n/(r-i),u=(e+t)/(e-t),l=(r+i)/(r-i),c=-(s+n)/(s-n),f=-2*s*n/(s-n);return a[0]=o,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=c,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,r,i,n,s){const a=this.elements,o=1/(e-t),h=1/(r-i),u=1/(s-n),l=(e+t)*o,c=(r+i)*h,f=(s+n)*u;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-c,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<16;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const Bc=new ic,Lc=new kc,Oc=new ic(0,0,0),Fc=new ic(1,1,1),Uc=new ic,zc=new ic,Gc=new ic,Hc=new kc,jc=new rc;class Vc{constructor(t=0,e=0,r=0,i=Vc.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i=this._order){return this._x=t,this._y=e,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const i=t.elements,n=i[0],s=i[4],a=i[8],o=i[1],h=i[5],u=i[9],l=i[2],c=i[6],f=i[10];switch(e){case"XYZ":this._y=Math.asin(El(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(c,h),this._z=0);break;case"YXZ":this._x=Math.asin(-El(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(o,h)):(this._y=Math.atan2(-l,n),this._z=0);break;case"ZXY":this._x=Math.asin(El(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-l,f),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-El(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(c,f),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,h));break;case"YZX":this._z=Math.asin(El(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-El(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(c,h),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return Hc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Hc,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return jc.setFromEuler(this),this.setFromQuaternion(jc,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Vc.DefaultOrder="XYZ",Vc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Wc{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let qc=0;const Xc=new ic,Yc=new rc,Zc=new kc,$c=new ic,Kc=new ic,Jc=new ic,Qc=new rc,tf=new ic(1,0,0),ef=new ic(0,1,0),rf=new ic(0,0,1),nf={type:"added"},sf={type:"removed"};class af extends _l{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qc++}),this.uuid=wl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=af.DefaultUp.clone();const t=new ic,e=new Vc,r=new rc,i=new ic(1,1,1);e._onChange((function(){r.setFromEuler(e,!1)})),r._onChange((function(){e.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new kc},normalMatrix:{value:new Il}}),this.matrix=new kc,this.matrixWorld=new kc,this.matrixAutoUpdate=af.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=af.DefaultMatrixWorldAutoUpdate,this.layers=new Wc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Yc.setFromAxisAngle(t,e),this.quaternion.multiply(Yc),this}rotateOnWorldAxis(t,e){return Yc.setFromAxisAngle(t,e),this.quaternion.premultiply(Yc),this}rotateX(t){return this.rotateOnAxis(tf,t)}rotateY(t){return this.rotateOnAxis(ef,t)}rotateZ(t){return this.rotateOnAxis(rf,t)}translateOnAxis(t,e){return Xc.copy(t).applyQuaternion(this.quaternion),this.position.add(Xc.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(tf,t)}translateY(t){return this.translateOnAxis(ef,t)}translateZ(t){return this.translateOnAxis(rf,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Zc.copy(this.matrixWorld).invert())}lookAt(t,e,r){t.isVector3?$c.copy(t):$c.set(t,e,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Kc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Zc.lookAt(Kc,$c,this.up):Zc.lookAt($c,Kc,this.up),this.quaternion.setFromRotationMatrix(Zc),i&&(Zc.extractRotation(i.matrixWorld),Yc.setFromRotationMatrix(Zc),this.quaternion.premultiply(Yc.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(nf)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(sf)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(sf)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Zc.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Zc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Zc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}}getObjectsByProperty(t,e){let r=[];this[t]===e&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectsByProperty(t,e);n.length>0&&(r=r.concat(n))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kc,t,Jc),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kc,Qc,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,i=e.length;r<i;r++){const i=e[r];!0!==i.matrixWorldAutoUpdate&&!0!==t||i.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,r=t.length;e<r;e++){const r=t[e];!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function n(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const r=e.shapes;if(Array.isArray(r))for(let e=0,i=r.length;e<i;e++){const i=r[e];n(t.shapes,i)}else n(t.shapes,r)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(n(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let r=0,i=this.material.length;r<i;r++)e.push(n(t.materials,this.material[r]));i.material=e}else i.material=n(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const r=this.animations[e];i.animations.push(n(t.animations,r))}}if(e){const e=s(t.geometries),i=s(t.materials),n=s(t.textures),a=s(t.images),o=s(t.shapes),h=s(t.skeletons),u=s(t.animations),l=s(t.nodes);e.length>0&&(r.geometries=e),i.length>0&&(r.materials=i),n.length>0&&(r.textures=n),a.length>0&&(r.images=a),o.length>0&&(r.shapes=o),h.length>0&&(r.skeletons=h),u.length>0&&(r.animations=u),l.length>0&&(r.nodes=l)}return r.object=i,r;function s(t){const e=[];for(const r in t){const i=t[r];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const r=t.children[e];this.add(r.clone())}return this}}af.DefaultUp=new ic(0,1,0),af.DefaultMatrixAutoUpdate=!0,af.DefaultMatrixWorldAutoUpdate=!0;const of=new ic,hf=new ic,uf=new ic,lf=new ic,cf=new ic,ff=new ic,df=new ic,pf=new ic,mf=new ic,gf=new ic;class vf{constructor(t=new ic,e=new ic,r=new ic){this.a=t,this.b=e,this.c=r}static getNormal(t,e,r,i){i.subVectors(r,e),of.subVectors(t,e),i.cross(of);const n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(t,e,r,i,n){of.subVectors(i,e),hf.subVectors(r,e),uf.subVectors(t,e);const s=of.dot(of),a=of.dot(hf),o=of.dot(uf),h=hf.dot(hf),u=hf.dot(uf),l=s*h-a*a;if(0===l)return n.set(-2,-1,-1);const c=1/l,f=(h*o-a*u)*c,d=(s*u-a*o)*c;return n.set(1-f-d,d,f)}static containsPoint(t,e,r,i){return this.getBarycoord(t,e,r,i,lf),lf.x>=0&&lf.y>=0&&lf.x+lf.y<=1}static getUV(t,e,r,i,n,s,a,o){return this.getBarycoord(t,e,r,i,lf),o.set(0,0),o.addScaledVector(n,lf.x),o.addScaledVector(s,lf.y),o.addScaledVector(a,lf.z),o}static isFrontFacing(t,e,r,i){return of.subVectors(r,e),hf.subVectors(t,e),of.cross(hf).dot(i)<0}set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this}setFromPointsAndIndices(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,r,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return of.subVectors(this.c,this.b),hf.subVectors(this.a,this.b),.5*of.cross(hf).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return vf.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return vf.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,r,i,n){return vf.getUV(t,this.a,this.b,this.c,e,r,i,n)}containsPoint(t){return vf.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return vf.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const r=this.a,i=this.b,n=this.c;let s,a;cf.subVectors(i,r),ff.subVectors(n,r),pf.subVectors(t,r);const o=cf.dot(pf),h=ff.dot(pf);if(o<=0&&h<=0)return e.copy(r);mf.subVectors(t,i);const u=cf.dot(mf),l=ff.dot(mf);if(u>=0&&l<=u)return e.copy(i);const c=o*l-u*h;if(c<=0&&o>=0&&u<=0)return s=o/(o-u),e.copy(r).addScaledVector(cf,s);gf.subVectors(t,n);const f=cf.dot(gf),d=ff.dot(gf);if(d>=0&&f<=d)return e.copy(n);const p=f*h-o*d;if(p<=0&&h>=0&&d<=0)return a=h/(h-d),e.copy(r).addScaledVector(ff,a);const m=u*d-f*l;if(m<=0&&l-u>=0&&f-d>=0)return df.subVectors(n,i),a=(l-u)/(l-u+(f-d)),e.copy(i).addScaledVector(df,a);const g=1/(m+p+c);return s=p*g,a=c*g,e.copy(r).addScaledVector(cf,s).addScaledVector(ff,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let _f=0;class bf extends _l{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_f++}),this.uuid=wl(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Pu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pl,this.stencilZFail=pl,this.stencilZPass=pl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const r=t[e];if(void 0===r){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[e]=r:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const r in t){const i=t[r];delete i.metadata,e.push(i)}return e}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),e){const e=i(t.textures),n=i(t.images);e.length>0&&(r.textures=e),n.length>0&&(r.images=n)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let r=null;if(null!==e){const t=e.length;r=new Array(t);for(let i=0;i!==t;++i)r[i]=e[i].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class yf extends bf{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Wl(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const xf=new ic,wf=new Rl;class Ef{constructor(t,e,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=r,this.usage=ml,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[t+i]=e.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,r=this.count;e<r;e++)wf.fromBufferAttribute(this,e),wf.applyMatrix3(t),this.setXY(e,wf.x,wf.y);else if(3===this.itemSize)for(let e=0,r=this.count;e<r;e++)xf.fromBufferAttribute(this,e),xf.applyMatrix3(t),this.setXYZ(e,xf.x,xf.y,xf.z);return this}applyMatrix4(t){for(let e=0,r=this.count;e<r;e++)xf.fromBufferAttribute(this,e),xf.applyMatrix4(t),this.setXYZ(e,xf.x,xf.y,xf.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)xf.fromBufferAttribute(this,e),xf.applyNormalMatrix(t),this.setXYZ(e,xf.x,xf.y,xf.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)xf.fromBufferAttribute(this,e),xf.transformDirection(t),this.setXYZ(e,xf.x,xf.y,xf.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Cl(e,this.array)),e}setX(t,e){return this.normalized&&(e=Dl(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Cl(e,this.array)),e}setY(t,e){return this.normalized&&(e=Dl(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Cl(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Dl(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Cl(e,this.array)),e}setW(t,e){return this.normalized&&(e=Dl(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,r){return t*=this.itemSize,this.normalized&&(e=Dl(e,this.array),r=Dl(r,this.array)),this.array[t+0]=e,this.array[t+1]=r,this}setXYZ(t,e,r,i){return t*=this.itemSize,this.normalized&&(e=Dl(e,this.array),r=Dl(r,this.array),i=Dl(i,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,e,r,i,n){return t*=this.itemSize,this.normalized&&(e=Dl(e,this.array),r=Dl(r,this.array),i=Dl(i,this.array),n=Dl(n,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=n,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==ml&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Mf extends Ef{constructor(t,e,r){super(new Uint16Array(t),e,r)}}class Sf extends Ef{constructor(t,e,r){super(new Uint32Array(t),e,r)}}class Af extends Ef{constructor(t,e,r){super(new Float32Array(t),e,r)}}let Tf=0;const Cf=new kc,Df=new af,Rf=new ic,If=new ac,Pf=new ac,Nf=new ic;class kf extends _l{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Tf++}),this.uuid=wl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Nl(t)?Sf:Mf)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const e=(new Il).getNormalMatrix(t);r.applyNormalMatrix(e),r.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Cf.makeRotationFromQuaternion(t),this.applyMatrix4(Cf),this}rotateX(t){return Cf.makeRotationX(t),this.applyMatrix4(Cf),this}rotateY(t){return Cf.makeRotationY(t),this.applyMatrix4(Cf),this}rotateZ(t){return Cf.makeRotationZ(t),this.applyMatrix4(Cf),this}translate(t,e,r){return Cf.makeTranslation(t,e,r),this.applyMatrix4(Cf),this}scale(t,e,r){return Cf.makeScale(t,e,r),this.applyMatrix4(Cf),this}lookAt(t){return Df.lookAt(t),Df.updateMatrix(),this.applyMatrix4(Df.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rf).negate(),this.translate(Rf.x,Rf.y,Rf.z),this}setFromPoints(t){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Af(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ac);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ic(-1/0,-1/0,-1/0),new ic(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];If.setFromBufferAttribute(r),this.morphTargetsRelative?(Nf.addVectors(this.boundingBox.min,If.min),this.boundingBox.expandByPoint(Nf),Nf.addVectors(this.boundingBox.max,If.max),this.boundingBox.expandByPoint(Nf)):(this.boundingBox.expandByPoint(If.min),this.boundingBox.expandByPoint(If.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sc);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ic,1/0);if(t){const r=this.boundingSphere.center;if(If.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];Pf.setFromBufferAttribute(r),this.morphTargetsRelative?(Nf.addVectors(If.min,Pf.min),If.expandByPoint(Nf),Nf.addVectors(If.max,Pf.max),If.expandByPoint(Nf)):(If.expandByPoint(Pf.min),If.expandByPoint(Pf.max))}If.getCenter(r);let i=0;for(let e=0,n=t.count;e<n;e++)Nf.fromBufferAttribute(t,e),i=Math.max(i,r.distanceToSquared(Nf));if(e)for(let n=0,s=e.length;n<s;n++){const s=e[n],a=this.morphTargetsRelative;for(let e=0,n=s.count;e<n;e++)Nf.fromBufferAttribute(s,e),a&&(Rf.fromBufferAttribute(t,e),Nf.add(Rf)),i=Math.max(i,r.distanceToSquared(Nf))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=t.array,i=e.position.array,n=e.normal.array,s=e.uv.array,a=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ef(new Float32Array(4*a),4));const o=this.getAttribute("tangent").array,h=[],u=[];for(let t=0;t<a;t++)h[t]=new ic,u[t]=new ic;const l=new ic,c=new ic,f=new ic,d=new Rl,p=new Rl,m=new Rl,g=new ic,v=new ic;function _(t,e,r){l.fromArray(i,3*t),c.fromArray(i,3*e),f.fromArray(i,3*r),d.fromArray(s,2*t),p.fromArray(s,2*e),m.fromArray(s,2*r),c.sub(l),f.sub(l),p.sub(d),m.sub(d);const n=1/(p.x*m.y-m.x*p.y);isFinite(n)&&(g.copy(c).multiplyScalar(m.y).addScaledVector(f,-p.y).multiplyScalar(n),v.copy(f).multiplyScalar(p.x).addScaledVector(c,-m.x).multiplyScalar(n),h[t].add(g),h[e].add(g),h[r].add(g),u[t].add(v),u[e].add(v),u[r].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:r.length}]);for(let t=0,e=b.length;t<e;++t){const e=b[t],i=e.start;for(let t=i,n=i+e.count;t<n;t+=3)_(r[t+0],r[t+1],r[t+2])}const y=new ic,x=new ic,w=new ic,E=new ic;function M(t){w.fromArray(n,3*t),E.copy(w);const e=h[t];y.copy(e),y.sub(w.multiplyScalar(w.dot(e))).normalize(),x.crossVectors(E,e);const r=x.dot(u[t])<0?-1:1;o[4*t]=y.x,o[4*t+1]=y.y,o[4*t+2]=y.z,o[4*t+3]=r}for(let t=0,e=b.length;t<e;++t){const e=b[t],i=e.start;for(let t=i,n=i+e.count;t<n;t+=3)M(r[t+0]),M(r[t+1]),M(r[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let r=this.getAttribute("normal");if(void 0===r)r=new Ef(new Float32Array(3*e.count),3),this.setAttribute("normal",r);else for(let t=0,e=r.count;t<e;t++)r.setXYZ(t,0,0,0);const i=new ic,n=new ic,s=new ic,a=new ic,o=new ic,h=new ic,u=new ic,l=new ic;if(t)for(let c=0,f=t.count;c<f;c+=3){const f=t.getX(c+0),d=t.getX(c+1),p=t.getX(c+2);i.fromBufferAttribute(e,f),n.fromBufferAttribute(e,d),s.fromBufferAttribute(e,p),u.subVectors(s,n),l.subVectors(i,n),u.cross(l),a.fromBufferAttribute(r,f),o.fromBufferAttribute(r,d),h.fromBufferAttribute(r,p),a.add(u),o.add(u),h.add(u),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(p,h.x,h.y,h.z)}else for(let t=0,a=e.count;t<a;t+=3)i.fromBufferAttribute(e,t+0),n.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),u.subVectors(s,n),l.subVectors(i,n),u.cross(l),r.setXYZ(t+0,u.x,u.y,u.z),r.setXYZ(t+1,u.x,u.y,u.z),r.setXYZ(t+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Nf.fromBufferAttribute(t,e),Nf.normalize(),t.setXYZ(e,Nf.x,Nf.y,Nf.z)}toNonIndexed(){function t(t,e){const r=t.array,i=t.itemSize,n=t.normalized,s=new r.constructor(e.length*i);let a=0,o=0;for(let n=0,h=e.length;n<h;n++){a=t.isInterleavedBufferAttribute?e[n]*t.data.stride+t.offset:e[n]*i;for(let t=0;t<i;t++)s[o++]=r[a++]}return new Ef(s,i,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new kf,r=this.index.array,i=this.attributes;for(const n in i){const s=t(i[n],r);e.setAttribute(n,s)}const n=this.morphAttributes;for(const i in n){const s=[],a=n[i];for(let e=0,i=a.length;e<i;e++){const i=t(a[e],r);s.push(i)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let t=0,r=s.length;t<r;t++){const r=s[t];e.addGroup(r.start,r.count,r.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const e in r){const i=r[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let n=!1;for(const e in this.morphAttributes){const r=this.morphAttributes[e],s=[];for(let e=0,i=r.length;e<i;e++){const i=r[e];s.push(i.toJSON(t.data))}s.length>0&&(i[e]=s,n=!0)}n&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;null!==r&&this.setIndex(r.clone(e));const i=t.attributes;for(const t in i){const r=i[t];this.setAttribute(t,r.clone(e))}const n=t.morphAttributes;for(const t in n){const r=[],i=n[t];for(let t=0,n=i.length;t<n;t++)r.push(i[t].clone(e));this.morphAttributes[t]=r}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let t=0,e=s.length;t<e;t++){const e=s[t];this.addGroup(e.start,e.count,e.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Bf=new kc,Lf=new Nc,Of=new Sc,Ff=new ic,Uf=new ic,zf=new ic,Gf=new ic,Hf=new ic,jf=new Rl,Vf=new Rl,Wf=new Rl,qf=new ic,Xf=new ic;class Yf extends af{constructor(t=new kf,e=new yf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=r.length;t<e;t++){const e=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;e.fromBufferAttribute(i,t);const a=this.morphTargetInfluences;if(n&&a){Hf.set(0,0,0);for(let r=0,i=n.length;r<i;r++){const i=a[r],o=n[r];0!==i&&(Gf.fromBufferAttribute(o,t),s?Hf.addScaledVector(Gf,i):Hf.addScaledVector(Gf.sub(e),i))}e.add(Hf)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){const r=this.geometry,i=this.material,n=this.matrixWorld;if(void 0===i)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),Of.copy(r.boundingSphere),Of.applyMatrix4(n),!1===t.ray.intersectsSphere(Of))return;if(Bf.copy(n).invert(),Lf.copy(t.ray).applyMatrix4(Bf),null!==r.boundingBox&&!1===Lf.intersectsBox(r.boundingBox))return;let s;const a=r.index,o=r.attributes.position,h=r.attributes.uv,u=r.attributes.uv2,l=r.groups,c=r.drawRange;if(null!==a)if(Array.isArray(i))for(let r=0,n=l.length;r<n;r++){const n=l[r],o=i[n.materialIndex];for(let r=Math.max(n.start,c.start),i=Math.min(a.count,Math.min(n.start+n.count,c.start+c.count));r<i;r+=3){const i=a.getX(r),l=a.getX(r+1),c=a.getX(r+2);s=Zf(this,o,t,Lf,h,u,i,l,c),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=n.materialIndex,e.push(s))}}else{for(let r=Math.max(0,c.start),n=Math.min(a.count,c.start+c.count);r<n;r+=3){const n=a.getX(r),o=a.getX(r+1),l=a.getX(r+2);s=Zf(this,i,t,Lf,h,u,n,o,l),s&&(s.faceIndex=Math.floor(r/3),e.push(s))}}else if(void 0!==o)if(Array.isArray(i))for(let r=0,n=l.length;r<n;r++){const n=l[r],a=i[n.materialIndex];for(let r=Math.max(n.start,c.start),i=Math.min(o.count,Math.min(n.start+n.count,c.start+c.count));r<i;r+=3){s=Zf(this,a,t,Lf,h,u,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=n.materialIndex,e.push(s))}}else{for(let r=Math.max(0,c.start),n=Math.min(o.count,c.start+c.count);r<n;r+=3){s=Zf(this,i,t,Lf,h,u,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),e.push(s))}}}}function Zf(t,e,r,i,n,s,a,o,h){t.getVertexPosition(a,Ff),t.getVertexPosition(o,Uf),t.getVertexPosition(h,zf);const u=function(t,e,r,i,n,s,a,o){let h;if(h=1===e.side?i.intersectTriangle(a,s,n,!0,o):i.intersectTriangle(n,s,a,0===e.side,o),null===h)return null;Xf.copy(o),Xf.applyMatrix4(t.matrixWorld);const u=r.ray.origin.distanceTo(Xf);return u<r.near||u>r.far?null:{distance:u,point:Xf.clone(),object:t}}(t,e,r,i,Ff,Uf,zf,qf);if(u){n&&(jf.fromBufferAttribute(n,a),Vf.fromBufferAttribute(n,o),Wf.fromBufferAttribute(n,h),u.uv=vf.getUV(qf,Ff,Uf,zf,jf,Vf,Wf,new Rl)),s&&(jf.fromBufferAttribute(s,a),Vf.fromBufferAttribute(s,o),Wf.fromBufferAttribute(s,h),u.uv2=vf.getUV(qf,Ff,Uf,zf,jf,Vf,Wf,new Rl));const t={a:a,b:o,c:h,normal:new ic,materialIndex:0};vf.getNormal(Ff,Uf,zf,t.normal),u.face=t}return u}class $f extends kf{constructor(t=1,e=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};const a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);const o=[],h=[],u=[],l=[];let c=0,f=0;function d(t,e,r,i,n,s,d,p,m,g,v){const _=s/m,b=d/g,y=s/2,x=d/2,w=p/2,E=m+1,M=g+1;let S=0,A=0;const T=new ic;for(let s=0;s<M;s++){const a=s*b-x;for(let o=0;o<E;o++){const c=o*_-y;T[t]=c*i,T[e]=a*n,T[r]=w,h.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[r]=p>0?1:-1,u.push(T.x,T.y,T.z),l.push(o/m),l.push(1-s/g),S+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const r=c+e+E*t,i=c+e+E*(t+1),n=c+(e+1)+E*(t+1),s=c+(e+1)+E*t;o.push(r,i,s),o.push(i,n,s),A+=6}a.addGroup(f,A,v),f+=A,c+=S}d("z","y","x",-1,-1,r,e,t,s,n,0),d("z","y","x",1,-1,r,e,-t,s,n,1),d("x","z","y",1,1,t,r,e,i,s,2),d("x","z","y",1,-1,t,r,-e,i,s,3),d("x","y","z",1,-1,t,e,r,i,n,4),d("x","y","z",-1,-1,t,e,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new Af(h,3)),this.setAttribute("normal",new Af(u,3)),this.setAttribute("uv",new Af(l,2))}static fromJSON(t){return new $f(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Kf(t){const e={};for(const r in t){e[r]={};for(const i in t[r]){const n=t[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[r][i]=n.clone():Array.isArray(n)?e[r][i]=n.slice():e[r][i]=n}}return e}function Jf(t){const e={};for(let r=0;r<t.length;r++){const i=Kf(t[r]);for(const t in i)e[t]=i[t]}return e}function Qf(t){return null===t.getRenderTarget()&&t.outputEncoding===cl?fl:dl}const td={clone:Kf,merge:Jf};class ed extends bf{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Kf(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let r=0;r<t.length;r++)e.push(t[r].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const i=this.uniforms[r].value;i&&i.isTexture?e.uniforms[r]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[r]={type:"m4",value:i.toArray()}:e.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const r={};for(const t in this.extensions)!0===this.extensions[t]&&(r[t]=!0);return Object.keys(r).length>0&&(e.extensions=r),e}}class rd extends af{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kc,this.projectionMatrix=new kc,this.projectionMatrixInverse=new kc}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class id extends rd{constructor(t=50,e=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*xl*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*yl*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*xl*Math.atan(Math.tan(.5*yl*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,r,i,n,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*yl*this.fov)/this.zoom,r=2*e,i=this.aspect*r,n=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;n+=s.offsetX*i/t,e-=s.offsetY*r/a,i*=s.width/t,r*=s.height/a}const a=this.filmOffset;0!==a&&(n+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,e,e-r,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const nd=-90;class sd extends af{constructor(t,e,r){super(),this.type="CubeCamera",this.renderTarget=r;const i=new id(nd,1,t,e);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const n=new id(nd,1,t,e);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);const s=new id(nd,1,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const a=new id(nd,1,t,e);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const o=new id(nd,1,t,e);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);const h=new id(nd,1,t,e);h.layers=this.layers,h.up.set(0,1,0),h.lookAt(0,0,-1),this.add(h)}update(t,e){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget,[i,n,s,a,o,h]=this.children,u=t.getRenderTarget(),l=t.toneMapping,c=t.xr.enabled;t.toneMapping=0,t.xr.enabled=!1;const f=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,n),t.setRenderTarget(r,2),t.render(e,s),t.setRenderTarget(r,3),t.render(e,a),t.setRenderTarget(r,4),t.render(e,o),r.texture.generateMipmaps=f,t.setRenderTarget(r,5),t.render(e,h),t.setRenderTarget(u),t.toneMapping=l,t.xr.enabled=c,r.texture.needsPMREMUpdate=!0}}class ad extends Kl{constructor(t,e,r,i,n,s,a,o,h,u){super(t=void 0!==t?t:[],e=void 0!==e?e:Nu,r,i,n,s,a,o,h,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class od extends Ql{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const r={width:t,height:t,depth:1},i=[r,r,r,r,r,r];this.texture=new ad(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Vu}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new $f(5,5,5),n=new ed({name:"CubemapFromEquirect",uniforms:Kf(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});n.uniforms.tEquirect.value=e;const s=new Yf(i,n),a=e.minFilter;e.minFilter===Wu&&(e.minFilter=Vu);return new sd(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,r,i){const n=t.getRenderTarget();for(let n=0;n<6;n++)t.setRenderTarget(this,n),t.clear(e,r,i);t.setRenderTarget(n)}}const hd=new ic,ud=new ic,ld=new Il;class cd{constructor(t=new ic(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,r,i){return this.normal.set(t,e,r),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,r){const i=hd.subVectors(r,e).cross(ud.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const r=t.delta(hd),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const n=-(t.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:e.copy(r).multiplyScalar(n).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return e<0&&r>0||r<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const r=e||ld.getNormalMatrix(t),i=this.coplanarPoint(hd).applyMatrix4(t),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const fd=new Sc,dd=new ic;class pd{constructor(t=new cd,e=new cd,r=new cd,i=new cd,n=new cd,s=new cd){this.planes=[t,e,r,i,n,s]}set(t,e,r,i,n,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(t){const e=this.planes;for(let r=0;r<6;r++)e[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t){const e=this.planes,r=t.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],h=r[5],u=r[6],l=r[7],c=r[8],f=r[9],d=r[10],p=r[11],m=r[12],g=r[13],v=r[14],_=r[15];return e[0].setComponents(a-i,l-o,p-c,_-m).normalize(),e[1].setComponents(a+i,l+o,p+c,_+m).normalize(),e[2].setComponents(a+n,l+h,p+f,_+g).normalize(),e[3].setComponents(a-n,l-h,p-f,_-g).normalize(),e[4].setComponents(a-s,l-u,p-d,_-v).normalize(),e[5].setComponents(a+s,l+u,p+d,_+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),fd.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(fd)}intersectsSprite(t){return fd.center.set(0,0,0),fd.radius=.7071067811865476,fd.applyMatrix4(t.matrixWorld),this.intersectsSphere(fd)}intersectsSphere(t){const e=this.planes,r=t.center,i=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(r)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let r=0;r<6;r++){const i=e[r];if(dd.x=i.normal.x>0?t.max.x:t.min.x,dd.y=i.normal.y>0?t.max.y:t.min.y,dd.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(dd)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function md(){let t=null,e=!1,r=null,i=null;function n(e,s){r(e,s),i=t.requestAnimationFrame(n)}return{start:function(){!0!==e&&null!==r&&(i=t.requestAnimationFrame(n),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){r=t},setContext:function(e){t=e}}}function gd(t,e){const r=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const r=i.get(e);r&&(t.deleteBuffer(r.buffer),i.delete(e))},update:function(e,n){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=i.get(e);void 0===s?i.set(e,function(e,i){const n=e.array,s=e.usage,a=t.createBuffer();let o;if(t.bindBuffer(i,a),t.bufferData(i,n,s),e.onUploadCallback(),n instanceof Float32Array)o=5126;else if(n instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");o=5131}else o=5123;else if(n instanceof Int16Array)o=5122;else if(n instanceof Uint32Array)o=5125;else if(n instanceof Int32Array)o=5124;else if(n instanceof Int8Array)o=5120;else if(n instanceof Uint8Array)o=5121;else{if(!(n instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+n);o=5121}return{buffer:a,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(e,n)):s.version<e.version&&(!function(e,i,n){const s=i.array,a=i.updateRange;t.bindBuffer(n,e),-1===a.count?t.bufferSubData(n,0,s):(r?t.bufferSubData(n,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):t.bufferSubData(n,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),i.onUploadCallback()}(s.buffer,e,n),s.version=e.version)}}}class vd extends kf{constructor(t=1,e=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:i};const n=t/2,s=e/2,a=Math.floor(r),o=Math.floor(i),h=a+1,u=o+1,l=t/a,c=e/o,f=[],d=[],p=[],m=[];for(let t=0;t<u;t++){const e=t*c-s;for(let r=0;r<h;r++){const i=r*l-n;d.push(i,-e,0),p.push(0,0,1),m.push(r/a),m.push(1-t/o)}}for(let t=0;t<o;t++)for(let e=0;e<a;e++){const r=e+h*t,i=e+h*(t+1),n=e+1+h*(t+1),s=e+1+h*t;f.push(r,i,s),f.push(i,n,s)}this.setIndex(f),this.setAttribute("position",new Af(d,3)),this.setAttribute("normal",new Af(p,3)),this.setAttribute("uv",new Af(m,2))}static fromJSON(t){return new vd(t.width,t.height,t.widthSegments,t.heightSegments)}}const _d={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},bd={common:{diffuse:{value:new Wl(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Il},uv2Transform:{value:new Il},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Rl(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Wl(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Wl(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Il}},sprite:{diffuse:{value:new Wl(16777215)},opacity:{value:1},center:{value:new Rl(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Il}}},yd={basic:{uniforms:Jf([bd.common,bd.specularmap,bd.envmap,bd.aomap,bd.lightmap,bd.fog]),vertexShader:_d.meshbasic_vert,fragmentShader:_d.meshbasic_frag},lambert:{uniforms:Jf([bd.common,bd.specularmap,bd.envmap,bd.aomap,bd.lightmap,bd.emissivemap,bd.bumpmap,bd.normalmap,bd.displacementmap,bd.fog,bd.lights,{emissive:{value:new Wl(0)}}]),vertexShader:_d.meshlambert_vert,fragmentShader:_d.meshlambert_frag},phong:{uniforms:Jf([bd.common,bd.specularmap,bd.envmap,bd.aomap,bd.lightmap,bd.emissivemap,bd.bumpmap,bd.normalmap,bd.displacementmap,bd.fog,bd.lights,{emissive:{value:new Wl(0)},specular:{value:new Wl(1118481)},shininess:{value:30}}]),vertexShader:_d.meshphong_vert,fragmentShader:_d.meshphong_frag},standard:{uniforms:Jf([bd.common,bd.envmap,bd.aomap,bd.lightmap,bd.emissivemap,bd.bumpmap,bd.normalmap,bd.displacementmap,bd.roughnessmap,bd.metalnessmap,bd.fog,bd.lights,{emissive:{value:new Wl(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_d.meshphysical_vert,fragmentShader:_d.meshphysical_frag},toon:{uniforms:Jf([bd.common,bd.aomap,bd.lightmap,bd.emissivemap,bd.bumpmap,bd.normalmap,bd.displacementmap,bd.gradientmap,bd.fog,bd.lights,{emissive:{value:new Wl(0)}}]),vertexShader:_d.meshtoon_vert,fragmentShader:_d.meshtoon_frag},matcap:{uniforms:Jf([bd.common,bd.bumpmap,bd.normalmap,bd.displacementmap,bd.fog,{matcap:{value:null}}]),vertexShader:_d.meshmatcap_vert,fragmentShader:_d.meshmatcap_frag},points:{uniforms:Jf([bd.points,bd.fog]),vertexShader:_d.points_vert,fragmentShader:_d.points_frag},dashed:{uniforms:Jf([bd.common,bd.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_d.linedashed_vert,fragmentShader:_d.linedashed_frag},depth:{uniforms:Jf([bd.common,bd.displacementmap]),vertexShader:_d.depth_vert,fragmentShader:_d.depth_frag},normal:{uniforms:Jf([bd.common,bd.bumpmap,bd.normalmap,bd.displacementmap,{opacity:{value:1}}]),vertexShader:_d.meshnormal_vert,fragmentShader:_d.meshnormal_frag},sprite:{uniforms:Jf([bd.sprite,bd.fog]),vertexShader:_d.sprite_vert,fragmentShader:_d.sprite_frag},background:{uniforms:{uvTransform:{value:new Il},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:_d.background_vert,fragmentShader:_d.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:_d.backgroundCube_vert,fragmentShader:_d.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_d.cube_vert,fragmentShader:_d.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_d.equirect_vert,fragmentShader:_d.equirect_frag},distanceRGBA:{uniforms:Jf([bd.common,bd.displacementmap,{referencePosition:{value:new ic},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_d.distanceRGBA_vert,fragmentShader:_d.distanceRGBA_frag},shadow:{uniforms:Jf([bd.lights,bd.fog,{color:{value:new Wl(0)},opacity:{value:1}}]),vertexShader:_d.shadow_vert,fragmentShader:_d.shadow_frag}};yd.physical={uniforms:Jf([yd.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Rl(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Wl(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Rl},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Wl(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Wl(1,1,1)},specularColorMap:{value:null}}]),vertexShader:_d.meshphysical_vert,fragmentShader:_d.meshphysical_frag};const xd={r:0,b:0,g:0};function wd(t,e,r,i,n,s,a){const o=new Wl(0);let h,u,l=!0===s?0:1,c=null,f=0,d=null;function p(e,r){e.getRGB(xd,Qf(t)),i.buffers.color.setClear(xd.r,xd.g,xd.b,r,a)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),l=e,p(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,p(o,l)},render:function(i,s){let a=!1,m=!0===s.isScene?s.background:null;if(m&&m.isTexture){m=(s.backgroundBlurriness>0?r:e).get(m)}const g=t.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?p(o,l):m&&m.isColor&&(p(m,1),a=!0),(t.autoClear||a)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.mapping===Ou)?(void 0===u&&(u=new Yf(new $f(1,1,1),new ed({name:"BackgroundCubeMaterial",uniforms:Kf(yd.backgroundCube.uniforms),vertexShader:yd.backgroundCube.vertexShader,fragmentShader:yd.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=m,u.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,u.material.toneMapped=m.encoding!==cl,c===m&&f===m.version&&d===t.toneMapping||(u.material.needsUpdate=!0,c=m,f=m.version,d=t.toneMapping),u.layers.enableAll(),i.unshift(u,u.geometry,u.material,0,0,null)):m&&m.isTexture&&(void 0===h&&(h=new Yf(new vd(2,2),new ed({name:"BackgroundMaterial",uniforms:Kf(yd.background.uniforms),vertexShader:yd.background.vertexShader,fragmentShader:yd.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(h)),h.material.uniforms.t2D.value=m,h.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,h.material.toneMapped=m.encoding!==cl,!0===m.matrixAutoUpdate&&m.updateMatrix(),h.material.uniforms.uvTransform.value.copy(m.matrix),c===m&&f===m.version&&d===t.toneMapping||(h.material.needsUpdate=!0,c=m,f=m.version,d=t.toneMapping),h.layers.enableAll(),i.unshift(h,h.geometry,h.material,0,0,null))}}}function Ed(t,e,r,i){const n=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},h=d(null);let u=h,l=!1;function c(e){return i.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function f(e){return i.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function d(t){const e=[],r=[],i=[];for(let t=0;t<n;t++)e[t]=0,r[t]=0,i[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:r,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){const t=u.newAttributes;for(let e=0,r=t.length;e<r;e++)t[e]=0}function m(t){g(t,0)}function g(r,n){const s=u.newAttributes,a=u.enabledAttributes,o=u.attributeDivisors;if(s[r]=1,0===a[r]&&(t.enableVertexAttribArray(r),a[r]=1),o[r]!==n){(i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,n),o[r]=n}}function v(){const e=u.newAttributes,r=u.enabledAttributes;for(let i=0,n=r.length;i<n;i++)r[i]!==e[i]&&(t.disableVertexAttribArray(i),r[i]=0)}function _(e,r,n,s,a,o){!0!==i.isWebGL2||5124!==n&&5125!==n?t.vertexAttribPointer(e,r,n,s,a,o):t.vertexAttribIPointer(e,r,n,a,o)}function b(){y(),l=!0,u!==h&&(u=h,c(u.object))}function y(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:function(n,h,f,b,y){let x=!1;if(a){const e=function(e,r,n){const a=!0===n.wireframe;let h=o[e.id];void 0===h&&(h={},o[e.id]=h);let u=h[r.id];void 0===u&&(u={},h[r.id]=u);let l=u[a];void 0===l&&(l=d(i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),u[a]=l);return l}(b,f,h);u!==e&&(u=e,c(u.object)),x=function(t,e,r,i){const n=u.attributes,s=e.attributes;let a=0;const o=r.getAttributes();for(const e in o){if(o[e].location>=0){const r=n[e];let i=s[e];if(void 0===i&&("instanceMatrix"===e&&t.instanceMatrix&&(i=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(i=t.instanceColor)),void 0===r)return!0;if(r.attribute!==i)return!0;if(i&&r.data!==i.data)return!0;a++}}return u.attributesNum!==a||u.index!==i}(n,b,f,y),x&&function(t,e,r,i){const n={},s=e.attributes;let a=0;const o=r.getAttributes();for(const e in o){if(o[e].location>=0){let r=s[e];void 0===r&&("instanceMatrix"===e&&t.instanceMatrix&&(r=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(r=t.instanceColor));const i={};i.attribute=r,r&&r.data&&(i.data=r.data),n[e]=i,a++}}u.attributes=n,u.attributesNum=a,u.index=i}(n,b,f,y)}else{const t=!0===h.wireframe;u.geometry===b.id&&u.program===f.id&&u.wireframe===t||(u.geometry=b.id,u.program=f.id,u.wireframe=t,x=!0)}null!==y&&r.update(y,34963),(x||l)&&(l=!1,function(n,s,a,o){if(!1===i.isWebGL2&&(n.isInstancedMesh||o.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const h=o.attributes,u=a.getAttributes(),l=s.defaultAttributeValues;for(const e in u){const i=u[e];if(i.location>=0){let s=h[e];if(void 0===s&&("instanceMatrix"===e&&n.instanceMatrix&&(s=n.instanceMatrix),"instanceColor"===e&&n.instanceColor&&(s=n.instanceColor)),void 0!==s){const e=s.normalized,a=s.itemSize,h=r.get(s);if(void 0===h)continue;const u=h.buffer,l=h.type,c=h.bytesPerElement;if(s.isInterleavedBufferAttribute){const r=s.data,h=r.stride,f=s.offset;if(r.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)g(i.location+t,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let t=0;t<i.locationSize;t++)m(i.location+t);t.bindBuffer(34962,u);for(let t=0;t<i.locationSize;t++)_(i.location+t,a/i.locationSize,l,e,h*c,(f+a/i.locationSize*t)*c)}else{if(s.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)g(i.location+t,s.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let t=0;t<i.locationSize;t++)m(i.location+t);t.bindBuffer(34962,u);for(let t=0;t<i.locationSize;t++)_(i.location+t,a/i.locationSize,l,e,a*c,a/i.locationSize*t*c)}}else if(void 0!==l){const r=l[e];if(void 0!==r)switch(r.length){case 2:t.vertexAttrib2fv(i.location,r);break;case 3:t.vertexAttrib3fv(i.location,r);break;case 4:t.vertexAttrib4fv(i.location,r);break;default:t.vertexAttrib1fv(i.location,r)}}}}v()}(n,h,f,b),null!==y&&t.bindBuffer(34963,r.get(y).buffer))},reset:b,resetDefaultState:y,dispose:function(){b();for(const t in o){const e=o[t];for(const t in e){const r=e[t];for(const t in r)f(r[t].object),delete r[t];delete e[t]}delete o[t]}},releaseStatesOfGeometry:function(t){if(void 0===o[t.id])return;const e=o[t.id];for(const t in e){const r=e[t];for(const t in r)f(r[t].object),delete r[t];delete e[t]}delete o[t.id]},releaseStatesOfProgram:function(t){for(const e in o){const r=o[e];if(void 0===r[t.id])continue;const i=r[t.id];for(const t in i)f(i[t].object),delete i[t];delete r[t.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:v}}function Md(t,e,r,i){const n=i.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,i){t.drawArrays(s,e,i),r.update(i,s,1)},this.renderInstances=function(i,a,o){if(0===o)return;let h,u;if(n)h=t,u="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](s,i,a,o),r.update(a,s,o)}}function Sd(t,e,r){let i;function n(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==r.precision?r.precision:"highp";const o=n(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const h=s||e.has("WEBGL_draw_buffers"),u=!0===r.logarithmicDepthBuffer,l=t.getParameter(34930),c=t.getParameter(35660),f=t.getParameter(3379),d=t.getParameter(34076),p=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),v=t.getParameter(36349),_=c>0,b=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:h,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const r=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:n,precision:a,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:f,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:_&&b,maxSamples:s?t.getParameter(36183):0}}function Ad(t){const e=this;let r=null,i=0,n=!1,s=!1;const a=new cd,o=new Il,h={value:null,needsUpdate:!1};function u(){h.value!==r&&(h.value=r,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function l(t,r,i,n){const s=null!==t?t.length:0;let u=null;if(0!==s){if(u=h.value,!0!==n||null===u){const e=i+4*s,n=r.matrixWorldInverse;o.getNormalMatrix(n),(null===u||u.length<e)&&(u=new Float32Array(e));for(let e=0,r=i;e!==s;++e,r+=4)a.copy(t[e]).applyMatrix4(n,o),a.normal.toArray(u,r),u[r+3]=a.constant}h.value=u,h.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,u}this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const a=0!==t.length||e||0!==i||n;return n=e,r=l(t,s,0),i=t.length,a},this.beginShadows=function(){s=!0,l(null)},this.endShadows=function(){s=!1,u()},this.setState=function(e,a,o){const c=e.clippingPlanes,f=e.clipIntersection,d=e.clipShadows,p=t.get(e);if(!n||null===c||0===c.length||s&&!d)s?l(null):u();else{const t=s?0:i,e=4*t;let n=p.clippingState||null;h.value=n,n=l(c,a,e,o);for(let t=0;t!==e;++t)n[t]=r[t];p.clippingState=n,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=t}}}function Td(t){let e=new WeakMap;function r(t,e){return e===Bu?t.mapping=Nu:e===Lu&&(t.mapping=ku),t}function i(t){const r=t.target;r.removeEventListener("dispose",i);const n=e.get(r);void 0!==n&&(e.delete(r),n.dispose())}return{get:function(n){if(n&&n.isTexture&&!1===n.isRenderTargetTexture){const s=n.mapping;if(s===Bu||s===Lu){if(e.has(n)){return r(e.get(n).texture,n.mapping)}{const s=n.image;if(s&&s.height>0){const a=new od(s.height/2);return a.fromEquirectangularTexture(t,n),e.set(n,a),n.addEventListener("dispose",i),r(a.texture,n.mapping)}return null}}}return n},dispose:function(){e=new WeakMap}}}class Cd extends rd{constructor(t=-1,e=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,r,i,n,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let n=r-t,s=r+t,a=i+e,o=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=t*this.view.offsetX,s=n+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const Dd=[.125,.215,.35,.446,.526,.582],Rd=20,Id=new Cd,Pd=new Wl;let Nd=null;const kd=(1+Math.sqrt(5))/2,Bd=1/kd,Ld=[new ic(1,1,1),new ic(-1,1,1),new ic(1,1,-1),new ic(-1,1,-1),new ic(0,kd,Bd),new ic(0,kd,-Bd),new ic(Bd,0,kd),new ic(-Bd,0,kd),new ic(kd,Bd,0),new ic(-kd,Bd,0)];class Od{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,r=.1,i=100){Nd=this._renderer.getRenderTarget(),this._setSize(256);const n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(t,r,i,n),e>0&&this._blur(n,0,0,e),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Gd(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=zd(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Nd),t.scissorTest=!1,Ud(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Nu||t.mapping===ku?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Nd=this._renderer.getRenderTarget();const r=e||this._allocateTargets();return this._textureToCubeUV(t,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,r={magFilter:Vu,minFilter:Vu,generateMipmaps:!1,type:Zu,format:Ku,encoding:ll,depthBuffer:!1},i=Fd(t,e,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Fd(t,e,r);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],r=[],i=[];let n=t;const s=t-4+1+Dd.length;for(let a=0;a<s;a++){const s=Math.pow(2,n);r.push(s);let o=1/s;a>t-4?o=Dd[a-t+4-1]:0===a&&(o=0),i.push(o);const h=1/(s-2),u=-h,l=1+h,c=[u,u,l,u,l,l,u,u,l,l,u,l],f=6,d=6,p=3,m=2,g=1,v=new Float32Array(p*d*f),_=new Float32Array(m*d*f),b=new Float32Array(g*d*f);for(let t=0;t<f;t++){const e=t%3*2/3-1,r=t>2?0:-1,i=[e,r,0,e+2/3,r,0,e+2/3,r+1,0,e,r,0,e+2/3,r+1,0,e,r+1,0];v.set(i,p*d*t),_.set(c,m*d*t);const n=[t,t,t,t,t,t];b.set(n,g*d*t)}const y=new kf;y.setAttribute("position",new Ef(v,p)),y.setAttribute("uv",new Ef(_,m)),y.setAttribute("faceIndex",new Ef(b,g)),e.push(y),n>4&&n--}return{lodPlanes:e,sizeLods:r,sigmas:i}}(i)),this._blurMaterial=function(t,e,r){const i=new Float32Array(Rd),n=new ic(0,1,0),s=new ed({name:"SphericalGaussianBlur",defines:{n:Rd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Hd(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,t,e)}return i}_compileMaterial(t){const e=new Yf(this._lodPlanes[0],t);this._renderer.compile(e,Id)}_sceneToCubeUV(t,e,r,i){const n=new id(90,1,e,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,h=o.autoClear,u=o.toneMapping;o.getClearColor(Pd),o.toneMapping=0,o.autoClear=!1;const l=new yf({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),c=new Yf(new $f,l);let f=!1;const d=t.background;d?d.isColor&&(l.color.copy(d),t.background=null,f=!0):(l.color.copy(Pd),f=!0);for(let e=0;e<6;e++){const r=e%3;0===r?(n.up.set(0,s[e],0),n.lookAt(a[e],0,0)):1===r?(n.up.set(0,0,s[e]),n.lookAt(0,a[e],0)):(n.up.set(0,s[e],0),n.lookAt(0,0,a[e]));const h=this._cubeSize;Ud(i,r*h,e>2?h:0,h,h),o.setRenderTarget(i),f&&o.render(c,n),o.render(t,n)}c.geometry.dispose(),c.material.dispose(),o.toneMapping=u,o.autoClear=h,t.background=d}_textureToCubeUV(t,e){const r=this._renderer,i=t.mapping===Nu||t.mapping===ku;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=Gd()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=zd());const n=i?this._cubemapMaterial:this._equirectMaterial,s=new Yf(this._lodPlanes[0],n);n.uniforms.envMap.value=t;const a=this._cubeSize;Ud(e,0,0,3*a,2*a),r.setRenderTarget(e),r.render(s,Id)}_applyPMREM(t){const e=this._renderer,r=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const r=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),i=Ld[(e-1)%Ld.length];this._blur(t,e-1,e,r,i)}e.autoClear=r}_blur(t,e,r,i,n){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,r,i,"latitudinal",n),this._halfBlur(s,t,r,r,i,"longitudinal",n)}_halfBlur(t,e,r,i,n,s,a){const o=this._renderer,h=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new Yf(this._lodPlanes[i],h),l=h.uniforms,c=this._sizeLods[r]-1,f=isFinite(n)?Math.PI/(2*c):2*Math.PI/39,d=n/f,p=isFinite(n)?1+Math.floor(3*d):Rd;p>Rd&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let t=0;t<Rd;++t){const e=t/d,r=Math.exp(-e*e/2);m.push(r),0===t?g+=r:t<p&&(g+=2*r)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;l.envMap.value=t.texture,l.samples.value=p,l.weights.value=m,l.latitudinal.value="latitudinal"===s,a&&(l.poleAxis.value=a);const{_lodMax:v}=this;l.dTheta.value=f,l.mipInt.value=v-r;const _=this._sizeLods[i];Ud(e,3*_*(i>v-4?i-v+4:0),4*(this._cubeSize-_),3*_,2*_),o.setRenderTarget(e),o.render(u,Id)}}function Fd(t,e,r){const i=new Ql(t,e,r);return i.texture.mapping=Ou,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Ud(t,e,r,i,n){t.viewport.set(e,r,i,n),t.scissor.set(e,r,i,n)}function zd(){return new ed({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Hd(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Gd(){return new ed({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Hd(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Hd(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function jd(t){let e=new WeakMap,r=null;function i(t){const r=t.target;r.removeEventListener("dispose",i);const n=e.get(r);void 0!==n&&(e.delete(r),n.dispose())}return{get:function(n){if(n&&n.isTexture){const s=n.mapping,a=s===Bu||s===Lu,o=s===Nu||s===ku;if(a||o){if(n.isRenderTargetTexture&&!0===n.needsPMREMUpdate){n.needsPMREMUpdate=!1;let i=e.get(n);return null===r&&(r=new Od(t)),i=a?r.fromEquirectangular(n,i):r.fromCubemap(n,i),e.set(n,i),i.texture}if(e.has(n))return e.get(n).texture;{const s=n.image;if(a&&s&&s.height>0||o&&s&&function(t){let e=0;const r=6;for(let i=0;i<r;i++)void 0!==t[i]&&e++;return e===r}(s)){null===r&&(r=new Od(t));const s=a?r.fromEquirectangular(n):r.fromCubemap(n);return e.set(n,s),n.addEventListener("dispose",i),s.texture}return null}}}return n},dispose:function(){e=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function Vd(t){const e={};function r(r){if(void 0!==e[r])return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(t){return null!==r(t)},init:function(t){t.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(t){const e=r(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function Wd(t,e,r,i){const n={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const t in o.attributes)e.remove(o.attributes[t]);o.removeEventListener("dispose",a),delete n[o.id];const h=s.get(o);h&&(e.remove(h),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,r.memory.geometries--}function o(t){const r=[],i=t.index,n=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],n=t[e+1],s=t[e+2];r.push(i,n,n,s,s,i)}}else{const t=n.array;a=n.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,n=e+2;r.push(t,i,i,n,n,t)}}const o=new(Nl(r)?Sf:Mf)(r,1);o.version=a;const h=s.get(t);h&&e.remove(h),s.set(t,o)}return{get:function(t,e){return!0===n[e.id]||(e.addEventListener("dispose",a),n[e.id]=!0,r.memory.geometries++),e},update:function(t){const r=t.attributes;for(const t in r)e.update(r[t],34962);const i=t.morphAttributes;for(const t in i){const r=i[t];for(let t=0,i=r.length;t<i;t++)e.update(r[t],34962)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const r=t.index;null!==r&&e.version<r.version&&o(t)}else o(t);return s.get(t)}}}function qd(t,e,r,i){const n=i.isWebGL2;let s,a,o;this.setMode=function(t){s=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,i){t.drawElements(s,i,a,e*o),r.update(i,s,1)},this.renderInstances=function(i,h,u){if(0===u)return;let l,c;if(n)l=t,c="drawElementsInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawElementsInstancedANGLE",null===l)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,h,a,i*o,u),r.update(h,s,u)}}function Xd(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,r,i){switch(e.calls++,r){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function Yd(t,e){return t[0]-e[0]}function Zd(t,e){return Math.abs(e[1])-Math.abs(t[1])}function $d(t,e,r){const i={},n=new Float32Array(8),s=new WeakMap,a=new Jl,o=[];for(let t=0;t<8;t++)o[t]=[t,0];return{update:function(h,u,l,c){const f=h.morphTargetInfluences;if(!0===e.isWebGL2){const i=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,n=void 0!==i?i.length:0;let o=s.get(u);if(void 0===o||o.count!==n){void 0!==o&&o.texture.dispose();const t=void 0!==u.morphAttributes.position,r=void 0!==u.morphAttributes.normal,i=void 0!==u.morphAttributes.color,h=u.morphAttributes.position||[],l=u.morphAttributes.normal||[],c=u.morphAttributes.color||[];let f=0;!0===t&&(f=1),!0===r&&(f=2),!0===i&&(f=3);let d=u.attributes.position.count*f,p=1;d>e.maxTextureSize&&(p=Math.ceil(d/e.maxTextureSize),d=e.maxTextureSize);const m=new Float32Array(d*p*4*n),g=new tc(m,d,p,n);g.type=Yu,g.needsUpdate=!0;const v=4*f;for(let e=0;e<n;e++){const n=h[e],s=l[e],o=c[e],u=d*p*4*e;for(let e=0;e<n.count;e++){const h=e*v;!0===t&&(a.fromBufferAttribute(n,e),m[u+h+0]=a.x,m[u+h+1]=a.y,m[u+h+2]=a.z,m[u+h+3]=0),!0===r&&(a.fromBufferAttribute(s,e),m[u+h+4]=a.x,m[u+h+5]=a.y,m[u+h+6]=a.z,m[u+h+7]=0),!0===i&&(a.fromBufferAttribute(o,e),m[u+h+8]=a.x,m[u+h+9]=a.y,m[u+h+10]=a.z,m[u+h+11]=4===o.itemSize?a.w:1)}}o={count:n,texture:g,size:new Rl(d,p)},s.set(u,o),u.addEventListener("dispose",(function t(){g.dispose(),s.delete(u),u.removeEventListener("dispose",t)}))}let h=0;for(let t=0;t<f.length;t++)h+=f[t];const l=u.morphTargetsRelative?1:1-h;c.getUniforms().setValue(t,"morphTargetBaseInfluence",l),c.getUniforms().setValue(t,"morphTargetInfluences",f),c.getUniforms().setValue(t,"morphTargetsTexture",o.texture,r),c.getUniforms().setValue(t,"morphTargetsTextureSize",o.size)}else{const e=void 0===f?0:f.length;let r=i[u.id];if(void 0===r||r.length!==e){r=[];for(let t=0;t<e;t++)r[t]=[t,0];i[u.id]=r}for(let t=0;t<e;t++){const e=r[t];e[0]=t,e[1]=f[t]}r.sort(Zd);for(let t=0;t<8;t++)t<e&&r[t][1]?(o[t][0]=r[t][0],o[t][1]=r[t][1]):(o[t][0]=Number.MAX_SAFE_INTEGER,o[t][1]=0);o.sort(Yd);const s=u.morphAttributes.position,a=u.morphAttributes.normal;let h=0;for(let t=0;t<8;t++){const e=o[t],r=e[0],i=e[1];r!==Number.MAX_SAFE_INTEGER&&i?(s&&u.getAttribute("morphTarget"+t)!==s[r]&&u.setAttribute("morphTarget"+t,s[r]),a&&u.getAttribute("morphNormal"+t)!==a[r]&&u.setAttribute("morphNormal"+t,a[r]),n[t]=i,h+=i):(s&&!0===u.hasAttribute("morphTarget"+t)&&u.deleteAttribute("morphTarget"+t),a&&!0===u.hasAttribute("morphNormal"+t)&&u.deleteAttribute("morphNormal"+t),n[t]=0)}const l=u.morphTargetsRelative?1:1-h;c.getUniforms().setValue(t,"morphTargetBaseInfluence",l),c.getUniforms().setValue(t,"morphTargetInfluences",n)}}}}function Kd(t,e,r,i){let n=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),r.remove(e.instanceMatrix),null!==e.instanceColor&&r.remove(e.instanceColor)}return{update:function(t){const a=i.render.frame,o=t.geometry,h=e.get(t,o);return n.get(h)!==a&&(e.update(h),n.set(h,a)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),r.update(t.instanceMatrix,34962),null!==t.instanceColor&&r.update(t.instanceColor,34962)),h},dispose:function(){n=new WeakMap}}}const Jd=new Kl,Qd=new tc,tp=new ec,ep=new ad,rp=[],ip=[],np=new Float32Array(16),sp=new Float32Array(9),ap=new Float32Array(4);function op(t,e,r){const i=t[0];if(i<=0||i>0)return t;const n=e*r;let s=rp[n];if(void 0===s&&(s=new Float32Array(n),rp[n]=s),0!==e){i.toArray(s,0);for(let i=1,n=0;i!==e;++i)n+=r,t[i].toArray(s,n)}return s}function hp(t,e){if(t.length!==e.length)return!1;for(let r=0,i=t.length;r<i;r++)if(t[r]!==e[r])return!1;return!0}function up(t,e){for(let r=0,i=e.length;r<i;r++)t[r]=e[r]}function lp(t,e){let r=ip[e];void 0===r&&(r=new Int32Array(e),ip[e]=r);for(let i=0;i!==e;++i)r[i]=t.allocateTextureUnit();return r}function cp(t,e){const r=this.cache;r[0]!==e&&(t.uniform1f(this.addr,e),r[0]=e)}function fp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(hp(r,e))return;t.uniform2fv(this.addr,e),up(r,e)}}function dp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else if(void 0!==e.r)r[0]===e.r&&r[1]===e.g&&r[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),r[0]=e.r,r[1]=e.g,r[2]=e.b);else{if(hp(r,e))return;t.uniform3fv(this.addr,e),up(r,e)}}function pp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(hp(r,e))return;t.uniform4fv(this.addr,e),up(r,e)}}function mp(t,e){const r=this.cache,i=e.elements;if(void 0===i){if(hp(r,e))return;t.uniformMatrix2fv(this.addr,!1,e),up(r,e)}else{if(hp(r,i))return;ap.set(i),t.uniformMatrix2fv(this.addr,!1,ap),up(r,i)}}function gp(t,e){const r=this.cache,i=e.elements;if(void 0===i){if(hp(r,e))return;t.uniformMatrix3fv(this.addr,!1,e),up(r,e)}else{if(hp(r,i))return;sp.set(i),t.uniformMatrix3fv(this.addr,!1,sp),up(r,i)}}function vp(t,e){const r=this.cache,i=e.elements;if(void 0===i){if(hp(r,e))return;t.uniformMatrix4fv(this.addr,!1,e),up(r,e)}else{if(hp(r,i))return;np.set(i),t.uniformMatrix4fv(this.addr,!1,np),up(r,i)}}function _p(t,e){const r=this.cache;r[0]!==e&&(t.uniform1i(this.addr,e),r[0]=e)}function bp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(hp(r,e))return;t.uniform2iv(this.addr,e),up(r,e)}}function yp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(hp(r,e))return;t.uniform3iv(this.addr,e),up(r,e)}}function xp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(hp(r,e))return;t.uniform4iv(this.addr,e),up(r,e)}}function wp(t,e){const r=this.cache;r[0]!==e&&(t.uniform1ui(this.addr,e),r[0]=e)}function Ep(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),r[0]=e.x,r[1]=e.y);else{if(hp(r,e))return;t.uniform2uiv(this.addr,e),up(r,e)}}function Mp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),r[0]=e.x,r[1]=e.y,r[2]=e.z);else{if(hp(r,e))return;t.uniform3uiv(this.addr,e),up(r,e)}}function Sp(t,e){const r=this.cache;if(void 0!==e.x)r[0]===e.x&&r[1]===e.y&&r[2]===e.z&&r[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),r[0]=e.x,r[1]=e.y,r[2]=e.z,r[3]=e.w);else{if(hp(r,e))return;t.uniform4uiv(this.addr,e),up(r,e)}}function Ap(t,e,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(e||Jd,n)}function Tp(t,e,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(e||tp,n)}function Cp(t,e,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(e||ep,n)}function Dp(t,e,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(t.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(e||Qd,n)}function Rp(t,e){t.uniform1fv(this.addr,e)}function Ip(t,e){const r=op(e,this.size,2);t.uniform2fv(this.addr,r)}function Pp(t,e){const r=op(e,this.size,3);t.uniform3fv(this.addr,r)}function Np(t,e){const r=op(e,this.size,4);t.uniform4fv(this.addr,r)}function kp(t,e){const r=op(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,r)}function Bp(t,e){const r=op(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,r)}function Lp(t,e){const r=op(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,r)}function Op(t,e){t.uniform1iv(this.addr,e)}function Fp(t,e){t.uniform2iv(this.addr,e)}function Up(t,e){t.uniform3iv(this.addr,e)}function zp(t,e){t.uniform4iv(this.addr,e)}function Gp(t,e){t.uniform1uiv(this.addr,e)}function Hp(t,e){t.uniform2uiv(this.addr,e)}function jp(t,e){t.uniform3uiv(this.addr,e)}function Vp(t,e){t.uniform4uiv(this.addr,e)}function Wp(t,e,r){const i=this.cache,n=e.length,s=lp(r,n);hp(i,s)||(t.uniform1iv(this.addr,s),up(i,s));for(let t=0;t!==n;++t)r.setTexture2D(e[t]||Jd,s[t])}function qp(t,e,r){const i=this.cache,n=e.length,s=lp(r,n);hp(i,s)||(t.uniform1iv(this.addr,s),up(i,s));for(let t=0;t!==n;++t)r.setTexture3D(e[t]||tp,s[t])}function Xp(t,e,r){const i=this.cache,n=e.length,s=lp(r,n);hp(i,s)||(t.uniform1iv(this.addr,s),up(i,s));for(let t=0;t!==n;++t)r.setTextureCube(e[t]||ep,s[t])}function Yp(t,e,r){const i=this.cache,n=e.length,s=lp(r,n);hp(i,s)||(t.uniform1iv(this.addr,s),up(i,s));for(let t=0;t!==n;++t)r.setTexture2DArray(e[t]||Qd,s[t])}class Zp{constructor(t,e,r){this.id=t,this.addr=r,this.cache=[],this.setValue=function(t){switch(t){case 5126:return cp;case 35664:return fp;case 35665:return dp;case 35666:return pp;case 35674:return mp;case 35675:return gp;case 35676:return vp;case 5124:case 35670:return _p;case 35667:case 35671:return bp;case 35668:case 35672:return yp;case 35669:case 35673:return xp;case 5125:return wp;case 36294:return Ep;case 36295:return Mp;case 36296:return Sp;case 35678:case 36198:case 36298:case 36306:case 35682:return Ap;case 35679:case 36299:case 36307:return Tp;case 35680:case 36300:case 36308:case 36293:return Cp;case 36289:case 36303:case 36311:case 36292:return Dp}}(e.type)}}class $p{constructor(t,e,r){this.id=t,this.addr=r,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Rp;case 35664:return Ip;case 35665:return Pp;case 35666:return Np;case 35674:return kp;case 35675:return Bp;case 35676:return Lp;case 5124:case 35670:return Op;case 35667:case 35671:return Fp;case 35668:case 35672:return Up;case 35669:case 35673:return zp;case 5125:return Gp;case 36294:return Hp;case 36295:return jp;case 36296:return Vp;case 35678:case 36198:case 36298:case 36306:case 35682:return Wp;case 35679:case 36299:case 36307:return qp;case 35680:case 36300:case 36308:case 36293:return Xp;case 36289:case 36303:case 36311:case 36292:return Yp}}(e.type)}}class Kp{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,r){const i=this.seq;for(let n=0,s=i.length;n!==s;++n){const s=i[n];s.setValue(t,e[s.id],r)}}}const Jp=/(\w+)(\])?(\[|\.)?/g;function Qp(t,e){t.seq.push(e),t.map[e.id]=e}function tm(t,e,r){const i=t.name,n=i.length;for(Jp.lastIndex=0;;){const s=Jp.exec(i),a=Jp.lastIndex;let o=s[1];const h="]"===s[2],u=s[3];if(h&&(o|=0),void 0===u||"["===u&&a+2===n){Qp(r,void 0===u?new Zp(o,t,e):new $p(o,t,e));break}{let t=r.map[o];void 0===t&&(t=new Kp(o),Qp(r,t)),r=t}}}class em{constructor(t,e){this.seq=[],this.map={};const r=t.getProgramParameter(e,35718);for(let i=0;i<r;++i){const r=t.getActiveUniform(e,i);tm(r,t.getUniformLocation(e,r.name),this)}}setValue(t,e,r,i){const n=this.map[e];void 0!==n&&n.setValue(t,r,i)}setOptional(t,e,r){const i=e[r];void 0!==i&&this.setValue(t,r,i)}static upload(t,e,r,i){for(let n=0,s=e.length;n!==s;++n){const s=e[n],a=r[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,i)}}static seqWithValue(t,e){const r=[];for(let i=0,n=t.length;i!==n;++i){const n=t[i];n.id in e&&r.push(n)}return r}}function rm(t,e,r){const i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),i}let im=0;function nm(t,e,r){const i=t.getShaderParameter(e,35713),n=t.getShaderInfoLog(e).trim();if(i&&""===n)return"";const s=/ERROR: 0:(\d+)/.exec(n);if(s){const i=parseInt(s[1]);return r.toUpperCase()+"\n\n"+n+"\n\n"+function(t,e){const r=t.split("\n"),i=[],n=Math.max(e-6,0),s=Math.min(e+6,r.length);for(let t=n;t<s;t++){const n=t+1;i.push(`${n===e?">":" "} ${n}: ${r[t]}`)}return i.join("\n")}(t.getShaderSource(e),i)}return n}function sm(t,e){const r=function(t){switch(t){case ll:return["Linear","( value )"];case cl:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function am(t,e){let r;switch(e){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="OptimizedCineon";break;case 4:r="ACESFilmic";break;case 5:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),r="Linear"}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function om(t){return""!==t}function hm(t,e){const r=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function um(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const lm=/^[ \t]*#include +<([\w\d./]+)>/gm;function cm(t){return t.replace(lm,fm)}function fm(t,e){const r=_d[e];if(void 0===r)throw new Error("Can not resolve #include <"+e+">");return cm(r)}const dm=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pm(t){return t.replace(dm,mm)}function mm(t,e,r,i){let n="";for(let t=parseInt(e);t<parseInt(r);t++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return n}function gm(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function vm(t,e,r,i){const n=t.getContext(),s=r.defines;let a=r.vertexShader,o=r.fragmentShader;const h=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(r),u=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Nu:case ku:e="ENVMAP_TYPE_CUBE";break;case Ou:e="ENVMAP_TYPE_CUBE_UV"}return e}(r),l=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===ku&&(e="ENVMAP_MODE_REFRACTION");return e}(r),c=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(r),f=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const r=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:i,maxMip:r}}(r),d=r.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(om).join("\n")}(r),p=function(t){const e=[];for(const r in t){const i=t[r];!1!==i&&e.push("#define "+r+" "+i)}return e.join("\n")}(s),m=n.createProgram();let g,v,_=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(g=[p].filter(om).join("\n"),g.length>0&&(g+="\n"),v=[d,p].filter(om).join("\n"),v.length>0&&(v+="\n")):(g=[gm(r),"#define SHADER_NAME "+r.shaderName,p,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+l:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(om).join("\n"),v=[d,gm(r),"#define SHADER_NAME "+r.shaderName,p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+l:"",r.envMap?"#define "+c:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==r.toneMapping?"#define TONE_MAPPING":"",0!==r.toneMapping?_d.tonemapping_pars_fragment:"",0!==r.toneMapping?am("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",_d.encodings_pars_fragment,sm("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(om).join("\n")),a=cm(a),a=hm(a,r),a=um(a,r),o=cm(o),o=hm(o,r),o=um(o,r),a=pm(a),o=pm(o),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(_="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",r.glslVersion===gl?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===gl?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const b=_+v+o,y=rm(n,35633,_+g+a),x=rm(n,35632,b);if(n.attachShader(m,y),n.attachShader(m,x),void 0!==r.index0AttributeName?n.bindAttribLocation(m,0,r.index0AttributeName):!0===r.morphTargets&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),t.debug.checkShaderErrors){const t=n.getProgramInfoLog(m).trim(),e=n.getShaderInfoLog(y).trim(),r=n.getShaderInfoLog(x).trim();let i=!0,s=!0;if(!1===n.getProgramParameter(m,35714)){i=!1;const e=nm(n,y,"vertex"),r=nm(n,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+r)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==r||(s=!1);s&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:r,prefix:v}})}let w,E;return n.deleteShader(y),n.deleteShader(x),this.getUniforms=function(){return void 0===w&&(w=new em(n,m)),w},this.getAttributes=function(){return void 0===E&&(E=function(t,e){const r={},i=t.getProgramParameter(e,35721);for(let n=0;n<i;n++){const i=t.getActiveAttrib(e,n),s=i.name;let a=1;35674===i.type&&(a=2),35675===i.type&&(a=3),35676===i.type&&(a=4),r[s]={type:i.type,location:t.getAttribLocation(e,s),locationSize:a}}return r}(n,m)),E},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=im++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=y,this.fragmentShader=x,this}let _m=0;class bm{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,r=t.fragmentShader,i=this._getShaderStage(e),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(n)&&(s.add(n),n.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let r=e.get(t);return void 0===r&&(r=new Set,e.set(t,r)),r}_getShaderStage(t){const e=this.shaderCache;let r=e.get(t);return void 0===r&&(r=new ym(t),e.set(t,r)),r}}class ym{constructor(t){this.id=_m++,this.code=t,this.usedTimes=0}}function xm(t,e,r,i,n,s,a){const o=new Wc,h=new bm,u=[],l=n.isWebGL2,c=n.logarithmicDepthBuffer,f=n.vertexTextures;let d=n.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,o,u,m,g){const v=m.fog,_=g.geometry,b=s.isMeshStandardMaterial?m.environment:null,y=(s.isMeshStandardMaterial?r:e).get(s.envMap||b),x=y&&y.mapping===Ou?y.image.height:null,w=p[s.type];null!==s.precision&&(d=n.getMaxPrecision(s.precision),d!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",d,"instead."));const E=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,M=void 0!==E?E.length:0;let S,A,T,C,D=0;if(void 0!==_.morphAttributes.position&&(D=1),void 0!==_.morphAttributes.normal&&(D=2),void 0!==_.morphAttributes.color&&(D=3),w){const t=yd[w];S=t.vertexShader,A=t.fragmentShader}else S=s.vertexShader,A=s.fragmentShader,h.update(s),T=h.getVertexShaderID(s),C=h.getFragmentShaderID(s);const R=t.getRenderTarget(),I=s.alphaTest>0,P=s.clearcoat>0,N=s.iridescence>0;return{isWebGL2:l,shaderID:w,shaderName:s.type,vertexShader:S,fragmentShader:A,defines:s.defines,customVertexShaderID:T,customFragmentShaderID:C,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:d,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:f,outputEncoding:null===R?t.outputEncoding:!0===R.isXRRenderTarget?R.texture.encoding:ll,map:!!s.map,matcap:!!s.matcap,envMap:!!y,envMapMode:y&&y.mapping,envMapCubeUVHeight:x,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:1===s.normalMapType,tangentSpaceNormalMap:0===s.normalMapType,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===cl,clearcoat:P,clearcoatMap:P&&!!s.clearcoatMap,clearcoatRoughnessMap:P&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:P&&!!s.clearcoatNormalMap,iridescence:N,iridescenceMap:N&&!!s.iridescenceMap,iridescenceThicknessMap:N&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&1===s.blending,alphaMap:!!s.alphaMap,alphaTest:I,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!_.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,vertexUvs:!!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatMap||s.clearcoatRoughnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.displacementMap||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheenColorMap||s.sheenRoughnessMap),uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap||!s.displacementMap),fog:!!v,useFog:!0===s.fog,fogExp2:v&&v.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:c,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:M,morphTextureStride:D,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:s.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||i.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(e){const r=[];if(e.shaderID?r.push(e.shaderID):(r.push(e.customVertexShaderID),r.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)r.push(t),r.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(r,e),function(t,e){o.disableAll(),e.isWebGL2&&o.enable(0);e.supportsVertexTextures&&o.enable(1);e.instancing&&o.enable(2);e.instancingColor&&o.enable(3);e.map&&o.enable(4);e.matcap&&o.enable(5);e.envMap&&o.enable(6);e.lightMap&&o.enable(7);e.aoMap&&o.enable(8);e.emissiveMap&&o.enable(9);e.bumpMap&&o.enable(10);e.normalMap&&o.enable(11);e.objectSpaceNormalMap&&o.enable(12);e.tangentSpaceNormalMap&&o.enable(13);e.clearcoat&&o.enable(14);e.clearcoatMap&&o.enable(15);e.clearcoatRoughnessMap&&o.enable(16);e.clearcoatNormalMap&&o.enable(17);e.iridescence&&o.enable(18);e.iridescenceMap&&o.enable(19);e.iridescenceThicknessMap&&o.enable(20);e.displacementMap&&o.enable(21);e.specularMap&&o.enable(22);e.roughnessMap&&o.enable(23);e.metalnessMap&&o.enable(24);e.gradientMap&&o.enable(25);e.alphaMap&&o.enable(26);e.alphaTest&&o.enable(27);e.vertexColors&&o.enable(28);e.vertexAlphas&&o.enable(29);e.vertexUvs&&o.enable(30);e.vertexTangents&&o.enable(31);e.uvsVertexOnly&&o.enable(32);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.skinning&&o.enable(4);e.morphTargets&&o.enable(5);e.morphNormals&&o.enable(6);e.morphColors&&o.enable(7);e.premultipliedAlpha&&o.enable(8);e.shadowMapEnabled&&o.enable(9);e.physicallyCorrectLights&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.specularIntensityMap&&o.enable(15);e.specularColorMap&&o.enable(16);e.transmission&&o.enable(17);e.transmissionMap&&o.enable(18);e.thicknessMap&&o.enable(19);e.sheen&&o.enable(20);e.sheenColorMap&&o.enable(21);e.sheenRoughnessMap&&o.enable(22);e.decodeVideoTexture&&o.enable(23);e.opaque&&o.enable(24);t.push(o.mask)}(r,e),r.push(t.outputEncoding)),r.push(e.customProgramCacheKey),r.join()},getUniforms:function(t){const e=p[t.type];let r;if(e){const t=yd[e];r=td.clone(t.uniforms)}else r=t.uniforms;return r},acquireProgram:function(e,r){let i;for(let t=0,e=u.length;t<e;t++){const e=u[t];if(e.cacheKey===r){i=e,++i.usedTimes;break}}return void 0===i&&(i=new vm(t,r,e,s),u.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){h.remove(t)},programs:u,dispose:function(){h.dispose()}}}function wm(){let t=new WeakMap;return{get:function(e){let r=t.get(e);return void 0===r&&(r={},t.set(e,r)),r},remove:function(e){t.delete(e)},update:function(e,r,i){t.get(e)[r]=i},dispose:function(){t=new WeakMap}}}function Em(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Mm(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Sm(){const t=[];let e=0;const r=[],i=[],n=[];function s(r,i,n,s,a,o){let h=t[e];return void 0===h?(h={id:r.id,object:r,geometry:i,material:n,groupOrder:s,renderOrder:r.renderOrder,z:a,group:o},t[e]=h):(h.id=r.id,h.object=r,h.geometry=i,h.material=n,h.groupOrder=s,h.renderOrder=r.renderOrder,h.z=a,h.group=o),e++,h}return{opaque:r,transmissive:i,transparent:n,init:function(){e=0,r.length=0,i.length=0,n.length=0},push:function(t,e,a,o,h,u){const l=s(t,e,a,o,h,u);a.transmission>0?i.push(l):!0===a.transparent?n.push(l):r.push(l)},unshift:function(t,e,a,o,h,u){const l=s(t,e,a,o,h,u);a.transmission>0?i.unshift(l):!0===a.transparent?n.unshift(l):r.unshift(l)},finish:function(){for(let r=e,i=t.length;r<i;r++){const e=t[r];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){r.length>1&&r.sort(t||Em),i.length>1&&i.sort(e||Mm),n.length>1&&n.sort(e||Mm)}}}function Am(){let t=new WeakMap;return{get:function(e,r){const i=t.get(e);let n;return void 0===i?(n=new Sm,t.set(e,[n])):r>=i.length?(n=new Sm,i.push(n)):n=i[r],n},dispose:function(){t=new WeakMap}}}function Tm(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let r;switch(e.type){case"DirectionalLight":r={direction:new ic,color:new Wl};break;case"SpotLight":r={position:new ic,direction:new ic,color:new Wl,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new ic,color:new Wl,distance:0,decay:0};break;case"HemisphereLight":r={direction:new ic,skyColor:new Wl,groundColor:new Wl};break;case"RectAreaLight":r={color:new Wl,position:new ic,halfWidth:new ic,halfHeight:new ic}}return t[e.id]=r,r}}}let Cm=0;function Dm(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Rm(t,e){const r=new Tm,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let r;switch(e.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rl};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rl,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=r,r}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let t=0;t<9;t++)n.probe.push(new ic);const s=new ic,a=new kc,o=new kc;return{setup:function(s,a){let o=0,h=0,u=0;for(let t=0;t<9;t++)n.probe[t].set(0,0,0);let l=0,c=0,f=0,d=0,p=0,m=0,g=0,v=0,_=0,b=0;s.sort(Dm);const y=!0!==a?Math.PI:1;for(let t=0,e=s.length;t<e;t++){const e=s[t],a=e.color,x=e.intensity,w=e.distance,E=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=a.r*x*y,h+=a.g*x*y,u+=a.b*x*y;else if(e.isLightProbe)for(let t=0;t<9;t++)n.probe[t].addScaledVector(e.sh.coefficients[t],x);else if(e.isDirectionalLight){const t=r.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),e.castShadow){const t=e.shadow,r=i.get(e);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,n.directionalShadow[l]=r,n.directionalShadowMap[l]=E,n.directionalShadowMatrix[l]=e.shadow.matrix,m++}n.directional[l]=t,l++}else if(e.isSpotLight){const t=r.get(e);t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(x*y),t.distance=w,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,n.spot[f]=t;const s=e.shadow;if(e.map&&(n.spotLightMap[_]=e.map,_++,s.updateMatrices(e),e.castShadow&&b++),n.spotLightMatrix[f]=s.matrix,e.castShadow){const t=i.get(e);t.shadowBias=s.bias,t.shadowNormalBias=s.normalBias,t.shadowRadius=s.radius,t.shadowMapSize=s.mapSize,n.spotShadow[f]=t,n.spotShadowMap[f]=E,v++}f++}else if(e.isRectAreaLight){const t=r.get(e);t.color.copy(a).multiplyScalar(x),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),n.rectArea[d]=t,d++}else if(e.isPointLight){const t=r.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,r=i.get(e);r.shadowBias=t.bias,r.shadowNormalBias=t.normalBias,r.shadowRadius=t.radius,r.shadowMapSize=t.mapSize,r.shadowCameraNear=t.camera.near,r.shadowCameraFar=t.camera.far,n.pointShadow[c]=r,n.pointShadowMap[c]=E,n.pointShadowMatrix[c]=e.shadow.matrix,g++}n.point[c]=t,c++}else if(e.isHemisphereLight){const t=r.get(e);t.skyColor.copy(e.color).multiplyScalar(x*y),t.groundColor.copy(e.groundColor).multiplyScalar(x*y),n.hemi[p]=t,p++}}d>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(n.rectAreaLTC1=bd.LTC_FLOAT_1,n.rectAreaLTC2=bd.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(n.rectAreaLTC1=bd.LTC_HALF_1,n.rectAreaLTC2=bd.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=o,n.ambient[1]=h,n.ambient[2]=u;const x=n.hash;x.directionalLength===l&&x.pointLength===c&&x.spotLength===f&&x.rectAreaLength===d&&x.hemiLength===p&&x.numDirectionalShadows===m&&x.numPointShadows===g&&x.numSpotShadows===v&&x.numSpotMaps===_||(n.directional.length=l,n.spot.length=f,n.rectArea.length=d,n.point.length=c,n.hemi.length=p,n.directionalShadow.length=m,n.directionalShadowMap.length=m,n.pointShadow.length=g,n.pointShadowMap.length=g,n.spotShadow.length=v,n.spotShadowMap.length=v,n.directionalShadowMatrix.length=m,n.pointShadowMatrix.length=g,n.spotLightMatrix.length=v+_-b,n.spotLightMap.length=_,n.numSpotLightShadowsWithMaps=b,x.directionalLength=l,x.pointLength=c,x.spotLength=f,x.rectAreaLength=d,x.hemiLength=p,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=v,x.numSpotMaps=_,n.version=Cm++)},setupView:function(t,e){let r=0,i=0,h=0,u=0,l=0;const c=e.matrixWorldInverse;for(let e=0,f=t.length;e<f;e++){const f=t[e];if(f.isDirectionalLight){const t=n.directional[r];t.direction.setFromMatrixPosition(f.matrixWorld),s.setFromMatrixPosition(f.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(c),r++}else if(f.isSpotLight){const t=n.spot[h];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(c),t.direction.setFromMatrixPosition(f.matrixWorld),s.setFromMatrixPosition(f.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(c),h++}else if(f.isRectAreaLight){const t=n.rectArea[u];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(c),o.identity(),a.copy(f.matrixWorld),a.premultiply(c),o.extractRotation(a),t.halfWidth.set(.5*f.width,0,0),t.halfHeight.set(0,.5*f.height,0),t.halfWidth.applyMatrix4(o),t.halfHeight.applyMatrix4(o),u++}else if(f.isPointLight){const t=n.point[i];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(c),i++}else if(f.isHemisphereLight){const t=n.hemi[l];t.direction.setFromMatrixPosition(f.matrixWorld),t.direction.transformDirection(c),l++}}},state:n}}function Im(t,e){const r=new Rm(t,e),i=[],n=[];return{init:function(){i.length=0,n.length=0},state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:function(t){r.setup(i,t)},setupLightsView:function(t){r.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){n.push(t)}}}function Pm(t,e){let r=new WeakMap;return{get:function(i,n=0){const s=r.get(i);let a;return void 0===s?(a=new Im(t,e),r.set(i,[a])):n>=s.length?(a=new Im(t,e),s.push(a)):a=s[n],a},dispose:function(){r=new WeakMap}}}class Nm extends bf{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class km extends bf{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new ic,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Bm(t,e,r){let i=new pd;const n=new Rl,s=new Rl,a=new Jl,o=new Nm({depthPacking:3201}),h=new km,u={},l=r.maxTextureSize,c={0:1,1:0,2:2},f=new ed({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rl},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=f.clone();d.defines.HORIZONTAL_PASS=1;const p=new kf;p.setAttribute("position",new Ef(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Yf(p,f),g=this;function v(r,i){const s=e.update(m);f.defines.VSM_SAMPLES!==r.blurSamples&&(f.defines.VSM_SAMPLES=r.blurSamples,d.defines.VSM_SAMPLES=r.blurSamples,f.needsUpdate=!0,d.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new Ql(n.x,n.y)),f.uniforms.shadow_pass.value=r.map.texture,f.uniforms.resolution.value=r.mapSize,f.uniforms.radius.value=r.radius,t.setRenderTarget(r.mapPass),t.clear(),t.renderBufferDirect(i,null,s,f,m,null),d.uniforms.shadow_pass.value=r.mapPass.texture,d.uniforms.resolution.value=r.mapSize,d.uniforms.radius.value=r.radius,t.setRenderTarget(r.map),t.clear(),t.renderBufferDirect(i,null,s,d,m,null)}function _(e,r,i,n,s,a){let l=null;const f=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==f)l=f;else if(l=!0===i.isPointLight?h:o,t.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){const t=l.uuid,e=r.uuid;let i=u[t];void 0===i&&(i={},u[t]=i);let n=i[e];void 0===n&&(n=l.clone(),i[e]=n),l=n}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===a?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:c[r.side],l.alphaMap=r.alphaMap,l.alphaTest=r.alphaTest,l.map=r.map,l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.displacementMap=r.displacementMap,l.displacementScale=r.displacementScale,l.displacementBias=r.displacementBias,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=n,l.farDistance=s),l}function b(r,n,s,a,o){if(!1===r.visible)return;if(r.layers.test(n.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&3===o)&&(!r.frustumCulled||i.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);const i=e.update(r),n=r.material;if(Array.isArray(n)){const e=i.groups;for(let h=0,u=e.length;h<u;h++){const u=e[h],l=n[u.materialIndex];if(l&&l.visible){const e=_(r,l,a,s.near,s.far,o);t.renderBufferDirect(s,null,i,e,r,u)}}}else if(n.visible){const e=_(r,n,a,s.near,s.far,o);t.renderBufferDirect(s,null,i,e,r,null)}}const h=r.children;for(let t=0,e=h.length;t<e;t++)b(h[t],n,s,a,o)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,r,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const h=t.getRenderTarget(),u=t.getActiveCubeFace(),c=t.getActiveMipmapLevel(),f=t.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(let h=0,u=e.length;h<u;h++){const u=e[h],c=u.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",u,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;n.copy(c.mapSize);const d=c.getFrameExtents();if(n.multiply(d),s.copy(c.mapSize),(n.x>l||n.y>l)&&(n.x>l&&(s.x=Math.floor(l/d.x),n.x=s.x*d.x,c.mapSize.x=s.x),n.y>l&&(s.y=Math.floor(l/d.y),n.y=s.y*d.y,c.mapSize.y=s.y)),null===c.map){const t=3!==this.type?{minFilter:Gu,magFilter:Gu}:{};c.map=new Ql(n.x,n.y,t),c.map.texture.name=u.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const p=c.getViewportCount();for(let t=0;t<p;t++){const e=c.getViewport(t);a.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),f.viewport(a),c.updateMatrices(u,t),i=c.getFrustum(),b(r,o,c.camera,u,this.type)}!0!==c.isPointLightShadow&&3===this.type&&v(c,o),c.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(h,u,c)}}function Lm(t,e,r){const i=r.isWebGL2;const n=new function(){let e=!1;const r=new Jl;let i=null;const n=new Jl(0,0,0,0);return{setMask:function(r){i===r||e||(t.colorMask(r,r,r,r),i=r)},setLocked:function(t){e=t},setClear:function(e,i,s,a,o){!0===o&&(e*=a,i*=a,s*=a),r.set(e,i,s,a),!1===n.equals(r)&&(t.clearColor(e,i,s,a),n.copy(r))},reset:function(){e=!1,i=null,n.set(-1,0,0,0)}}},s=new function(){let e=!1,r=null,i=null,n=null;return{setTest:function(t){t?z(2929):G(2929)},setMask:function(i){r===i||e||(t.depthMask(i),r=i)},setFunc:function(e){if(i!==e){switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}i=e}},setLocked:function(t){e=t},setClear:function(e){n!==e&&(t.clearDepth(e),n=e)},reset:function(){e=!1,r=null,i=null,n=null}}},a=new function(){let e=!1,r=null,i=null,n=null,s=null,a=null,o=null,h=null,u=null;return{setTest:function(t){e||(t?z(2960):G(2960))},setMask:function(i){r===i||e||(t.stencilMask(i),r=i)},setFunc:function(e,r,a){i===e&&n===r&&s===a||(t.stencilFunc(e,r,a),i=e,n=r,s=a)},setOp:function(e,r,i){a===e&&o===r&&h===i||(t.stencilOp(e,r,i),a=e,o=r,h=i)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,r=null,i=null,n=null,s=null,a=null,o=null,h=null,u=null}}},o=new WeakMap,h=new WeakMap;let u={},l={},c=new WeakMap,f=[],d=null,p=!1,m=null,g=null,v=null,_=null,b=null,y=null,x=null,w=!1,E=null,M=null,S=null,A=null,T=null;const C=t.getParameter(35661);let D=!1,R=0;const I=t.getParameter(7938);-1!==I.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(I)[1]),D=R>=1):-1!==I.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),D=R>=2);let P=null,N={};const k=t.getParameter(3088),B=t.getParameter(2978),L=(new Jl).fromArray(k),O=(new Jl).fromArray(B);function F(e,r,i){const n=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<i;e++)t.texImage2D(r+e,0,6408,1,1,0,6408,5121,n);return s}const U={};function z(e){!0!==u[e]&&(t.enable(e),u[e]=!0)}function G(e){!1!==u[e]&&(t.disable(e),u[e]=!1)}U[3553]=F(3553,3553,1),U[34067]=F(34067,34069,6),n.setClear(0,0,0,1),s.setClear(1),a.setClear(0),z(2929),s.setFunc(3),W(!1),q(1),z(2884),V(0);const H={[Pu]:32774,101:32778,102:32779};if(i)H[103]=32775,H[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(H[103]=t.MIN_EXT,H[104]=t.MAX_EXT)}const j={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function V(e,r,i,n,s,a,o,h){if(0!==e){if(!1===p&&(z(3042),p=!0),5===e)s=s||r,a=a||i,o=o||n,r===g&&s===b||(t.blendEquationSeparate(H[r],H[s]),g=r,b=s),i===v&&n===_&&a===y&&o===x||(t.blendFuncSeparate(j[i],j[n],j[a],j[o]),v=i,_=n,y=a,x=o),m=e,w=!1;else if(e!==m||h!==w){if(g===Pu&&b===Pu||(t.blendEquation(32774),g=Pu,b=Pu),h)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}v=null,_=null,y=null,x=null,m=e,w=h}}else!0===p&&(G(3042),p=!1)}function W(e){E!==e&&(e?t.frontFace(2304):t.frontFace(2305),E=e)}function q(e){0!==e?(z(2884),e!==M&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):G(2884),M=e}function X(e,r,i){e?(z(32823),A===r&&T===i||(t.polygonOffset(r,i),A=r,T=i)):G(32823)}return{buffers:{color:n,depth:s,stencil:a},enable:z,disable:G,bindFramebuffer:function(e,r){return l[e]!==r&&(t.bindFramebuffer(e,r),l[e]=r,i&&(36009===e&&(l[36160]=r),36160===e&&(l[36009]=r)),!0)},drawBuffers:function(i,n){let s=f,a=!1;if(i)if(s=c.get(n),void 0===s&&(s=[],c.set(n,s)),i.isWebGLMultipleRenderTargets){const t=i.texture;if(s.length!==t.length||36064!==s[0]){for(let e=0,r=t.length;e<r;e++)s[e]=36064+e;s.length=t.length,a=!0}}else 36064!==s[0]&&(s[0]=36064,a=!0);else 1029!==s[0]&&(s[0]=1029,a=!0);a&&(r.isWebGL2?t.drawBuffers(s):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(e){return d!==e&&(t.useProgram(e),d=e,!0)},setBlending:V,setMaterial:function(t,e){2===t.side?G(2884):z(2884);let r=1===t.side;e&&(r=!r),W(r),1===t.blending&&!1===t.transparent?V(0):V(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),n.setMask(t.colorWrite);const i=t.stencilWrite;a.setTest(i),i&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),X(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?z(32926):G(32926)},setFlipSided:W,setCullFace:q,setLineWidth:function(e){e!==S&&(D&&t.lineWidth(e),S=e)},setPolygonOffset:X,setScissorTest:function(t){t?z(3089):G(3089)},activeTexture:function(e){void 0===e&&(e=33984+C-1),P!==e&&(t.activeTexture(e),P=e)},bindTexture:function(e,r,i){void 0===i&&(i=null===P?33984+C-1:P);let n=N[i];void 0===n&&(n={type:void 0,texture:void 0},N[i]=n),n.type===e&&n.texture===r||(P!==i&&(t.activeTexture(i),P=i),t.bindTexture(e,r||U[e]),n.type=e,n.texture=r)},unbindTexture:function(){const e=N[P];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(e,r){let i=h.get(r);void 0===i&&(i=new WeakMap,h.set(r,i));let n=i.get(e);void 0===n&&(n=t.getUniformBlockIndex(r,e.name),i.set(e,n))},uniformBlockBinding:function(e,r){const i=h.get(r).get(e);o.get(r)!==i&&(t.uniformBlockBinding(r,i,e.__bindingPointIndex),o.set(r,i))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===L.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===O.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},P=null,N={},l={},c=new WeakMap,f=[],d=null,p=!1,m=null,g=null,v=null,_=null,b=null,y=null,x=null,w=!1,E=null,M=null,S=null,A=null,T=null,L.set(0,0,t.canvas.width,t.canvas.height),O.set(0,0,t.canvas.width,t.canvas.height),n.reset(),s.reset(),a.reset()}}}function Om(t,e,r,i,n,s,a){const o=n.isWebGL2,h=n.maxTextures,u=n.maxCubemapSize,l=n.maxTextureSize,c=n.maxSamples,f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function _(t,e){return v?new OffscreenCanvas(t,e):kl("canvas")}function b(t,e,r,i){let n=1;if((t.width>i||t.height>i)&&(n=i/Math.max(t.width,t.height)),n<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?Tl:Math.floor,s=i(n*t.width),a=i(n*t.height);void 0===m&&(m=_(s,a));const o=r?_(s,a):m;o.width=s,o.height=a;return o.getContext("2d").drawImage(t,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+a+")."),o}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return Al(t.width)&&Al(t.height)}function x(t,e){return t.generateMipmaps&&e&&t.minFilter!==Gu&&t.minFilter!==Vu}function w(e){t.generateMipmap(e)}function E(r,i,n,s,a=!1){if(!1===o)return i;if(null!==r){if(void 0!==t[r])return t[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let h=i;return 6403===i&&(5126===n&&(h=33326),5131===n&&(h=33325),5121===n&&(h=33321)),33319===i&&(5126===n&&(h=33328),5131===n&&(h=33327),5121===n&&(h=33323)),6408===i&&(5126===n&&(h=34836),5131===n&&(h=34842),5121===n&&(h=s===cl&&!1===a?35907:32856),32819===n&&(h=32854),32820===n&&(h=32855)),33325!==h&&33326!==h&&33327!==h&&33328!==h&&34842!==h&&34836!==h||e.get("EXT_color_buffer_float"),h}function M(t,e,r){return!0===x(t,r)||t.isFramebufferTexture&&t.minFilter!==Gu&&t.minFilter!==Vu?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function S(t){return t===Gu||t===Hu||t===ju?9728:9729}function A(t){const e=t.target;e.removeEventListener("dispose",A),function(t){const e=i.get(t);if(void 0===e.__webglInit)return;const r=t.source,n=g.get(r);if(n){const i=n[e.__cacheKey];i.usedTimes--,0===i.usedTimes&&C(t),0===Object.keys(n).length&&g.delete(r)}i.remove(t)}(e),e.isVideoTexture&&p.delete(e)}function T(e){const r=e.target;r.removeEventListener("dispose",T),function(e){const r=e.texture,n=i.get(e),s=i.get(r);void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),a.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[e]);else{if(t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let e=0;e<n.__webglColorRenderbuffer.length;e++)n.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(n.__webglColorRenderbuffer[e]);n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let e=0,n=r.length;e<n;e++){const n=i.get(r[e]);n.__webglTexture&&(t.deleteTexture(n.__webglTexture),a.memory.textures--),i.remove(r[e])}i.remove(r),i.remove(e)}(r)}function C(e){const r=i.get(e);t.deleteTexture(r.__webglTexture);const n=e.source;delete g.get(n)[r.__cacheKey],a.memory.textures--}let D=0;function R(t,e){const n=i.get(t);if(t.isVideoTexture&&function(t){const e=a.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&n.__version!==t.version){const r=t.image;if(null===r)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==r.complete)return void B(n,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.bindTexture(3553,n.__webglTexture,33984+e)}const I={[Fu]:10497,[Uu]:33071,[zu]:33648},P={[Gu]:9728,[Hu]:9984,[ju]:9986,[Vu]:9729,1007:9985,[Wu]:9987};function N(r,s,a){if(a?(t.texParameteri(r,10242,I[s.wrapS]),t.texParameteri(r,10243,I[s.wrapT]),32879!==r&&35866!==r||t.texParameteri(r,32882,I[s.wrapR]),t.texParameteri(r,10240,P[s.magFilter]),t.texParameteri(r,10241,P[s.minFilter])):(t.texParameteri(r,10242,33071),t.texParameteri(r,10243,33071),32879!==r&&35866!==r||t.texParameteri(r,32882,33071),s.wrapS===Uu&&s.wrapT===Uu||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(r,10240,S(s.magFilter)),t.texParameteri(r,10241,S(s.minFilter)),s.minFilter!==Gu&&s.minFilter!==Vu&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(s.magFilter===Gu)return;if(s.minFilter!==ju&&s.minFilter!==Wu)return;if(s.type===Yu&&!1===e.has("OES_texture_float_linear"))return;if(!1===o&&s.type===Zu&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(t.texParameterf(r,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,n.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function k(e,r){let i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",A));const n=r.source;let s=g.get(n);void 0===s&&(s={},g.set(n,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}(r);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const n=s[e.__cacheKey];void 0!==n&&(s[e.__cacheKey].usedTimes--,0===n.usedTimes&&C(r)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return i}function B(e,n,a){let h=3553;(n.isDataArrayTexture||n.isCompressedArrayTexture)&&(h=35866),n.isData3DTexture&&(h=32879);const u=k(e,n),c=n.source;r.bindTexture(h,e.__webglTexture,33984+a);const f=i.get(c);if(c.version!==f.__version||!0===u){r.activeTexture(33984+a),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment),t.pixelStorei(37443,0);const e=function(t){return!o&&(t.wrapS!==Uu||t.wrapT!==Uu||t.minFilter!==Gu&&t.minFilter!==Vu)}(n)&&!1===y(n.image);let i=b(n.image,e,!1,l);i=G(n,i);const d=y(i)||o,p=s.convert(n.format,n.encoding);let m,g=s.convert(n.type),v=E(n.internalFormat,p,g,n.encoding,n.isVideoTexture);N(h,n,d);const _=n.mipmaps,S=o&&!0!==n.isVideoTexture,A=void 0===f.__version||!0===u,T=M(n,i,d);if(n.isDepthTexture)v=6402,o?v=n.type===Yu?36012:n.type===Xu?33190:n.type===$u?35056:33189:n.type===Yu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===Ju&&6402===v&&1012!==n.type&&n.type!==Xu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Xu,g=s.convert(n.type)),n.format===Qu&&6402===v&&(v=34041,n.type!==$u&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=$u,g=s.convert(n.type))),A&&(S?r.texStorage2D(3553,1,v,i.width,i.height):r.texImage2D(3553,0,v,i.width,i.height,0,p,g,null));else if(n.isDataTexture)if(_.length>0&&d){S&&A&&r.texStorage2D(3553,T,v,_[0].width,_[0].height);for(let t=0,e=_.length;t<e;t++)m=_[t],S?r.texSubImage2D(3553,t,0,0,m.width,m.height,p,g,m.data):r.texImage2D(3553,t,v,m.width,m.height,0,p,g,m.data);n.generateMipmaps=!1}else S?(A&&r.texStorage2D(3553,T,v,i.width,i.height),r.texSubImage2D(3553,0,0,0,i.width,i.height,p,g,i.data)):r.texImage2D(3553,0,v,i.width,i.height,0,p,g,i.data);else if(n.isCompressedTexture)if(n.isCompressedArrayTexture){S&&A&&r.texStorage3D(35866,T,v,_[0].width,_[0].height,i.depth);for(let t=0,e=_.length;t<e;t++)m=_[t],n.format!==Ku?null!==p?S?r.compressedTexSubImage3D(35866,t,0,0,0,m.width,m.height,i.depth,p,m.data,0,0):r.compressedTexImage3D(35866,t,v,m.width,m.height,i.depth,0,m.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?r.texSubImage3D(35866,t,0,0,0,m.width,m.height,i.depth,p,g,m.data):r.texImage3D(35866,t,v,m.width,m.height,i.depth,0,p,g,m.data)}else{S&&A&&r.texStorage2D(3553,T,v,_[0].width,_[0].height);for(let t=0,e=_.length;t<e;t++)m=_[t],n.format!==Ku?null!==p?S?r.compressedTexSubImage2D(3553,t,0,0,m.width,m.height,p,m.data):r.compressedTexImage2D(3553,t,v,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?r.texSubImage2D(3553,t,0,0,m.width,m.height,p,g,m.data):r.texImage2D(3553,t,v,m.width,m.height,0,p,g,m.data)}else if(n.isDataArrayTexture)S?(A&&r.texStorage3D(35866,T,v,i.width,i.height,i.depth),r.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,p,g,i.data)):r.texImage3D(35866,0,v,i.width,i.height,i.depth,0,p,g,i.data);else if(n.isData3DTexture)S?(A&&r.texStorage3D(32879,T,v,i.width,i.height,i.depth),r.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,p,g,i.data)):r.texImage3D(32879,0,v,i.width,i.height,i.depth,0,p,g,i.data);else if(n.isFramebufferTexture){if(A)if(S)r.texStorage2D(3553,T,v,i.width,i.height);else{let t=i.width,e=i.height;for(let i=0;i<T;i++)r.texImage2D(3553,i,v,t,e,0,p,g,null),t>>=1,e>>=1}}else if(_.length>0&&d){S&&A&&r.texStorage2D(3553,T,v,_[0].width,_[0].height);for(let t=0,e=_.length;t<e;t++)m=_[t],S?r.texSubImage2D(3553,t,0,0,p,g,m):r.texImage2D(3553,t,v,p,g,m);n.generateMipmaps=!1}else S?(A&&r.texStorage2D(3553,T,v,i.width,i.height),r.texSubImage2D(3553,0,0,0,p,g,i)):r.texImage2D(3553,0,v,p,g,i);x(n,d)&&w(h),f.__version=c.version,n.onUpdate&&n.onUpdate(n)}e.__version=n.version}function L(e,n,a,o,h){const u=s.convert(a.format,a.encoding),l=s.convert(a.type),c=E(a.internalFormat,u,l,a.encoding);i.get(n).__hasExternalTextures||(32879===h||35866===h?r.texImage3D(h,0,c,n.width,n.height,n.depth,0,u,l,null):r.texImage2D(h,0,c,n.width,n.height,0,u,l,null)),r.bindFramebuffer(36160,e),z(n)?f.framebufferTexture2DMultisampleEXT(36160,o,h,i.get(a).__webglTexture,0,U(n)):(3553===h||h>=34069&&h<=34074)&&t.framebufferTexture2D(36160,o,h,i.get(a).__webglTexture,0),r.bindFramebuffer(36160,null)}function O(e,r,i){if(t.bindRenderbuffer(36161,e),r.depthBuffer&&!r.stencilBuffer){let n=33189;if(i||z(r)){const e=r.depthTexture;e&&e.isDepthTexture&&(e.type===Yu?n=36012:e.type===Xu&&(n=33190));const i=U(r);z(r)?f.renderbufferStorageMultisampleEXT(36161,i,n,r.width,r.height):t.renderbufferStorageMultisample(36161,i,n,r.width,r.height)}else t.renderbufferStorage(36161,n,r.width,r.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(r.depthBuffer&&r.stencilBuffer){const n=U(r);i&&!1===z(r)?t.renderbufferStorageMultisample(36161,n,35056,r.width,r.height):z(r)?f.renderbufferStorageMultisampleEXT(36161,n,35056,r.width,r.height):t.renderbufferStorage(36161,34041,r.width,r.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===r.isWebGLMultipleRenderTargets?r.texture:[r.texture];for(let n=0;n<e.length;n++){const a=e[n],o=s.convert(a.format,a.encoding),h=s.convert(a.type),u=E(a.internalFormat,o,h,a.encoding),l=U(r);i&&!1===z(r)?t.renderbufferStorageMultisample(36161,l,u,r.width,r.height):z(r)?f.renderbufferStorageMultisampleEXT(36161,l,u,r.width,r.height):t.renderbufferStorage(36161,u,r.width,r.height)}}t.bindRenderbuffer(36161,null)}function F(e){const n=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!n.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),R(n.depthTexture,0);const s=i.get(n.depthTexture).__webglTexture,a=U(n);if(n.depthTexture.format===Ju)z(n)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,a):t.framebufferTexture2D(36160,36096,3553,s,0);else{if(n.depthTexture.format!==Qu)throw new Error("Unknown depthTexture format");z(n)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,a):t.framebufferTexture2D(36160,33306,3553,s,0)}}(n.__webglFramebuffer,e)}else if(s){n.__webglDepthbuffer=[];for(let i=0;i<6;i++)r.bindFramebuffer(36160,n.__webglFramebuffer[i]),n.__webglDepthbuffer[i]=t.createRenderbuffer(),O(n.__webglDepthbuffer[i],e,!1)}else r.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),O(n.__webglDepthbuffer,e,!1);r.bindFramebuffer(36160,null)}function U(t){return Math.min(c,t.samples)}function z(t){const r=i.get(t);return o&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function G(t,r){const i=t.encoding,n=t.format,s=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===vl||i!==ll&&(i===cl?!1===o?!0===e.has("EXT_sRGB")&&n===Ku?(t.format=vl,t.minFilter=Vu,t.generateMipmaps=!1):r=Xl.sRGBToLinear(r):n===Ku&&s===qu||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),r}this.allocateTextureUnit=function(){const t=D;return t>=h&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+h),D+=1,t},this.resetTextureUnits=function(){D=0},this.setTexture2D=R,this.setTexture2DArray=function(t,e){const n=i.get(t);t.version>0&&n.__version!==t.version?B(n,t,e):r.bindTexture(35866,n.__webglTexture,33984+e)},this.setTexture3D=function(t,e){const n=i.get(t);t.version>0&&n.__version!==t.version?B(n,t,e):r.bindTexture(32879,n.__webglTexture,33984+e)},this.setTextureCube=function(e,n){const a=i.get(e);e.version>0&&a.__version!==e.version?function(e,n,a){if(6!==n.image.length)return;const h=k(e,n),l=n.source;r.bindTexture(34067,e.__webglTexture,33984+a);const c=i.get(l);if(l.version!==c.__version||!0===h){r.activeTexture(33984+a),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment),t.pixelStorei(37443,0);const e=n.isCompressedTexture||n.image[0].isCompressedTexture,i=n.image[0]&&n.image[0].isDataTexture,f=[];for(let t=0;t<6;t++)f[t]=e||i?i?n.image[t].image:n.image[t]:b(n.image[t],!1,!0,u),f[t]=G(n,f[t]);const d=f[0],p=y(d)||o,m=s.convert(n.format,n.encoding),g=s.convert(n.type),v=E(n.internalFormat,m,g,n.encoding),_=o&&!0!==n.isVideoTexture,S=void 0===c.__version||!0===h;let A,T=M(n,d,p);if(N(34067,n,p),e){_&&S&&r.texStorage2D(34067,T,v,d.width,d.height);for(let t=0;t<6;t++){A=f[t].mipmaps;for(let e=0;e<A.length;e++){const i=A[e];n.format!==Ku?null!==m?_?r.compressedTexSubImage2D(34069+t,e,0,0,i.width,i.height,m,i.data):r.compressedTexImage2D(34069+t,e,v,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_?r.texSubImage2D(34069+t,e,0,0,i.width,i.height,m,g,i.data):r.texImage2D(34069+t,e,v,i.width,i.height,0,m,g,i.data)}}}else{A=n.mipmaps,_&&S&&(A.length>0&&T++,r.texStorage2D(34067,T,v,f[0].width,f[0].height));for(let t=0;t<6;t++)if(i){_?r.texSubImage2D(34069+t,0,0,0,f[t].width,f[t].height,m,g,f[t].data):r.texImage2D(34069+t,0,v,f[t].width,f[t].height,0,m,g,f[t].data);for(let e=0;e<A.length;e++){const i=A[e].image[t].image;_?r.texSubImage2D(34069+t,e+1,0,0,i.width,i.height,m,g,i.data):r.texImage2D(34069+t,e+1,v,i.width,i.height,0,m,g,i.data)}}else{_?r.texSubImage2D(34069+t,0,0,0,m,g,f[t]):r.texImage2D(34069+t,0,v,m,g,f[t]);for(let e=0;e<A.length;e++){const i=A[e];_?r.texSubImage2D(34069+t,e+1,0,0,m,g,i.image[t]):r.texImage2D(34069+t,e+1,v,m,g,i.image[t])}}}x(n,p)&&w(34067),c.__version=l.version,n.onUpdate&&n.onUpdate(n)}e.__version=n.version}(a,e,n):r.bindTexture(34067,a.__webglTexture,33984+n)},this.rebindTextures=function(t,e,r){const n=i.get(t);void 0!==e&&L(n.__webglFramebuffer,t,t.texture,36064,3553),void 0!==r&&F(t)},this.setupRenderTarget=function(e){const h=e.texture,u=i.get(e),l=i.get(h);e.addEventListener("dispose",T),!0!==e.isWebGLMultipleRenderTargets&&(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=h.version,a.memory.textures++);const c=!0===e.isWebGLCubeRenderTarget,f=!0===e.isWebGLMultipleRenderTargets,d=y(e)||o;if(c){u.__webglFramebuffer=[];for(let e=0;e<6;e++)u.__webglFramebuffer[e]=t.createFramebuffer()}else{if(u.__webglFramebuffer=t.createFramebuffer(),f)if(n.drawBuffers){const r=e.texture;for(let e=0,n=r.length;e<n;e++){const n=i.get(r[e]);void 0===n.__webglTexture&&(n.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&e.samples>0&&!1===z(e)){const i=f?h:[h];u.__webglMultisampledFramebuffer=t.createFramebuffer(),u.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,u.__webglMultisampledFramebuffer);for(let r=0;r<i.length;r++){const n=i[r];u.__webglColorRenderbuffer[r]=t.createRenderbuffer(),t.bindRenderbuffer(36161,u.__webglColorRenderbuffer[r]);const a=s.convert(n.format,n.encoding),o=s.convert(n.type),h=E(n.internalFormat,a,o,n.encoding,!0===e.isXRRenderTarget),l=U(e);t.renderbufferStorageMultisample(36161,l,h,e.width,e.height),t.framebufferRenderbuffer(36160,36064+r,36161,u.__webglColorRenderbuffer[r])}t.bindRenderbuffer(36161,null),e.depthBuffer&&(u.__webglDepthRenderbuffer=t.createRenderbuffer(),O(u.__webglDepthRenderbuffer,e,!0)),r.bindFramebuffer(36160,null)}}if(c){r.bindTexture(34067,l.__webglTexture),N(34067,h,d);for(let t=0;t<6;t++)L(u.__webglFramebuffer[t],e,h,36064,34069+t);x(h,d)&&w(34067),r.unbindTexture()}else if(f){const t=e.texture;for(let n=0,s=t.length;n<s;n++){const s=t[n],a=i.get(s);r.bindTexture(3553,a.__webglTexture),N(3553,s,d),L(u.__webglFramebuffer,e,s,36064+n,3553),x(s,d)&&w(3553)}r.unbindTexture()}else{let t=3553;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(o?t=e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(t,l.__webglTexture),N(t,h,d),L(u.__webglFramebuffer,e,h,36064,t),x(h,d)&&w(t),r.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(t){const e=y(t)||o,n=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,a=n.length;s<a;s++){const a=n[s];if(x(a,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,n=i.get(a).__webglTexture;r.bindTexture(e,n),w(e),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(o&&e.samples>0&&!1===z(e)){const n=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],s=e.width,a=e.height;let o=16384;const h=[],u=e.stencilBuffer?33306:36096,l=i.get(e),c=!0===e.isWebGLMultipleRenderTargets;if(c)for(let e=0;e<n.length;e++)r.bindFramebuffer(36160,l.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,null),r.bindFramebuffer(36160,l.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,null,0);r.bindFramebuffer(36008,l.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,l.__webglFramebuffer);for(let r=0;r<n.length;r++){h.push(36064+r),e.depthBuffer&&h.push(u);const f=void 0!==l.__ignoreDepthValues&&l.__ignoreDepthValues;if(!1===f&&(e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024)),c&&t.framebufferRenderbuffer(36008,36064,36161,l.__webglColorRenderbuffer[r]),!0===f&&(t.invalidateFramebuffer(36008,[u]),t.invalidateFramebuffer(36009,[u])),c){const e=i.get(n[r]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,9728),d&&t.invalidateFramebuffer(36008,h)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),c)for(let e=0;e<n.length;e++){r.bindFramebuffer(36160,l.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,l.__webglColorRenderbuffer[e]);const s=i.get(n[e]).__webglTexture;r.bindFramebuffer(36160,l.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,s,0)}r.bindFramebuffer(36009,l.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=L,this.useMultisampledRTT=z}function Fm(t,e,r){const i=r.isWebGL2;return{convert:function(r,n=null){let s;if(r===qu)return 5121;if(1017===r)return 32819;if(1018===r)return 32820;if(1010===r)return 5120;if(1011===r)return 5122;if(1012===r)return 5123;if(1013===r)return 5124;if(r===Xu)return 5125;if(r===Yu)return 5126;if(r===Zu)return i?5131:(s=e.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(1021===r)return 6406;if(r===Ku)return 6408;if(1024===r)return 6409;if(1025===r)return 6410;if(r===Ju)return 6402;if(r===Qu)return 34041;if(1022===r)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(r===vl)return s=e.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(1028===r)return 6403;if(1029===r)return 36244;if(1030===r)return 33319;if(1031===r)return 33320;if(1033===r)return 36249;if(r===tl||r===el||r===rl||r===il)if(n===cl){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(r===tl)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===el)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===rl)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===il)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(r===tl)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===el)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===rl)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===il)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===r||35841===r||35842===r||35843===r){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(35840===r)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===r)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===r)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===r)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===r)return s=e.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===r||37496===r){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(37492===r)return n===cl?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(37496===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(37808===r||37809===r||37810===r||37811===r||37812===r||37813===r||37814===r||37815===r||37816===r||37817===r||37818===r||37819===r||37820===r||37821===r){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(37808===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===r)return n===cl?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===r){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(36492===r)return n===cl?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}return r===$u?i?34042:(s=e.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[r]?t[r]:null}}}class Um extends id{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class zm extends af{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Gm={type:"move"};class Hm{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new zm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new zm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ic,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ic),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new zm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ic,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ic),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const r of t.hand.values())this._getHandJoint(e,r)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,r){let i=null,n=null,s=null;const a=this._targetRay,o=this._grip,h=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(h&&t.hand){s=!0;for(const i of t.hand.values()){const t=e.getJointPose(i,r),n=this._getHandJoint(h,i);null!==t&&(n.matrix.fromArray(t.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.jointRadius=t.radius),n.visible=null!==t}const i=h.joints["index-finger-tip"],n=h.joints["thumb-tip"],a=i.position.distanceTo(n.position),o=.02,u=.005;h.inputState.pinching&&a>o+u?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&a<=o-u&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(n=e.getPose(t.gripSpace,r),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=e.getPose(t.targetRaySpace,r),null===i&&null!==n&&(i=n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Gm)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==n),null!==h&&(h.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const r=new zm;r.matrixAutoUpdate=!1,r.visible=!1,t.joints[e.jointName]=r,t.add(r)}return t.joints[e.jointName]}}class jm extends Kl{constructor(t,e,r,i,n,s,a,o,h,u){if((u=void 0!==u?u:Ju)!==Ju&&u!==Qu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&u===Ju&&(r=Xu),void 0===r&&u===Qu&&(r=$u),super(null,i,n,s,a,o,u,r,h),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==a?a:Gu,this.minFilter=void 0!==o?o:Gu,this.flipY=!1,this.generateMipmaps=!1}}class Vm extends _l{constructor(t,e){super();const r=this;let i=null,n=1,s=null,a="local-floor",o=null,h=null,u=null,l=null,c=null,f=null;const d=e.getContextAttributes();let p=null,m=null;const g=[],v=[],_=new Set,b=new Map,y=new id;y.layers.enable(1),y.viewport=new Jl;const x=new id;x.layers.enable(2),x.viewport=new Jl;const w=[y,x],E=new Um;E.layers.enable(1),E.layers.enable(2);let M=null,S=null;function A(t){const e=v.indexOf(t.inputSource);if(-1===e)return;const r=g[e];void 0!==r&&r.dispatchEvent({type:t.type,data:t.inputSource})}function T(){i.removeEventListener("select",A),i.removeEventListener("selectstart",A),i.removeEventListener("selectend",A),i.removeEventListener("squeeze",A),i.removeEventListener("squeezestart",A),i.removeEventListener("squeezeend",A),i.removeEventListener("end",T),i.removeEventListener("inputsourceschange",C);for(let t=0;t<g.length;t++){const e=v[t];null!==e&&(v[t]=null,g[t].disconnect(e))}M=null,S=null,t.setRenderTarget(p),c=null,l=null,u=null,i=null,m=null,N.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function C(t){for(let e=0;e<t.removed.length;e++){const r=t.removed[e],i=v.indexOf(r);i>=0&&(v[i]=null,g[i].disconnect(r))}for(let e=0;e<t.added.length;e++){const r=t.added[e];let i=v.indexOf(r);if(-1===i){for(let t=0;t<g.length;t++){if(t>=v.length){v.push(r),i=t;break}if(null===v[t]){v[t]=r,i=t;break}}if(-1===i)break}const n=g[i];n&&n.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=g[t];return void 0===e&&(e=new Hm,g[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=g[t];return void 0===e&&(e=new Hm,g[t]=e),e.getGripSpace()},this.getHand=function(t){let e=g[t];return void 0===e&&(e=new Hm,g[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){n=t,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o||s},this.setReferenceSpace=function(t){o=t},this.getBaseLayer=function(){return null!==l?l:c},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(h){if(i=h,null!==i){if(p=t.getRenderTarget(),i.addEventListener("select",A),i.addEventListener("selectstart",A),i.addEventListener("selectend",A),i.addEventListener("squeeze",A),i.addEventListener("squeezestart",A),i.addEventListener("squeezeend",A),i.addEventListener("end",T),i.addEventListener("inputsourceschange",C),!0!==d.xrCompatible&&await e.makeXRCompatible(),void 0===i.renderState.layers||!1===t.capabilities.isWebGL2){const r={antialias:void 0!==i.renderState.layers||d.antialias,alpha:d.alpha,depth:d.depth,stencil:d.stencil,framebufferScaleFactor:n};c=new XRWebGLLayer(i,e,r),i.updateRenderState({baseLayer:c}),m=new Ql(c.framebufferWidth,c.framebufferHeight,{format:Ku,type:qu,encoding:t.outputEncoding,stencilBuffer:d.stencil})}else{let r=null,s=null,a=null;d.depth&&(a=d.stencil?35056:33190,r=d.stencil?Qu:Ju,s=d.stencil?$u:Xu);const o={colorFormat:32856,depthFormat:a,scaleFactor:n};u=new XRWebGLBinding(i,e),l=u.createProjectionLayer(o),i.updateRenderState({layers:[l]}),m=new Ql(l.textureWidth,l.textureHeight,{format:Ku,type:qu,depthTexture:new jm(l.textureWidth,l.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:d.stencil,encoding:t.outputEncoding,samples:d.antialias?4:0});t.properties.get(m).__ignoreDepthValues=l.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),o=null,s=await i.requestReferenceSpace(a),N.setContext(i),N.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};const D=new ic,R=new ic;function I(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;E.near=x.near=y.near=t.near,E.far=x.far=y.far=t.far,M===E.near&&S===E.far||(i.updateRenderState({depthNear:E.near,depthFar:E.far}),M=E.near,S=E.far);const e=t.parent,r=E.cameras;I(E,e);for(let t=0;t<r.length;t++)I(r[t],e);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),t.matrix.copy(E.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const n=t.children;for(let t=0,e=n.length;t<e;t++)n[t].updateMatrixWorld(!0);2===r.length?function(t,e,r){D.setFromMatrixPosition(e.matrixWorld),R.setFromMatrixPosition(r.matrixWorld);const i=D.distanceTo(R),n=e.projectionMatrix.elements,s=r.projectionMatrix.elements,a=n[14]/(n[10]-1),o=n[14]/(n[10]+1),h=(n[9]+1)/n[5],u=(n[9]-1)/n[5],l=(n[8]-1)/n[0],c=(s[8]+1)/s[0],f=a*l,d=a*c,p=i/(-l+c),m=p*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+p,v=o+p,_=f-m,b=d+(i-m),y=h*o/v*g,x=u*o/v*g;t.projectionMatrix.makePerspective(_,b,y,x,g,v)}(E,y,x):E.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){return null!==l?l.fixedFoveation:null!==c?c.fixedFoveation:void 0},this.setFoveation=function(t){null!==l&&(l.fixedFoveation=t),null!==c&&void 0!==c.fixedFoveation&&(c.fixedFoveation=t)},this.getPlanes=function(){return _};let P=null;const N=new md;N.setAnimationLoop((function(e,i){if(h=i.getViewerPose(o||s),f=i,null!==h){const e=h.views;null!==c&&(t.setRenderTargetFramebuffer(m,c.framebuffer),t.setRenderTarget(m));let r=!1;e.length!==E.cameras.length&&(E.cameras.length=0,r=!0);for(let i=0;i<e.length;i++){const n=e[i];let s=null;if(null!==c)s=c.getViewport(n);else{const e=u.getViewSubImage(l,n);s=e.viewport,0===i&&(t.setRenderTargetTextures(m,e.colorTexture,l.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(m))}let a=w[i];void 0===a&&(a=new id,a.layers.enable(i),a.viewport=new Jl,w[i]=a),a.matrix.fromArray(n.transform.matrix),a.projectionMatrix.fromArray(n.projectionMatrix),a.viewport.set(s.x,s.y,s.width,s.height),0===i&&E.matrix.copy(a.matrix),!0===r&&E.cameras.push(a)}}for(let t=0;t<g.length;t++){const e=v[t],r=g[t];null!==e&&void 0!==r&&r.update(e,i,o||s)}if(P&&P(e,i),i.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:i.detectedPlanes});let t=null;for(const e of _)i.detectedPlanes.has(e)||(null===t&&(t=[]),t.push(e));if(null!==t)for(const e of t)_.delete(e),b.delete(e),r.dispatchEvent({type:"planeremoved",data:e});for(const t of i.detectedPlanes)if(_.has(t)){const e=b.get(t);t.lastChangedTime>e&&(b.set(t,t.lastChangedTime),r.dispatchEvent({type:"planechanged",data:t}))}else _.add(t),b.set(t,i.lastChangedTime),r.dispatchEvent({type:"planeadded",data:t})}f=null})),this.setAnimationLoop=function(t){P=t},this.dispose=function(){}}}function Wm(t,e){function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map),i.alphaMap&&(r.alphaMap.value=i.alphaMap),i.bumpMap&&(r.bumpMap.value=i.bumpMap,r.bumpScale.value=i.bumpScale,1===i.side&&(r.bumpScale.value*=-1)),i.displacementMap&&(r.displacementMap.value=i.displacementMap,r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap),i.normalMap&&(r.normalMap.value=i.normalMap,r.normalScale.value.copy(i.normalScale),1===i.side&&r.normalScale.value.negate()),i.specularMap&&(r.specularMap.value=i.specularMap),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);const n=e.get(i).envMap;if(n&&(r.envMap.value=n,r.flipEnvMap.value=n.isCubeTexture&&!1===n.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;const e=!0!==t.physicallyCorrectLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*e}let s,a;i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity),i.map?s=i.map:i.specularMap?s=i.specularMap:i.displacementMap?s=i.displacementMap:i.normalMap?s=i.normalMap:i.bumpMap?s=i.bumpMap:i.roughnessMap?s=i.roughnessMap:i.metalnessMap?s=i.metalnessMap:i.alphaMap?s=i.alphaMap:i.emissiveMap?s=i.emissiveMap:i.clearcoatMap?s=i.clearcoatMap:i.clearcoatNormalMap?s=i.clearcoatNormalMap:i.clearcoatRoughnessMap?s=i.clearcoatRoughnessMap:i.iridescenceMap?s=i.iridescenceMap:i.iridescenceThicknessMap?s=i.iridescenceThicknessMap:i.specularIntensityMap?s=i.specularIntensityMap:i.specularColorMap?s=i.specularColorMap:i.transmissionMap?s=i.transmissionMap:i.thicknessMap?s=i.thicknessMap:i.sheenColorMap?s=i.sheenColorMap:i.sheenRoughnessMap&&(s=i.sheenRoughnessMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),r.uvTransform.value.copy(s.matrix)),i.aoMap?a=i.aoMap:i.lightMap&&(a=i.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),r.uv2Transform.value.copy(a.matrix))}return{refreshFogUniforms:function(e,r){r.color.getRGB(e.fogColor.value,Qf(t)),r.isFog?(e.fogNear.value=r.near,e.fogFar.value=r.far):r.isFogExp2&&(e.fogDensity.value=r.density)},refreshMaterialUniforms:function(t,i,n,s,a){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(t,i):i.isMeshToonMaterial?(r(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(r(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(r(t,i),function(t,r){t.roughness.value=r.roughness,t.metalness.value=r.metalness,r.roughnessMap&&(t.roughnessMap.value=r.roughnessMap);r.metalnessMap&&(t.metalnessMap.value=r.metalnessMap);const i=e.get(r).envMap;i&&(t.envMapIntensity.value=r.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,r){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=r.texture,t.transmissionSamplerSize.value.set(r.width,r.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap);e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,i,a)):i.isMeshMatcapMaterial?(r(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?r(t,i):i.isMeshDistanceMaterial?(r(t,i),function(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?r(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,r,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*r,t.scale.value=.5*i,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i,n,s):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let r;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function qm(t,e,r,i){let n={},s={},a=[];const o=r.isWebGL2?t.getParameter(35375):0;function h(t,e,r){const i=t.value;if(void 0===r[e]){if("number"==typeof i)r[e]=i;else{const t=Array.isArray(i)?i:[i],n=[];for(let e=0;e<t.length;e++)n.push(t[e].clone());r[e]=n}return!0}if("number"==typeof i){if(r[e]!==i)return r[e]=i,!0}else{const t=Array.isArray(r[e])?r[e]:[r[e]],n=Array.isArray(i)?i:[i];for(let e=0;e<t.length;e++){const r=t[e];if(!1===r.equals(n[e]))return r.copy(n[e]),!0}}return!1}function u(t){const e={boundary:0,storage:0};return"number"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),e}function l(e){const r=e.target;r.removeEventListener("dispose",l);const i=a.indexOf(r.__bindingPointIndex);a.splice(i,1),t.deleteBuffer(n[r.id]),delete n[r.id],delete s[r.id]}return{bind:function(t,e){const r=e.program;i.uniformBlockBinding(t,r)},update:function(r,c){let f=n[r.id];void 0===f&&(!function(t){const e=t.uniforms;let r=0;const i=16;let n=0;for(let t=0,s=e.length;t<s;t++){const s=e[t],a={boundary:0,storage:0},o=Array.isArray(s.value)?s.value:[s.value];for(let t=0,e=o.length;t<e;t++){const e=u(o[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(s.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=r,t>0){n=r%i;0!==n&&i-n-a.boundary<0&&(r+=i-n,s.__offset=r)}r+=a.storage}n=r%i,n>0&&(r+=i-n);t.__size=r,t.__cache={}}(r),f=function(e){const r=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=r;const i=t.createBuffer(),n=e.__size,s=e.usage;return t.bindBuffer(35345,i),t.bufferData(35345,n,s),t.bindBuffer(35345,null),t.bindBufferBase(35345,r,i),i}(r),n[r.id]=f,r.addEventListener("dispose",l));const d=c.program;i.updateUBOMapping(r,d);const p=e.render.frame;s[r.id]!==p&&(!function(e){const r=n[e.id],i=e.uniforms,s=e.__cache;t.bindBuffer(35345,r);for(let e=0,r=i.length;e<r;e++){const r=i[e];if(!0===h(r,e,s)){const e=r.__offset,i=Array.isArray(r.value)?r.value:[r.value];let n=0;for(let s=0;s<i.length;s++){const a=i[s],o=u(a);"number"==typeof a?(r.__data[0]=a,t.bufferSubData(35345,e+n,r.__data)):a.isMatrix3?(r.__data[0]=a.elements[0],r.__data[1]=a.elements[1],r.__data[2]=a.elements[2],r.__data[3]=a.elements[0],r.__data[4]=a.elements[3],r.__data[5]=a.elements[4],r.__data[6]=a.elements[5],r.__data[7]=a.elements[0],r.__data[8]=a.elements[6],r.__data[9]=a.elements[7],r.__data[10]=a.elements[8],r.__data[11]=a.elements[0]):(a.toArray(r.__data,n),n+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,e,r.__data)}}t.bindBuffer(35345,null)}(r),s[r.id]=p)},dispose:function(){for(const e in n)t.deleteBuffer(n[e]);a=[],n={},s={}}}}function Xm(t={}){this.isWebGLRenderer=!0;const e=void 0!==t.canvas?t.canvas:function(){const t=kl("canvas");return t.style.display="block",t}(),r=void 0!==t.context?t.context:null,i=void 0===t.depth||t.depth,n=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,o=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,h=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let l;l=null!==r?r.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let c=null,f=null;const d=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ll,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const m=this;let g=!1,v=0,_=0,b=null,y=-1,x=null;const w=new Jl,E=new Jl;let M=null,S=e.width,A=e.height,T=1,C=null,D=null;const R=new Jl(0,0,S,A),I=new Jl(0,0,S,A);let P=!1;const N=new pd;let k=!1,B=!1,L=null;const O=new kc,F=new Rl,U=new ic,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return null===b?T:1}let H,j,V,W,q,X,Y,Z,$,K,J,Q,tt,et,rt,it,nt,st,at,ot,ht,ut,lt,ct,ft=r;function dt(t,r){for(let i=0;i<t.length;i++){const n=t[i],s=e.getContext(n,r);if(null!==s)return s}return null}try{const t={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Iu}`),e.addEventListener("webglcontextlost",gt,!1),e.addEventListener("webglcontextrestored",vt,!1),e.addEventListener("webglcontextcreationerror",_t,!1),null===ft){const e=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&e.shift(),ft=dt(e,t),null===ft)throw dt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ft.getShaderPrecisionFormat&&(ft.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function pt(){H=new Vd(ft),j=new Sd(ft,H,t),H.init(j),ut=new Fm(ft,H,j),V=new Lm(ft,H,j),W=new Xd,q=new wm,X=new Om(ft,H,V,q,j,ut,W),Y=new Td(m),Z=new jd(m),$=new gd(ft,j),lt=new Ed(ft,H,$,j),K=new Wd(ft,$,W,lt),J=new Kd(ft,K,$,W),at=new $d(ft,j,X),it=new Ad(q),Q=new xm(m,Y,Z,H,j,lt,it),tt=new Wm(m,q),et=new Am,rt=new Pm(H,j),st=new wd(m,Y,Z,V,J,l,a),nt=new Bm(m,J,j),ct=new qm(ft,W,j,V),ot=new Md(ft,H,W,j),ht=new qd(ft,H,W,j),W.programs=Q.programs,m.capabilities=j,m.extensions=H,m.properties=q,m.renderLists=et,m.shadowMap=nt,m.state=V,m.info=W}pt();const mt=new Vm(m,ft);function gt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=W.autoReset,e=nt.enabled,r=nt.autoUpdate,i=nt.needsUpdate,n=nt.type;pt(),W.autoReset=t,nt.enabled=e,nt.autoUpdate=r,nt.needsUpdate=i,nt.type=n}function _t(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function bt(t){const e=t.target;e.removeEventListener("dispose",bt),function(t){(function(t){const e=q.get(t).programs;void 0!==e&&(e.forEach((function(t){Q.releaseProgram(t)})),t.isShaderMaterial&&Q.releaseShaderCache(t))})(t),q.remove(t)}(e)}this.xr=mt,this.getContext=function(){return ft},this.getContextAttributes=function(){return ft.getContextAttributes()},this.forceContextLoss=function(){const t=H.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=H.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(t){void 0!==t&&(T=t,this.setSize(S,A,!1))},this.getSize=function(t){return t.set(S,A)},this.setSize=function(t,r,i){mt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=t,A=r,e.width=Math.floor(t*T),e.height=Math.floor(r*T),!1!==i&&(e.style.width=t+"px",e.style.height=r+"px"),this.setViewport(0,0,t,r))},this.getDrawingBufferSize=function(t){return t.set(S*T,A*T).floor()},this.setDrawingBufferSize=function(t,r,i){S=t,A=r,T=i,e.width=Math.floor(t*i),e.height=Math.floor(r*i),this.setViewport(0,0,t,r)},this.getCurrentViewport=function(t){return t.copy(w)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,r,i){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,r,i),V.viewport(w.copy(R).multiplyScalar(T).floor())},this.getScissor=function(t){return t.copy(I)},this.setScissor=function(t,e,r,i){t.isVector4?I.set(t.x,t.y,t.z,t.w):I.set(t,e,r,i),V.scissor(E.copy(I).multiplyScalar(T).floor())},this.getScissorTest=function(){return P},this.setScissorTest=function(t){V.setScissorTest(P=t)},this.setOpaqueSort=function(t){C=t},this.setTransparentSort=function(t){D=t},this.getClearColor=function(t){return t.copy(st.getClearColor())},this.setClearColor=function(){st.setClearColor.apply(st,arguments)},this.getClearAlpha=function(){return st.getClearAlpha()},this.setClearAlpha=function(){st.setClearAlpha.apply(st,arguments)},this.clear=function(t=!0,e=!0,r=!0){let i=0;t&&(i|=16384),e&&(i|=256),r&&(i|=1024),ft.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",gt,!1),e.removeEventListener("webglcontextrestored",vt,!1),e.removeEventListener("webglcontextcreationerror",_t,!1),et.dispose(),rt.dispose(),q.dispose(),Y.dispose(),Z.dispose(),J.dispose(),lt.dispose(),ct.dispose(),Q.dispose(),mt.dispose(),mt.removeEventListener("sessionstart",xt),mt.removeEventListener("sessionend",wt),L&&(L.dispose(),L=null),Et.stop()},this.renderBufferDirect=function(t,e,r,i,n,s){null===e&&(e=z);const a=n.isMesh&&n.matrixWorld.determinant()<0,o=function(t,e,r,i,n){!0!==e.isScene&&(e=z);X.resetTextureUnits();const s=e.fog,a=i.isMeshStandardMaterial?e.environment:null,o=null===b?m.outputEncoding:!0===b.isXRRenderTarget?b.texture.encoding:ll,h=(i.isMeshStandardMaterial?Z:Y).get(i.envMap||a),u=!0===i.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,l=!!i.normalMap&&!!r.attributes.tangent,c=!!r.morphAttributes.position,d=!!r.morphAttributes.normal,p=!!r.morphAttributes.color,g=i.toneMapped?m.toneMapping:0,v=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,_=void 0!==v?v.length:0,w=q.get(i),E=f.state.lights;if(!0===k&&(!0===B||t!==x)){const e=t===x&&i.id===y;it.setState(i,t,e)}let M=!1;i.version===w.__version?w.needsLights&&w.lightsStateVersion!==E.state.version||w.outputEncoding!==o||n.isInstancedMesh&&!1===w.instancing?M=!0:n.isInstancedMesh||!0!==w.instancing?n.isSkinnedMesh&&!1===w.skinning?M=!0:n.isSkinnedMesh||!0!==w.skinning?w.envMap!==h||!0===i.fog&&w.fog!==s?M=!0:void 0===w.numClippingPlanes||w.numClippingPlanes===it.numPlanes&&w.numIntersection===it.numIntersection?(w.vertexAlphas!==u||w.vertexTangents!==l||w.morphTargets!==c||w.morphNormals!==d||w.morphColors!==p||w.toneMapping!==g||!0===j.isWebGL2&&w.morphTargetsCount!==_)&&(M=!0):M=!0:M=!0:M=!0:(M=!0,w.__version=i.version);let S=w.currentProgram;!0===M&&(S=Ct(i,e,n));let C=!1,D=!1,R=!1;const I=S.getUniforms(),P=w.uniforms;V.useProgram(S.program)&&(C=!0,D=!0,R=!0);i.id!==y&&(y=i.id,D=!0);if(C||x!==t){if(I.setValue(ft,"projectionMatrix",t.projectionMatrix),j.logarithmicDepthBuffer&&I.setValue(ft,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),x!==t&&(x=t,D=!0,R=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=I.map.cameraPosition;void 0!==e&&e.setValue(ft,U.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&I.setValue(ft,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||n.isSkinnedMesh)&&I.setValue(ft,"viewMatrix",t.matrixWorldInverse)}if(n.isSkinnedMesh){I.setOptional(ft,n,"bindMatrix"),I.setOptional(ft,n,"bindMatrixInverse");const t=n.skeleton;t&&(j.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),I.setValue(ft,"boneTexture",t.boneTexture,X),I.setValue(ft,"boneTextureSize",t.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const N=r.morphAttributes;(void 0!==N.position||void 0!==N.normal||void 0!==N.color&&!0===j.isWebGL2)&&at.update(n,r,i,S);(D||w.receiveShadow!==n.receiveShadow)&&(w.receiveShadow=n.receiveShadow,I.setValue(ft,"receiveShadow",n.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(P.envMap.value=h,P.flipEnvMap.value=h.isCubeTexture&&!1===h.isRenderTargetTexture?-1:1);D&&(I.setValue(ft,"toneMappingExposure",m.toneMappingExposure),w.needsLights&&(F=R,(O=P).ambientLightColor.needsUpdate=F,O.lightProbe.needsUpdate=F,O.directionalLights.needsUpdate=F,O.directionalLightShadows.needsUpdate=F,O.pointLights.needsUpdate=F,O.pointLightShadows.needsUpdate=F,O.spotLights.needsUpdate=F,O.spotLightShadows.needsUpdate=F,O.rectAreaLights.needsUpdate=F,O.hemisphereLights.needsUpdate=F),s&&!0===i.fog&&tt.refreshFogUniforms(P,s),tt.refreshMaterialUniforms(P,i,T,A,L),em.upload(ft,w.uniformsList,P,X));var O,F;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(em.upload(ft,w.uniformsList,P,X),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&I.setValue(ft,"center",n.center);if(I.setValue(ft,"modelViewMatrix",n.modelViewMatrix),I.setValue(ft,"normalMatrix",n.normalMatrix),I.setValue(ft,"modelMatrix",n.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const t=i.uniformsGroups;for(let e=0,r=t.length;e<r;e++)if(j.isWebGL2){const r=t[e];ct.update(r,S),ct.bind(r,S)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return S}(t,e,r,i,n);V.setMaterial(i,a);let h=r.index,u=1;!0===i.wireframe&&(h=K.getWireframeAttribute(r),u=2);const l=r.drawRange,c=r.attributes.position;let d=l.start*u,p=(l.start+l.count)*u;null!==s&&(d=Math.max(d,s.start*u),p=Math.min(p,(s.start+s.count)*u)),null!==h?(d=Math.max(d,0),p=Math.min(p,h.count)):null!=c&&(d=Math.max(d,0),p=Math.min(p,c.count));const g=p-d;if(g<0||g===1/0)return;let v;lt.setup(n,i,o,r,h);let _=ot;if(null!==h&&(v=$.get(h),_=ht,_.setIndex(v)),n.isMesh)!0===i.wireframe?(V.setLineWidth(i.wireframeLinewidth*G()),_.setMode(1)):_.setMode(4);else if(n.isLine){let t=i.linewidth;void 0===t&&(t=1),V.setLineWidth(t*G()),n.isLineSegments?_.setMode(1):n.isLineLoop?_.setMode(2):_.setMode(3)}else n.isPoints?_.setMode(0):n.isSprite&&_.setMode(4);if(n.isInstancedMesh)_.renderInstances(d,g,n.count);else if(r.isInstancedBufferGeometry){const t=void 0!==r._maxInstanceCount?r._maxInstanceCount:1/0,e=Math.min(r.instanceCount,t);_.renderInstances(d,g,e)}else _.render(d,g)},this.compile=function(t,e){function r(t,e,r){!0===t.transparent&&3===t.side?(t.side=1,t.needsUpdate=!0,Ct(t,e,r),t.side=0,t.needsUpdate=!0,Ct(t,e,r),t.side=3):Ct(t,e,r)}f=rt.get(t),f.init(),p.push(f),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))})),f.setupLights(m.physicallyCorrectLights),t.traverse((function(e){const i=e.material;if(i)if(Array.isArray(i))for(let n=0;n<i.length;n++){r(i[n],t,e)}else r(i,t,e)})),p.pop(),f=null};let yt=null;function xt(){Et.stop()}function wt(){Et.start()}const Et=new md;function Mt(t,e,r,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||N.intersectsSprite(t)){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(O);const e=J.update(t),n=t.material;n.visible&&c.push(t,e,n,r,U.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==W.render.frame&&(t.skeleton.update(),t.skeleton.frame=W.render.frame),!t.frustumCulled||N.intersectsObject(t))){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(O);const e=J.update(t),n=t.material;if(Array.isArray(n)){const i=e.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=n[a.materialIndex];o&&o.visible&&c.push(t,e,o,r,U.z,a)}}else n.visible&&c.push(t,e,n,r,U.z,null)}const n=t.children;for(let t=0,s=n.length;t<s;t++)Mt(n[t],e,r,i)}function St(t,e,r,i){const n=t.opaque,a=t.transmissive,o=t.transparent;f.setupLightsView(r),a.length>0&&function(t,e,r){const i=j.isWebGL2;null===L&&(L=new Ql(1,1,{generateMipmaps:!0,type:H.has("EXT_color_buffer_half_float")?Zu:qu,minFilter:Wu,samples:i&&!0===s?4:0}));m.getDrawingBufferSize(F),i?L.setSize(F.x,F.y):L.setSize(Tl(F.x),Tl(F.y));const n=m.getRenderTarget();m.setRenderTarget(L),m.clear();const a=m.toneMapping;m.toneMapping=0,At(t,e,r),m.toneMapping=a,X.updateMultisampleRenderTarget(L),X.updateRenderTargetMipmap(L),m.setRenderTarget(n)}(n,e,r),i&&V.viewport(w.copy(i)),n.length>0&&At(n,e,r),a.length>0&&At(a,e,r),o.length>0&&At(o,e,r),V.buffers.depth.setTest(!0),V.buffers.depth.setMask(!0),V.buffers.color.setMask(!0),V.setPolygonOffset(!1)}function At(t,e,r){const i=!0===e.isScene?e.overrideMaterial:null;for(let n=0,s=t.length;n<s;n++){const s=t[n],a=s.object,o=s.geometry,h=null===i?s.material:i,u=s.group;a.layers.test(r.layers)&&Tt(a,e,r,o,h,u)}}function Tt(t,e,r,i,n,s){t.onBeforeRender(m,e,r,i,n,s),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),n.onBeforeRender(m,e,r,i,t,s),!0===n.transparent&&3===n.side?(n.side=1,n.needsUpdate=!0,m.renderBufferDirect(r,e,i,n,t,s),n.side=0,n.needsUpdate=!0,m.renderBufferDirect(r,e,i,n,t,s),n.side=3):m.renderBufferDirect(r,e,i,n,t,s),t.onAfterRender(m,e,r,i,n,s)}function Ct(t,e,r){!0!==e.isScene&&(e=z);const i=q.get(t),n=f.state.lights,s=f.state.shadowsArray,a=n.state.version,o=Q.getParameters(t,n.state,s,e,r),h=Q.getProgramCacheKey(o);let u=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?Z:Y).get(t.envMap||i.environment),void 0===u&&(t.addEventListener("dispose",bt),u=new Map,i.programs=u);let l=u.get(h);if(void 0!==l){if(i.currentProgram===l&&i.lightsStateVersion===a)return Dt(t,o),l}else o.uniforms=Q.getUniforms(t),t.onBuild(r,o,m),t.onBeforeCompile(o,m),l=Q.acquireProgram(o,h),u.set(h,l),i.uniforms=o.uniforms;const c=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(c.clippingPlanes=it.uniform),Dt(t,o),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=a,i.needsLights&&(c.ambientLightColor.value=n.state.ambient,c.lightProbe.value=n.state.probe,c.directionalLights.value=n.state.directional,c.directionalLightShadows.value=n.state.directionalShadow,c.spotLights.value=n.state.spot,c.spotLightShadows.value=n.state.spotShadow,c.rectAreaLights.value=n.state.rectArea,c.ltc_1.value=n.state.rectAreaLTC1,c.ltc_2.value=n.state.rectAreaLTC2,c.pointLights.value=n.state.point,c.pointLightShadows.value=n.state.pointShadow,c.hemisphereLights.value=n.state.hemi,c.directionalShadowMap.value=n.state.directionalShadowMap,c.directionalShadowMatrix.value=n.state.directionalShadowMatrix,c.spotShadowMap.value=n.state.spotShadowMap,c.spotLightMatrix.value=n.state.spotLightMatrix,c.spotLightMap.value=n.state.spotLightMap,c.pointShadowMap.value=n.state.pointShadowMap,c.pointShadowMatrix.value=n.state.pointShadowMatrix);const d=l.getUniforms(),p=em.seqWithValue(d.seq,c);return i.currentProgram=l,i.uniformsList=p,l}function Dt(t,e){const r=q.get(t);r.outputEncoding=e.outputEncoding,r.instancing=e.instancing,r.skinning=e.skinning,r.morphTargets=e.morphTargets,r.morphNormals=e.morphNormals,r.morphColors=e.morphColors,r.morphTargetsCount=e.morphTargetsCount,r.numClippingPlanes=e.numClippingPlanes,r.numIntersection=e.numClipIntersection,r.vertexAlphas=e.vertexAlphas,r.vertexTangents=e.vertexTangents,r.toneMapping=e.toneMapping}Et.setAnimationLoop((function(t){yt&&yt(t)})),"undefined"!=typeof self&&Et.setContext(self),this.setAnimationLoop=function(t){yt=t,mt.setAnimationLoop(t),null===t?Et.stop():Et.start()},mt.addEventListener("sessionstart",xt),mt.addEventListener("sessionend",wt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===mt.enabled&&!0===mt.isPresenting&&(!0===mt.cameraAutoUpdate&&mt.updateCamera(e),e=mt.getCamera()),!0===t.isScene&&t.onBeforeRender(m,t,e,b),f=rt.get(t,p.length),f.init(),p.push(f),O.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),N.setFromProjectionMatrix(O),B=this.localClippingEnabled,k=it.init(this.clippingPlanes,B,e),c=et.get(t,d.length),c.init(),d.push(c),Mt(t,e,0,m.sortObjects),c.finish(),!0===m.sortObjects&&c.sort(C,D),!0===k&&it.beginShadows();const r=f.state.shadowsArray;if(nt.render(r,t,e),!0===k&&it.endShadows(),!0===this.info.autoReset&&this.info.reset(),st.render(c,t),f.setupLights(m.physicallyCorrectLights),e.isArrayCamera){const r=e.cameras;for(let e=0,i=r.length;e<i;e++){const i=r[e];St(c,t,i,i.viewport)}}else St(c,t,e);null!==b&&(X.updateMultisampleRenderTarget(b),X.updateRenderTargetMipmap(b)),!0===t.isScene&&t.onAfterRender(m,t,e),lt.resetDefaultState(),y=-1,x=null,p.pop(),f=p.length>0?p[p.length-1]:null,d.pop(),c=d.length>0?d[d.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(t,e,r){q.get(t.texture).__webglTexture=e,q.get(t.depthTexture).__webglTexture=r;const i=q.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===r,i.__autoAllocateDepthBuffer||!0===H.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const r=q.get(t);r.__webglFramebuffer=e,r.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,r=0){b=t,v=e,_=r;let i=!0,n=null,s=!1,a=!1;if(t){const r=q.get(t);void 0!==r.__useDefaultFramebuffer?(V.bindFramebuffer(36160,null),i=!1):void 0===r.__webglFramebuffer?X.setupRenderTarget(t):r.__hasExternalTextures&&X.rebindTextures(t,q.get(t.texture).__webglTexture,q.get(t.depthTexture).__webglTexture);const o=t.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(a=!0);const h=q.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(n=h[e],s=!0):n=j.isWebGL2&&t.samples>0&&!1===X.useMultisampledRTT(t)?q.get(t).__webglMultisampledFramebuffer:h,w.copy(t.viewport),E.copy(t.scissor),M=t.scissorTest}else w.copy(R).multiplyScalar(T).floor(),E.copy(I).multiplyScalar(T).floor(),M=P;if(V.bindFramebuffer(36160,n)&&j.drawBuffers&&i&&V.drawBuffers(t,n),V.viewport(w),V.scissor(E),V.setScissorTest(M),s){const i=q.get(t.texture);ft.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,r)}else if(a){const i=q.get(t.texture),n=e||0;ft.framebufferTextureLayer(36160,36064,i.__webglTexture,r||0,n)}y=-1},this.readRenderTargetPixels=function(t,e,r,i,n,s,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){V.bindFramebuffer(36160,o);try{const a=t.texture,o=a.format,h=a.type;if(o!==Ku&&ut.convert(o)!==ft.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const u=h===Zu&&(H.has("EXT_color_buffer_half_float")||j.isWebGL2&&H.has("EXT_color_buffer_float"));if(!(h===qu||ut.convert(h)===ft.getParameter(35738)||h===Yu&&(j.isWebGL2||H.has("OES_texture_float")||H.has("WEBGL_color_buffer_float"))||u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-i&&r>=0&&r<=t.height-n&&ft.readPixels(e,r,i,n,ut.convert(o),ut.convert(h),s)}finally{const t=null!==b?q.get(b).__webglFramebuffer:null;V.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,r=0){const i=Math.pow(2,-r),n=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i);X.setTexture2D(e,0),ft.copyTexSubImage2D(3553,r,0,0,t.x,t.y,n,s),V.unbindTexture()},this.copyTextureToTexture=function(t,e,r,i=0){const n=e.image.width,s=e.image.height,a=ut.convert(r.format),o=ut.convert(r.type);X.setTexture2D(r,0),ft.pixelStorei(37440,r.flipY),ft.pixelStorei(37441,r.premultiplyAlpha),ft.pixelStorei(3317,r.unpackAlignment),e.isDataTexture?ft.texSubImage2D(3553,i,t.x,t.y,n,s,a,o,e.image.data):e.isCompressedTexture?ft.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):ft.texSubImage2D(3553,i,t.x,t.y,a,o,e.image),0===i&&r.generateMipmaps&&ft.generateMipmap(3553),V.unbindTexture()},this.copyTextureToTexture3D=function(t,e,r,i,n=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,o=t.max.z-t.min.z+1,h=ut.convert(i.format),u=ut.convert(i.type);let l;if(i.isData3DTexture)X.setTexture3D(i,0),l=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");X.setTexture2DArray(i,0),l=35866}ft.pixelStorei(37440,i.flipY),ft.pixelStorei(37441,i.premultiplyAlpha),ft.pixelStorei(3317,i.unpackAlignment);const c=ft.getParameter(3314),f=ft.getParameter(32878),d=ft.getParameter(3316),p=ft.getParameter(3315),g=ft.getParameter(32877),v=r.isCompressedTexture?r.mipmaps[0]:r.image;ft.pixelStorei(3314,v.width),ft.pixelStorei(32878,v.height),ft.pixelStorei(3316,t.min.x),ft.pixelStorei(3315,t.min.y),ft.pixelStorei(32877,t.min.z),r.isDataTexture||r.isData3DTexture?ft.texSubImage3D(l,n,e.x,e.y,e.z,s,a,o,h,u,v.data):r.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ft.compressedTexSubImage3D(l,n,e.x,e.y,e.z,s,a,o,h,v.data)):ft.texSubImage3D(l,n,e.x,e.y,e.z,s,a,o,h,u,v),ft.pixelStorei(3314,c),ft.pixelStorei(32878,f),ft.pixelStorei(3316,d),ft.pixelStorei(3315,p),ft.pixelStorei(32877,g),0===n&&i.generateMipmaps&&ft.generateMipmap(l),V.unbindTexture()},this.initTexture=function(t){t.isCubeTexture?X.setTextureCube(t,0):t.isData3DTexture?X.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?X.setTexture2DArray(t,0):X.setTexture2D(t,0),V.unbindTexture()},this.resetState=function(){v=0,_=0,b=null,V.reset(),lt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Xm{}).prototype.isWebGL1Renderer=!0;class Ym extends bf{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Wl(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const Zm=new ic,$m=new ic,Km=new kc,Jm=new Nc,Qm=new Sc;class tg extends af{constructor(t=new kf,e=new Ym){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,r=[0];for(let t=1,i=e.count;t<i;t++)Zm.fromBufferAttribute(e,t-1),$m.fromBufferAttribute(e,t),r[t]=r[t-1],r[t]+=Zm.distanceTo($m);t.setAttribute("lineDistance",new Af(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const r=this.geometry,i=this.matrixWorld,n=t.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Qm.copy(r.boundingSphere),Qm.applyMatrix4(i),Qm.radius+=n,!1===t.ray.intersectsSphere(Qm))return;Km.copy(i).invert(),Jm.copy(t.ray).applyMatrix4(Km);const a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,h=new ic,u=new ic,l=new ic,c=new ic,f=this.isLineSegments?2:1,d=r.index,p=r.attributes.position;if(null!==d){for(let r=Math.max(0,s.start),i=Math.min(d.count,s.start+s.count)-1;r<i;r+=f){const i=d.getX(r),n=d.getX(r+1);h.fromBufferAttribute(p,i),u.fromBufferAttribute(p,n);if(Jm.distanceSqToSegment(h,u,c,l)>o)continue;c.applyMatrix4(this.matrixWorld);const s=t.ray.origin.distanceTo(c);s<t.near||s>t.far||e.push({distance:s,point:l.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,s.start),i=Math.min(p.count,s.start+s.count)-1;r<i;r+=f){h.fromBufferAttribute(p,r),u.fromBufferAttribute(p,r+1);if(Jm.distanceSqToSegment(h,u,c,l)>o)continue;c.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(c);i<t.near||i>t.far||e.push({distance:i,point:l.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const r=t[e[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=r.length;t<e;t++){const e=r[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const eg=new ic,rg=new ic;class ig extends tg{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,r=[];for(let t=0,i=e.count;t<i;t+=2)eg.fromBufferAttribute(e,t),rg.fromBufferAttribute(e,t+1),r[t]=0===t?0:r[t-1],r[t+1]=r[t]+eg.distanceTo(rg);t.setAttribute("lineDistance",new Af(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}function ng(t,e,r){return ag(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)}function sg(t,e,r){return!t||!r&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function ag(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class og{constructor(t,e,r,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(r),this.sampleValues=e,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let r=this._cachedIndex,i=e[r],n=e[r-1];t:{e:{let s;r:{i:if(!(t<i)){for(let s=r+2;;){if(void 0===i){if(t<n)break i;return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(n=i,i=e[++r],t<i)break e}s=e.length;break r}if(t>=n)break t;{const a=e[1];t<a&&(r=2,n=a);for(let s=r-2;;){if(void 0===n)return this._cachedIndex=0,this.copySampleValue_(0);if(r===s)break;if(i=n,n=e[--r-1],t>=n)break e}s=r,r=0}}for(;r<s;){const i=r+s>>>1;t<e[i]?s=i:r=i+1}if(i=e[r],n=e[r-1],void 0===n)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return r=e.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=t*i;for(let t=0;t!==i;++t)e[t]=r[n+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class hg extends og{constructor(t,e,r,i){super(t,e,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ol,endingEnd:ol}}intervalChanged_(t,e,r){const i=this.parameterPositions;let n=t-2,s=t+1,a=i[n],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case hl:n=t,a=2*e-r;break;case ul:n=i.length-2,a=e+i[n]-i[n+1];break;default:n=t,a=r}if(void 0===o)switch(this.getSettings_().endingEnd){case hl:s=t,o=2*r-e;break;case ul:s=1,o=r+i[1]-i[0];break;default:s=t-1,o=e}const h=.5*(r-e),u=this.valueSize;this._weightPrev=h/(e-a),this._weightNext=h/(o-r),this._offsetPrev=n*u,this._offsetNext=s*u}interpolate_(t,e,r,i){const n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,h=o-a,u=this._offsetPrev,l=this._offsetNext,c=this._weightPrev,f=this._weightNext,d=(r-e)/(i-e),p=d*d,m=p*d,g=-c*m+2*c*p-c*d,v=(1+c)*m+(-1.5-2*c)*p+(-.5+c)*d+1,_=(-1-f)*m+(1.5+f)*p+.5*d,b=f*m-f*p;for(let t=0;t!==a;++t)n[t]=g*s[u+t]+v*s[h+t]+_*s[o+t]+b*s[l+t];return n}}class ug extends og{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t,e,r,i){const n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,h=o-a,u=(r-e)/(i-e),l=1-u;for(let t=0;t!==a;++t)n[t]=s[h+t]*l+s[o+t]*u;return n}}class lg extends og{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class cg{constructor(t,e,r,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=sg(e,this.TimeBufferType),this.values=sg(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let r;if(e.toJSON!==this.toJSON)r=e.toJSON(t);else{r={name:t.name,times:sg(t.times,Array),values:sg(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(r.interpolation=e)}return r.type=t.ValueTypeName,r}InterpolantFactoryMethodDiscrete(t){return new lg(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new ug(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new hg(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case nl:e=this.InterpolantFactoryMethodDiscrete;break;case sl:e=this.InterpolantFactoryMethodLinear;break;case al:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nl;case this.InterpolantFactoryMethodLinear:return sl;case this.InterpolantFactoryMethodSmooth:return al}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let r=0,i=e.length;r!==i;++r)e[r]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let r=0,i=e.length;r!==i;++r)e[r]*=t}return this}trim(t,e){const r=this.times,i=r.length;let n=0,s=i-1;for(;n!==i&&r[n]<t;)++n;for(;-1!==s&&r[s]>e;)--s;if(++s,0!==n||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);const t=this.getValueSize();this.times=ng(r,n,s),this.values=ng(this.values,n*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const r=this.times,i=this.values,n=r.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let e=0;e!==n;e++){const i=r[e];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,i),t=!1;break}if(null!==s&&s>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,i,s),t=!1;break}s=i}if(void 0!==i&&ag(i))for(let e=0,r=i.length;e!==r;++e){const r=i[e];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,r),t=!1;break}}return t}optimize(){const t=ng(this.times),e=ng(this.values),r=this.getValueSize(),i=this.getInterpolation()===al,n=t.length-1;let s=1;for(let a=1;a<n;++a){let n=!1;const o=t[a];if(o!==t[a+1]&&(1!==a||o!==t[0]))if(i)n=!0;else{const t=a*r,i=t-r,s=t+r;for(let a=0;a!==r;++a){const r=e[t+a];if(r!==e[i+a]||r!==e[s+a]){n=!0;break}}}if(n){if(a!==s){t[s]=t[a];const i=a*r,n=s*r;for(let t=0;t!==r;++t)e[n+t]=e[i+t]}++s}}if(n>0){t[s]=t[n];for(let t=n*r,i=s*r,a=0;a!==r;++a)e[i+a]=e[t+a];++s}return s!==t.length?(this.times=ng(t,0,s),this.values=ng(e,0,s*r)):(this.times=t,this.values=e),this}clone(){const t=ng(this.times,0),e=ng(this.values,0),r=new(0,this.constructor)(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}cg.prototype.TimeBufferType=Float32Array,cg.prototype.ValueBufferType=Float32Array,cg.prototype.DefaultInterpolation=sl;class fg extends cg{}fg.prototype.ValueTypeName="bool",fg.prototype.ValueBufferType=Array,fg.prototype.DefaultInterpolation=nl,fg.prototype.InterpolantFactoryMethodLinear=void 0,fg.prototype.InterpolantFactoryMethodSmooth=void 0;class dg extends cg{}dg.prototype.ValueTypeName="color";class pg extends cg{}pg.prototype.ValueTypeName="number";class mg extends og{constructor(t,e,r,i){super(t,e,r,i)}interpolate_(t,e,r,i){const n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-e)/(i-e);let h=t*a;for(let t=h+a;h!==t;h+=4)rc.slerpFlat(n,0,s,h-a,s,h,o);return n}}class gg extends cg{InterpolantFactoryMethodLinear(t){return new mg(this.times,this.values,this.getValueSize(),t)}}gg.prototype.ValueTypeName="quaternion",gg.prototype.DefaultInterpolation=sl,gg.prototype.InterpolantFactoryMethodSmooth=void 0;class vg extends cg{}vg.prototype.ValueTypeName="string",vg.prototype.ValueBufferType=Array,vg.prototype.DefaultInterpolation=nl,vg.prototype.InterpolantFactoryMethodLinear=void 0,vg.prototype.InterpolantFactoryMethodSmooth=void 0;class _g extends cg{}_g.prototype.ValueTypeName="vector";class bg extends Error{constructor(t,e){super(t),this.response=e}}const yg="\\[\\]\\.:\\/",xg=new RegExp("["+yg+"]","g"),wg="[^"+yg+"]",Eg="[^"+yg.replace("\\.","")+"]",Mg=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",wg)+/(WCOD+)?/.source.replace("WCOD",Eg)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",wg)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",wg)+"$"),Sg=["material","materials","bones","map"];class Ag{constructor(t,e,r){this.path=e,this.parsedPath=r||Ag.parseTrackName(e),this.node=Ag.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,r){return t&&t.isAnimationObjectGroup?new Ag.Composite(t,e,r):new Ag(t,e,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(xg,"")}static parseTrackName(t){const e=Mg.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=r.nodeName.substring(i+1);-1!==Sg.indexOf(t)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=t)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(void 0!==r)return r}if(t.children){const r=function(t){for(let i=0;i<t.length;i++){const n=t[i];if(n.name===e||n.uuid===e)return n;const s=r(n.children);if(s)return s}return null},i=r(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)t[e++]=r[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,r=e.objectName,i=e.propertyName;let n=e.propertyIndex;if(t||(t=Ag.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let i=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const s=t[i];if(void 0===s){const r=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+i+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[n]&&(n=t.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ag.Composite=class{constructor(t,e,r){const i=r||Ag.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(t,e)}setValue(t,e){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}},Ag.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ag.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ag.prototype.GetterByBindingType=[Ag.prototype._getValue_direct,Ag.prototype._getValue_array,Ag.prototype._getValue_arrayElement,Ag.prototype._getValue_toArray],Ag.prototype.SetterByBindingTypeAndVersioning=[[Ag.prototype._setValue_direct,Ag.prototype._setValue_direct_setNeedsUpdate,Ag.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ag.prototype._setValue_array,Ag.prototype._setValue_array_setNeedsUpdate,Ag.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ag.prototype._setValue_arrayElement,Ag.prototype._setValue_arrayElement_setNeedsUpdate,Ag.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ag.prototype._setValue_fromArray,Ag.prototype._setValue_fromArray_setNeedsUpdate,Ag.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class Tg extends ig{constructor(t=10,e=10,r=4473924,i=8947848){r=new Wl(r),i=new Wl(i);const n=e/2,s=t/e,a=t/2,o=[],h=[];for(let t=0,u=0,l=-a;t<=e;t++,l+=s){o.push(-a,0,l,a,0,l),o.push(l,0,-a,l,0,a);const e=t===n?r:i;e.toArray(h,u),u+=3,e.toArray(h,u),u+=3,e.toArray(h,u),u+=3,e.toArray(h,u),u+=3}const u=new kf;u.setAttribute("position",new Af(o,3)),u.setAttribute("color",new Af(h,3));super(u,new Ym({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Cg extends ig{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],r=new kf;r.setAttribute("position",new Af(e,3)),r.setAttribute("color",new Af([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(r,new Ym({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,r){const i=new Wl,n=this.geometry.attributes.color.array;return i.set(t),i.toArray(n,0),i.toArray(n,3),i.set(e),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Iu}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Iu)
/*!
 * @pixi-essentials/svg - v1.1.4
 * Compiled Sun, 11 Jul 2021 02:38:02 UTC
 *
 * @pixi-essentials/svg is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, Shukant K. Pal <shukantpal@outlook.com>, All Rights Reserved
 */;var Dg={};!function(t){var e=/^\s+/,r=/\s+$/,i=0,n=t.round,s=t.min,a=t.max,o=t.random;function h(o,u){if(u=u||{},(o=o||"")instanceof h)return o;if(!(this instanceof h))return new h(o,u);var l=function(i){var n={r:0,g:0,b:0},o=1,h=null,u=null,l=null,c=!1,f=!1;"string"==typeof i&&(i=function(t){t=t.replace(e,"").replace(r,"").toLowerCase();var i,n=!1;if(A[t])t=A[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(i=U.rgb.exec(t))?{r:i[1],g:i[2],b:i[3]}:(i=U.rgba.exec(t))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=U.hsl.exec(t))?{h:i[1],s:i[2],l:i[3]}:(i=U.hsla.exec(t))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=U.hsv.exec(t))?{h:i[1],s:i[2],v:i[3]}:(i=U.hsva.exec(t))?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=U.hex8.exec(t))?{r:I(i[1]),g:I(i[2]),b:I(i[3]),a:B(i[4]),format:n?"name":"hex8"}:(i=U.hex6.exec(t))?{r:I(i[1]),g:I(i[2]),b:I(i[3]),format:n?"name":"hex"}:(i=U.hex4.exec(t))?{r:I(i[1]+""+i[1]),g:I(i[2]+""+i[2]),b:I(i[3]+""+i[3]),a:B(i[4]+""+i[4]),format:n?"name":"hex8"}:!!(i=U.hex3.exec(t))&&{r:I(i[1]+""+i[1]),g:I(i[2]+""+i[2]),b:I(i[3]+""+i[3]),format:n?"name":"hex"}}(i));"object"==typeof i&&(z(i.r)&&z(i.g)&&z(i.b)?(n=function(t,e,r){return{r:255*D(t,255),g:255*D(e,255),b:255*D(r,255)}}(i.r,i.g,i.b),c=!0,f="%"===String(i.r).substr(-1)?"prgb":"rgb"):z(i.h)&&z(i.s)&&z(i.v)?(h=N(i.s),u=N(i.v),n=function(e,r,i){e=6*D(e,360),r=D(r,100),i=D(i,100);var n=t.floor(e),s=e-n,a=i*(1-r),o=i*(1-s*r),h=i*(1-(1-s)*r),u=n%6,l=[i,o,a,a,h,i][u],c=[h,i,i,o,a,a][u],f=[a,a,h,i,i,o][u];return{r:255*l,g:255*c,b:255*f}}(i.h,h,u),c=!0,f="hsv"):z(i.h)&&z(i.s)&&z(i.l)&&(h=N(i.s),l=N(i.l),n=function(t,e,r){var i,n,s;function a(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}if(t=D(t,360),e=D(e,100),r=D(r,100),0===e)i=n=s=r;else{var o=r<.5?r*(1+e):r+e-r*e,h=2*r-o;i=a(h,o,t+1/3),n=a(h,o,t),s=a(h,o,t-1/3)}return{r:255*i,g:255*n,b:255*s}}(i.h,h,l),c=!0,f="hsl"),i.hasOwnProperty("a")&&(o=i.a));return o=C(o),{ok:c,format:i.format||f,r:s(255,a(n.r,0)),g:s(255,a(n.g,0)),b:s(255,a(n.b,0)),a:o}}(o);this._originalInput=o,this._r=l.r,this._g=l.g,this._b=l.b,this._a=l.a,this._roundA=n(100*this._a)/100,this._format=u.format||l.format,this._gradientType=u.gradientType,this._r<1&&(this._r=n(this._r)),this._g<1&&(this._g=n(this._g)),this._b<1&&(this._b=n(this._b)),this._ok=l.ok,this._tc_id=i++}function u(t,e,r){t=D(t,255),e=D(e,255),r=D(r,255);var i,n,o=a(t,e,r),h=s(t,e,r),u=(o+h)/2;if(o==h)i=n=0;else{var l=o-h;switch(n=u>.5?l/(2-o-h):l/(o+h),o){case t:i=(e-r)/l+(e<r?6:0);break;case e:i=(r-t)/l+2;break;case r:i=(t-e)/l+4}i/=6}return{h:i,s:n,l:u}}function l(t,e,r){t=D(t,255),e=D(e,255),r=D(r,255);var i,n,o=a(t,e,r),h=s(t,e,r),u=o,l=o-h;if(n=0===o?0:l/o,o==h)i=0;else{switch(o){case t:i=(e-r)/l+(e<r?6:0);break;case e:i=(r-t)/l+2;break;case r:i=(t-e)/l+4}i/=6}return{h:i,s:n,v:u}}function c(t,e,r,i){var s=[P(n(t).toString(16)),P(n(e).toString(16)),P(n(r).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function f(t,e,r,i){return[P(k(i)),P(n(t).toString(16)),P(n(e).toString(16)),P(n(r).toString(16))].join("")}function d(t,e){e=0===e?0:e||10;var r=h(t).toHsl();return r.s-=e/100,r.s=R(r.s),h(r)}function p(t,e){e=0===e?0:e||10;var r=h(t).toHsl();return r.s+=e/100,r.s=R(r.s),h(r)}function m(t){return h(t).desaturate(100)}function g(t,e){e=0===e?0:e||10;var r=h(t).toHsl();return r.l+=e/100,r.l=R(r.l),h(r)}function v(t,e){e=0===e?0:e||10;var r=h(t).toRgb();return r.r=a(0,s(255,r.r-n(-e/100*255))),r.g=a(0,s(255,r.g-n(-e/100*255))),r.b=a(0,s(255,r.b-n(-e/100*255))),h(r)}function _(t,e){e=0===e?0:e||10;var r=h(t).toHsl();return r.l-=e/100,r.l=R(r.l),h(r)}function b(t,e){var r=h(t).toHsl(),i=(r.h+e)%360;return r.h=i<0?360+i:i,h(r)}function y(t){var e=h(t).toHsl();return e.h=(e.h+180)%360,h(e)}function x(t){var e=h(t).toHsl(),r=e.h;return[h(t),h({h:(r+120)%360,s:e.s,l:e.l}),h({h:(r+240)%360,s:e.s,l:e.l})]}function w(t){var e=h(t).toHsl(),r=e.h;return[h(t),h({h:(r+90)%360,s:e.s,l:e.l}),h({h:(r+180)%360,s:e.s,l:e.l}),h({h:(r+270)%360,s:e.s,l:e.l})]}function E(t){var e=h(t).toHsl(),r=e.h;return[h(t),h({h:(r+72)%360,s:e.s,l:e.l}),h({h:(r+216)%360,s:e.s,l:e.l})]}function M(t,e,r){e=e||6,r=r||30;var i=h(t).toHsl(),n=360/r,s=[h(t)];for(i.h=(i.h-(n*e>>1)+720)%360;--e;)i.h=(i.h+n)%360,s.push(h(i));return s}function S(t,e){e=e||6;for(var r=h(t).toHsv(),i=r.h,n=r.s,s=r.v,a=[],o=1/e;e--;)a.push(h({h:i,s:n,v:s})),s=(s+o)%1;return a}h.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var e,r,i,n=this.toRgb();return e=n.r/255,r=n.g/255,i=n.b/255,.2126*(e<=.03928?e/12.92:t.pow((e+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:t.pow((r+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:t.pow((i+.055)/1.055,2.4))},setAlpha:function(t){return this._a=C(t),this._roundA=n(100*this._a)/100,this},toHsv:function(){var t=l(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=l(this._r,this._g,this._b),e=n(360*t.h),r=n(100*t.s),i=n(100*t.v);return 1==this._a?"hsv("+e+", "+r+"%, "+i+"%)":"hsva("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=u(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=u(this._r,this._g,this._b),e=n(360*t.h),r=n(100*t.s),i=n(100*t.l);return 1==this._a?"hsl("+e+", "+r+"%, "+i+"%)":"hsla("+e+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return c(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,r,i,s){var a=[P(n(t).toString(16)),P(n(e).toString(16)),P(n(r).toString(16)),P(k(i))];return s&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:n(this._r),g:n(this._g),b:n(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+n(this._r)+", "+n(this._g)+", "+n(this._b)+")":"rgba("+n(this._r)+", "+n(this._g)+", "+n(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:n(100*D(this._r,255))+"%",g:n(100*D(this._g,255))+"%",b:n(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+n(100*D(this._r,255))+"%, "+n(100*D(this._g,255))+"%, "+n(100*D(this._b,255))+"%)":"rgba("+n(100*D(this._r,255))+"%, "+n(100*D(this._g,255))+"%, "+n(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(T[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+f(this._r,this._g,this._b,this._a),r=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var n=h(t);r="#"+f(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+r+")"},toString:function(t){var e=!!t;t=t||this._format;var r=!1,i=this._a<1&&this._a>=0;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(r=this.toRgbString()),"prgb"===t&&(r=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(r=this.toHexString()),"hex3"===t&&(r=this.toHexString(!0)),"hex4"===t&&(r=this.toHex8String(!0)),"hex8"===t&&(r=this.toHex8String()),"name"===t&&(r=this.toName()),"hsl"===t&&(r=this.toHslString()),"hsv"===t&&(r=this.toHsvString()),r||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return h(this.toString())},_applyModification:function(t,e){var r=t.apply(null,[this].concat([].slice.call(e)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(g,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(d,arguments)},saturate:function(){return this._applyModification(p,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(M,arguments)},complement:function(){return this._applyCombination(y,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(E,arguments)},triad:function(){return this._applyCombination(x,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},h.fromRatio=function(t,e){if("object"==typeof t){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]="a"===i?t[i]:N(t[i]));t=r}return h(t,e)},h.equals=function(t,e){return!(!t||!e)&&h(t).toRgbString()==h(e).toRgbString()},h.random=function(){return h.fromRatio({r:o(),g:o(),b:o()})},h.mix=function(t,e,r){r=0===r?0:r||50;var i=h(t).toRgb(),n=h(e).toRgb(),s=r/100;return h({r:(n.r-i.r)*s+i.r,g:(n.g-i.g)*s+i.g,b:(n.b-i.b)*s+i.b,a:(n.a-i.a)*s+i.a})},h.readability=function(e,r){var i=h(e),n=h(r);return(t.max(i.getLuminance(),n.getLuminance())+.05)/(t.min(i.getLuminance(),n.getLuminance())+.05)},h.isReadable=function(t,e,r){var i,n,s=h.readability(t,e);switch(n=!1,(i=function(t){var e,r;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==r&&"large"!==r&&(r="small");return{level:e,size:r}}(r)).level+i.size){case"AAsmall":case"AAAlarge":n=s>=4.5;break;case"AAlarge":n=s>=3;break;case"AAAsmall":n=s>=7}return n},h.mostReadable=function(t,e,r){var i,n,s,a,o=null,u=0;n=(r=r||{}).includeFallbackColors,s=r.level,a=r.size;for(var l=0;l<e.length;l++)(i=h.readability(t,e[l]))>u&&(u=i,o=h(e[l]));return h.isReadable(t,o,{level:s,size:a})||!n?o:(r.includeFallbackColors=!1,h.mostReadable(t,["#fff","#000"],r))};var A=h.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},T=h.hexNames=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}(A);function C(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function D(e,r){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(e)&&(e="100%");var i=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(e);return e=s(r,a(0,parseFloat(e))),i&&(e=parseInt(e*r,10)/100),t.abs(e-r)<1e-6?1:e%r/parseFloat(r)}function R(t){return s(1,a(0,t))}function I(t){return parseInt(t,16)}function P(t){return 1==t.length?"0"+t:""+t}function N(t){return t<=1&&(t=100*t+"%"),t}function k(e){return t.round(255*parseFloat(e)).toString(16)}function B(t){return I(t)/255}var L,O,F,U=(O="[\\s|\\(]+("+(L="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",F="[\\s|\\(]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",{CSS_UNIT:new RegExp(L),rgb:new RegExp("rgb"+O),rgba:new RegExp("rgba"+F),hsl:new RegExp("hsl"+O),hsla:new RegExp("hsla"+F),hsv:new RegExp("hsv"+O),hsva:new RegExp("hsva"+F),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function z(t){return!!U.CSS_UNIT.exec(t)}Dg?Dg=h:"function"==typeof define&&define.amd?define((function(){return h})):window.tinycolor=h}(Math);new Kr,new Kr;var Rg,Ig={};function Pg(t,e){return t.b===e.b&&t.a===e.a}function Ng(t,e){return t.b<e.b||t.b===e.b&&t.a<=e.a}function kg(t,e,r){var i=e.b-t.b,n=r.b-e.b;return 0<i+n?i<n?e.a-t.a+i/(i+n)*(t.a-r.a):e.a-r.a+n/(i+n)*(r.a-t.a):0}function Bg(t,e,r){var i=e.b-t.b,n=r.b-e.b;return 0<i+n?(e.a-r.a)*i+(e.a-t.a)*n:0}function Lg(t,e){return t.a<e.a||t.a===e.a&&t.b<=e.b}function Og(t,e,r){var i=e.a-t.a,n=r.a-e.a;return 0<i+n?i<n?e.b-t.b+i/(i+n)*(t.b-r.b):e.b-r.b+n/(i+n)*(r.b-t.b):0}function Fg(t,e,r){var i=e.a-t.a,n=r.a-e.a;return 0<i+n?(e.b-r.b)*i+(e.b-t.b)*n:0}function Ug(t){return Ng(t.b.a,t.a)}function zg(t){return Ng(t.a,t.b.a)}function Gg(t,e,r,i){return(t=0>t?0:t)<=(r=0>r?0:r)?0===r?(e+i)/2:e+t/(t+r)*(i-e):i+r/(t+r)*(e-i)}function Hg(t){var e=Xg(t.b);return Zg(e,t.c),Zg(e.b,t.c),$g(e,t.a),e}function jg(t,e){var r=!1,i=!1;t!==e&&(e.a!==t.a&&(i=!0,Jg(e.a,t.a)),e.d!==t.d&&(r=!0,Qg(e.d,t.d)),Yg(e,t),i||(Zg(e,t.a),t.a.c=t),r||($g(e,t.d),t.d.a=t))}function Vg(t){var e=t.b,r=!1;t.d!==t.b.d&&(r=!0,Qg(t.d,t.b.d)),t.c===t?Jg(t.a,null):(t.b.d.a=Dv(t),t.a.c=t.c,Yg(t,Dv(t)),r||$g(t,t.d)),e.c===e?(Jg(e.a,null),Qg(e.d,null)):(t.d.a=Dv(e),e.a.c=e.c,Yg(e,Dv(e))),Kg(t)}function Wg(t){var e=Xg(t),r=e.b;return Yg(e,t.e),e.a=t.b.a,Zg(r,e.a),e.d=r.d=t.d,e=e.b,Yg(t.b,Dv(t.b)),Yg(t.b,e),t.b.a=e.a,e.b.a.c=e.b,e.b.d=t.b.d,e.f=t.f,e.b.f=t.b.f,e}function qg(t,e){var r=!1,i=Xg(t),n=i.b;return e.d!==t.d&&(r=!0,Qg(e.d,t.d)),Yg(i,t.e),Yg(n,e),i.a=t.b.a,n.a=e.a,i.d=n.d=t.d,t.d.a=n,r||$g(i,t.d),i}function Xg(t){var e=new Cv,r=new Cv,i=t.b.h;return r.h=i,i.b.h=e,e.h=t,t.b.h=r,e.b=r,e.c=e,e.e=r,r.b=e,r.c=r,r.e=e}function Yg(t,e){var r=t.c,i=e.c;r.b.e=e,i.b.e=t,t.c=i,e.c=r}function Zg(t,e){var r=e.f,i=new Iv(e,r);r.e=i,e.f=i,r=i.c=t;do{r.a=i,r=r.c}while(r!==t)}function $g(t,e){var r=e.d,i=new Tv(e,r);r.b=i,e.d=i,i.a=t,i.c=e.c,r=t;do{r.d=i,r=r.e}while(r!==t)}function Kg(t){var e=t.h;t=t.b.h,e.b.h=t,t.b.h=e}function Jg(t,e){var r=t.c,i=r;do{i.a=e,i=i.c}while(i!==r);r=t.f,(i=t.e).f=r,r.e=i}function Qg(t,e){var r=t.a,i=r;do{i.d=e,i=i.e}while(i!==r);r=t.d,(i=t.b).d=r,r.b=i}function tv(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e}var ev=4e150;function rv(t,e){t.f+=e.f,t.b.f+=e.b.f}function iv(t,e,r){return t=t.a,e=e.a,r=r.a,e.b.a===t?r.b.a===t?Ng(e.a,r.a)?0>=Bg(r.b.a,e.a,r.a):0<=Bg(e.b.a,r.a,e.a):0>=Bg(r.b.a,t,r.a):r.b.a===t?0<=Bg(e.b.a,t,e.a):(e=kg(e.b.a,t,e.a))>=(t=kg(r.b.a,t,r.a))}function nv(t){t.a.i=null;var e=t.e;e.a.c=e.c,e.c.a=e.a,t.e=null}function sv(t,e){Vg(t.a),t.c=!1,t.a=e,e.i=t}function av(t){var e=t.a.a;do{t=jv(t)}while(t.a.a===e);return t.c&&(sv(t,e=qg(Hv(t).a.b,t.a.e)),t=jv(t)),t}function ov(t,e,r){var i=new Gv;return i.a=r,i.e=xv(t.f,e.e,i),r.i=i}function hv(t,e){switch(t.s){case 100130:return 0!=(1&e);case 100131:return 0!==e;case 100132:return 0<e;case 100133:return 0>e;case 100134:return 2<=e||-2>=e}return!1}function uv(t){var e=t.a,r=e.d;r.c=t.d,r.a=e,nv(t)}function lv(t,e,r){for(t=e,e=e.a;t!==r;){t.c=!1;var i=Hv(t),n=i.a;if(n.a!==e.a){if(!i.c){uv(t);break}sv(i,n=qg(e.c.b,n.b))}e.c!==n&&(jg(Dv(n),n),jg(e,n)),uv(t),e=i.a,t=i}return e}function cv(t,e,r,i,n,s){var a=!0;do{ov(t,e,r.b),r=r.c}while(r!==i);for(null===n&&(n=Hv(e).a.b.c);(r=(i=Hv(e)).a.b).a===n.a;)r.c!==n&&(jg(Dv(r),r),jg(Dv(n),r)),i.f=e.f-r.f,i.d=hv(t,i.f),e.b=!0,!a&&mv(t,e)&&(rv(r,n),nv(e),Vg(n)),a=!1,e=i,n=r;e.b=!0,s&&vv(t,e)}function fv(t,e,r,i,n){var s=[e.g[0],e.g[1],e.g[2]];e.d=null,e.d=t.o&&t.o(s,r,i,t.c)||null,null===e.d&&(n?t.n||(Av(t,100156),t.n=!0):e.d=r[0])}function dv(t,e,r){var i=[null,null,null,null];i[0]=e.a.d,i[1]=r.a.d,fv(t,e.a,i,[.5,.5,0,0],!1),jg(e,r)}function pv(t,e,r,i,n){var s=Math.abs(e.b-t.b)+Math.abs(e.a-t.a),a=Math.abs(r.b-t.b)+Math.abs(r.a-t.a),o=n+1;i[n]=.5*a/(s+a),i[o]=.5*s/(s+a),t.g[0]+=i[n]*e.g[0]+i[o]*r.g[0],t.g[1]+=i[n]*e.g[1]+i[o]*r.g[1],t.g[2]+=i[n]*e.g[2]+i[o]*r.g[2]}function mv(t,e){var r=Hv(e),i=e.a,n=r.a;if(Ng(i.a,n.a)){if(0<Bg(n.b.a,i.a,n.a))return!1;if(Pg(i.a,n.a)){if(i.a!==n.a){r=t.e;var s=i.a.h;if(0<=s){var a=(r=r.b).d,o=r.e,h=r.c,u=h[s];a[u]=a[r.a],h[a[u]]=u,u<=--r.a&&(1>=u||Ng(o[a[u>>1]],o[a[u]])?Uv(r,u):zv(r,u)),o[s]=null,h[s]=r.b,r.b=s}else for(r.c[-(s+1)]=null;0<r.a&&null===r.c[r.d[r.a-1]];)--r.a;dv(t,Dv(n),i)}}else Wg(n.b),jg(i,Dv(n)),e.b=r.b=!0}else{if(0>Bg(i.b.a,n.a,i.a))return!1;jv(e).b=e.b=!0,Wg(i.b),jg(Dv(n),i)}return!0}function gv(t,e){var r=Hv(e),i=e.a,n=r.a,s=i.a,a=n.a,o=i.b.a,h=n.b.a,u=new Iv;if(Bg(o,t.a,s),Bg(h,t.a,a),s===a||Math.min(s.a,o.a)>Math.max(a.a,h.a))return!1;if(Ng(s,a)){if(0<Bg(h,s,a))return!1}else if(0>Bg(o,a,s))return!1;var l,c,f=o,d=s,p=h,m=a;if(Ng(f,d)||(l=f,f=d,d=l),Ng(p,m)||(l=p,p=m,m=l),Ng(f,p)||(l=f,f=p,p=l,l=d,d=m,m=l),Ng(p,d)?Ng(d,m)?(0>(l=kg(f,p,d))+(c=kg(p,d,m))&&(l=-l,c=-c),u.b=Gg(l,p.b,c,d.b)):(0>(l=Bg(f,p,d))+(c=-Bg(f,m,d))&&(l=-l,c=-c),u.b=Gg(l,p.b,c,m.b)):u.b=(p.b+d.b)/2,Lg(f,d)||(l=f,f=d,d=l),Lg(p,m)||(l=p,p=m,m=l),Lg(f,p)||(l=f,f=p,p=l,l=d,d=m,m=l),Lg(p,d)?Lg(d,m)?(0>(l=Og(f,p,d))+(c=Og(p,d,m))&&(l=-l,c=-c),u.a=Gg(l,p.a,c,d.a)):(0>(l=Fg(f,p,d))+(c=-Fg(f,m,d))&&(l=-l,c=-c),u.a=Gg(l,p.a,c,m.a)):u.a=(p.a+d.a)/2,Ng(u,t.a)&&(u.b=t.a.b,u.a=t.a.a),f=Ng(s,a)?s:a,Ng(f,u)&&(u.b=f.b,u.a=f.a),Pg(u,s)||Pg(u,a))return mv(t,e),!1;if(!Pg(o,t.a)&&0<=Bg(o,t.a,u)||!Pg(h,t.a)&&0>=Bg(h,t.a,u)){if(h===t.a)return Wg(i.b),jg(n.b,i),i=Hv(e=av(e)).a,lv(t,Hv(e),r),cv(t,e,Dv(i),i,i,!0),!0;if(o===t.a){Wg(n.b),jg(i.e,Dv(n)),a=(s=r=e).a.b.a;do{s=jv(s)}while(s.a.b.a===a);return s=Hv(e=s).a.b.c,r.a=Dv(n),cv(t,e,(n=lv(t,r,null)).c,i.b.c,s,!0),!0}return 0<=Bg(o,t.a,u)&&(jv(e).b=e.b=!0,Wg(i.b),i.a.b=t.a.b,i.a.a=t.a.a),0>=Bg(h,t.a,u)&&(e.b=r.b=!0,Wg(n.b),n.a.b=t.a.b,n.a.a=t.a.a),!1}return Wg(i.b),Wg(n.b),jg(Dv(n),i),i.a.b=u.b,i.a.a=u.a,i.a.h=Nv(t.e,i.a),i=i.a,n=[0,0,0,0],u=[s.d,o.d,a.d,h.d],i.g[0]=i.g[1]=i.g[2]=0,pv(i,s,o,n,0),pv(i,a,h,n,2),fv(t,i,u,n,!0),jv(e).b=e.b=r.b=!0,!1}function vv(t,e){for(var r=Hv(e);;){for(;r.b;)e=r,r=Hv(r);if(!e.b&&(r=e,null===(e=jv(e))||!e.b))break;e.b=!1;var i,n=e.a,s=r.a;if(i=n.b.a!==s.b.a)t:{var a=Hv(i=e),o=i.a,h=a.a,u=void 0;if(Ng(o.b.a,h.b.a)){if(0>Bg(o.b.a,h.b.a,o.a)){i=!1;break t}jv(i).b=i.b=!0,u=Wg(o),jg(h.b,u),u.d.c=i.d}else{if(0<Bg(h.b.a,o.b.a,h.a)){i=!1;break t}i.b=a.b=!0,u=Wg(h),jg(o.e,h.b),u.b.d.c=i.d}i=!0}if(i&&(r.c?(nv(r),Vg(s),s=(r=Hv(e)).a):e.c&&(nv(e),Vg(n),n=(e=jv(r)).a)),n.a!==s.a)if(n.b.a===s.b.a||e.c||r.c||n.b.a!==t.a&&s.b.a!==t.a)mv(t,e);else if(gv(t,e))break;n.a===s.a&&n.b.a===s.b.a&&(rv(s,n),nv(e),Vg(n),e=jv(r))}}function _v(t,e){t.a=e;for(var r=e.c;null===r.i;)if((r=r.c)===e.c){r=t;var i=e;(a=new Gv).a=i.c.b;var n=(h=r.f).a;do{n=n.a}while(null!==n.b&&!h.c(h.b,a,n.b));var s=Hv(h=n.b),a=h.a;n=s.a;if(0===Bg(a.b.a,i,a.a))Pg((a=h.a).a,i)||Pg(a.b.a,i)||(Wg(a.b),h.c&&(Vg(a.c),h.c=!1),jg(i.c,a),_v(r,i));else{var o=Ng(n.b.a,a.b.a)?h:s;s=void 0;h.d||o.c?(s=o===h?qg(i.c.b,a.e):qg(n.b.c.b,i.c).b,o.c?sv(o,s):(a=r,(h=ov(r,h,s)).f=jv(h).f+h.a.f,h.d=hv(a,h.f)),_v(r,i)):cv(r,h,i.c,i.c,null,!0)}return}if(h=(a=Hv(r=av(r.i))).a,(a=lv(t,a,null)).c===h){a=(h=a).c,n=Hv(r),s=r.a,o=n.a;var h,u=!1;s.b.a!==o.b.a&&gv(t,r),Pg(s.a,t.a)&&(jg(Dv(a),s),a=Hv(r=av(r)).a,lv(t,Hv(r),n),u=!0),Pg(o.a,t.a)&&(jg(h,Dv(o)),h=lv(t,n,null),u=!0),u?cv(t,r,h.c,a,a,!0):(i=Ng(o.a,s.a)?Dv(o):s,cv(t,r,i=qg(h.c.b,i),i.c,i.c,!1),i.b.i.c=!0,vv(t,r))}else cv(t,r,a.c,h,h,!0)}function bv(t,e){var r=new Gv,i=Hg(t.b);i.a.b=ev,i.a.a=e,i.b.a.b=-ev,i.b.a.a=e,t.a=i.b.a,r.a=i,r.f=0,r.d=!1,r.c=!1,r.h=!0,r.b=!1,i=xv(i=t.f,i.a,r),r.e=i}function yv(t){this.a=new wv,this.b=t,this.c=iv}function xv(t,e,r){do{e=e.c}while(null!==e.b&&!t.c(t.b,e.b,r));return t=new wv(r,e.a,e),e.a.c=t,e.a=t}function wv(t,e,r){this.b=t||null,this.a=e||this,this.c=r||this}function Ev(){this.d=Mv,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var Mv=0;function Sv(t,e){if(t.d!==e)for(;t.d!==e;)if(t.d<e)switch(t.d){case Mv:Av(t,100151),t.u(null);break;case 1:Av(t,100152),t.t()}else switch(t.d){case 2:Av(t,100154),t.v();break;case 1:Av(t,100153),t.w()}}function Av(t,e){t.p&&t.p(e,t.c)}function Tv(t,e){this.b=t||this,this.d=e||this,this.a=null,this.c=!1}function Cv(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function Dv(t){return t.b.e}function Rv(){this.c=new Iv,this.a=new Tv,this.b=new Cv,this.d=new Cv,this.b.b=this.d,this.d.b=this.b}function Iv(t,e){this.e=t||this,this.f=e||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Pv(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Bv}function Nv(t,e){if(t.e){var r,i=t.b,n=++i.a;return 2*n>i.f&&(i.f*=2,i.c=Lv(i.c,i.f+1)),0===i.b?r=n:(r=i.b,i.b=i.c[i.b]),i.e[r]=e,i.c[r]=n,i.d[n]=r,i.h&&zv(i,n),r}return i=t.a++,t.c[i]=e,-(i+1)}function kv(t){if(0===t.a)return Fv(t.b);var e=t.c[t.d[t.a-1]];if(0!==t.b.a&&Ng(Ov(t.b),e))return Fv(t.b);do{--t.a}while(0<t.a&&null===t.c[t.d[t.a-1]]);return e}function Bv(){this.d=Lv([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function Lv(t,e){for(var r=Array(e),i=0;i<t.length;i++)r[i]=t[i];for(;i<e;i++)r[i]=0;return r}function Ov(t){return t.e[t.d[1]]}function Fv(t){var e=t.d,r=t.e,i=t.c,n=e[1],s=r[n];return 0<t.a&&(e[1]=e[t.a],i[e[1]]=1,r[n]=null,i[n]=t.b,t.b=n,0<--t.a&&Uv(t,1)),s}function Uv(t,e){for(var r=t.d,i=t.e,n=t.c,s=e,a=r[s];;){var o=s<<1;o<t.a&&Ng(i[r[o+1]],i[r[o]])&&(o+=1);var h=r[o];if(o>t.a||Ng(i[a],i[h])){r[s]=a,n[a]=s;break}r[s]=h,n[h]=s,s=o}}function zv(t,e){for(var r=t.d,i=t.e,n=t.c,s=e,a=r[s];;){var o=s>>1,h=r[o];if(0===o||Ng(i[h],i[a])){r[s]=a,n[a]=s;break}r[s]=h,n[h]=s,s=o}}function Gv(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Hv(t){return t.e.c.b}function jv(t){return t.e.a.b}(Rg=Ev.prototype).x=function(){Sv(this,Mv)},Rg.B=function(t,e){switch(t){case 100142:return;case 100140:switch(e){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=e)}break;case 100141:return void(this.m=!!e);default:return void Av(this,100900)}Av(this,100901)},Rg.y=function(t){switch(t){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:Av(this,100900)}return!1},Rg.A=function(t,e,r){this.j[0]=t,this.j[1]=e,this.j[2]=r},Rg.z=function(t,e){var r=e||null;switch(t){case 100100:case 100106:this.h=r;break;case 100104:case 100110:this.l=r;break;case 100101:case 100107:this.k=r;break;case 100102:case 100108:this.i=r;break;case 100103:case 100109:this.p=r;break;case 100105:case 100111:this.o=r;break;case 100112:this.r=r;break;default:Av(this,100900)}},Rg.C=function(t,e){var r=!1,i=[0,0,0];Sv(this,2);for(var n=0;3>n;++n){var s=t[n];-1e150>s&&(s=-1e150,r=!0),1e150<s&&(s=1e150,r=!0),i[n]=s}r&&Av(this,100155),null===(r=this.q)?jg(r=Hg(this.b),r.b):(Wg(r),r=r.e),r.a.d=e,r.a.g[0]=i[0],r.a.g[1]=i[1],r.a.g[2]=i[2],r.f=1,r.b.f=-1,this.q=r},Rg.u=function(t){Sv(this,Mv),this.d=1,this.b=new Rv,this.c=t},Rg.t=function(){Sv(this,1),this.d=2,this.q=null},Rg.v=function(){Sv(this,2),this.d=1},Rg.w=function(){Sv(this,1),this.d=Mv;var t=!1,e=[a=this.j[0],r=this.j[1],n=this.j[2]];if(0===a&&0===r&&0===n){for(var r=[-2e150,-2e150,-2e150],i=[2e150,2e150,2e150],n=[],s=[],a=(t=this.b.c).e;a!==t;a=a.e)for(var o=0;3>o;++o){var h=a.g[o];h<i[o]&&(i[o]=h,s[o]=a),h>r[o]&&(r[o]=h,n[o]=a)}if(a=0,r[1]-i[1]>r[0]-i[0]&&(a=1),r[2]-i[2]>r[a]-i[a]&&(a=2),i[a]>=r[a])e[0]=0,e[1]=0,e[2]=1;else{for(r=0,i=s[a],n=n[a],s=[0,0,0],i=[i.g[0]-n.g[0],i.g[1]-n.g[1],i.g[2]-n.g[2]],o=[0,0,0],a=t.e;a!==t;a=a.e)o[0]=a.g[0]-n.g[0],o[1]=a.g[1]-n.g[1],o[2]=a.g[2]-n.g[2],s[0]=i[1]*o[2]-i[2]*o[1],s[1]=i[2]*o[0]-i[0]*o[2],s[2]=i[0]*o[1]-i[1]*o[0],(h=s[0]*s[0]+s[1]*s[1]+s[2]*s[2])>r&&(r=h,e[0]=s[0],e[1]=s[1],e[2]=s[2]);0>=r&&(e[0]=e[1]=e[2]=0,e[tv(i)]=1)}t=!0}for(s=tv(e),a=this.b.c,r=(s+1)%3,n=(s+2)%3,s=0<e[s]?1:-1,e=a.e;e!==a;e=e.e)e.b=e.g[r],e.a=s*e.g[n];if(t){for(e=0,a=(t=this.b.a).b;a!==t;a=a.b)if(!(0>=(r=a.a).f))do{e+=(r.a.b-r.b.a.b)*(r.a.a+r.b.a.a),r=r.e}while(r!==a.a);if(0>e)for(t=(e=this.b.c).e;t!==e;t=t.e)t.a=-t.a}for(this.n=!1,a=(e=this.b.b).h;a!==e;a=t)t=a.h,r=a.e,Pg(a.a,a.b.a)&&a.e.e!==a&&(dv(this,r,a),Vg(a),r=(a=r).e),r.e===a&&(r!==a&&(r!==t&&r!==t.b||(t=t.h),Vg(r)),a!==t&&a!==t.b||(t=t.h),Vg(a));for(this.e=e=new Pv,a=(t=this.b.c).e;a!==t;a=a.e)a.h=Nv(e,a);for(function(t){t.d=[];for(var e=0;e<t.a;e++)t.d[e]=e;t.d.sort(function(t){return function(e,r){return Ng(t[e],t[r])?1:-1}}(t.c)),t.e=!0,function(t){for(var e=t.a;1<=e;--e)Uv(t,e);t.h=!0}(t.b)}(e),this.f=new yv(this),bv(this,-ev),bv(this,ev);null!==(e=kv(this.e));){for(;;){t:if(a=this.e,0===a.a)t=Ov(a.b);else if(t=a.c[a.d[a.a-1]],0!==a.b.a&&(a=Ov(a.b),Ng(a,t))){t=a;break t}if(null===t||!Pg(t,e))break;t=kv(this.e),dv(this,e.c,t.c)}_v(this,e)}for(this.a=this.f.a.a.b.a.a,e=0;null!==(t=this.f.a.a.b);)t.h||++e,nv(t);for(this.f=null,(e=this.e).b=null,e.d=null,this.e=e.c=null,a=(e=this.b).a.b;a!==e.a;a=t)t=a.b,(a=a.a).e.e===a&&(rv(a.c,a),Vg(a));if(!this.n){if(e=this.b,this.m)for(a=e.b.h;a!==e.b;a=t)t=a.h,a.b.d.c!==a.d.c?a.f=a.d.c?1:-1:Vg(a);else for(a=e.a.b;a!==e.a;a=t)if(t=a.b,a.c){for(a=a.a;Ng(a.b.a,a.a);a=a.c.b);for(;Ng(a.a,a.b.a);a=a.e);for(r=a.c.b,n=void 0;a.e!==r;)if(Ng(a.b.a,r.a)){for(;r.e!==a&&(Ug(r.e)||0>=Bg(r.a,r.b.a,r.e.b.a));)r=(n=qg(r.e,r)).b;r=r.c.b}else{for(;r.e!==a&&(zg(a.c.b)||0<=Bg(a.b.a,a.a,a.c.b.a));)a=(n=qg(a,a.c.b)).b;a=a.e}for(;r.e.e!==a;)r=(n=qg(r.e,r)).b}if(this.h||this.i||this.k||this.l)if(this.m){for(t=(e=this.b).a.b;t!==e.a;t=t.b)if(t.c){this.h&&this.h(2,this.c),a=t.a;do{this.k&&this.k(a.a.d,this.c),a=a.e}while(a!==t.a);this.i&&this.i(this.c)}}else{for(e=this.b,t=!!this.l,a=!1,r=-1,n=e.a.d;n!==e.a;n=n.d)if(n.c){a||(this.h&&this.h(4,this.c),a=!0),s=n.a;do{t&&(r!==(i=s.b.d.c?0:1)&&(r=i,this.l&&this.l(!!r,this.c))),this.k&&this.k(s.a.d,this.c),s=s.e}while(s!==n.a)}a&&this.i&&this.i(this.c)}if(this.r){for(a=(e=this.b).a.b;a!==e.a;a=t)if(t=a.b,!a.c){n=(r=a.a).e,s=void 0;do{n=(s=n).e,s.d=null,null===s.b.d&&(s.c===s?Jg(s.a,null):(s.a.c=s.c,Yg(s,Dv(s))),(i=s.b).c===i?Jg(i.a,null):(i.a.c=i.c,Yg(i,Dv(i))),Kg(s))}while(s!==r);r=a.d,(a=a.b).d=r,r.b=a}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},Ig.libtess={GluTesselator:Ev,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},Ev.prototype.gluDeleteTess=Ev.prototype.x,Ev.prototype.gluTessProperty=Ev.prototype.B,Ev.prototype.gluGetTessProperty=Ev.prototype.y,Ev.prototype.gluTessNormal=Ev.prototype.A,Ev.prototype.gluTessCallback=Ev.prototype.z,Ev.prototype.gluTessVertex=Ev.prototype.C,Ev.prototype.gluTessBeginPolygon=Ev.prototype.u,Ev.prototype.gluTessBeginContour=Ev.prototype.t,Ev.prototype.gluTessEndContour=Ev.prototype.v,Ev.prototype.gluTessEndPolygon=Ev.prototype.w,Ig=Ig.libtess;var Vv,Wv,qv;
/*!
 * d-path-parser - v1.0.0
 * by Massimo Artizzu (MaxArt2501)
 *
 * https://github.com/MaxArt2501/d-path-parser
 *
 * Licensed under the MIT License
 * See LICENSE for details
 */Vv=function(){return function(t){for(var e={command:/\s*([achlmqstvz])/gi,number:/\s*([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/gi,comma:/\s*(?:(,)|\s)/g,flag:/\s*([01])/g},r={number:function(t){return+l("number",t)},"coordinate pair":function(t){var e=l("number",t);return null!==e||t?(l("comma"),{x:+e,y:+l("number",!0)}):null},"arc definition":function(t){var e=r["coordinate pair"](t);if(!e&&!t)return null;l("comma");var i=+l("number",!0);l("comma",!0);var n=!!+l("flag",!0);l("comma");var s=!!+l("flag",!0);return l("comma"),{radii:e,rotation:i,large:n,clockwise:s,end:r["coordinate pair"](!0)}}},i=0,n=[];i<t.length;){var s,a=l("command"),o=a.toUpperCase(),h=a!==o;switch(o){case"M":s=c("coordinate pair").map((function(t,e){return 1===e&&(a=h?"l":"L"),u({end:t})}));break;case"L":case"T":s=c("coordinate pair").map((function(t){return u({end:t})}));break;case"C":if((s=c("coordinate pair")).length%3)throw Error("Expected coordinate pair triplet at position "+i);s=s.reduce((function(t,e,r){var i=r%3;return i?t[t.length-1][1===i?"cp2":"end"]=e:t.push(u({cp1:e})),t}),[]);break;case"Q":case"S":if(1&(s=c("coordinate pair")).length)throw Error("Expected coordinate pair couple at position "+i);s=s.reduce((function(t,e,r){return 1&r?t[t.length-1].end=e:t.push(u({cp:e})),t}),[]);break;case"H":case"V":s=c("number").map((function(t){return u({value:t})}));break;case"A":s=c("arc definition").map(u);break;case"Z":s=[{code:"Z"}]}n.push.apply(n,s)}return n;function u(t){return t.code=a,t.relative=h,t}function l(r,n){e[r].lastIndex=i;var s=e[r].exec(t);if(!s||s.index!==i){if(!n)return null;throw Error("Expected "+r+" at position "+i)}return i=e[r].lastIndex,s[1]}function c(t){for(var e,i=[],n=!0;e=r[t](n);)i.push(e),n=!!l("comma");return i}}},"function"==typeof define&&define.amd?define([],Vv):Vv(),function(t){t[t.HORIZONTAL=0]="HORIZONTAL";t[t.VERTICAL=1]="VERTICAL"}(Wv||(Wv={}));!function(t){t[t.HOR=0]="HOR";t[t.VERT=1]="VERT";t[t.NONE=2]="NONE"}(qv||(qv={}));new Kr;new Kr;
/*!
 * @pixi-essentials/cull - v1.0.12
 * Compiled Wed, 17 Mar 2021 16:10:19 UTC
 *
 * @pixi-essentials/cull is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2020, Shukant Pal <shukantpal@outlook.com>, All Rights Reserved
 */
new Kr;new Map;var Xv;!function(t){t.NONZERO="nonzero";t.EVENODD="evenodd"}(Xv||(Xv={}));new Ns;var Yv;!function(t){t[t.POLY=0]="POLY";t[t.RECT=1]="RECT";t[t.CIRC=2]="CIRC";t[t.ELIP=3]="ELIP";t[t.RREC=4]="RREC"}(Yv||(Yv={}));new ri,Jo._segmentsCount.bind(Jo);new ri;const Zv={build(){},triangulate(t,e){try{const r=t.shape,i=r.contours.filter((t=>t.length>0)).filter((t=>void 0===t.find((t=>isNaN(t))))),n=new Ig.GluTesselator,s=[];n.gluTessProperty(Ig.gluEnum.GLU_TESS_WINDING_RULE,r.fillRule===Xv.EVENODD?Ig.windingRule.GLU_TESS_WINDING_ODD:Ig.windingRule.GLU_TESS_WINDING_NONZERO),n.gluTessCallback(Ig.gluEnum.GLU_TESS_VERTEX_DATA,(function(t,e){e[e.length]=t[0],e[e.length]=t[1]})),n.gluTessCallback(Ig.gluEnum.GLU_TESS_BEGIN,(function(t){t!==Ig.primitiveType.GL_TRIANGLES&&console.warn(`expected TRIANGLES but got type: ${t}`)})),n.gluTessCallback(Ig.gluEnum.GLU_TESS_ERROR,(function(t){console.error("error callback"),console.error(`error number: ${t}`)})),n.gluTessCallback(Ig.gluEnum.GLU_TESS_COMBINE,(function(t,e,r){return[t[0],t[1],t[2]]})),n.gluTessCallback(Ig.gluEnum.GLU_TESS_EDGE_FLAG,(function(t){})),n.gluTessNormal(0,0,1),n.gluTessBeginPolygon(s);for(let t=0;t<i.length;t++){const e=i[t];n.gluTessBeginContour();for(let t=0;t<e.length;){const r=e[t++],i=[r,e[t++],0];n.gluTessVertex(i,i)}n.gluTessEndContour()}n.gluTessEndPolygon();const a=e.points,o=e.indices,h=a.length/2;for(let t=0;t<s.length;)a.push(s[t++],s[t++]);for(let t=0;t<s.length/2;t++)o.push(t+h)}catch(t){console.error(t)}}};_h.FILL_COMMANDS[100]=Zv;const $v=new $s;$v.matrix=[.33,.33,.33,0,0,0,0,0,0,0,0,0,0,0,0,.33,.33,.33,0,0];new Kr,new Kr;class Kv extends Hs{constructor(){super(ln.EMPTY),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.texture=ln.from(this.canvas),this.contentList=new Map,this.dirtyId=0,this.updateId=0}async clear(){this.contentList.clear(),this.dirtyId++,this.position.set(0,0)}async put(t,e,r,i,n){this.contentList.set(t,{position:e,content:r,style:i,matrix:n});const s=Ih.measureText(r,new kh(i),!1,this.canvas);return this.dirtyId++,{x:e.x+s.width,y:e.y}}updateText(){let t=0,e=0;this.contentList.forEach((({position:r,content:i,style:n})=>{const s=Ih.measureText(i,new kh(n),!1,this.canvas);t=Math.max(t,r.x+s.width),e=Math.max(e,r.y+s.height+s.fontProperties.descent)}));const r=window.devicePixelRatio||1;this.canvas.width=t*r,this.canvas.height=e*r,this.texture.baseTexture.setRealSize(t,e,r),this.texture.update(),this.context.clearRect(0,0,t*r,e*r),this.context.setTransform(1,0,0,1,0,0),this.context.scale(r,r);let i=0;for(const[t,{position:e,content:r,style:n}]of this.contentList){const t=Ih.measureText(r,new kh(n),!1,this.canvas),s=new kh(n);this.context.fillStyle="string"==typeof s.fill?s.fill:"black",this.context.font=s.toFontString(),this.context.fillText(r,e.x,e.y+t.height),0===i&&(this.y-=t.height),i++}this.updateId=this.dirtyId}render(t){this.updateId!==this.dirtyId&&(this.updateText(),this.updateTransform()),super.render(t)}}class Jv extends Us{static __initStatic(){this.defaultEngine=Kv}constructor(){super(),this.currentTextPosition={x:0,y:0},this.engine=new Jv.defaultEngine,this.addChild(this.engine)}async embedText(t,e={}){const r=this.engine;t instanceof SVGTextElement&&(await r.clear(),this.currentTextPosition.x=t.x.baseVal.length>0?t.x.baseVal.getItem(0).value:0,this.currentTextPosition.y=t.y.baseVal.length>0?t.y.baseVal.getItem(0).value:0);const i=t.getAttribute("fill"),n=t.getAttribute("font-family"),s=parseFloat(t.getAttribute("font-size")),a=t.getAttribute("font-weight"),o=function(t,e=16){return t?t.includes("em")?parseFloat(t)*e:parseFloat(t):0}(t.getAttribute("letter-spacing"),s);e.fill=i||e.fill||"black",e.fontFamily=n||!e.fontFamily?`${n||"serif"}, serif`:e.fontFamily,e.fontSize=isNaN(s)?e.fontSize:s,e.fontWeight=a||e.fontWeight||"normal",e.letterSpacing=isNaN(o)?e.letterSpacing||0:o,e.wordWrap=!0,e.wordWrapWidth=400;const h=t.childNodes;for(let t=0,i=h.length;t<i;t++){const i=h.item(t);let n,s;i instanceof globalThis.Text?(n=i.data,s=e,this.currentTextPosition=await r.put(i,{x:this.currentTextPosition.x,y:this.currentTextPosition.y},n,s),this.emit("nodetransformdirty")):i instanceof SVGTSpanElement&&(i.x.baseVal.length>0&&(this.currentTextPosition.x=i.x.baseVal.getItem(0).value),i.y.baseVal.length>0&&(this.currentTextPosition.y=i.y.baseVal.getItem(0).value),await this.embedText(i,{...e}))}}}Jv.__initStatic();new ri,new Kr;function Qv({width:t,height:e}){const r=(new vh).lineStyle(1,16711680);return function(t,e){t.forEach((t=>{const[r,i,n,s]=t instanceof Array?t:[t.x1,t.y1,t.x2,t.y2];e.moveTo(r,i),e.lineTo(n,s)}))}([[-t/2,0,t/2,0],[0,e/2,0,-e/2]],r),r}var t_,e_={};t_=function(){function t(t){return i.appendChild(t.dom),t}function e(t){for(var e=0;e<i.children.length;e++)i.children[e].style.display=e===t?"block":"none";r=t}var r=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(t){t.preventDefault(),e(++r%i.children.length)}),!1);var n=(performance||Date).now(),s=n,a=0,o=t(new t_.Panel("FPS","#0ff","#002")),h=t(new t_.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new t_.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:i,addPanel:t,showPanel:e,begin:function(){n=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(h.update(t-n,200),t>s+1e3&&(o.update(1e3*a/(t-s),100),s=t,a=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:i,setMode:e}},t_.Panel=function(t,e,r){var i=1/0,n=0,s=Math.round,a=s(window.devicePixelRatio||1),o=80*a,h=48*a,u=3*a,l=2*a,c=3*a,f=15*a,d=74*a,p=30*a,m=document.createElement("canvas");m.width=o,m.height=h,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=r,g.fillRect(0,0,o,h),g.fillStyle=e,g.fillText(t,u,l),g.fillRect(c,f,d,p),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(c,f,d,p),{dom:m,update:function(h,v){i=Math.min(i,h),n=Math.max(n,h),g.fillStyle=r,g.globalAlpha=1,g.fillRect(0,0,o,f),g.fillStyle=e,g.fillText(s(h)+" "+t+" ("+s(i)+"-"+s(n)+")",u,l),g.drawImage(m,c+a,f,d-a,p,c,f,d-a,p),g.fillRect(c+d-a,f,a,p),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(c+d-a,f,a,s((1-h/v)*p))}}},e_=t_;var r_={};function i_(){return r_=i_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},r_.__esModule=!0,r_.default=r_,i_.apply(this,arguments)}(r_=i_).__esModule=!0,r_.default=r_;var n_={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function s_(t){return"number"==typeof t}function a_(t){return!(!t||"object"!=typeof t||"function"!=typeof t.constructor)&&(!0===t.isBigNumber&&"object"==typeof t.constructor.prototype&&!0===t.constructor.prototype.isBigNumber||"function"==typeof t.constructor.isDecimal&&!0===t.constructor.isDecimal(t))}function o_(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isComplex||!1}function h_(t){return t&&"object"==typeof t&&!0===Object.getPrototypeOf(t).isFraction||!1}function u_(t){return t&&!0===t.constructor.prototype.isUnit||!1}function l_(t){return"string"==typeof t}var c_=Array.isArray;function f_(t){return t&&!0===t.constructor.prototype.isMatrix||!1}function d_(t){return Array.isArray(t)||f_(t)}function p_(t){return t&&t.isDenseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function m_(t){return t&&t.isSparseMatrix&&!0===t.constructor.prototype.isMatrix||!1}function g_(t){return t&&!0===t.constructor.prototype.isRange||!1}function v_(t){return t&&!0===t.constructor.prototype.isIndex||!1}function __(t){return"boolean"==typeof t}function b_(t){return t&&!0===t.constructor.prototype.isResultSet||!1}function y_(t){return t&&!0===t.constructor.prototype.isHelp||!1}function x_(t){return"function"==typeof t}function w_(t){return t instanceof Date}function E_(t){return t instanceof RegExp}function M_(t){return!(!t||"object"!=typeof t||t.constructor!==Object||o_(t)||h_(t))}function S_(t){return null===t}function A_(t){return void 0===t}function T_(t){return t&&!0===t.isAccessorNode&&!0===t.constructor.prototype.isNode||!1}function C_(t){return t&&!0===t.isArrayNode&&!0===t.constructor.prototype.isNode||!1}function D_(t){return t&&!0===t.isAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function R_(t){return t&&!0===t.isBlockNode&&!0===t.constructor.prototype.isNode||!1}function I_(t){return t&&!0===t.isConditionalNode&&!0===t.constructor.prototype.isNode||!1}function P_(t){return t&&!0===t.isConstantNode&&!0===t.constructor.prototype.isNode||!1}function N_(t){return t&&!0===t.isFunctionAssignmentNode&&!0===t.constructor.prototype.isNode||!1}function k_(t){return t&&!0===t.isFunctionNode&&!0===t.constructor.prototype.isNode||!1}function B_(t){return t&&!0===t.isIndexNode&&!0===t.constructor.prototype.isNode||!1}function L_(t){return t&&!0===t.isNode&&!0===t.constructor.prototype.isNode||!1}function O_(t){return t&&!0===t.isObjectNode&&!0===t.constructor.prototype.isNode||!1}function F_(t){return t&&!0===t.isOperatorNode&&!0===t.constructor.prototype.isNode||!1}function U_(t){return t&&!0===t.isParenthesisNode&&!0===t.constructor.prototype.isNode||!1}function z_(t){return t&&!0===t.isRangeNode&&!0===t.constructor.prototype.isNode||!1}function G_(t){return t&&!0===t.isRelationalNode&&!0===t.constructor.prototype.isNode||!1}function H_(t){return t&&!0===t.isSymbolNode&&!0===t.constructor.prototype.isNode||!1}function j_(t){return t&&!0===t.constructor.prototype.isChain||!1}function V_(t){var e=typeof t;return"object"===e?null===t?"null":a_(t)?"BigNumber":t.constructor&&t.constructor.name?t.constructor.name:"Object":e}function W_(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null==t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map((function(t){return W_(t)}));if(t instanceof Date)return new Date(t.valueOf());if(a_(t))return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);return q_(t,W_)}function q_(t,e){var r={};for(var i in t)Z_(t,i)&&(r[i]=e(t[i]));return r}function X_(t,e){for(var r in e)Z_(e,r)&&(t[r]=e[r]);return t}function Y_(t,e){var r,i,n;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(i=0,n=t.length;i<n;i++)if(!Y_(t[i],e[i]))return!1;return!0}if("function"==typeof t)return t===e;if(t instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(r in t)if(!(r in e)||!Y_(t[r],e[r]))return!1;for(r in e)if(!(r in t))return!1;return!0}return t===e}function Z_(t,e){return t&&Object.hasOwnProperty.call(t,e)}function $_(t,e){for(var r={},i=0;i<e.length;i++){var n=e[i],s=t[n];void 0!==s&&(r[n]=s)}return r}var K_=["Matrix","Array"],J_=["number","BigNumber","Fraction"];var Q_=function(t){if(t)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(n_)};r(r_)(Q_,n_,{MATRIX_OPTIONS:K_,NUMBER_OPTIONS:J_});var tb={};function eb(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)}!function(t){
/*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   */
var e,r,i,n,s=9e15,a=1e9,o="0123456789abcdef",h="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",u="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",l={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},c=!0,f="[DecimalError] ",d=f+"Invalid argument: ",p=f+"Precision limit exceeded",m=f+"crypto unavailable",g="[object Decimal]",v=Math.floor,_=Math.pow,b=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,y=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,w=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,E=1e7,M=h.length-1,S=u.length-1,A={toStringTag:g};function T(t){var e,r,i,n=t.length-1,s="",a=t[0];if(n>0){for(s+=a,e=1;e<n;e++)(r=7-(i=t[e]+"").length)&&(s+=F(r)),s+=i;(r=7-(i=(a=t[e])+"").length)&&(s+=F(r))}else if(0===a)return"0";for(;a%10==0;)a/=10;return s+a}function C(t,e,r){if(t!==~~t||t<e||t>r)throw Error(d+t)}function D(t,e,r,i){var n,s,a,o;for(s=t[0];s>=10;s/=10)--e;return--e<0?(e+=7,n=0):(n=Math.ceil((e+1)/7),e%=7),s=_(10,7-e),o=t[n]%s|0,null==i?e<3?(0==e?o=o/100|0:1==e&&(o=o/10|0),a=r<4&&99999==o||r>3&&49999==o||5e4==o||0==o):a=(r<4&&o+1==s||r>3&&o+1==s/2)&&(t[n+1]/s/100|0)==_(10,e-2)-1||(o==s/2||0==o)&&0==(t[n+1]/s/100|0):e<4?(0==e?o=o/1e3|0:1==e?o=o/100|0:2==e&&(o=o/10|0),a=(i||r<4)&&9999==o||!i&&r>3&&4999==o):a=((i||r<4)&&o+1==s||!i&&r>3&&o+1==s/2)&&(t[n+1]/s/1e3|0)==_(10,e-3)-1,a}function R(t,e,r){for(var i,n,s=[0],a=0,h=t.length;a<h;){for(n=s.length;n--;)s[n]*=e;for(s[0]+=o.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>r-1&&(void 0===s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/r|0,s[i]%=r)}return s.reverse()}A.absoluteValue=A.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),P(t)},A.ceil=function(){return P(new this.constructor(this),this.e+1,2)},A.clampedTo=A.clamp=function(t,e){var r=this,i=r.constructor;if(t=new i(t),e=new i(e),!t.s||!e.s)return new i(NaN);if(t.gt(e))throw Error(d+e);return r.cmp(t)<0?t:r.cmp(e)>0?e:new i(r)},A.comparedTo=A.cmp=function(t){var e,r,i,n,s=this,a=s.d,o=(t=new s.constructor(t)).d,h=s.s,u=t.s;if(!a||!o)return h&&u?h!==u?h:a===o?0:!a^h<0?1:-1:NaN;if(!a[0]||!o[0])return a[0]?h:o[0]?-u:0;if(h!==u)return h;if(s.e!==t.e)return s.e>t.e^h<0?1:-1;for(e=0,r=(i=a.length)<(n=o.length)?i:n;e<r;++e)if(a[e]!==o[e])return a[e]>o[e]^h<0?1:-1;return i===n?0:i>n^h<0?1:-1},A.cosine=A.cos=function(){var t,e,r=this,i=r.constructor;return r.d?r.d[0]?(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(t,e){var r,i,n;if(e.isZero())return e;i=e.d.length,i<32?n=(1/Y(4,r=Math.ceil(i/3))).toString():(r=16,n="2.3283064365386962890625e-10");t.precision+=r,e=X(t,1,e.times(n),new t(1));for(var s=r;s--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return t.precision-=r,e}(i,Z(i,r)),i.precision=t,i.rounding=e,P(2==n||3==n?r.neg():r,t,e,!0)):new i(1):new i(NaN)},A.cubeRoot=A.cbrt=function(){var t,e,r,i,n,s,a,o,h,u,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(c=!1,(s=l.s*_(l.s*l,1/3))&&Math.abs(s)!=1/0?i=new f(s.toString()):(r=T(l.d),(s=((t=l.e)-r.length+1)%3)&&(r+=1==s||-2==s?"0":"00"),s=_(r,1/3),t=v((t+1)/3)-(t%3==(t<0?-1:2)),(i=new f(r=s==1/0?"5e"+t:(r=s.toExponential()).slice(0,r.indexOf("e")+1)+t)).s=l.s),a=(t=f.precision)+3;;)if(u=(h=(o=i).times(o).times(o)).plus(l),i=I(u.plus(l).times(o),u.plus(h),a+2,1),T(o.d).slice(0,a)===(r=T(i.d)).slice(0,a)){if("9999"!=(r=r.slice(a-3,a+1))&&(n||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(P(i,t+1,1),e=!i.times(i).times(i).eq(l));break}if(!n&&(P(o,t+1,0),o.times(o).times(o).eq(l))){i=o;break}a+=4,n=1}return c=!0,P(i,t,f.rounding,e)},A.decimalPlaces=A.dp=function(){var t,e=this.d,r=NaN;if(e){if(r=7*((t=e.length-1)-v(this.e/7)),t=e[t])for(;t%10==0;t/=10)r--;r<0&&(r=0)}return r},A.dividedBy=A.div=function(t){return I(this,new this.constructor(t))},A.dividedToIntegerBy=A.divToInt=function(t){var e=this.constructor;return P(I(this,new e(t),0,1,1),e.precision,e.rounding)},A.equals=A.eq=function(t){return 0===this.cmp(t)},A.floor=function(){return P(new this.constructor(this),this.e+1,3)},A.greaterThan=A.gt=function(t){return this.cmp(t)>0},A.greaterThanOrEqualTo=A.gte=function(t){var e=this.cmp(t);return 1==e||0===e},A.hyperbolicCosine=A.cosh=function(){var t,e,r,i,n,s=this,a=s.constructor,o=new a(1);if(!s.isFinite())return new a(s.s?1/0:NaN);if(s.isZero())return o;r=a.precision,i=a.rounding,a.precision=r+Math.max(s.e,s.sd())+4,a.rounding=1,(n=s.d.length)<32?e=(1/Y(4,t=Math.ceil(n/3))).toString():(t=16,e="2.3283064365386962890625e-10"),s=X(a,1,s.times(e),new a(1),!0);for(var h,u=t,l=new a(8);u--;)h=s.times(s),s=o.minus(h.times(l.minus(h.times(l))));return P(s,a.precision=r,a.rounding=i,!0)},A.hyperbolicSine=A.sinh=function(){var t,e,r,i,n=this,s=n.constructor;if(!n.isFinite()||n.isZero())return new s(n);if(e=s.precision,r=s.rounding,s.precision=e+Math.max(n.e,n.sd())+4,s.rounding=1,(i=n.d.length)<3)n=X(s,2,n,n,!0);else{t=(t=1.4*Math.sqrt(i))>16?16:0|t,n=X(s,2,n=n.times(1/Y(5,t)),n,!0);for(var a,o=new s(5),h=new s(16),u=new s(20);t--;)a=n.times(n),n=n.times(o.plus(a.times(h.times(a).plus(u))))}return s.precision=e,s.rounding=r,P(n,e,r,!0)},A.hyperbolicTangent=A.tanh=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+7,i.rounding=1,I(r.sinh(),r.cosh(),i.precision=t,i.rounding=e)):new i(r.s)},A.inverseCosine=A.acos=function(){var t,e=this,r=e.constructor,i=e.abs().cmp(1),n=r.precision,s=r.rounding;return-1!==i?0===i?e.isNeg()?L(r,n,s):new r(0):new r(NaN):e.isZero()?L(r,n+4,s).times(.5):(r.precision=n+6,r.rounding=1,e=e.asin(),t=L(r,n+4,s).times(.5),r.precision=n,r.rounding=s,t.minus(e))},A.inverseHyperbolicCosine=A.acosh=function(){var t,e,r=this,i=r.constructor;return r.lte(1)?new i(r.eq(1)?0:NaN):r.isFinite()?(t=i.precision,e=i.rounding,i.precision=t+Math.max(Math.abs(r.e),r.sd())+4,i.rounding=1,c=!1,r=r.times(r).minus(1).sqrt().plus(r),c=!0,i.precision=t,i.rounding=e,r.ln()):new i(r)},A.inverseHyperbolicSine=A.asinh=function(){var t,e,r=this,i=r.constructor;return!r.isFinite()||r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+2*Math.max(Math.abs(r.e),r.sd())+6,i.rounding=1,c=!1,r=r.times(r).plus(1).sqrt().plus(r),c=!0,i.precision=t,i.rounding=e,r.ln())},A.inverseHyperbolicTangent=A.atanh=function(){var t,e,r,i,n=this,s=n.constructor;return n.isFinite()?n.e>=0?new s(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(t=s.precision,e=s.rounding,i=n.sd(),Math.max(i,t)<2*-n.e-1?P(new s(n),t,e,!0):(s.precision=r=i-n.e,n=I(n.plus(1),new s(1).minus(n),r+t,1),s.precision=t+4,s.rounding=1,n=n.ln(),s.precision=t,s.rounding=e,n.times(.5))):new s(NaN)},A.inverseSine=A.asin=function(){var t,e,r,i,n=this,s=n.constructor;return n.isZero()?new s(n):(e=n.abs().cmp(1),r=s.precision,i=s.rounding,-1!==e?0===e?((t=L(s,r+4,i).times(.5)).s=n.s,t):new s(NaN):(s.precision=r+6,s.rounding=1,n=n.div(new s(1).minus(n.times(n)).sqrt().plus(1)).atan(),s.precision=r,s.rounding=i,n.times(2)))},A.inverseTangent=A.atan=function(){var t,e,r,i,n,s,a,o,h,u=this,l=u.constructor,f=l.precision,d=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&f+4<=S)return(a=L(l,f+4,d).times(.25)).s=u.s,a}else{if(!u.s)return new l(NaN);if(f+4<=S)return(a=L(l,f+4,d).times(.5)).s=u.s,a}for(l.precision=o=f+10,l.rounding=1,t=r=Math.min(28,o/7+2|0);t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(c=!1,e=Math.ceil(o/7),i=1,h=u.times(u),a=new l(u),n=u;-1!==t;)if(n=n.times(h),s=a.minus(n.div(i+=2)),n=n.times(h),void 0!==(a=s.plus(n.div(i+=2))).d[e])for(t=e;a.d[t]===s.d[t]&&t--;);return r&&(a=a.times(2<<r-1)),c=!0,P(a,l.precision=f,l.rounding=d,!0)},A.isFinite=function(){return!!this.d},A.isInteger=A.isInt=function(){return!!this.d&&v(this.e/7)>this.d.length-2},A.isNaN=function(){return!this.s},A.isNegative=A.isNeg=function(){return this.s<0},A.isPositive=A.isPos=function(){return this.s>0},A.isZero=function(){return!!this.d&&0===this.d[0]},A.lessThan=A.lt=function(t){return this.cmp(t)<0},A.lessThanOrEqualTo=A.lte=function(t){return this.cmp(t)<1},A.logarithm=A.log=function(t){var e,r,i,n,s,a,o,h,u=this,l=u.constructor,f=l.precision,d=l.rounding;if(null==t)t=new l(10),e=!0;else{if(r=(t=new l(t)).d,t.s<0||!r||!r[0]||t.eq(1))return new l(NaN);e=t.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new l(r&&!r[0]?-1/0:1!=u.s?NaN:r?0:1/0);if(e)if(r.length>1)s=!0;else{for(n=r[0];n%10==0;)n/=10;s=1!==n}if(c=!1,a=j(u,o=f+5),i=e?B(l,o+10):j(t,o),D((h=I(a,i,o,1)).d,n=f,d))do{if(a=j(u,o+=10),i=e?B(l,o+10):j(t,o),h=I(a,i,o,1),!s){+T(h.d).slice(n+1,n+15)+1==1e14&&(h=P(h,f+1,0));break}}while(D(h.d,n+=10,d));return c=!0,P(h,f,d)},A.minus=A.sub=function(t){var e,r,i,n,s,a,o,h,u,l,f,d,p=this,m=p.constructor;if(t=new m(t),!p.d||!t.d)return p.s&&t.s?p.d?t.s=-t.s:t=new m(t.d||p.s!==t.s?p:NaN):t=new m(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(u=p.d,d=t.d,o=m.precision,h=m.rounding,!u[0]||!d[0]){if(d[0])t.s=-t.s;else{if(!u[0])return new m(3===h?-0:0);t=new m(p)}return c?P(t,o,h):t}if(r=v(t.e/7),l=v(p.e/7),u=u.slice(),s=l-r){for((f=s<0)?(e=u,s=-s,a=d.length):(e=d,r=l,a=u.length),s>(i=Math.max(Math.ceil(o/7),a)+2)&&(s=i,e.length=1),e.reverse(),i=s;i--;)e.push(0);e.reverse()}else{for((f=(i=u.length)<(a=d.length))&&(a=i),i=0;i<a;i++)if(u[i]!=d[i]){f=u[i]<d[i];break}s=0}for(f&&(e=u,u=d,d=e,t.s=-t.s),a=u.length,i=d.length-a;i>0;--i)u[a++]=0;for(i=d.length;i>s;){if(u[--i]<d[i]){for(n=i;n&&0===u[--n];)u[n]=E-1;--u[n],u[i]+=E}u[i]-=d[i]}for(;0===u[--a];)u.pop();for(;0===u[0];u.shift())--r;return u[0]?(t.d=u,t.e=k(u,r),c?P(t,o,h):t):new m(3===h?-0:0)},A.modulo=A.mod=function(t){var e,r=this,i=r.constructor;return t=new i(t),!r.d||!t.s||t.d&&!t.d[0]?new i(NaN):!t.d||r.d&&!r.d[0]?P(new i(r),i.precision,i.rounding):(c=!1,9==i.modulo?(e=I(r,t.abs(),0,3,1)).s*=t.s:e=I(r,t,0,i.modulo,1),e=e.times(t),c=!0,r.minus(e))},A.naturalExponential=A.exp=function(){return H(this)},A.naturalLogarithm=A.ln=function(){return j(this)},A.negated=A.neg=function(){var t=new this.constructor(this);return t.s=-t.s,P(t)},A.plus=A.add=function(t){var e,r,i,n,s,a,o,h,u,l,f=this,d=f.constructor;if(t=new d(t),!f.d||!t.d)return f.s&&t.s?f.d||(t=new d(t.d||f.s===t.s?f:NaN)):t=new d(NaN),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(u=f.d,l=t.d,o=d.precision,h=d.rounding,!u[0]||!l[0])return l[0]||(t=new d(f)),c?P(t,o,h):t;if(s=v(f.e/7),i=v(t.e/7),u=u.slice(),n=s-i){for(n<0?(r=u,n=-n,a=l.length):(r=l,i=s,a=u.length),n>(a=(s=Math.ceil(o/7))>a?s+1:a+1)&&(n=a,r.length=1),r.reverse();n--;)r.push(0);r.reverse()}for((a=u.length)-(n=l.length)<0&&(n=a,r=l,l=u,u=r),e=0;n;)e=(u[--n]=u[n]+l[n]+e)/E|0,u[n]%=E;for(e&&(u.unshift(e),++i),a=u.length;0==u[--a];)u.pop();return t.d=u,t.e=k(u,i),c?P(t,o,h):t},A.precision=A.sd=function(t){var e,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(d+t);return r.d?(e=O(r.d),t&&r.e+1>e&&(e=r.e+1)):e=NaN,e},A.round=function(){var t=this,e=t.constructor;return P(new e(t),t.e+1,e.rounding)},A.sine=A.sin=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+Math.max(r.e,r.sd())+7,i.rounding=1,r=function(t,e){var r,i=e.d.length;if(i<3)return e.isZero()?e:X(t,2,e,e);r=(r=1.4*Math.sqrt(i))>16?16:0|r,e=e.times(1/Y(5,r)),e=X(t,2,e,e);for(var n,s=new t(5),a=new t(16),o=new t(20);r--;)n=e.times(e),e=e.times(s.plus(n.times(a.times(n).minus(o))));return e}(i,Z(i,r)),i.precision=t,i.rounding=e,P(n>2?r.neg():r,t,e,!0)):new i(NaN)},A.squareRoot=A.sqrt=function(){var t,e,r,i,n,s,a=this,o=a.d,h=a.e,u=a.s,l=a.constructor;if(1!==u||!o||!o[0])return new l(!u||u<0&&(!o||o[0])?NaN:o?a:1/0);for(c=!1,0==(u=Math.sqrt(+a))||u==1/0?(((e=T(o)).length+h)%2==0&&(e+="0"),u=Math.sqrt(e),h=v((h+1)/2)-(h<0||h%2),i=new l(e=u==1/0?"5e"+h:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+h)):i=new l(u.toString()),r=(h=l.precision)+3;;)if(i=(s=i).plus(I(a,s,r+2,1)).times(.5),T(s.d).slice(0,r)===(e=T(i.d)).slice(0,r)){if("9999"!=(e=e.slice(r-3,r+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(P(i,h+1,1),t=!i.times(i).eq(a));break}if(!n&&(P(s,h+1,0),s.times(s).eq(a))){i=s;break}r+=4,n=1}return c=!0,P(i,h,l.rounding,t)},A.tangent=A.tan=function(){var t,e,r=this,i=r.constructor;return r.isFinite()?r.isZero()?new i(r):(t=i.precision,e=i.rounding,i.precision=t+10,i.rounding=1,(r=r.sin()).s=1,r=I(r,new i(1).minus(r.times(r)).sqrt(),t+10,0),i.precision=t,i.rounding=e,P(2==n||4==n?r.neg():r,t,e,!0)):new i(NaN)},A.times=A.mul=function(t){var e,r,i,n,s,a,o,h,u,l=this,f=l.constructor,d=l.d,p=(t=new f(t)).d;if(t.s*=l.s,!(d&&d[0]&&p&&p[0]))return new f(!t.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:d&&p?0*t.s:t.s/0);for(r=v(l.e/7)+v(t.e/7),(h=d.length)<(u=p.length)&&(s=d,d=p,p=s,a=h,h=u,u=a),s=[],i=a=h+u;i--;)s.push(0);for(i=u;--i>=0;){for(e=0,n=h+i;n>i;)o=s[n]+p[i]*d[n-i-1]+e,s[n--]=o%E|0,e=o/E|0;s[n]=(s[n]+e)%E|0}for(;!s[--a];)s.pop();return e?++r:s.shift(),t.d=s,t.e=k(s,r),c?P(t,f.precision,f.rounding):t},A.toBinary=function(t,e){return $(this,2,t,e)},A.toDecimalPlaces=A.toDP=function(t,e){var r=this,i=r.constructor;return r=new i(r),void 0===t?r:(C(t,0,a),void 0===e?e=i.rounding:C(e,0,8),P(r,t+r.e+1,e))},A.toExponential=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=N(i,!0):(C(t,0,a),void 0===e?e=n.rounding:C(e,0,8),r=N(i=P(new n(i),t+1,e),!0,t+1)),i.isNeg()&&!i.isZero()?"-"+r:r},A.toFixed=function(t,e){var r,i,n=this,s=n.constructor;return void 0===t?r=N(n):(C(t,0,a),void 0===e?e=s.rounding:C(e,0,8),r=N(i=P(new s(n),t+n.e+1,e),!1,t+i.e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},A.toFraction=function(t){var e,r,i,n,s,a,o,h,u,l,f,p,m=this,g=m.d,v=m.constructor;if(!g)return new v(m);if(u=r=new v(1),i=h=new v(0),a=(s=(e=new v(i)).e=O(g)-m.e-1)%7,e.d[0]=_(10,a<0?7+a:a),null==t)t=s>0?e:u;else{if(!(o=new v(t)).isInt()||o.lt(u))throw Error(d+o);t=o.gt(e)?s>0?e:u:o}for(c=!1,o=new v(T(g)),l=v.precision,v.precision=s=7*g.length*2;f=I(o,e,0,1,1),1!=(n=r.plus(f.times(i))).cmp(t);)r=i,i=n,n=u,u=h.plus(f.times(n)),h=n,n=e,e=o.minus(f.times(n)),o=n;return n=I(t.minus(r),i,0,1,1),h=h.plus(n.times(u)),r=r.plus(n.times(i)),h.s=u.s=m.s,p=I(u,i,s,1).minus(m).abs().cmp(I(h,r,s,1).minus(m).abs())<1?[u,i]:[h,r],v.precision=l,c=!0,p},A.toHexadecimal=A.toHex=function(t,e){return $(this,16,t,e)},A.toNearest=function(t,e){var r=this,i=r.constructor;if(r=new i(r),null==t){if(!r.d)return r;t=new i(1),e=i.rounding}else{if(t=new i(t),void 0===e?e=i.rounding:C(e,0,8),!r.d)return t.s?r:t;if(!t.d)return t.s&&(t.s=r.s),t}return t.d[0]?(c=!1,r=I(r,t,0,e,1).times(t),c=!0,P(r)):(t.s=r.s,r=t),r},A.toNumber=function(){return+this},A.toOctal=function(t,e){return $(this,8,t,e)},A.toPower=A.pow=function(t){var e,r,i,n,s,a,o=this,h=o.constructor,u=+(t=new h(t));if(!(o.d&&t.d&&o.d[0]&&t.d[0]))return new h(_(+o,u));if((o=new h(o)).eq(1))return o;if(i=h.precision,s=h.rounding,t.eq(1))return P(o,i,s);if((e=v(t.e/7))>=t.d.length-1&&(r=u<0?-u:u)<=9007199254740991)return n=U(h,o,r,i),t.s<0?new h(1).div(n):P(n,i,s);if((a=o.s)<0){if(e<t.d.length-1)return new h(NaN);if(0==(1&t.d[e])&&(a=1),0==o.e&&1==o.d[0]&&1==o.d.length)return o.s=a,o}return(e=0!=(r=_(+o,u))&&isFinite(r)?new h(r+"").e:v(u*(Math.log("0."+T(o.d))/Math.LN10+o.e+1)))>h.maxE+1||e<h.minE-1?new h(e>0?a/0:0):(c=!1,h.rounding=o.s=1,r=Math.min(12,(e+"").length),(n=H(t.times(j(o,i+r)),i)).d&&D((n=P(n,i+5,1)).d,i,s)&&(e=i+10,+T((n=P(H(t.times(j(o,e+r)),e),e+5,1)).d).slice(i+1,i+15)+1==1e14&&(n=P(n,i+1,0))),n.s=a,c=!0,h.rounding=s,P(n,i,s))},A.toPrecision=function(t,e){var r,i=this,n=i.constructor;return void 0===t?r=N(i,i.e<=n.toExpNeg||i.e>=n.toExpPos):(C(t,1,a),void 0===e?e=n.rounding:C(e,0,8),r=N(i=P(new n(i),t,e),t<=i.e||i.e<=n.toExpNeg,t)),i.isNeg()&&!i.isZero()?"-"+r:r},A.toSignificantDigits=A.toSD=function(t,e){var r=this.constructor;return void 0===t?(t=r.precision,e=r.rounding):(C(t,1,a),void 0===e?e=r.rounding:C(e,0,8)),P(new r(this),t,e)},A.toString=function(){var t=this,e=t.constructor,r=N(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+r:r},A.truncated=A.trunc=function(){return P(new this.constructor(this),this.e+1,1)},A.valueOf=A.toJSON=function(){var t=this,e=t.constructor,r=N(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+r:r};var I=function(){function t(t,e,r){var i,n=0,s=t.length;for(t=t.slice();s--;)i=t[s]*e+n,t[s]=i%r|0,n=i/r|0;return n&&t.unshift(n),t}function e(t,e,r,i){var n,s;if(r!=i)s=r>i?1:-1;else for(n=s=0;n<r;n++)if(t[n]!=e[n]){s=t[n]>e[n]?1:-1;break}return s}function i(t,e,r,i){for(var n=0;r--;)t[r]-=n,n=t[r]<e[r]?1:0,t[r]=n*i+t[r]-e[r];for(;!t[0]&&t.length>1;)t.shift()}return function(n,s,a,o,h,u){var l,c,f,d,p,m,g,_,b,y,x,w,M,S,A,T,C,D,R,I,N=n.constructor,k=n.s==s.s?1:-1,B=n.d,L=s.d;if(!(B&&B[0]&&L&&L[0]))return new N(n.s&&s.s&&(B?!L||B[0]!=L[0]:L)?B&&0==B[0]||!L?0*k:k/0:NaN);for(u?(p=1,c=n.e-s.e):(u=E,p=7,c=v(n.e/p)-v(s.e/p)),R=L.length,C=B.length,y=(b=new N(k)).d=[],f=0;L[f]==(B[f]||0);f++);if(L[f]>(B[f]||0)&&c--,null==a?(S=a=N.precision,o=N.rounding):S=h?a+(n.e-s.e)+1:a,S<0)y.push(1),m=!0;else{if(S=S/p+2|0,f=0,1==R){for(d=0,L=L[0],S++;(f<C||d)&&S--;f++)A=d*u+(B[f]||0),y[f]=A/L|0,d=A%L|0;m=d||f<C}else{for((d=u/(L[0]+1)|0)>1&&(L=t(L,d,u),B=t(B,d,u),R=L.length,C=B.length),T=R,w=(x=B.slice(0,R)).length;w<R;)x[w++]=0;(I=L.slice()).unshift(0),D=L[0],L[1]>=u/2&&++D;do{d=0,(l=e(L,x,R,w))<0?(M=x[0],R!=w&&(M=M*u+(x[1]||0)),(d=M/D|0)>1?(d>=u&&(d=u-1),1==(l=e(g=t(L,d,u),x,_=g.length,w=x.length))&&(d--,i(g,R<_?I:L,_,u))):(0==d&&(l=d=1),g=L.slice()),(_=g.length)<w&&g.unshift(0),i(x,g,w,u),-1==l&&(l=e(L,x,R,w=x.length))<1&&(d++,i(x,R<w?I:L,w,u)),w=x.length):0===l&&(d++,x=[0]),y[f++]=d,l&&x[0]?x[w++]=B[T]||0:(x=[B[T]],w=1)}while((T++<C||void 0!==x[0])&&S--);m=void 0!==x[0]}y[0]||y.shift()}if(1==p)b.e=c,r=m;else{for(f=1,d=y[0];d>=10;d/=10)f++;b.e=f+c*p-1,P(b,h?a+b.e+1:a,o,m)}return b}}();function P(t,e,r,i){var n,s,a,o,h,u,l,f,d,p=t.constructor;t:if(null!=e){if(!(f=t.d))return t;for(n=1,o=f[0];o>=10;o/=10)n++;if((s=e-n)<0)s+=7,a=e,h=(l=f[d=0])/_(10,n-a-1)%10|0;else if((d=Math.ceil((s+1)/7))>=(o=f.length)){if(!i)break t;for(;o++<=d;)f.push(0);l=h=0,n=1,a=(s%=7)-7+1}else{for(l=o=f[d],n=1;o>=10;o/=10)n++;h=(a=(s%=7)-7+n)<0?0:l/_(10,n-a-1)%10|0}if(i=i||e<0||void 0!==f[d+1]||(a<0?l:l%_(10,n-a-1)),u=r<4?(h||i)&&(0==r||r==(t.s<0?3:2)):h>5||5==h&&(4==r||i||6==r&&(s>0?a>0?l/_(10,n-a):0:f[d-1])%10&1||r==(t.s<0?8:7)),e<1||!f[0])return f.length=0,u?(e-=t.e+1,f[0]=_(10,(7-e%7)%7),t.e=-e||0):f[0]=t.e=0,t;if(0==s?(f.length=d,o=1,d--):(f.length=d+1,o=_(10,7-s),f[d]=a>0?(l/_(10,n-a)%_(10,a)|0)*o:0),u)for(;;){if(0==d){for(s=1,a=f[0];a>=10;a/=10)s++;for(a=f[0]+=o,o=1;a>=10;a/=10)o++;s!=o&&(t.e++,f[0]==E&&(f[0]=1));break}if(f[d]+=o,f[d]!=E)break;f[d--]=0,o=1}for(s=f.length;0===f[--s];)f.pop()}return c&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function N(t,e,r){if(!t.isFinite())return V(t);var i,n=t.e,s=T(t.d),a=s.length;return e?(r&&(i=r-a)>0?s=s.charAt(0)+"."+s.slice(1)+F(i):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(t.e<0?"e":"e+")+t.e):n<0?(s="0."+F(-n-1)+s,r&&(i=r-a)>0&&(s+=F(i))):n>=a?(s+=F(n+1-a),r&&(i=r-n-1)>0&&(s=s+"."+F(i))):((i=n+1)<a&&(s=s.slice(0,i)+"."+s.slice(i)),r&&(i=r-a)>0&&(n+1===a&&(s+="."),s+=F(i))),s}function k(t,e){var r=t[0];for(e*=7;r>=10;r/=10)e++;return e}function B(t,e,r){if(e>M)throw c=!0,r&&(t.precision=r),Error(p);return P(new t(h),e,1,!0)}function L(t,e,r){if(e>S)throw Error(p);return P(new t(u),e,r,!0)}function O(t){var e=t.length-1,r=7*e+1;if(e=t[e]){for(;e%10==0;e/=10)r--;for(e=t[0];e>=10;e/=10)r++}return r}function F(t){for(var e="";t--;)e+="0";return e}function U(t,e,r,i){var n,s=new t(1),a=Math.ceil(i/7+4);for(c=!1;;){if(r%2&&K((s=s.times(e)).d,a)&&(n=!0),0===(r=v(r/2))){r=s.d.length-1,n&&0===s.d[r]&&++s.d[r];break}K((e=e.times(e)).d,a)}return c=!0,s}function z(t){return 1&t.d[t.d.length-1]}function G(t,e,r){for(var i,n=new t(e[0]),s=0;++s<e.length;){if(!(i=new t(e[s])).s){n=i;break}n[r](i)&&(n=i)}return n}function H(t,e){var r,i,n,s,a,o,h,u=0,l=0,f=0,d=t.constructor,p=d.rounding,m=d.precision;if(!t.d||!t.d[0]||t.e>17)return new d(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(c=!1,h=m):h=e,o=new d(.03125);t.e>-2;)t=t.times(o),f+=5;for(h+=i=Math.log(_(2,f))/Math.LN10*2+5|0,r=s=a=new d(1),d.precision=h;;){if(s=P(s.times(t),h,1),r=r.times(++l),T((o=a.plus(I(s,r,h,1))).d).slice(0,h)===T(a.d).slice(0,h)){for(n=f;n--;)a=P(a.times(a),h,1);if(null!=e)return d.precision=m,a;if(!(u<3&&D(a.d,h-i,p,u)))return P(a,d.precision=m,p,c=!0);d.precision=h+=10,r=s=o=new d(1),l=0,u++}a=o}}function j(t,e){var r,i,n,s,a,o,h,u,l,f,d,p=1,m=t,g=m.d,v=m.constructor,_=v.rounding,b=v.precision;if(m.s<0||!g||!g[0]||!m.e&&1==g[0]&&1==g.length)return new v(g&&!g[0]?-1/0:1!=m.s?NaN:g?0:m);if(null==e?(c=!1,l=b):l=e,v.precision=l+=10,i=(r=T(g)).charAt(0),!(Math.abs(s=m.e)<15e14))return u=B(v,l+2,b).times(s+""),m=j(new v(i+"."+r.slice(1)),l-10).plus(u),v.precision=b,null==e?P(m,b,_,c=!0):m;for(;i<7&&1!=i||1==i&&r.charAt(1)>3;)i=(r=T((m=m.times(t)).d)).charAt(0),p++;for(s=m.e,i>1?(m=new v("0."+r),s++):m=new v(i+"."+r.slice(1)),f=m,h=a=m=I(m.minus(1),m.plus(1),l,1),d=P(m.times(m),l,1),n=3;;){if(a=P(a.times(d),l,1),T((u=h.plus(I(a,new v(n),l,1))).d).slice(0,l)===T(h.d).slice(0,l)){if(h=h.times(2),0!==s&&(h=h.plus(B(v,l+2,b).times(s+""))),h=I(h,new v(p),l,1),null!=e)return v.precision=b,h;if(!D(h.d,l-10,_,o))return P(h,v.precision=b,_,c=!0);v.precision=l+=10,u=a=m=I(f.minus(1),f.plus(1),l,1),d=P(m.times(m),l,1),n=o=1}h=u,n+=2}}function V(t){return String(t.s*t.s/0)}function W(t,e){var r,i,n;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(r<0&&(r=i),r+=+e.slice(i+1),e=e.substring(0,i)):r<0&&(r=e.length),i=0;48===e.charCodeAt(i);i++);for(n=e.length;48===e.charCodeAt(n-1);--n);if(e=e.slice(i,n)){if(n-=i,t.e=r=r-i-1,t.d=[],i=(r+1)%7,r<0&&(i+=7),i<n){for(i&&t.d.push(+e.slice(0,i)),n-=7;i<n;)t.d.push(+e.slice(i,i+=7));i=7-(e=e.slice(i)).length}else i-=n;for(;i--;)e+="0";t.d.push(+e),c&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function q(t,r){var i,n,s,a,o,h,u,l,f;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),w.test(r))return W(t,r)}else if("Infinity"===r||"NaN"===r)return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(y.test(r))i=16,r=r.toLowerCase();else if(b.test(r))i=2;else{if(!x.test(r))throw Error(d+r);i=8}for((a=r.search(/p/i))>0?(u=+r.slice(a+1),r=r.substring(2,a)):r=r.slice(2),o=(a=r.indexOf("."))>=0,n=t.constructor,o&&(a=(h=(r=r.replace(".","")).length)-a,s=U(n,new n(i),a,2*a)),a=f=(l=R(r,i,E)).length-1;0===l[a];--a)l.pop();return a<0?new n(0*t.s):(t.e=k(l,f),t.d=l,c=!1,o&&(t=I(t,s,4*h)),u&&(t=t.times(Math.abs(u)<54?_(2,u):e.pow(2,u))),c=!0,t)}function X(t,e,r,i,n){var s,a,o,h,u=t.precision,l=Math.ceil(u/7);for(c=!1,h=r.times(r),o=new t(i);;){if(a=I(o.times(h),new t(e++*e++),u,1),o=n?i.plus(a):i.minus(a),i=I(a.times(h),new t(e++*e++),u,1),void 0!==(a=o.plus(i)).d[l]){for(s=l;a.d[s]===o.d[s]&&s--;);if(-1==s)break}s=o,o=i,i=a,a=s}return c=!0,a.d.length=l+1,a}function Y(t,e){for(var r=t;--e;)r*=t;return r}function Z(t,e){var r,i=e.s<0,s=L(t,t.precision,1),a=s.times(.5);if((e=e.abs()).lte(a))return n=i?4:1,e;if((r=e.divToInt(s)).isZero())n=i?3:2;else{if((e=e.minus(r.times(s))).lte(a))return n=z(r)?i?2:3:i?4:1,e;n=z(r)?i?1:4:i?3:2}return e.minus(s).abs()}function $(t,e,i,n){var s,h,u,l,c,f,d,p,m,g=t.constructor,v=void 0!==i;if(v?(C(i,1,a),void 0===n?n=g.rounding:C(n,0,8)):(i=g.precision,n=g.rounding),t.isFinite()){for(v?(s=2,16==e?i=4*i-3:8==e&&(i=3*i-2)):s=e,(u=(d=N(t)).indexOf("."))>=0&&(d=d.replace(".",""),(m=new g(1)).e=d.length-u,m.d=R(N(m),10,s),m.e=m.d.length),h=c=(p=R(d,10,s)).length;0==p[--c];)p.pop();if(p[0]){if(u<0?h--:((t=new g(t)).d=p,t.e=h,p=(t=I(t,m,i,n,0,s)).d,h=t.e,f=r),u=p[i],l=s/2,f=f||void 0!==p[i+1],f=n<4?(void 0!==u||f)&&(0===n||n===(t.s<0?3:2)):u>l||u===l&&(4===n||f||6===n&&1&p[i-1]||n===(t.s<0?8:7)),p.length=i,f)for(;++p[--i]>s-1;)p[i]=0,i||(++h,p.unshift(1));for(c=p.length;!p[c-1];--c);for(u=0,d="";u<c;u++)d+=o.charAt(p[u]);if(v){if(c>1)if(16==e||8==e){for(u=16==e?4:3,--c;c%u;c++)d+="0";for(c=(p=R(d,s,e)).length;!p[c-1];--c);for(u=1,d="1.";u<c;u++)d+=o.charAt(p[u])}else d=d.charAt(0)+"."+d.slice(1);d=d+(h<0?"p":"p+")+h}else if(h<0){for(;++h;)d="0"+d;d="0."+d}else if(++h>c)for(h-=c;h--;)d+="0";else h<c&&(d=d.slice(0,h)+"."+d.slice(h))}else d=v?"0p+0":"0";d=(16==e?"0x":2==e?"0b":8==e?"0o":"")+d}else d=V(t);return t.s<0?"-"+d:d}function K(t,e){if(t.length>e)return t.length=e,!0}function J(t){return new this(t).abs()}function Q(t){return new this(t).acos()}function tt(t){return new this(t).acosh()}function et(t,e){return new this(t).plus(e)}function rt(t){return new this(t).asin()}function it(t){return new this(t).asinh()}function nt(t){return new this(t).atan()}function st(t){return new this(t).atanh()}function at(t,e){t=new this(t),e=new this(e);var r,i=this.precision,n=this.rounding,s=i+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(r=e.s<0?L(this,i,n):new this(0)).s=t.s:!t.d||e.isZero()?(r=L(this,s,1).times(.5)).s=t.s:e.s<0?(this.precision=s,this.rounding=1,r=this.atan(I(t,e,s,1)),e=L(this,s,1),this.precision=i,this.rounding=n,r=t.s<0?r.minus(e):r.plus(e)):r=this.atan(I(t,e,s,1)):(r=L(this,s,1).times(e.s>0?.25:.75)).s=t.s:r=new this(NaN),r}function ot(t){return new this(t).cbrt()}function ht(t){return P(t=new this(t),t.e+1,2)}function ut(t,e,r){return new this(t).clamp(e,r)}function lt(t){if(!t||"object"!=typeof t)throw Error(f+"Object expected");var e,r,i,n=!0===t.defaults,o=["precision",1,a,"rounding",0,8,"toExpNeg",-s,0,"toExpPos",0,s,"maxE",0,s,"minE",-s,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(r=o[e],n&&(this[r]=l[r]),void 0!==(i=t[r])){if(!(v(i)===i&&i>=o[e+1]&&i<=o[e+2]))throw Error(d+r+": "+i);this[r]=i}if(r="crypto",n&&(this[r]=l[r]),void 0!==(i=t[r])){if(!0!==i&&!1!==i&&0!==i&&1!==i)throw Error(d+r+": "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(m);this[r]=!0}else this[r]=!1}return this}function ct(t){return new this(t).cos()}function ft(t){return new this(t).cosh()}function dt(t,e){return new this(t).div(e)}function pt(t){return new this(t).exp()}function mt(t){return P(t=new this(t),t.e+1,3)}function gt(){var t,e,r=new this(0);for(c=!1,t=0;t<arguments.length;)if((e=new this(arguments[t++])).d)r.d&&(r=r.plus(e.times(e)));else{if(e.s)return c=!0,new this(1/0);r=e}return c=!0,r.sqrt()}function vt(t){return t instanceof e||t&&t.toStringTag===g||!1}function _t(t){return new this(t).ln()}function bt(t,e){return new this(t).log(e)}function yt(t){return new this(t).log(2)}function xt(t){return new this(t).log(10)}function wt(){return G(this,arguments,"lt")}function Et(){return G(this,arguments,"gt")}function Mt(t,e){return new this(t).mod(e)}function St(t,e){return new this(t).mul(e)}function At(t,e){return new this(t).pow(e)}function Tt(t){var e,r,i,n,s=0,o=new this(1),h=[];if(void 0===t?t=this.precision:C(t,1,a),i=Math.ceil(t/7),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(i));s<i;)(n=e[s])>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:h[s++]=n%1e7;else{if(!crypto.randomBytes)throw Error(m);for(e=crypto.randomBytes(i*=4);s<i;)(n=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((127&e[s+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,s):(h.push(n%1e7),s+=4);s=i/4}else for(;s<i;)h[s++]=1e7*Math.random()|0;for(t%=7,(i=h[--s])&&t&&(n=_(10,7-t),h[s]=(i/n|0)*n);0===h[s];s--)h.pop();if(s<0)r=0,h=[0];else{for(r=-1;0===h[0];r-=7)h.shift();for(i=1,n=h[0];n>=10;n/=10)i++;i<7&&(r-=7-i)}return o.e=r,o.d=h,o}function Ct(t){return P(t=new this(t),t.e+1,this.rounding)}function Dt(t){return(t=new this(t)).d?t.d[0]?t.s:0*t.s:t.s||NaN}function Rt(t){return new this(t).sin()}function It(t){return new this(t).sinh()}function Pt(t){return new this(t).sqrt()}function Nt(t,e){return new this(t).sub(e)}function kt(){var t=0,e=arguments,r=new this(e[t]);for(c=!1;r.s&&++t<e.length;)r=r.plus(e[t]);return c=!0,P(r,this.precision,this.rounding)}function Bt(t){return new this(t).tan()}function Lt(t){return new this(t).tanh()}function Ot(t){return P(t=new this(t),t.e+1,1)}e=function t(e){var r,i,n;function s(t){var e,r,i,n=this;if(!(n instanceof s))return new s(t);if(n.constructor=s,vt(t))return n.s=t.s,void(c?!t.d||t.e>s.maxE?(n.e=NaN,n.d=null):t.e<s.minE?(n.e=0,n.d=[0]):(n.e=t.e,n.d=t.d.slice()):(n.e=t.e,n.d=t.d?t.d.slice():t.d));if("number"===(i=typeof t)){if(0===t)return n.s=1/t<0?-1:1,n.e=0,void(n.d=[0]);if(t<0?(t=-t,n.s=-1):n.s=1,t===~~t&&t<1e7){for(e=0,r=t;r>=10;r/=10)e++;return void(c?e>s.maxE?(n.e=NaN,n.d=null):e<s.minE?(n.e=0,n.d=[0]):(n.e=e,n.d=[t]):(n.e=e,n.d=[t]))}return 0*t!=0?(t||(n.s=NaN),n.e=NaN,void(n.d=null)):W(n,t.toString())}if("string"!==i)throw Error(d+t);return 45===(r=t.charCodeAt(0))?(t=t.slice(1),n.s=-1):(43===r&&(t=t.slice(1)),n.s=1),w.test(t)?W(n,t):q(n,t)}if(s.prototype=A,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.EUCLID=9,s.config=s.set=lt,s.clone=t,s.isDecimal=vt,s.abs=J,s.acos=Q,s.acosh=tt,s.add=et,s.asin=rt,s.asinh=it,s.atan=nt,s.atanh=st,s.atan2=at,s.cbrt=ot,s.ceil=ht,s.clamp=ut,s.cos=ct,s.cosh=ft,s.div=dt,s.exp=pt,s.floor=mt,s.hypot=gt,s.ln=_t,s.log=bt,s.log10=xt,s.log2=yt,s.max=wt,s.min=Et,s.mod=Mt,s.mul=St,s.pow=At,s.random=Tt,s.round=Ct,s.sign=Dt,s.sin=Rt,s.sinh=It,s.sqrt=Pt,s.sub=Nt,s.sum=kt,s.tan=Bt,s.tanh=Lt,s.trunc=Ot,void 0===e&&(e={}),e&&!0!==e.defaults)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)e.hasOwnProperty(i=n[r++])||(e[i]=this[i]);return s.config(e),s}(l),e.prototype.constructor=e,e.default=e.Decimal=e,h=new e(h),u=new e(u),"function"==typeof define&&define.amd?define((function(){return e})):tb?("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(A[Symbol.for("nodejs.util.inspect.custom")]=A.toString,A[Symbol.toStringTag]="Decimal"),tb=e):(t||(t="undefined"!=typeof self&&self&&self.self==self?self:window),i=t.Decimal,e.noConflict=function(){return t.Decimal=i,e},t.Decimal=e)}(tb);var rb=Math.sign||function(t){return t>0?1:t<0?-1:0},ib=Math.log2||function(t){return Math.log(t)/Math.LN2},nb=Math.log10||function(t){return Math.log(t)/Math.LN10},sb=(Math.log1p,Math.cbrt||function(t){if(0===t)return t;var e,r=t<0;return r&&(t=-t),e=isFinite(t)?(t/((e=Math.exp(Math.log(t)/3))*e)+2*e)/3:t,r?-e:e}),ab=Math.expm1||function(t){return t>=2e-4||t<=-2e-4?Math.exp(t)-1:t+t*t/2+t*t*t/6};function ob(t,e,r){var i={2:"0b",8:"0o",16:"0x"}[e],n="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!eb(r))throw new Error("size must be an integer");if(t>2**(r-1)-1||t<-(2**(r-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!eb(t))throw new Error("Value must be an integer");t<0&&(t+=2**r),n="i".concat(r)}var s="";return t<0&&(t=-t,s="-"),"".concat(s).concat(i).concat(t.toString(e)).concat(n)}function hb(t,e){if("function"==typeof e)return e(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var r,i,n="auto";if(e&&(e.notation&&(n=e.notation),s_(e)?r=e:s_(e.precision)&&(r=e.precision),e.wordSize&&"number"!=typeof(i=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return lb(t,r);case"exponential":return cb(t,r);case"engineering":return function(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=ub(t),i=fb(r,e),n=i.exponent,s=i.coefficients,a=n%3==0?n:n<0?n-3-n%3:n-n%3;if(s_(e))for(;e>s.length||n-a+1>s.length;)s.push(0);else for(var o=Math.abs(n-a)-(s.length-1),h=0;h<o;h++)s.push(0);var u=Math.abs(n-a),l=1;for(;u>0;)l++,u--;var c=s.slice(l).join(""),f=s_(e)&&c.length||c.match(/[1-9]/)?"."+c:"",d=s.slice(0,l).join("")+f+"e"+(n>=0?"+":"")+a.toString();return i.sign+d}(t,r);case"bin":return ob(t,2,i);case"oct":return ob(t,8,i);case"hex":return ob(t,16,i);case"auto":return function(t,e,r){if(isNaN(t)||!isFinite(t))return String(t);var i=r&&void 0!==r.lowerExp?r.lowerExp:-3,n=r&&void 0!==r.upperExp?r.upperExp:5,s=ub(t),a=e?fb(s,e):s;if(a.exponent<i||a.exponent>=n)return cb(t,e);var o=a.coefficients,h=a.exponent;o.length<e&&(o=o.concat(db(e-o.length))),o=o.concat(db(h-o.length+1+(o.length<e?e-o.length:0)));var u=h>0?h:0;return u<(o=db(-h).concat(o)).length-1&&o.splice(u+1,0,"."),a.sign+o.join("")}(t,r,e&&e).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function ub(t){var e=String(t).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var r=e[1],i=e[2],n=parseFloat(e[4]||"0"),s=i.indexOf(".");n+=-1!==s?s-1:i.length-1;var a=i.replace(".","").replace(/^0*/,(function(t){return n-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===a.length&&(a.push(0),n++),{sign:r,coefficients:a,exponent:n}}function lb(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=ub(t),i="number"==typeof e?fb(r,r.exponent+1+e):r,n=i.coefficients,s=i.exponent+1,a=s+(e||0);return n.length<a&&(n=n.concat(db(a-n.length))),s<0&&(n=db(1-s).concat(n),s=1),s<n.length&&n.splice(s,0,0===s?"0.":"."),i.sign+n.join("")}function cb(t,e){if(isNaN(t)||!isFinite(t))return String(t);var r=ub(t),i=e?fb(r,e):r,n=i.coefficients,s=i.exponent;n.length<e&&(n=n.concat(db(e-n.length)));var a=n.shift();return i.sign+a+(n.length>0?"."+n.join(""):"")+"e"+(s>=0?"+":"")+s}function fb(t,e){for(var r={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},i=r.coefficients;e<=0;)i.unshift(0),r.exponent++,e++;if(i.length>e&&i.splice(e,i.length-e)[0]>=5){var n=e-1;for(i[n]++;10===i[n];)i.pop(),0===n&&(i.unshift(0),r.exponent++,n++),i[--n]++}return r}function db(t){for(var e=[],r=0;r<t;r++)e.push(0);return e}var pb=Number.EPSILON||2220446049250313e-31;function mb(t,e,r){if(null==r)return t===e;if(t===e)return!0;if(isNaN(t)||isNaN(e))return!1;if(isFinite(t)&&isFinite(e)){var i=Math.abs(t-e);return i<pb||i<=Math.max(Math.abs(t),Math.abs(e))*r}return!1}var gb=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)},vb=Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},_b=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2},bb=(Math.cosh,Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2});Math.tanh;function yb(t,e,r){var i=new(0,t.constructor)(2),n="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!eb(r))throw new Error("size must be an integer");if(t.greaterThan(i.pow(r-1).sub(1))||t.lessThan(i.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!t.isInteger())throw new Error("Value must be an integer");t.lessThan(0)&&(t=t.add(i.pow(r))),n="i".concat(r)}switch(e){case 2:return"".concat(t.toBinary()).concat(n);case 8:return"".concat(t.toOctal()).concat(n);case 16:return"".concat(t.toHexadecimal()).concat(n);default:throw new Error("Base ".concat(e," not supported "))}}function xb(t,e){if("function"==typeof e)return e(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var r,i,n="auto";if(void 0!==e&&(e.notation&&(n=e.notation),"number"==typeof e?r=e:e.precision&&(r=e.precision),e.wordSize&&"number"!=typeof(i=e.wordSize)))throw new Error('Option "wordSize" must be a number');switch(n){case"fixed":return function(t,e){return t.toFixed(e)}(t,r);case"exponential":return wb(t,r);case"engineering":return function(t,e){var r=t.e,i=r%3==0?r:r<0?r-3-r%3:r-r%3,n=t.mul(Math.pow(10,-i)),s=n.toPrecision(e);-1!==s.indexOf("e")&&(s=n.toString());return s+"e"+(r>=0?"+":"")+i.toString()}(t,r);case"bin":return yb(t,2,i);case"oct":return yb(t,8,i);case"hex":return yb(t,16,i);case"auto":var s=e&&void 0!==e.lowerExp?e.lowerExp:-3,a=e&&void 0!==e.upperExp?e.upperExp:5;if(t.isZero())return"0";var o=t.toSignificantDigits(r),h=o.e;return(h>=s&&h<a?o.toFixed():wb(t,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function wb(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()}function Eb(t,e){var r=t.length-e.length,i=t.length;return t.substring(r,i)===e}function Mb(t,e){var r=function(t,e){if("number"==typeof t)return hb(t,e);if(a_(t))return xb(t,e);if(function(t){return t&&"object"==typeof t&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t))return e&&"decimal"===e.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return Sb(t,e);if(l_(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"==typeof t){return"function"==typeof t.format?t.format(e):t&&t.toString(e)!=={}.toString()?t.toString(e):"{"+Object.keys(t).map((r=>'"'+r+'": '+Mb(t[r],e))).join(", ")+"}"}return String(t)}(t,e);return e&&"object"==typeof e&&"truncate"in e&&r.length>e.truncate?r.substring(0,e.truncate-3)+"...":r}function Sb(t,e){if(Array.isArray(t)){for(var r="[",i=t.length,n=0;n<i;n++)0!==n&&(r+=", "),r+=Sb(t[n],e);return r+="]"}return Mb(t,e)}function Ab(t,e){if(!l_(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+V_(t)+", index: 0)");if(!l_(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+V_(e)+", index: 1)");return t===e?0:t>e?1:-1}function Tb(t,e,r){if(!(this instanceof Tb))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}function Cb(t,e,r){if(!(this instanceof Cb))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function Db(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function Rb(t,e,r){var i,n=t.length;if(n!==e[r])throw new Tb(n,e[r]);if(r<e.length-1){var s=r+1;for(i=0;i<n;i++){var a=t[i];if(!Array.isArray(a))throw new Tb(e.length-1,e.length,"<");Rb(t[i],e,s)}}else for(i=0;i<n;i++)if(Array.isArray(t[i]))throw new Tb(e.length+1,e.length,">")}function Ib(t,e){if(0===e.length){if(Array.isArray(t))throw new Tb(t.length,0)}else Rb(t,e,0)}function Pb(t,e){if(!s_(t)||!eb(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new Cb(t,e)}function Nb(t,e,r){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");return e.forEach((function(t){if(!s_(t)||!eb(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Mb(e)+")")})),kb(t,e,0,void 0!==r?r:0),t}function kb(t,e,r,i){var n,s,a=t.length,o=e[r],h=Math.min(a,o);if(t.length=o,r<e.length-1){var u=r+1;for(n=0;n<h;n++)s=t[n],Array.isArray(s)||(s=[s],t[n]=s),kb(s,e,u,i);for(n=h;n<o;n++)s=[],t[n]=s,kb(s,e,u,i)}else{for(n=0;n<h;n++)for(;Array.isArray(t[n]);)t[n]=t[n][0];for(n=h;n<o;n++)t[n]=i}}function Bb(t,e){var r=zb(t),i=r.length;if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Tb(0,i,"!=");var n=Ob(e=Lb(e,i));if(i!==n)throw new Tb(n,i,"!=");try{return function(t,e){for(var r,i=t,n=e.length-1;n>0;n--){var s=e[n];r=[];for(var a=i.length/s,o=0;o<a;o++)r.push(i.slice(o*s,(o+1)*s));i=r}return i}(r,e)}catch(t){if(t instanceof Tb)throw new Tb(n,i,"!=");throw t}}function Lb(t,e){var r=Ob(t),i=t.slice(),n=t.indexOf(-1);if(t.indexOf(-1,n+1)>=0)throw new Error("More than one wildcard in sizes");if(n>=0){if(!(e%r==0))throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-r);i[n]=-e/r}return i}function Ob(t){return t.reduce(((t,e)=>t*e),1)}function Fb(t,e,r,i){var n=i||Db(t);if(r)for(var s=0;s<r;s++)t=[t],n.unshift(1);for(t=Ub(t,e,0);n.length<e;)n.push(1);return t}function Ub(t,e,r){var i,n;if(Array.isArray(t)){var s=r+1;for(i=0,n=t.length;i<n;i++)t[i]=Ub(t[i],e,s)}else for(var a=r;a<e;a++)t=[t];return t}function zb(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(r){Array.isArray(r)?r.forEach(t):e.push(r)})),e}function Gb(t,e){for(var r,i=0,n=0;n<t.length;n++){var s=t[n],a=Array.isArray(s);if(0===n&&a&&(i=s.length),a&&s.length!==i)return;var o=a?Gb(s,e):e(s);if(void 0===r)r=o;else if(r!==o)return"mixed"}return r}function Hb(t,e,r,i){function n(i){var n=$_(i,e.map(jb));return function(t,e,r){var i=e.filter((t=>!function(t){return t&&"?"===t[0]}(t))).every((t=>void 0!==r[t]));if(!i){var n=e.filter((t=>void 0===r[t]));throw new Error('Cannot create function "'.concat(t,'", ')+"some dependencies are missing: ".concat(n.map((t=>'"'.concat(t,'"'))).join(", "),"."))}}(t,e,i),r(n)}return n.isFactory=!0,n.fn=t,n.dependencies=e.slice().sort(),i&&(n.meta=i),n}function jb(t){return t&&"?"===t[0]?t.slice(1):t}Tb.prototype=new RangeError,Tb.prototype.constructor=RangeError,Tb.prototype.name="DimensionError",Tb.prototype.isDimensionError=!0,Cb.prototype=new RangeError,Cb.prototype.constructor=RangeError,Cb.prototype.name="IndexError",Cb.prototype.isIndexError=!0;var Vb=Hb("BigNumber",["?on","config"],(t=>{var{on:e,config:i}=t,n=r(tb).clone({precision:i.precision,modulo:r(tb).EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(t){return new n(t.value)},e&&e("config",(function(t,e){t.precision!==e.precision&&n.config({precision:t.precision})})),n}),{isClass:!0}),Wb={};
/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(t){var e=Math.cosh||function(t){return Math.abs(t)<1e-9?1-t:.5*(Math.exp(t)+Math.exp(-t))},r=Math.sinh||function(t){return Math.abs(t)<1e-9?t:.5*(Math.exp(t)-Math.exp(-t))},i=function(){throw SyntaxError("Invalid Param")};function n(t,e){var r=Math.abs(t),i=Math.abs(e);return 0===t?Math.log(i):0===e?Math.log(r):r<3e3&&i<3e3?.5*Math.log(t*t+e*e):(t/=2,e/=2,.5*Math.log(t*t+e*e)+Math.LN2)}function s(t,e){if(!(this instanceof s))return new s(t,e);var r=function(t,e){var r={re:0,im:0};if(null==t)r.re=r.im=0;else if(void 0!==e)r.re=t,r.im=e;else switch(typeof t){case"object":if("im"in t&&"re"in t)r.re=t.re,r.im=t.im;else if("abs"in t&&"arg"in t){if(!Number.isFinite(t.abs)&&Number.isFinite(t.arg))return s.INFINITY;r.re=t.abs*Math.cos(t.arg),r.im=t.abs*Math.sin(t.arg)}else if("r"in t&&"phi"in t){if(!Number.isFinite(t.r)&&Number.isFinite(t.phi))return s.INFINITY;r.re=t.r*Math.cos(t.phi),r.im=t.r*Math.sin(t.phi)}else 2===t.length?(r.re=t[0],r.im=t[1]):i();break;case"string":r.im=r.re=0;var n=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),a=1,o=0;null===n&&i();for(var h=0;h<n.length;h++){var u=n[h];" "===u||"\t"===u||"\n"===u||("+"===u?a++:"-"===u?o++:"i"===u||"I"===u?(a+o===0&&i()," "===n[h+1]||isNaN(n[h+1])?r.im+=parseFloat((o%2?"-":"")+"1"):(r.im+=parseFloat((o%2?"-":"")+n[h+1]),h++),a=o=0):((a+o===0||isNaN(u))&&i(),"i"===n[h+1]||"I"===n[h+1]?(r.im+=parseFloat((o%2?"-":"")+u),h++):r.re+=parseFloat((o%2?"-":"")+u),a=o=0))}a+o>0&&i();break;case"number":r.im=0,r.re=t;break;default:i()}return isNaN(r.re)||isNaN(r.im),r}(t,e);this.re=r.re,this.im=r.im}s.prototype={re:0,im:0,sign:function(){var t=this.abs();return new s(this.re/t,this.im/t)},add:function(t,e){var r=new s(t,e);return this.isInfinite()&&r.isInfinite()?s.NAN:this.isInfinite()||r.isInfinite()?s.INFINITY:new s(this.re+r.re,this.im+r.im)},sub:function(t,e){var r=new s(t,e);return this.isInfinite()&&r.isInfinite()?s.NAN:this.isInfinite()||r.isInfinite()?s.INFINITY:new s(this.re-r.re,this.im-r.im)},mul:function(t,e){var r=new s(t,e);return this.isInfinite()&&r.isZero()||this.isZero()&&r.isInfinite()?s.NAN:this.isInfinite()||r.isInfinite()?s.INFINITY:0===r.im&&0===this.im?new s(this.re*r.re,0):new s(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(t,e){var r=new s(t,e);if(this.isZero()&&r.isZero()||this.isInfinite()&&r.isInfinite())return s.NAN;if(this.isInfinite()||r.isZero())return s.INFINITY;if(this.isZero()||r.isInfinite())return s.ZERO;t=this.re,e=this.im;var i,n,a=r.re,o=r.im;return 0===o?new s(t/a,e/a):Math.abs(a)<Math.abs(o)?new s((t*(n=a/o)+e)/(i=a*n+o),(e*n-t)/i):new s((t+e*(n=o/a))/(i=o*n+a),(e-t*n)/i)},pow:function(t,e){var r=new s(t,e);if(t=this.re,e=this.im,r.isZero())return s.ONE;if(0===r.im){if(0===e&&t>0)return new s(Math.pow(t,r.re),0);if(0===t)switch((r.re%4+4)%4){case 0:return new s(Math.pow(e,r.re),0);case 1:return new s(0,Math.pow(e,r.re));case 2:return new s(-Math.pow(e,r.re),0);case 3:return new s(0,-Math.pow(e,r.re))}}if(0===t&&0===e&&r.re>0&&r.im>=0)return s.ZERO;var i=Math.atan2(e,t),a=n(t,e);return t=Math.exp(r.re*a-r.im*i),e=r.im*a+r.re*i,new s(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,r=this.re,i=this.im,n=this.abs();if(r>=0){if(0===i)return new s(Math.sqrt(r),0);t=.5*Math.sqrt(2*(n+r))}else t=Math.abs(i)/Math.sqrt(2*(n-r));return e=r<=0?.5*Math.sqrt(2*(n-r)):Math.abs(i)/Math.sqrt(2*(n+r)),new s(t,i<0?-e:e)},exp:function(){var t=Math.exp(this.re);return this.im,new s(t*Math.cos(this.im),t*Math.sin(this.im))},expm1:function(){var t=this.re,e=this.im;return new s(Math.expm1(t)*Math.cos(e)+function(t){var e=Math.PI/4;if(-e>t||t>e)return Math.cos(t)-1;var r=t*t;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(e),Math.exp(t)*Math.sin(e))},log:function(){var t=this.re,e=this.im;return new s(n(t,e),Math.atan2(e,t))},abs:function(){return t=this.re,e=this.im,r=Math.abs(t),i=Math.abs(e),r<3e3&&i<3e3?Math.sqrt(r*r+i*i):(r<i?(r=i,i=t/e):i=e/t,r*Math.sqrt(1+i*i));var t,e,r,i},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,i=this.im;return new s(Math.sin(t)*e(i),Math.cos(t)*r(i))},cos:function(){var t=this.re,i=this.im;return new s(Math.cos(t)*e(i),-Math.sin(t)*r(i))},tan:function(){var t=2*this.re,i=2*this.im,n=Math.cos(t)+e(i);return new s(Math.sin(t)/n,r(i)/n)},cot:function(){var t=2*this.re,i=2*this.im,n=Math.cos(t)-e(i);return new s(-Math.sin(t)/n,r(i)/n)},sec:function(){var t=this.re,i=this.im,n=.5*e(2*i)+.5*Math.cos(2*t);return new s(Math.cos(t)*e(i)/n,Math.sin(t)*r(i)/n)},csc:function(){var t=this.re,i=this.im,n=.5*e(2*i)-.5*Math.cos(2*t);return new s(Math.sin(t)*e(i)/n,-Math.cos(t)*r(i)/n)},asin:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(i.im,-i.re)},acos:function(){var t=this.re,e=this.im,r=new s(e*e-t*t+1,-2*t*e).sqrt(),i=new s(r.re-e,r.im+t).log();return new s(Math.PI/2-i.im,i.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new s(0,1/0);if(-1===e)return new s(0,-1/0)}var r=t*t+(1-e)*(1-e),i=new s((1-e*e-t*t)/r,-2*t/r).log();return new s(-.5*i.im,.5*i.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new s(Math.atan2(1,t),0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atan():new s(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acos():new s(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(Math.PI/2,1/0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asin():new s(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,i=this.im;return new s(r(t)*Math.cos(i),e(t)*Math.sin(i))},cosh:function(){var t=this.re,i=this.im;return new s(e(t)*Math.cos(i),r(t)*Math.sin(i))},tanh:function(){var t=2*this.re,i=2*this.im,n=e(t)+Math.cos(i);return new s(r(t)/n,Math.sin(i)/n)},coth:function(){var t=2*this.re,i=2*this.im,n=e(t)-Math.cos(i);return new s(r(t)/n,-Math.sin(i)/n)},csch:function(){var t=this.re,i=this.im,n=Math.cos(2*i)-e(2*t);return new s(-2*r(t)*Math.cos(i)/n,2*e(t)*Math.sin(i)/n)},sech:function(){var t=this.re,i=this.im,n=Math.cos(2*i)+e(2*t);return new s(2*e(t)*Math.cos(i)/n,-2*r(t)*Math.sin(i)/n)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t=this.acos();if(t.im<=0){var e=t.re;t.re=-t.im,t.im=e}else{e=t.im;t.im=-t.re,t.re=e}return t},atanh:function(){var t=this.re,e=this.im,r=t>1&&0===e,i=1-t,a=1+t,o=i*i+e*e,h=0!==o?new s((a*i-e*e)/o,(e*i+a*e)/o):new s(-1!==t?t/0:0,0!==e?e/0:0),u=h.re;return h.re=n(h.re,h.im)/2,h.im=Math.atan2(h.im,u)/2,r&&(h.im=-h.im),h},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new s(0,Math.PI/2);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).atanh():new s(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new s(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).asinh():new s(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(this.isZero())return s.INFINITY;var r=t*t+e*e;return 0!==r?new s(t/r,-e/r).acosh():new s(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return s.INFINITY;if(this.isInfinite())return s.ZERO;var t=this.re,e=this.im,r=t*t+e*e;return new s(t/r,-e/r)},conjugate:function(){return new s(this.re,-this.im)},neg:function(){return new s(-this.re,-this.im)},ceil:function(t){return t=Math.pow(10,t||0),new s(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new s(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new s(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){var r=new s(t,e);return Math.abs(r.re-this.re)<=s.EPSILON&&Math.abs(r.im-this.im)<=s.EPSILON},clone:function(){return new s(this.re,this.im)},toString:function(){var t=this.re,e=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(t)<s.EPSILON&&(t=0),Math.abs(e)<s.EPSILON&&(e=0),0===e?r+t:(0!==t?(r+=t,r+=" ",e<0?(e=-e,r+="-"):r+="+",r+=" "):e<0&&(e=-e,r+="-"),1!==e&&(r+=e),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s.PI=new s(Math.PI,0),s.E=new s(Math.E,0),s.INFINITY=new s(1/0,1/0),s.NAN=new s(NaN,NaN),s.EPSILON=1e-15,"function"==typeof define&&define.amd?define([],(function(){return s})):(Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Complex=s,Wb=s)}();var qb=Hb("Complex",[],(()=>(Object.defineProperty(r(Wb),"name",{value:"Complex"}),r(Wb).prototype.constructor=r(Wb),r(Wb).prototype.type="Complex",r(Wb).prototype.isComplex=!0,r(Wb).prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},r(Wb).prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},r(Wb).prototype.format=function(t){var e=this.im,r=this.re,i=hb(this.re,t),n=hb(this.im,t),s=s_(t)?t:t?t.precision:null;if(null!==s){var a=Math.pow(10,-s);Math.abs(r/e)<a&&(r=0),Math.abs(e/r)<a&&(e=0)}return 0===e?i:0===r?1===e?"i":-1===e?"-i":n+"i":e<0?-1===e?i+" - i":i+" - "+n.substring(1)+"i":1===e?i+" + i":i+" + "+n+"i"},r(Wb).fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return r(Wb)(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var i=arguments[0],n=arguments[1];if(s_(i)){if(u_(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),s_(n))return new(r(Wb))({r:i,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},r(Wb).prototype.valueOf=r(Wb).prototype.toString,r(Wb).fromJSON=function(t){return new(r(Wb))(t)},r(Wb).compare=function(t,e){return t.re>e.re?1:t.re<e.re?-1:t.im>e.im?1:t.im<e.im?-1:0},r(Wb))),{isClass:!0});function Xb(t){var e=0,r=1,i=Object.create(null),n=Object.create(null),s=0,a=function(t){var a=n[t];if(a&&(delete i[a],delete n[t],--e,r===a)){if(!e)return s=0,void(r=1);for(;!hasOwnProperty.call(i,++r);)continue}};return t=Math.abs(t),{hit:function(o){var h=n[o],u=++s;if(i[u]=o,n[o]=u,!h){if(++e<=t)return;return o=i[r],a(o),o}if(delete i[h],r===h)for(;!hasOwnProperty.call(i,++r);)continue},delete:a,clear:function(){e=s=0,r=1,i=Object.create(null),n=Object.create(null)}}}function Yb(t){var{hasher:e,limit:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=null==r?Number.POSITIVE_INFINITY:r,e=null==e?JSON.stringify:e,function i(){"object"!=typeof i.cache&&(i.cache={values:new Map,lru:Xb(r||Number.POSITIVE_INFINITY)});for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var a=e(n);if(i.cache.values.has(a))return i.cache.lru.hit(a),i.cache.values.get(a);var o=t.apply(t,n);return i.cache.values.set(a,o),i.cache.values.delete(i.cache.lru.hit(a)),o}}function Zb(t){return Object.keys(t.signatures||{}).reduce((function(t,e){var r=(e.match(/,/g)||[]).length+1;return Math.max(t,r)}),-1)}Yb((function(t){return new t(1).exp()}),{hasher:Kb}),Yb((function(t){return new t(1).plus(new t(5).sqrt()).div(2)}),{hasher:Kb});var $b=Yb((function(t){return t.acos(-1)}),{hasher:Kb});Yb((function(t){return $b(t).times(2)}),{hasher:Kb});function Kb(t){return t[0].precision}var Jb="number",Qb="number, number";function ty(t){return Math.abs(t)}function ey(t,e){return t+e}function ry(t,e){return t*e}function iy(t){return-t}function ny(t){return t}function sy(t){return sb(t)}function ay(t){return t*t*t}function oy(t){return Math.exp(t)}function hy(t){return ab(t)}function uy(t,e){if(!eb(t)||!eb(e))throw new Error("Parameters in function gcd must be integer numbers");for(var r;0!==e;)r=t%e,t=e,e=r;return t<0?-t:t}function ly(t,e){if(!eb(t)||!eb(e))throw new Error("Parameters in function lcm must be integer numbers");if(0===t||0===e)return 0;for(var r,i=t*e;0!==e;)e=t%(r=e),t=r;return Math.abs(i/t)}function cy(t,e){return e?Math.log(t)/Math.log(e):Math.log(t)}function fy(t){return nb(t)}function dy(t){return ib(t)}function py(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}function my(t){return rb(t)}function gy(t){return t*t}function vy(t,e){var r,i,n,s=0,a=1,o=1,h=0;if(!eb(t)||!eb(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)n=t-(i=Math.floor(t/e))*e,r=s,s=a-i*s,a=r,r=o,o=h-i*o,h=r,t=e,e=n;return t<0?[-t,-a,-h]:[t,t?a:0,h]}function _y(t,e){return t*t<1&&e===1/0||t*t>1&&e===-1/0?0:Math.pow(t,e)}function by(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!eb(e)||e<0||e>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(lb(t,e))}ty.signature=Jb,ey.signature=Qb,ry.signature=Qb,iy.signature=Jb,ny.signature=Jb,sy.signature=Jb,ay.signature=Jb,oy.signature=Jb,hy.signature=Jb,uy.signature=Qb,ly.signature=Qb,fy.signature=Jb,dy.signature=Jb,py.signature=Qb,my.signature=Jb,gy.signature=Jb,vy.signature=Qb,_y.signature=Qb;var yy="number, number";function xy(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function bitAnd");return t&e}function wy(t){if(!eb(t))throw new Error("Integer expected in function bitNot");return~t}function Ey(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function bitOr");return t|e}function My(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function bitXor");return t^e}function Sy(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function leftShift");return t<<e}function Ay(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function rightArithShift");return t>>e}function Ty(t,e){if(!eb(t)||!eb(e))throw new Error("Integers expected in function rightLogShift");return t>>>e}xy.signature=yy,wy.signature="number",Ey.signature=yy,My.signature=yy,Sy.signature=yy,Ay.signature=yy,Ty.signature=yy;var Cy=Math.PI,Dy=(Math.PI,Math.E,"number, number");function Ry(t){return!t}function Iy(t,e){return!(!t&&!e)}function Py(t,e){return!!t!=!!e}function Ny(t,e){return!(!t||!e)}function ky(t,e){if(e<t)return 1;if(e===t)return e;var r=e+t>>1;return ky(t,r)*ky(r+1,e)}function By(t){var e;if(eb(t))return t<=0?isFinite(t)?1/0:NaN:t>171?1/0:ky(1,t-1);if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*By(1-t));if(t>=171.35)return 1/0;if(t>85){var r=t*t,i=r*t,n=i*t,s=n*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*r)-139/(51840*i)-571/(2488320*n)+163879/(209018880*s)+5246819/(75246796800*s*t))}--t,e=Oy[0];for(var a=1;a<Oy.length;++a)e+=Oy[a]/(t+a);var o=t+Ly+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,t+.5)*Math.exp(-o)*e}Ry.signature="number",Iy.signature=Dy,Py.signature=Dy,Ny.signature=Dy,By.signature="number";var Ly=4.7421875,Oy=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Fy=.9189385332046728,Uy=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function zy(t){if(t<0)return NaN;if(0===t)return 1/0;if(!isFinite(t))return t;if(t<.5)return Math.log(Math.PI/Math.sin(Math.PI*t))-zy(1-t);for(var e=(t-=1)+5+.5,r=Uy[0],i=6;i>=1;i--)r+=Uy[i]/(t+i);return Fy+(t+.5)*Math.log(e)-e+Math.log(r)}zy.signature="number";var Gy="number";function Hy(t){return gb(t)}function jy(t){return Math.atan(1/t)}function Vy(t){return isFinite(t)?(Math.log((t+1)/t)+Math.log(t/(t-1)))/2:0}function Wy(t){return Math.asin(1/t)}function qy(t){var e=1/t;return Math.log(e+Math.sqrt(e*e+1))}function Xy(t){return Math.acos(1/t)}function Yy(t){var e=1/t,r=Math.sqrt(e*e-1);return Math.log(r+e)}function Zy(t){return vb(t)}function $y(t){return _b(t)}function Ky(t){return 1/Math.tan(t)}function Jy(t){var e=Math.exp(2*t);return(e+1)/(e-1)}function Qy(t){return 1/Math.sin(t)}function tx(t){return 0===t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*rb(t)}function ex(t){return 1/Math.cos(t)}function rx(t){return 2/(Math.exp(t)+Math.exp(-t))}function ix(t){return bb(t)}Hy.signature=Gy,jy.signature=Gy,Vy.signature=Gy,Wy.signature=Gy,qy.signature=Gy,Xy.signature=Gy,Yy.signature=Gy,Zy.signature=Gy,$y.signature=Gy,Ky.signature=Gy,Jy.signature=Gy,Qy.signature=Gy,tx.signature=Gy,ex.signature=Gy,rx.signature=Gy,ix.signature=Gy;var nx="number";function sx(t){return t<0}function ax(t){return t>0}function ox(t){return 0===t}function hx(t){return Number.isNaN(t)}sx.signature=nx,ax.signature=nx,ox.signature=nx,hx.signature=nx;var ux=lx("pi",["config","?BigNumber"],(t=>{var{config:e,BigNumber:r}=t;return"BigNumber"===e.number?$b(r):Cy}));function lx(t,e,r){return Hb(t,e,r,{recreateOnConfigChange:!0})}cx("fineStructure",.0072973525693),cx("weakMixingAngle",.2229),cx("efimovFactor",22.7),cx("sackurTetrode",-1.16487052358);function cx(t,e){return Hb(t,["config","BigNumber"],(t=>{var{config:r,BigNumber:i}=t;return"BigNumber"===r.number?new i(e):e}))}var fx={};
/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(t){var e={s:1,n:0,d:1};function r(t,e){if(isNaN(t=parseInt(t,10)))throw o.InvalidParameter;return t*e}function i(t,e){if(0===e)throw o.DivisionByZero;var r=Object.create(o.prototype);r.s=t<0?-1:1;var i=a(t=t<0?-t:t,e);return r.n=t/i,r.d=e/i,r}function n(t){for(var e={},r=t,i=2,n=4;n<=r;){for(;r%i==0;)r/=i,e[i]=(e[i]||0)+1;n+=1+2*i++}return r!==t?r>1&&(e[r]=(e[r]||0)+1):e[t]=(e[t]||0)+1,e}var s=function(t,i){var n,s=0,a=1,h=1,u=0,l=0,c=0,f=1,d=1,p=0,m=1,g=1,v=1,_=1e7;if(null==t);else if(void 0!==i){if(h=(s=t)*(a=i),s%1!=0||a%1!=0)throw o.NonIntegerParameter}else switch(typeof t){case"object":if("d"in t&&"n"in t)s=t.n,a=t.d,"s"in t&&(s*=t.s);else{if(!(0 in t))throw o.InvalidParameter;s=t[0],1 in t&&(a=t[1])}h=s*a;break;case"number":if(t<0&&(h=t,t=-t),t%1==0)s=t;else if(t>0){for(t>=1&&(t/=d=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));m<=_&&v<=_;){if(t===(n=(p+g)/(m+v))){m+v<=_?(s=p+g,a=m+v):v>m?(s=g,a=v):(s=p,a=m);break}t>n?(p+=g,m+=v):(g+=p,v+=m),m>_?(s=g,a=v):(s=p,a=m)}s*=d}else(isNaN(t)||isNaN(i))&&(a=s=NaN);break;case"string":if(null===(m=t.match(/\d+|./g)))throw o.InvalidParameter;if("-"===m[p]?(h=-1,p++):"+"===m[p]&&p++,m.length===p+1?l=r(m[p++],h):"."===m[p+1]||"."===m[p]?("."!==m[p]&&(u=r(m[p++],h)),(++p+1===m.length||"("===m[p+1]&&")"===m[p+3]||"'"===m[p+1]&&"'"===m[p+3])&&(l=r(m[p],h),f=Math.pow(10,m[p].length),p++),("("===m[p]&&")"===m[p+2]||"'"===m[p]&&"'"===m[p+2])&&(c=r(m[p+1],h),d=Math.pow(10,m[p+1].length)-1,p+=3)):"/"===m[p+1]||":"===m[p+1]?(l=r(m[p],h),f=r(m[p+2],1),p+=3):"/"===m[p+3]&&" "===m[p+1]&&(u=r(m[p],h),l=r(m[p+2],h),f=r(m[p+4],1),p+=5),m.length<=p){h=s=c+(a=f*d)*u+d*l;break}default:throw o.InvalidParameter}if(0===a)throw o.DivisionByZero;e.s=h<0?-1:1,e.n=Math.abs(s),e.d=Math.abs(a)};function a(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}}function o(t,r){if(s(t,r),!(this instanceof o))return i(e.s*e.n,e.d);t=a(e.d,e.n),this.s=e.s,this.n=e.n/t,this.d=e.d/t}o.DivisionByZero=new Error("Division by Zero"),o.InvalidParameter=new Error("Invalid argument"),o.NonIntegerParameter=new Error("Parameters must be integer"),o.prototype={s:1,n:0,d:1,abs:function(){return i(this.n,this.d)},neg:function(){return i(-this.s*this.n,this.d)},add:function(t,r){return s(t,r),i(this.s*this.n*e.d+e.s*this.d*e.n,this.d*e.d)},sub:function(t,r){return s(t,r),i(this.s*this.n*e.d-e.s*this.d*e.n,this.d*e.d)},mul:function(t,r){return s(t,r),i(this.s*e.s*this.n*e.n,this.d*e.d)},div:function(t,r){return s(t,r),i(this.s*e.s*this.n*e.d,this.d*e.n)},clone:function(){return i(this.s*this.n,this.d)},mod:function(t,r){if(isNaN(this.n)||isNaN(this.d))return new o(NaN);if(void 0===t)return i(this.s*this.n%this.d,1);if(s(t,r),0===e.n&&0===this.d)throw o.DivisionByZero;return i(this.s*(e.d*this.n)%(e.n*this.d),e.d*this.d)},gcd:function(t,r){return s(t,r),i(a(e.n,this.n)*a(e.d,this.d),e.d*this.d)},lcm:function(t,r){return s(t,r),0===e.n&&0===this.n?i(0,1):i(e.n*this.n,a(e.n,this.n)*a(e.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new o(NaN):i(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return i(this.s*this.d,this.n)},pow:function(t,r){if(s(t,r),1===e.d)return e.s<0?i(Math.pow(this.s*this.d,e.n),Math.pow(this.n,e.n)):i(Math.pow(this.s*this.n,e.n),Math.pow(this.d,e.n));if(this.s<0)return null;var a=n(this.n),o=n(this.d),h=1,u=1;for(var l in a)if("1"!==l){if("0"===l){h=0;break}if(a[l]*=e.n,a[l]%e.d!=0)return null;a[l]/=e.d,h*=Math.pow(l,a[l])}for(var l in o)if("1"!==l){if(o[l]*=e.n,o[l]%e.d!=0)return null;o[l]/=e.d,u*=Math.pow(l,o[l])}return e.s<0?i(u,h):i(h,u)},equals:function(t,r){return s(t,r),this.s*this.n*e.d==e.s*e.n*this.d},compare:function(t,r){s(t,r);var i=this.s*this.n*e.d-e.s*e.n*this.d;return(0<i)-(i<0)},simplify:function(t){if(isNaN(this.n)||isNaN(this.d))return this;t=t||.001;for(var e=this.abs(),r=e.toContinued(),n=1;n<r.length;n++){for(var s=i(r[n-1],1),a=n-2;a>=0;a--)s=s.inverse().add(r[a]);if(s.sub(e).abs().valueOf()<t)return s.mul(this.s)}return this},divisible:function(t,r){return s(t,r),!(!(e.n*this.d)||this.n*e.d%(e.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,r+=" ",i%=n),r+=i,r+="/",r+=n),r},toLatex:function(t){var e,r="",i=this.n,n=this.d;return this.s<0&&(r+="-"),1===n?r+=i:(t&&(e=Math.floor(i/n))>0&&(r+=e,i%=n),r+="\\frac{",r+=i,r+="}{",r+=n,r+="}"),r},toContinued:function(){var t,e=this.n,r=this.d,i=[];if(isNaN(e)||isNaN(r))return i;do{i.push(Math.floor(e/r)),t=e%r,e=r,r=t}while(1!==e);return i},toString:function(t){var e=this.n,r=this.d;if(isNaN(e)||isNaN(r))return"NaN";t=t||15;var i=function(t,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var r=10%e,i=1;1!==r;i++)if(r=10*r%e,i>2e3)return 0;return i}(0,r),n=function(t,e,r){for(var i=1,n=function(t,e,r){for(var i=1;e>0;t=t*t%r,e>>=1)1&e&&(i=i*t%r);return i}(10,r,e),s=0;s<300;s++){if(i===n)return s;i=10*i%e,n=10*n%e}return 0}(0,r,i),s=this.s<0?"-":"";if(s+=e/r|0,e%=r,(e*=10)&&(s+="."),i){for(var a=n;a--;)s+=e/r|0,e%=r,e*=10;s+="(";for(a=i;a--;)s+=e/r|0,e%=r,e*=10;s+=")"}else for(a=t;e&&a--;)s+=e/r|0,e%=r,e*=10;return s}},"function"==typeof define&&define.amd?define([],(function(){return o})):(Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Fraction=o,fx=o)}();var dx=Hb("Fraction",[],(()=>(Object.defineProperty(r(fx),"name",{value:"Fraction"}),r(fx).prototype.constructor=r(fx),r(fx).prototype.type="Fraction",r(fx).prototype.isFraction=!0,r(fx).prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},r(fx).fromJSON=function(t){return new(r(fx))(t)},r(fx))),{isClass:!0}),px=Hb("Matrix",[],(()=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator")}return t.prototype.type="Matrix",t.prototype.isMatrix=!0,t.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},t.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},t.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},t.prototype.subset=function(t,e,r){throw new Error("Cannot invoke subset on a Matrix interface")},t.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},t.prototype.set=function(t,e,r){throw new Error("Cannot invoke set on a Matrix interface")},t.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},t.prototype.reshape=function(t,e){throw new Error("Cannot invoke reshape on a Matrix interface")},t.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},t.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},t.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},t.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},t.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},t.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},t.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},t.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},t.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},t}),{isClass:!0}),mx=Hb("DenseMatrix",["Matrix"],(t=>{var{Matrix:e}=t;function r(t,e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!l_(e))throw new Error("Invalid datatype: "+e);if(f_(t))"DenseMatrix"===t.type?(this._data=W_(t._data),this._size=W_(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&c_(t.data)&&c_(t.size))this._data=t.data,this._size=t.size,Ib(this._data,this._size),this._datatype=e||t.datatype;else if(c_(t))this._data=u(t),this._size=Db(this._data),Ib(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+V_(t)+")");this._data=[],this._size=[0],this._datatype=e}}function i(t,e){if(!v_(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var i=e.size();if(i.length!==t._size.length)throw new Tb(i.length,t._size.length);for(var s=e.min(),a=e.max(),o=0,h=t._size.length;o<h;o++)Pb(s[o],t._size[o]),Pb(a[o],t._size[o]);return new r(n(t._data,e,i.length,0),t._datatype)}function n(t,e,r,i){var s=i===r-1,a=e.dimension(i);return s?a.map((function(e){return Pb(e,t.length),t[e]})).valueOf():a.map((function(s){return Pb(s,t.length),n(t[s],e,r,i+1)})).valueOf()}function s(t,e,r,i){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var n,s=e.size(),o=e.isScalar();if(f_(r)?(n=r.size(),r=r.valueOf()):n=Db(r),o){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(s.length<t._size.length)throw new Tb(s.length,t._size.length,"<");if(n.length<s.length){for(var u=0,l=0;1===s[u]&&1===n[u];)u++;for(;1===s[u];)l++,u++;r=Fb(r,s.length,l,n)}if(!Y_(s,n))throw new Tb(s,n,">");var c=e.max().map((function(t){return t+1}));h(t,c,i);var f=s.length;a(t._data,e,r,f,0)}return t}function a(t,e,r,i,n){var s=n===i-1,o=e.dimension(n);s?o.forEach((function(e,i){Pb(e),t[e]=r[i[0]]})):o.forEach((function(s,o){Pb(s),a(t[s],e,r[o[0]],i,n+1)}))}function o(t,e,r){if(0===e.length){for(var i=t._data;c_(i);)i=i[0];return i}return t._size=e.slice(0),t._data=Nb(t._data,t._size,r),t}function h(t,e,r){for(var i=t._size.slice(0),n=!1;i.length<e.length;)i.push(0),n=!0;for(var s=0,a=e.length;s<a;s++)e[s]>i[s]&&(i[s]=e[s],n=!0);n&&o(t,i,r)}function u(t){for(var e=0,r=t.length;e<r;e++){var i=t[e];c_(i)?t[e]=u(i):i&&!0===i.isMatrix&&(t[e]=u(i.valueOf()))}return t}return r.prototype=new e,r.prototype.createDenseMatrix=function(t,e){return new r(t,e)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return Gb(this._data,V_)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(t,e){return new r(t,e)},r.prototype.subset=function(t,e,r){switch(arguments.length){case 1:return i(this,t);case 2:case 3:return s(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(t){if(!c_(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Tb(t.length,this._size.length);for(var e=0;e<t.length;e++)Pb(t[e],this._size[e]);for(var r=this._data,i=0,n=t.length;i<n;i++){var s=t[i];Pb(s,r.length),r=r[s]}return r},r.prototype.set=function(t,e,r){if(!c_(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new Tb(t.length,this._size.length,"<");var i,n,s,a=t.map((function(t){return t+1}));h(this,a,r);var o=this._data;for(i=0,n=t.length-1;i<n;i++)Pb(s=t[i],o.length),o=o[s];return Pb(s=t[t.length-1],o.length),o[s]=e,this},r.prototype.resize=function(t,e,r){if(!d_(t))throw new TypeError("Array or Matrix expected");var i=t.valueOf().map((t=>Array.isArray(t)&&1===t.length?t[0]:t));return o(r?this.clone():this,i,e)},r.prototype.reshape=function(t,e){var r=e?this.clone():this;r._data=Bb(r._data,t);var i=r._size.reduce(((t,e)=>t*e));return r._size=Lb(t,i),r},r.prototype.clone=function(){return new r({data:W_(this._data),size:W_(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(t){var e=this,i=Zb(t),n=function r(n,s){return c_(n)?n.map((function(t,e){return r(t,s.concat(e))})):1===i?t(n):2===i?t(n,s):t(n,s,e)}(this._data,[]);return new r(n,void 0!==this._datatype?Gb(n,V_):void 0)},r.prototype.forEach=function(t){var e=this;!function r(i,n){c_(i)?i.forEach((function(t,e){r(t,n.concat(e))})):t(i,n,e)}(this._data,[])},r.prototype[Symbol.iterator]=function*(){yield*function*t(e,r){if(c_(e))for(var i=0;i<e.length;i++)yield*t(e[i],r.concat(i));else yield{value:e,index:r}}(this._data,[])},r.prototype.rows=function(){var t=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var e=this._data;for(var i of e)t.push(new r([i],this._datatype));return t},r.prototype.columns=function(){var t=this,e=[],i=this.size();if(2!==i.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var n=this._data,s=function(i){var s=n.map((t=>[t[i]]));e.push(new r(s,t._datatype))},a=0;a<i[1];a++)s(a);return e},r.prototype.toArray=function(){return W_(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(t){return Mb(this._data,t)},r.prototype.toString=function(){return Mb(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(t){if(t){if(a_(t)&&(t=t.toNumber()),!s_(t)||!eb(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,i=t<0?-t:0,n=this._size[0],s=this._size[1],a=Math.min(n-i,s-e),o=[],h=0;h<a;h++)o[h]=this._data[h+i][h+e];return new r({data:o,size:[a],datatype:this._datatype})},r.diagonal=function(t,e,i,n){if(!c_(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(a_(t)&&(t=t.toNumber()),!s_(t)||!eb(t)||t<1)throw new Error("Size values must be positive integers");return t})),i){if(a_(i)&&(i=i.toNumber()),!s_(i)||!eb(i))throw new TypeError("The parameter k must be an integer number")}else i=0;var s,a=i>0?i:0,o=i<0?-i:0,h=t[0],u=t[1],l=Math.min(h-o,u-a);if(c_(e)){if(e.length!==l)throw new Error("Invalid value array length");s=function(t){return e[t]}}else if(f_(e)){var c=e.size();if(1!==c.length||c[0]!==l)throw new Error("Invalid matrix length");s=function(t){return e.get([t])}}else s=function(){return e};n||(n=a_(s(0))?s(0).mul(0):0);var f=[];if(t.length>0){f=Nb(f,t,n);for(var d=0;d<l;d++)f[d+o][d+a]=s(d)}return new r({data:f,size:[h,u]})},r.fromJSON=function(t){return new r(t)},r.prototype.swapRows=function(t,e){if(!(s_(t)&&eb(t)&&s_(e)&&eb(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Pb(t,this._size[0]),Pb(e,this._size[0]),r._swapRows(t,e,this._data),this},r._swapRows=function(t,e,r){var i=r[t];r[t]=r[e],r[e]=i},r}),{isClass:!0}),gx={};function vx(t,e){if(xx(t)&&bx(t,e))return t[e];if("function"==typeof t[e]&&yx(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')}function _x(t,e,r){if(xx(t)&&bx(t,e))return t[e]=r,r;throw new Error('No access to property "'+e+'"')}function bx(t,e){return!(!t||"object"!=typeof t)&&(!!Z_(wx,e)||!(e in Object.prototype)&&!(e in Function.prototype))}function yx(t,e){return null!=t&&"function"==typeof t[e]&&(!(Z_(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t))&&(!!Z_(Ex,e)||!(e in Object.prototype)&&!(e in Function.prototype)))}function xx(t){return"object"==typeof t&&t&&t.constructor===Object}gx=function(){function t(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=e(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s:s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,h=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){h=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(h)throw a}}}}function e(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(){return!0}function s(){return!1}function a(){}var o="Argument is not a typed-function.";function h(){function e(t){return"object"===i(t)&&null!==t&&t.constructor===Object}var r,u,l=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:e},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],c={name:"any",test:n,isAny:!0},f=0,d={createCount:0};function p(e){var i=r.get(e);if(i)return i;var n,s,a='Unknown type "'+e+'"',o=e.toLowerCase(),h=t(u);try{for(h.s();!(s=h.n()).done;)if((n=s.value).toLowerCase()===o){a+='. Did you mean "'+n+'" ?';break}}catch(t){h.e(t)}finally{h.f()}throw new TypeError(a)}function m(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",i=e?p(e).index:u.length,n=[],s=0;s<t.length;++s){if(!t[s]||"string"!=typeof t[s].name||"function"!=typeof t[s].test)throw new TypeError("Object with properties {name: string, test: function} expected");var a=t[s].name;if(r.has(a))throw new TypeError('Duplicate type name "'+a+'"');n.push(a),r.set(a,{name:a,test:t[s].test,isAny:t[s].isAny,index:i+s,conversionsTo:[]})}var o=u.slice(i);u=u.slice(0,i).concat(n).concat(o);for(var h=i+n.length;h<u.length;++h)r.get(u[h]).index=h}function g(){r=new Map,u=[],f=0,m([c],!1)}function v(){var e,i,n=t(u);try{for(n.s();!(i=n.n()).done;)e=i.value,r.get(e).conversionsTo=[]}catch(t){n.e(t)}finally{n.f()}f=0}function _(t){var e=u.filter((function(e){var i=r.get(e);return!i.isAny&&i.test(t)}));return e.length?e:["any"]}function b(t){return t&&"function"==typeof t&&"_typedFunctionData"in t}function y(e,r,i){if(!b(e))throw new TypeError(o);var n=i&&i.exact,s=T(Array.isArray(r)?r.join(","):r),a=E(s);if(!n||a in e.signatures){var h=e._typedFunctionData.signatureMap.get(a);if(h)return h}var u,l,c,f=s.length;if(n)for(l in u=[],e.signatures)u.push(e._typedFunctionData.signatureMap.get(l));else u=e._typedFunctionData.signatures;for(var d=0;d<f;++d){var p,m=s[d],g=[],v=void 0,_=t(u);try{for(_.s();!(p=_.n()).done;){var y=I((v=p.value).params,d);if(y&&(!m.restParam||y.restParam)){if(!y.hasAny&&"continue"===function(){var t=A(y);if(m.types.some((function(e){return!t.has(e.name)})))return"continue"}())continue;g.push(v)}}}catch(t){_.e(t)}finally{_.f()}if(0===(u=g).length)break}var x,w=t(u);try{for(w.s();!(x=w.n()).done;)if((c=x.value).params.length<=f)return c}catch(t){w.e(t)}finally{w.f()}throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+E(s,", ")+"))")}function x(t,e,r){return y(t,e,r).implementation}function w(t,e){var r=p(e);if(r.test(t))return t;var i=r.conversionsTo;if(0===i.length)throw new Error("There are no conversions to "+e+" defined.");for(var n=0;n<i.length;n++)if(p(i[n].from).test(t))return i[n].convert(t);throw new Error("Cannot convert "+t+" to "+e)}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return t.map((function(t){return t.name})).join(e)}function M(t){var e=0===t.indexOf("..."),r=(e?t.length>3?t.slice(3):"any":t).split("|").map((function(t){return p(t.trim())})),i=!1,n=e?"...":"";return{types:r.map((function(t){return i=t.isAny||i,n+=t.name+"|",{name:t.name,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:null,conversionIndex:-1}})),name:n.slice(0,-1),hasAny:i,hasConversion:!1,restParam:e}}function S(t){var e=z(t.types.map((function(t){return t.name}))),r=t.hasAny,i=t.name,n=e.map((function(t){var e=p(t.from);return r=e.isAny||r,i+="|"+t.from,{name:t.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:t,conversionIndex:t.index}}));return{types:t.types.concat(n),name:i,hasAny:r,hasConversion:n.length>0,restParam:t.restParam}}function A(t){return t.typeSet||(t.typeSet=new Set,t.types.forEach((function(e){return t.typeSet.add(e.name)}))),t.typeSet}function T(t){var e=[];if("string"!=typeof t)throw new TypeError("Signatures must be strings");var r=t.trim();if(""===r)return e;for(var i=r.split(","),n=0;n<i.length;++n){var s=M(i[n].trim());if(s.restParam&&n!==i.length-1)throw new SyntaxError('Unexpected rest parameter "'+i[n]+'": only allowed for the last parameter');if(0===s.types.length)return null;e.push(s)}return e}function C(t){var e=J(t);return!!e&&e.restParam}function D(t){if(t&&0!==t.types.length){if(1===t.types.length)return p(t.types[0].name).test;if(2===t.types.length){var e=p(t.types[0].name).test,r=p(t.types[1].name).test;return function(t){return e(t)||r(t)}}var i=t.types.map((function(t){return p(t.name).test}));return function(t){for(var e=0;e<i.length;e++)if(i[e](t))return!0;return!1}}return n}function R(t){var e,r,i;if(C(t)){var n=(e=K(t).map(D)).length,s=D(J(t)),a=function(t){for(var e=n;e<t.length;e++)if(!s(t[e]))return!1;return!0};return function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return a(t)&&t.length>=n+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(r=D(t[0]),function(t){return r(t[0])&&1===t.length}):2===t.length?(r=D(t[0]),i=D(t[1]),function(t){return r(t[0])&&i(t[1])&&2===t.length}):(e=t.map(D),function(t){for(var r=0;r<e.length;r++)if(!e[r](t[r]))return!1;return t.length===e.length})}function I(t,e){return e<t.length?t[e]:C(t)?J(t):null}function P(t,e){var r=I(t,e);return r?A(r):new Set}function N(t){return null===t.conversion||void 0===t.conversion}function k(e,r){var i=new Set;return e.forEach((function(e){var n,s,a=t(P(e.params,r));try{for(a.s();!(s=a.n()).done;)n=s.value,i.add(n)}catch(t){a.e(t)}finally{a.f()}})),i.has("any")?["any"]:Array.from(i)}function B(t,e,r){var n,s,a,o=t||"unnamed",h=r,u=function(){var t=[];if(h.forEach((function(r){var i=D(I(r.params,a));(a<r.params.length||C(r.params))&&i(e[a])&&t.push(r)})),0===t.length){if((s=k(h,a)).length>0){var r=_(e[a]);return(n=new TypeError("Unexpected type of argument in function "+o+" (expected: "+s.join(" or ")+", actual: "+r.join(" | ")+", index: "+a+")")).data={category:"wrongType",fn:o,index:a,actual:r,expected:s},{v:n}}}else h=t};for(a=0;a<e.length;a++){var l=u();if("object"===i(l))return l.v}var c=h.map((function(t){return C(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,c))return s=k(h,a),(n=new TypeError("Too few arguments in function "+o+" (expected: "+s.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:o,index:e.length,expected:s},n;var f=Math.max.apply(null,c);if(e.length>f)return(n=new TypeError("Too many arguments in function "+o+" (expected: "+f+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:o,index:e.length,expectedLength:f},n;for(var d=[],p=0;p<e.length;++p)d.push(_(e[p]).join("|"));return(n=new TypeError('Arguments of type "'+d.join(", ")+'" do not match any of the defined signatures of function '+o+".")).data={category:"mismatch",actual:d},n}function L(t){for(var e=u.length+1,r=0;r<t.types.length;r++)N(t.types[r])&&(e=Math.min(e,t.types[r].typeIndex));return e}function O(t){for(var e=f+1,r=0;r<t.types.length;r++)N(t.types[r])||(e=Math.min(e,t.types[r].conversionIndex));return e}function F(t,e){if(t.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return-1;if(t.restParam){if(!e.restParam)return 1}else if(e.restParam)return-1;if(t.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return-1;var r=L(t)-L(e);if(r<0)return-1;if(r>0)return 1;var i=O(t)-O(e);return i<0?-1:i>0?1:0}function U(e,r){var i=e.params,n=r.params,s=J(i),a=J(n),o=C(i),h=C(n);if(o&&s.hasAny){if(!h||!a.hasAny)return 1}else if(h&&a.hasAny)return-1;var u,l,c=0,f=0,d=t(i);try{for(d.s();!(l=d.n()).done;)(u=l.value).hasAny&&++c,u.hasConversion&&++f}catch(t){d.e(t)}finally{d.f()}var p,m=0,g=0,v=t(n);try{for(v.s();!(p=v.n()).done;)(u=p.value).hasAny&&++m,u.hasConversion&&++g}catch(t){v.e(t)}finally{v.f()}if(c!==m)return c-m;if(o&&s.hasConversion){if(!h||!a.hasConversion)return 1}else if(h&&a.hasConversion)return-1;if(f!==g)return f-g;if(o){if(!h)return 1}else if(h)return-1;var _=(i.length-n.length)*(o?-1:1);if(0!==_)return _;for(var b,y=[],x=0,w=0;w<i.length;++w){var E=F(i[w],n[w]);y.push(E),x+=E}if(0!==x)return x;for(var M=0,S=y;M<S.length;M++)if(0!==(b=S[M]))return b;return 0}function z(e){if(0===e.length)return[];var r=e.map(p);e.length>1&&r.sort((function(t,e){return t.index-e.index}));var i=r[0].conversionsTo;if(1===e.length)return i;i=i.concat([]);for(var n=new Set(e),s=1;s<r.length;++s){var a,o=void 0,h=t(r[s].conversionsTo);try{for(h.s();!(a=h.n()).done;)o=a.value,n.has(o.from)||(i.push(o),n.add(o.from))}catch(t){h.e(t)}finally{h.f()}}return i}function G(t,e){var r=e;if(t.some((function(t){return t.hasConversion}))){var i=C(t),n=t.map(H);r=function(){for(var t=[],r=i?arguments.length-1:arguments.length,s=0;s<r;s++)t[s]=n[s](arguments[s]);return i&&(t[r]=arguments[r].map(n[r])),e.apply(this,t)}}var s=r;if(C(t)){var a=t.length-1;s=function(){return r.apply(this,Q(arguments,0,a).concat([Q(arguments,a)]))}}return s}function H(t){var e,r,i,n,s=[],a=[];switch(t.types.forEach((function(t){t.conversion&&(s.push(p(t.conversion.from).test),a.push(t.conversion.convert))})),a.length){case 0:return function(t){return t};case 1:return e=s[0],i=a[0],function(t){return e(t)?i(t):t};case 2:return e=s[0],r=s[1],i=a[0],n=a[1],function(t){return e(t)?i(t):r(t)?n(t):t};default:return function(t){for(var e=0;e<a.length;e++)if(s[e](t))return a[e](t);return t}}}function j(t){function e(t,r,i){if(r<t.length){var n=t[r],s=[];if(n.restParam){var a=n.types.filter(N);a.length<n.types.length&&s.push({types:a,name:"..."+a.map((function(t){return t.name})).join("|"),hasAny:a.some((function(t){return t.isAny})),hasConversion:!1,restParam:!0}),s.push(n)}else s=n.types.map((function(t){return{types:[t],name:t.name,hasAny:t.isAny,hasConversion:t.conversion,restParam:!1}}));return et(s,(function(n){return e(t,r+1,i.concat([n]))}))}return[i]}return e(t,0,[])}function V(e,r){for(var i=Math.max(e.length,r.length),n=0;n<i;n++){var s,a=P(e,n),o=!1,h=void 0,u=t(P(r,n));try{for(u.s();!(s=u.n()).done;)if(h=s.value,a.has(h)){o=!0;break}}catch(t){u.e(t)}finally{u.f()}if(!o)return!1}var l=e.length,c=r.length,f=C(e),d=C(r);return f?d?l===c:c>=l:d?l>=c:l===c}function W(t){return t.map((function(t){return at(t)?nt(t.referToSelf.callback):st(t)?it(t.referTo.references,t.referTo.callback):t}))}function q(e,r,i){var n,s,a=[],o=t(e);try{for(o.s();!(s=o.n()).done;){var h=i[n=s.value];if("number"!=typeof h)throw new TypeError('No definition for referenced signature "'+n+'"');if("function"!=typeof(h=r[h]))return!1;a.push(h)}}catch(t){o.e(t)}finally{o.f()}return a}function X(t,e,r){for(var i=W(t),n=new Array(i.length).fill(!1),s=!0;s;){s=!1;for(var a=!0,o=0;o<i.length;++o)if(!n[o]){var h=i[o];if(at(h))i[o]=h.referToSelf.callback(r),i[o].referToSelf=h.referToSelf,n[o]=!0,a=!1;else if(st(h)){var u=q(h.referTo.references,i,e);u?(i[o]=h.referTo.callback.apply(this,u),i[o].referTo=h.referTo,n[o]=!0,a=!1):s=!0}}if(a&&s)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return i}function Y(t){var e=/\bthis(\(|\.signatures\b)/;Object.keys(t).forEach((function(r){var i=t[r];if(e.test(i.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}function Z(e,r){if(d.createCount++,0===Object.keys(r).length)throw new SyntaxError("No signatures provided");d.warnAgainstDeprecatedThis&&Y(r);var i,n=[],o=[],h={},u=[],l=function(){if(!Object.prototype.hasOwnProperty.call(r,i))return"continue";var e=T(i);if(!e)return"continue";n.forEach((function(t){if(V(t,e))throw new TypeError('Conflicting signatures "'+E(t)+'" and "'+E(e)+'".')})),n.push(e);var s=o.length;o.push(r[i]);var a,l=void 0,c=t(j(e.map(S)));try{for(c.s();!(a=c.n()).done;){var f=E(l=a.value);u.push({params:l,name:f,fn:s}),l.every((function(t){return!t.hasConversion}))&&(h[f]=s)}}catch(t){c.e(t)}finally{c.f()}};for(i in r)l();u.sort(U);var c,f=X(o,h,pt);for(c in h)Object.prototype.hasOwnProperty.call(h,c)&&(h[c]=f[h[c]]);for(var p=[],m=new Map,g=0,v=u;g<v.length;g++)c=v[g],m.has(c.name)||(c.fn=f[c.fn],p.push(c),m.set(c.name,c));for(var _=p[0]&&p[0].params.length<=2&&!C(p[0].params),b=p[1]&&p[1].params.length<=2&&!C(p[1].params),y=p[2]&&p[2].params.length<=2&&!C(p[2].params),x=p[3]&&p[3].params.length<=2&&!C(p[3].params),w=p[4]&&p[4].params.length<=2&&!C(p[4].params),M=p[5]&&p[5].params.length<=2&&!C(p[5].params),A=_&&b&&y&&x&&w&&M,I=0;I<p.length;++I)p[I].test=R(p[I].params);for(var P=_?D(p[0].params[0]):s,N=b?D(p[1].params[0]):s,k=y?D(p[2].params[0]):s,B=x?D(p[3].params[0]):s,L=w?D(p[4].params[0]):s,O=M?D(p[5].params[0]):s,F=_?D(p[0].params[1]):s,z=b?D(p[1].params[1]):s,H=y?D(p[2].params[1]):s,W=x?D(p[3].params[1]):s,q=w?D(p[4].params[1]):s,Z=M?D(p[5].params[1]):s,$=0;$<p.length;++$)p[$].implementation=G(p[$].params,p[$].fn);var K=_?p[0].implementation:a,J=b?p[1].implementation:a,Q=y?p[2].implementation:a,tt=x?p[3].implementation:a,et=w?p[4].implementation:a,rt=M?p[5].implementation:a,it=_?p[0].params.length:-1,nt=b?p[1].params.length:-1,st=y?p[2].params.length:-1,at=x?p[3].params.length:-1,ot=w?p[4].params.length:-1,ht=M?p[5].params.length:-1,ut=A?6:0,lt=p.length,ct=p.map((function(t){return t.test})),ft=p.map((function(t){return t.implementation})),dt=function(){for(var t=ut;t<lt;t++)if(ct[t](arguments))return ft[t].apply(this,arguments);return d.onMismatch(e,arguments,p)};function pt(t,e){return arguments.length===it&&P(t)&&F(e)?K.apply(this,arguments):arguments.length===nt&&N(t)&&z(e)?J.apply(this,arguments):arguments.length===st&&k(t)&&H(e)?Q.apply(this,arguments):arguments.length===at&&B(t)&&W(e)?tt.apply(this,arguments):arguments.length===ot&&L(t)&&q(e)?et.apply(this,arguments):arguments.length===ht&&O(t)&&Z(e)?rt.apply(this,arguments):dt.apply(this,arguments)}try{Object.defineProperty(pt,"name",{value:e})}catch(t){}return pt.signatures=h,pt._typedFunctionData={signatures:p,signatureMap:m},pt}function $(t,e,r){throw B(t,e,r)}function K(t){return Q(t,0,t.length-1)}function J(t){return t[t.length-1]}function Q(t,e,r){return Array.prototype.slice.call(t,e,r)}function tt(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return t[r]}function et(t,e){return Array.prototype.concat.apply([],t.map(e))}function rt(){var t=K(arguments).map((function(t){return E(T(t))})),e=J(arguments);if("function"!=typeof e)throw new TypeError("Callback function expected as last argument");return it(t,e)}function it(t,e){return{referTo:{references:t,callback:e}}}function nt(t){if("function"!=typeof t)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:t}}}function st(t){return t&&"object"===i(t.referTo)&&Array.isArray(t.referTo.references)&&"function"==typeof t.referTo.callback}function at(t){return t&&"object"===i(t.referToSelf)&&"function"==typeof t.referToSelf.callback}function ot(t,e){if(!t)return e;if(e&&e!==t){var r=new Error("Function names do not match (expected: "+t+", actual: "+e+")");throw r.data={actual:e,expected:t},r}return t}function ht(t){var e;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(b(t[r])||"string"==typeof t[r].signature)&&(e=ot(e,t[r].name));return e}function ut(t,e){var r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(r in t&&e[r]!==t[r]){var i=new Error('Signature "'+r+'" is defined twice');throw i.data={signature:r,sourceFunction:e[r],destFunction:t[r]},i}t[r]=e[r]}}g(),m(l);var lt=d;function ct(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(t.to===t.from)throw new SyntaxError('Illegal to define conversion from "'+t.from+'" to itself.')}return d=function(t){for(var r="string"==typeof t,i=r?t:"",n={},s=r?1:0;s<arguments.length;++s){var a=arguments[s],o={},h=void 0;if("function"==typeof a?(h=a.name,"string"==typeof a.signature?o[a.signature]=a:b(a)&&(o=a.signatures)):e(a)&&(o=a,r||(h=ht(a))),0===Object.keys(o).length){var u=new TypeError("Argument to 'typed' at index "+s+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw u.data={index:s,argument:a},u}r||(i=ot(i,h)),ut(n,o)}return Z(i||"",n)},d.create=h,d.createCount=lt.createCount,d.onMismatch=$,d.throwMismatchError=$,d.createError=B,d.clear=g,d.clearConversions=v,d.addTypes=m,d._findType=p,d.referTo=rt,d.referToSelf=nt,d.convert=w,d.findSignature=y,d.find=x,d.isTypedFunction=b,d.warnAgainstDeprecatedThis=!0,d.addType=function(t,e){var i="any";!1!==e&&r.has("Object")&&(i="Object"),d.addTypes([t],i)},d.addConversion=function(t){ct(t);var e=p(t.to);if(!e.conversionsTo.every((function(e){return e.from!==t.from})))throw new Error('There is already a conversion from "'+t.from+'" to "'+e.name+'"');e.conversionsTo.push({from:t.from,convert:t.convert,index:f++})},d.addConversions=function(t){t.forEach(d.addConversion)},d.removeConversion=function(t){ct(t);var e=p(t.to),r=tt(e.conversionsTo,(function(e){return e.from===t.from}));if(!r)throw new Error("Attempt to remove nonexistent conversion from "+t.from+" to "+t.to);if(r.convert!==t.convert)throw new Error("Conversion to remove does not match existing conversion");var i=e.conversionsTo.indexOf(r);e.conversionsTo.splice(i,1)},d.resolve=function(t,e){if(!b(t))throw new TypeError(o);for(var r=t._typedFunctionData.signatures,i=0;i<r.length;++i)if(r[i].test(e))return r[i];return null},d}return h()}();var wx={length:!0,name:!0},Ex={toString:!0,valueOf:!0,toLocaleString:!0};class Mx{constructor(t){this.wrappedObject=t}keys(){return Object.keys(this.wrappedObject)}get(t){return vx(this.wrappedObject,t)}set(t,e){return _x(this.wrappedObject,t,e),this}has(t){return e=this.wrappedObject,t in e;var e}}function Sx(t){return!!t&&(t instanceof Map||t instanceof Mx||"function"==typeof t.set&&"function"==typeof t.get&&"function"==typeof t.keys&&"function"==typeof t.has)}var Ax=function(){return Ax=r(gx).create,r(gx)},Tx=Hb("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(t){var{BigNumber:e,Complex:r,DenseMatrix:i,Fraction:n}=t,s=Ax();return s.clear(),s.addTypes([{name:"number",test:s_},{name:"Complex",test:o_},{name:"BigNumber",test:a_},{name:"Fraction",test:h_},{name:"Unit",test:u_},{name:"identifier",test:t=>l_&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])*$/.test(t)},{name:"string",test:l_},{name:"Chain",test:j_},{name:"Array",test:c_},{name:"Matrix",test:f_},{name:"DenseMatrix",test:p_},{name:"SparseMatrix",test:m_},{name:"Range",test:g_},{name:"Index",test:v_},{name:"boolean",test:__},{name:"ResultSet",test:b_},{name:"Help",test:y_},{name:"function",test:x_},{name:"Date",test:w_},{name:"RegExp",test:E_},{name:"null",test:S_},{name:"undefined",test:A_},{name:"AccessorNode",test:T_},{name:"ArrayNode",test:C_},{name:"AssignmentNode",test:D_},{name:"BlockNode",test:R_},{name:"ConditionalNode",test:I_},{name:"ConstantNode",test:P_},{name:"FunctionNode",test:k_},{name:"FunctionAssignmentNode",test:N_},{name:"IndexNode",test:B_},{name:"Node",test:L_},{name:"ObjectNode",test:O_},{name:"OperatorNode",test:F_},{name:"ParenthesisNode",test:U_},{name:"RangeNode",test:z_},{name:"RelationalNode",test:G_},{name:"SymbolNode",test:H_},{name:"Map",test:Sx},{name:"Object",test:M_}]),s.addConversions([{from:"number",to:"BigNumber",convert:function(t){if(e||Cx(t),t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e(t)}},{from:"number",to:"Complex",convert:function(t){return r||Dx(t),new r(t,0)}},{from:"BigNumber",to:"Complex",convert:function(t){return r||Dx(t),new r(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return r||Dx(t),new r(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){n||Rx(t);var e=new n(t);if(e.valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(t){e||Cx(t);try{return new e(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){n||Rx(t);try{return new n(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){r||Dx(t);try{return new r(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(t){return e||Cx(t),new e(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return n||Rx(t),new n(+t)}},{from:"boolean",to:"string",convert:function(t){return String(t)}},{from:"Array",to:"Matrix",convert:function(t){return i||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new i(t)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}]),s.onMismatch=(t,e,r)=>{var i=s.createError(t,e,r);if(["wrongType","mismatch"].includes(i.data.category)&&1===e.length&&d_(e[0])&&r.some((t=>!t.params.includes(",")))){var n=new TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw n.data=i.data,n}throw i},s.onMismatch=(t,e,r)=>{var i=s.createError(t,e,r);if(["wrongType","mismatch"].includes(i.data.category)&&1===e.length&&d_(e[0])&&r.some((t=>!t.params.includes(",")))){var n=new TypeError("Function '".concat(t,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(t,")'."));throw n.data=i.data,n}throw i},s}));function Cx(t){throw new Error("Cannot convert value ".concat(t," into a BigNumber: no class 'BigNumber' provided"))}function Dx(t){throw new Error("Cannot convert value ".concat(t," into a Complex number: no class 'Complex' provided"))}function Rx(t){throw new Error("Cannot convert value ".concat(t," into a Fraction, no class 'Fraction' provided."))}function Ix(t){var e,r,i=t.length,n=t[0].length,s=[];for(r=0;r<n;r++){var a=[];for(e=0;e<i;e++)a.push(t[e][r]);s.push(a)}return s}function Px(t){for(var e=0;e<t.length;e++)if(d_(t[e]))return!0;return!1}function Nx(t,e){f_(t)&&(t=t.valueOf());for(var r=0,i=t.length;r<i;r++){var n=t[r];Array.isArray(n)?Nx(n,e):e(n)}}function kx(t,e,r){return t&&"function"==typeof t.map?t.map((function(t){return kx(t,e,r)})):e(t)}function Bx(t,e,r){var i=Array.isArray(t)?Db(t):t.size();if(e<0||e>=i.length)throw new Cb(e,i.length);return f_(t)?t.create(Lx(t.valueOf(),e,r)):Lx(t,e,r)}function Lx(t,e,r){var i,n,s,a;if(e<=0){if(Array.isArray(t[0])){for(a=Ix(t),n=[],i=0;i<a.length;i++)n[i]=Lx(a[i],e-1,r);return n}for(s=t[0],i=1;i<t.length;i++)s=r(s,t[i]);return s}for(n=[],i=0;i<t.length;i++)n[i]=Lx(t[i],e-1,r);return n}var Ox=Hb("abs",["typed"],(t=>{var{typed:e}=t;return e("abs",{number:ty,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0)))})})),Fx="addScalar",Ux=Hb(Fx,["typed"],(t=>{var{typed:e}=t;return e(Fx,{"number, number":ey,"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":e.referToSelf((t=>(r,i)=>{if(null===r.value||void 0===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===i.value||void 0===i.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var n=r.clone();return n.value=e.find(t,[n.valueType(),i.valueType()])(n.value,i.value),n.fixPrefix=!1,n}))})})),zx=Hb("bignumber",["typed","BigNumber"],(t=>{var{typed:e,BigNumber:r}=t;return e("bignumber",{"":function(){return new r(0)},number:function(t){return new r(t+"")},string:function(t){var e=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var i=e[2],n=r(e[1]),s=new r(2).pow(Number(i));if(n.gt(s.sub(1)))throw new SyntaxError('String "'.concat(t,'" is out of range'));var a=new r(2).pow(Number(i)-1);return n.gte(a)?n.sub(s):n}return new r(t)},BigNumber:function(t){return t},Fraction:function(t){return new r(t.n).div(t.d).times(t.s)},null:function(t){return new r(0)},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})}));function Gx(t,e){if(!eb(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(!eb(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");for(var r=t-e,i=1,n=2,s=e<r?e:r,a=e<r?r+1:e+1;a<=t;++a)for(i*=a;n<=s&&i%n==0;)i/=n,++n;return n<=s&&(i/=ky(n,s)),i}Gx.signature="number, number";var Hx="conj",jx=Hb(Hx,["typed"],(t=>{var{typed:e}=t;return e(Hx,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})})),Vx=Hb("trigUnit",["typed"],(t=>{var{typed:e}=t;return{Unit:e.referToSelf((t=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(t,r.valueType())(r.value)}))}}));function Wx(t,e,r){if(null==r)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var i=t.minus(e).abs();if(i.isZero())return!0;var n=t.constructor.max(t.abs(),e.abs());return i.lte(n.times(r))}return!1}function qx(t,e,r){return mb(t.re,e.re,r)&&mb(t.im,e.im,r)}var Xx=Hb("compareUnits",["typed"],(t=>{var{typed:e}=t;return{"Unit, Unit":e.referToSelf((t=>(r,i)=>{if(!r.equalBase(i))throw new Error("Cannot compare units with different base");return e.find(t,[r.valueType(),i.valueType()])(r.value,i.value)}))}})),Yx="equalScalar",Zx=Hb(Yx,["typed","config"],(t=>{var{typed:e,config:r}=t,i=Xx({typed:e});return e(Yx,{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,e){return mb(t,e,r.epsilon)},"BigNumber, BigNumber":function(t,e){return t.eq(e)||Wx(t,e,r.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return qx(t,e,r.epsilon)}},i)}));Hb(Yx,["typed","config"],(t=>{var{typed:e,config:r}=t;return e(Yx,{"number, number":function(t,e){return mb(t,e,r.epsilon)}})})),Math.pow(2,53);var $x="format",Kx=Hb($x,["typed"],(t=>{var{typed:e}=t;return e($x,{any:Mb,"any, Object | function | number":Mb})})),Jx=(Hb("hex",["typed","format"],(t=>{var{typed:e,format:r}=t;return e("hex",{"number | BigNumber":function(t){return r(t,{notation:"hex"})},"number | BigNumber, number":function(t,e){return r(t,{notation:"hex",wordSize:e})}})})),"isZero"),Qx=Hb(Jx,["typed"],(t=>{var{typed:e}=t;return e(Jx,{number:ox,BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:e.referToSelf((t=>r=>e.find(t,r.valueType())(r.value))),"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})}));var tw=Hb("multiplyScalar",["typed"],(t=>{var{typed:e}=t;return e("multiplyScalar",{"number, number":ry,"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":(t,e)=>e.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,e)=>t.multiply(e)})}));var ew=Hb("number",["typed"],(t=>{var{typed:e}=t,r=e("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e,r,i=(r=(e=t).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:{"0b":2,"0o":8,"0x":16}[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(i)return function(t){for(var e=parseInt(t.integerPart,t.radix),r=0,i=0;i<t.fractionalPart.length;i++)r+=parseInt(t.fractionalPart[i],t.radix)/Math.pow(t.radix,i+1);var n=e+r;if(isNaN(n))throw new SyntaxError('String "'+t.input+'" is no valid number');return n}(i);var n=0,s=t.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);s&&(n=Number(s[2]),t=s[1]);var a=Number(t);if(isNaN(a))throw new SyntaxError('String "'+t+'" is no valid number');if(s){if(a>2**n-1)throw new SyntaxError('String "'.concat(t,'" is out of range'));a>=2**(n-1)&&(a-=2**n)}return a},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))});return r.fromJSON=function(t){return parseFloat(t.value)},r})),rw=(Hb("oct",["typed","format"],(t=>{var{typed:e,format:r}=t;return e("oct",{"number | BigNumber":function(t){return r(t,{notation:"oct"})},"number | BigNumber, number":function(t,e){return r(t,{notation:"oct",wordSize:e})}})})),s("lSM16")),iw=s("cEvOy"),nw=s("4Pyy4"),sw=s("d83i5"),aw=s("bqVCQ"),ow=s("71IaV"),hw={};!function(t,e,r){var i,n=256,a="random",o=r.pow(n,6),h=r.pow(2,52),u=2*h,l=255;function c(s,l,c){var v=[],_=m(p((l=1==l?{entropy:!0}:l||{}).entropy?[s,g(e)]:null==s?function(){try{var r;return i&&(r=i.randomBytes)?r=r(n):(r=new Uint8Array(n),(t.crypto||t.msCrypto).getRandomValues(r)),g(r)}catch(r){var s=t.navigator,a=s&&s.plugins;return[+new Date,t,a,t.screen,g(e)]}}():s,3),v),b=new f(v),y=function(){for(var t=b.g(6),e=o,r=0;t<h;)t=(t+r)*n,e*=n,r=b.g(1);for(;t>=u;)t/=2,e/=2,r>>>=1;return(t+r)/e};return y.int32=function(){return 0|b.g(4)},y.quick=function(){return b.g(4)/4294967296},y.double=y,m(g(b.S),e),(l.pass||c||function(t,e,i,n){return n&&(n.S&&d(n,b),t.state=function(){return d(b,{})}),i?(r[a]=t,e):t})(y,_,"global"in l?l.global:this==r,l.state)}function f(t){var e,r=t.length,i=this,s=0,a=i.i=i.j=0,o=i.S=[];for(r||(t=[r++]);s<n;)o[s]=s++;for(s=0;s<n;s++)o[s]=o[a=l&a+t[s%r]+(e=o[s])],o[a]=e;(i.g=function(t){for(var e,r=0,s=i.i,a=i.j,o=i.S;t--;)e=o[s=l&s+1],r=r*n+o[l&(o[s]=o[a=l&a+e])+(o[a]=e)];return i.i=s,i.j=a,r})(n)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){var r,i=[],n=typeof t;if(e&&"object"==n)for(r in t)try{i.push(p(t[r],e-1))}catch(t){}return i.length?i:"string"==n?t:t+"\0"}function m(t,e){for(var r,i=t+"",n=0;n<i.length;)e[l&n]=l&(r^=19*e[l&n])+i.charCodeAt(n++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),e),hw){hw=c;try{i=s("4AFFV")}catch(t){}}else"function"==typeof define&&define.amd?define((function(){return c})):r["seed"+a]=c}("undefined"!=typeof self?self:hw,[],Math),hw.alea=rw,hw.xor128=iw,hw.xorwow=nw,hw.xorshift7=sw,hw.xor4096=aw,hw.tychei=ow;Date.now();var uw=Hb("SparseMatrix",["typed","equalScalar","Matrix"],(t=>{var{typed:e,equalScalar:r,Matrix:i}=t;function n(t,e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!l_(e))throw new Error("Invalid datatype: "+e);if(f_(t))!function(t,e,r){"SparseMatrix"===e.type?(t._values=e._values?W_(e._values):void 0,t._index=W_(e._index),t._ptr=W_(e._ptr),t._size=W_(e._size),t._datatype=r||e._datatype):s(t,e.valueOf(),r||e._datatype)}(this,t,e);else if(t&&c_(t.index)&&c_(t.ptr)&&c_(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(c_(t))s(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+V_(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}function s(t,i,n){t._values=[],t._index=[],t._ptr=[],t._datatype=n;var s=i.length,a=0,o=r,h=0;if(l_(n)&&(o=e.find(r,[n,n])||r,h=e.convert(0,n)),s>0){var u=0;do{t._ptr.push(t._index.length);for(var l=0;l<s;l++){var c=i[l];if(c_(c)){if(0===u&&a<c.length&&(a=c.length),u<c.length){var f=c[u];o(f,h)||(t._values.push(f),t._index.push(l))}}else 0===u&&a<1&&(a=1),o(c,h)||(t._values.push(c),t._index.push(l))}u++}while(u<a)}t._ptr.push(t._index.length),t._size=[s,a]}function a(t,e){if(!v_(e))throw new TypeError("Invalid index");if(e.isScalar())return t.get(e.min());var r,i,s,a,o=e.size();if(o.length!==t._size.length)throw new Tb(o.length,t._size.length);var h=e.min(),u=e.max();for(r=0,i=t._size.length;r<i;r++)Pb(h[r],t._size[r]),Pb(u[r],t._size[r]);var l=t._values,c=t._index,f=t._ptr,d=e.dimension(0),p=e.dimension(1),m=[],g=[];d.forEach((function(t,e){g[t]=e[0],m[t]=!0}));var v=l?[]:void 0,_=[],b=[];return p.forEach((function(t){for(b.push(_.length),s=f[t],a=f[t+1];s<a;s++)r=c[s],!0===m[r]&&(_.push(g[r]),v&&v.push(l[s]))})),b.push(_.length),new n({values:v,index:_,ptr:b,size:o,datatype:t._datatype})}function o(t,e,r,i){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var n,s=e.size(),a=e.isScalar();if(f_(r)?(n=r.size(),r=r.toArray()):n=Db(r),a){if(0!==n.length)throw new TypeError("Scalar expected");t.set(e.min(),r,i)}else{if(1!==s.length&&2!==s.length)throw new Tb(s.length,t._size.length,"<");if(n.length<s.length){for(var o=0,h=0;1===s[o]&&1===n[o];)o++;for(;1===s[o];)h++,o++;r=Fb(r,s.length,h,n)}if(!Y_(s,n))throw new Tb(s,n,">");if(1===s.length){e.dimension(0).forEach((function(e,n){Pb(e),t.set([e,0],r[n[0]],i)}))}else{var u=e.dimension(0),l=e.dimension(1);u.forEach((function(e,n){Pb(e),l.forEach((function(s,a){Pb(s),t.set([e,s],r[n[0]][a[0]],i)}))}))}}return t}function h(t,e,r,i){if(r-e==0)return r;for(var n=e;n<r;n++)if(i[n]===t)return n;return e}function u(t,e,r,i,n,s,a){n.splice(t,0,i),s.splice(t,0,e);for(var o=r+1;o<a.length;o++)a[o]++}function l(t,i,n,s){var a=s||0,o=r,h=0;l_(t._datatype)&&(o=e.find(r,[t._datatype,t._datatype])||r,h=e.convert(0,t._datatype),a=e.convert(a,t._datatype));var u,l,c,f=!o(a,h),d=t._size[0],p=t._size[1];if(n>p){for(l=p;l<n;l++)if(t._ptr[l]=t._values.length,f)for(u=0;u<d;u++)t._values.push(a),t._index.push(u);t._ptr[n]=t._values.length}else n<p&&(t._ptr.splice(n+1,p-n),t._values.splice(t._ptr[n],t._values.length),t._index.splice(t._ptr[n],t._index.length));if(p=n,i>d){if(f){var m=0;for(l=0;l<p;l++){t._ptr[l]=t._ptr[l]+m,c=t._ptr[l+1]+m;var g=0;for(u=d;u<i;u++,g++)t._values.splice(c+g,0,a),t._index.splice(c+g,0,u),m++}t._ptr[p]=t._values.length}}else if(i<d){var v=0;for(l=0;l<p;l++){t._ptr[l]=t._ptr[l]-v;var _=t._ptr[l],b=t._ptr[l+1]-v;for(c=_;c<b;c++)(u=t._index[c])>i-1&&(t._values.splice(c,1),t._index.splice(c,1),v++)}t._ptr[l]=t._values.length}return t._size[0]=i,t._size[1]=n,t}function c(t,e,r,i,n){var s,a,o=i[0],h=i[1],u=[];for(s=0;s<o;s++)for(u[s]=[],a=0;a<h;a++)u[s][a]=0;for(a=0;a<h;a++)for(var l=r[a],c=r[a+1],f=l;f<c;f++)u[s=e[f]][a]=t?n?W_(t[f]):t[f]:1;return u}return n.prototype=new i,n.prototype.createSparseMatrix=function(t,e){return new n(t,e)},Object.defineProperty(n,"name",{value:"SparseMatrix"}),n.prototype.constructor=n,n.prototype.type="SparseMatrix",n.prototype.isSparseMatrix=!0,n.prototype.getDataType=function(){return Gb(this._values,V_)},n.prototype.storage=function(){return"sparse"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(t,e){return new n(t,e)},n.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},n.prototype.subset=function(t,e,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return a(this,t);case 2:case 3:return o(this,t,e,r);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(t){if(!c_(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Tb(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],r=t[1];Pb(e,this._size[0]),Pb(r,this._size[1]);var i=h(e,this._ptr[r],this._ptr[r+1],this._index);return i<this._ptr[r+1]&&this._index[i]===e?this._values[i]:0},n.prototype.set=function(t,i,n){if(!c_(t))throw new TypeError("Array expected");if(t.length!==this._size.length)throw new Tb(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var s=t[0],a=t[1],o=this._size[0],c=this._size[1],f=r,d=0;l_(this._datatype)&&(f=e.find(r,[this._datatype,this._datatype])||r,d=e.convert(0,this._datatype)),(s>o-1||a>c-1)&&(l(this,Math.max(s+1,o),Math.max(a+1,c),n),o=this._size[0],c=this._size[1]),Pb(s,o),Pb(a,c);var p=h(s,this._ptr[a],this._ptr[a+1],this._index);return p<this._ptr[a+1]&&this._index[p]===s?f(i,d)?function(t,e,r,i,n){r.splice(t,1),i.splice(t,1);for(var s=e+1;s<n.length;s++)n[s]--}(p,a,this._values,this._index,this._ptr):this._values[p]=i:f(i,d)||u(p,s,a,i,this._values,this._index,this._ptr),this},n.prototype.resize=function(t,e,r){if(!d_(t))throw new TypeError("Array or Matrix expected");var i=t.valueOf().map((t=>Array.isArray(t)&&1===t.length?t[0]:t));if(2!==i.length)throw new Error("Only two dimensions matrix are supported");return i.forEach((function(t){if(!s_(t)||!eb(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Mb(i)+")")})),l(r?this.clone():this,i[0],i[1],e)},n.prototype.reshape=function(t,e){if(!c_(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");t.forEach((function(e){if(!s_(e)||!eb(e)||e<=-2||0===e)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Mb(t)+")")}));var r=this._size[0]*this._size[1];if(r!==(t=Lb(t,r))[0]*t[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var i=e?this.clone():this;if(this._size[0]===t[0]&&this._size[1]===t[1])return i;for(var n=[],s=0;s<i._ptr.length;s++)for(var a=0;a<i._ptr[s+1]-i._ptr[s];a++)n.push(s);for(var o=i._values.slice(),l=i._index.slice(),c=0;c<i._index.length;c++){var f=l[c],d=n[c],p=f*i._size[1]+d;n[c]=p%t[1],l[c]=Math.floor(p/t[1])}i._values.length=0,i._index.length=0,i._ptr.length=t[1]+1,i._size=t.slice();for(var m=0;m<i._ptr.length;m++)i._ptr[m]=0;for(var g=0;g<o.length;g++){var v=l[g],_=n[g],b=o[g];u(h(v,i._ptr[_],i._ptr[_+1],i._index),v,_,b,i._values,i._index,i._ptr)}return i},n.prototype.clone=function(){return new n({values:this._values?W_(this._values):void 0,index:W_(this._index),ptr:W_(this._ptr),size:W_(this._size),datatype:this._datatype})},n.prototype.size=function(){return this._size.slice(0)},n.prototype.map=function(t,i){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var s=this,a=this._size[0],o=this._size[1],h=Zb(t);return function(t,i,s,a,o,h,u){var l=[],c=[],f=[],d=r,p=0;l_(t._datatype)&&(d=e.find(r,[t._datatype,t._datatype])||r,p=e.convert(0,t._datatype));for(var m=function(t,e,r){t=h(t,e,r),d(t,p)||(l.push(t),c.push(e))},g=a;g<=o;g++){f.push(l.length);var v=t._ptr[g],_=t._ptr[g+1];if(u)for(var b=v;b<_;b++){var y=t._index[b];y>=i&&y<=s&&m(t._values[b],y-i,g-a)}else{for(var x={},w=v;w<_;w++){x[t._index[w]]=t._values[w]}for(var E=i;E<=s;E++){m(E in x?x[E]:0,E-i,g-a)}}}return f.push(l.length),new n({values:l,index:c,ptr:f,size:[s-i+1,o-a+1]})}(this,0,a-1,0,o-1,(function(e,r,i){return 1===h?t(e):2===h?t(e,[r,i]):t(e,[r,i],s)}),i)},n.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this._size[0],i=this._size[1],n=0;n<i;n++){var s=this._ptr[n],a=this._ptr[n+1];if(e)for(var o=s;o<a;o++){var h=this._index[o];t(this._values[o],[h,n],this)}else{for(var u={},l=s;l<a;l++){u[this._index[l]]=this._values[l]}for(var c=0;c<r;c++){t(c in u?u[c]:0,[c,n],this)}}}},n.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var t=this._size[1],e=0;e<t;e++)for(var r=this._ptr[e],i=this._ptr[e+1],n=r;n<i;n++){var s=this._index[n];yield{value:this._values[n],index:[s,e]}}},n.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},n.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},n.prototype.format=function(t){for(var e=this._size[0],r=this._size[1],i=this.density(),n="Sparse Matrix ["+Mb(e,t)+" x "+Mb(r,t)+"] density: "+Mb(i,t)+"\n",s=0;s<r;s++)for(var a=this._ptr[s],o=this._ptr[s+1],h=a;h<o;h++){n+="\n    ("+Mb(this._index[h],t)+", "+Mb(s,t)+") ==> "+(this._values?Mb(this._values[h],t):"X")}return n},n.prototype.toString=function(){return Mb(this.toArray())},n.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(t){if(t){if(a_(t)&&(t=t.toNumber()),!s_(t)||!eb(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,r=t<0?-t:0,i=this._size[0],s=this._size[1],a=Math.min(i-r,s-e),o=[],h=[],u=[];u[0]=0;for(var l=e;l<s&&o.length<a;l++)for(var c=this._ptr[l],f=this._ptr[l+1],d=c;d<f;d++){var p=this._index[d];if(p===l-e+r){o.push(this._values[d]),h[o.length-1]=p-r;break}}return u.push(o.length),new n({values:o,index:h,ptr:u,size:[a,1]})},n.fromJSON=function(t){return new n(t)},n.diagonal=function(t,i,s,a,o){if(!c_(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map((function(t){if(a_(t)&&(t=t.toNumber()),!s_(t)||!eb(t)||t<1)throw new Error("Size values must be positive integers");return t})),s){if(a_(s)&&(s=s.toNumber()),!s_(s)||!eb(s))throw new TypeError("The parameter k must be an integer number")}else s=0;var h=r,u=0;l_(o)&&(h=e.find(r,[o,o])||r,u=e.convert(0,o));var l,c=s>0?s:0,f=s<0?-s:0,d=t[0],p=t[1],m=Math.min(d-f,p-c);if(c_(i)){if(i.length!==m)throw new Error("Invalid value array length");l=function(t){return i[t]}}else if(f_(i)){var g=i.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");l=function(t){return i.get([t])}}else l=function(){return i};for(var v=[],_=[],b=[],y=0;y<p;y++){b.push(v.length);var x=y-c;if(x>=0&&x<m){var w=l(x);h(w,u)||(_.push(x+f),v.push(w))}}return b.push(v.length),new n({values:v,index:_,ptr:b,size:[d,p]})},n.prototype.swapRows=function(t,e){if(!(s_(t)&&eb(t)&&s_(e)&&eb(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Pb(t,this._size[0]),Pb(e,this._size[0]),n._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},n._forEachRow=function(t,e,r,i,n){for(var s=i[t],a=i[t+1],o=s;o<a;o++)n(r[o],e[o])},n._swapRows=function(t,e,r,i,n,s){for(var a=0;a<r;a++){var o=s[a],u=s[a+1],l=h(t,o,u,n),c=h(e,o,u,n);if(l<u&&c<u&&n[l]===t&&n[c]===e){if(i){var f=i[l];i[l]=i[c],i[c]=f}}else if(l<u&&n[l]===t&&(c>=u||n[c]!==e)){var d=i?i[l]:void 0;n.splice(c,0,e),i&&i.splice(c,0,d),n.splice(c<=l?l+1:l,1),i&&i.splice(c<=l?l+1:l,1)}else if(c<u&&n[c]===e&&(l>=u||n[l]!==t)){var p=i?i[c]:void 0;n.splice(l,0,t),i&&i.splice(l,0,p),n.splice(l<=c?c+1:c,1),i&&i.splice(l<=c?c+1:c,1)}}},n}),{isClass:!0}),lw=Hb("tan",["typed"],(t=>{var{typed:e}=t,r=Vx({typed:e});return e("tan",{number:Math.tan,"Complex | BigNumber":t=>t.tan()},r)}));Hb("bin",["typed","format"],(t=>{var{typed:e,format:r}=t;return e("bin",{"number | BigNumber":function(t){return r(t,{notation:"bin"})},"number | BigNumber, number":function(t,e){return r(t,{notation:"bin",wordSize:e})}})}));var cw=Hb("cos",["typed"],(t=>{var{typed:e}=t,r=Vx({typed:e});return e("cos",{number:Math.cos,"Complex | BigNumber":t=>t.cos()},r)})),fw=Hb("sqrt",["config","typed","Complex"],(t=>{var{config:e,typed:r,Complex:i}=t;return r("sqrt",{number:n,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():n(t.toNumber())},Unit:function(t){return t.pow(.5)}});function n(t){return isNaN(t)?NaN:t>=0||e.predictable?Math.sqrt(t):new i(t,0).sqrt()}})),dw="unaryMinus",pw=Hb(dw,["typed"],(t=>{var{typed:e}=t;return e(dw,{number:iy,"Complex | BigNumber | Fraction":t=>t.neg(),Unit:e.referToSelf((t=>r=>{var i=r.clone();return i.value=e.find(t,i.valueType())(r.value),i})),"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0)))})})),mw=Hb("fraction",["typed","Fraction"],(t=>{var{typed:e,Fraction:r}=t;return e("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new r(t)},string:function(t){return new r(t)},"number, number":function(t,e){return new r(t,e)},null:function(t){return new r(0)},BigNumber:function(t){return new r(t.toString())},Fraction:function(t){return t},Object:function(t){return new r(t)},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})})),gw="isNumeric",vw=Hb(gw,["typed"],(t=>{var{typed:e}=t;return e(gw,{"number | BigNumber | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})})),_w="matrix",bw=Hb(_w,["typed","Matrix","DenseMatrix","SparseMatrix"],(t=>{var{typed:e,Matrix:r,DenseMatrix:i,SparseMatrix:n}=t;return e(_w,{"":function(){return s([])},string:function(t){return s([],t)},"string, string":function(t,e){return s([],t,e)},Array:function(t){return s(t)},Matrix:function(t){return s(t,t.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(t,e,r){if("dense"===e||"default"===e||void 0===e)return new i(t,r);if("sparse"===e)return new n(t,r);throw new TypeError("Unknown matrix type "+JSON.stringify(e)+".")}})),yw=Hb("matAlgo03xDSf",["typed"],(t=>{var{typed:e}=t;return function(t,r,i,n){var s=t._data,a=t._size,o=t._datatype,h=r._values,u=r._index,l=r._ptr,c=r._size,f=r._datatype;if(a.length!==c.length)throw new Tb(a.length,c.length);if(a[0]!==c[0]||a[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,p=a[0],m=a[1],g=0,v=i;"string"==typeof o&&o===f&&(d=o,g=e.convert(0,d),v=e.find(i,[d,d]));for(var _=[],b=0;b<p;b++)_[b]=[];for(var y=[],x=[],w=0;w<m;w++){for(var E=w+1,M=l[w],S=l[w+1],A=M;A<S;A++){var T=u[A];y[T]=n?v(h[A],s[T][w]):v(s[T][w],h[A]),x[T]=E}for(var C=0;C<p;C++)x[C]===E?_[C][w]=y[C]:_[C][w]=n?v(g,s[C][w]):v(s[C][w],g)}return t.createDenseMatrix({data:_,size:[p,m],datatype:d})}})),xw=Hb("matAlgo05xSfSf",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,i,n){var s=t._values,a=t._index,o=t._ptr,h=t._size,u=t._datatype,l=i._values,c=i._index,f=i._ptr,d=i._size,p=i._datatype;if(h.length!==d.length)throw new Tb(h.length,d.length);if(h[0]!==d[0]||h[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+d+")");var m,g=h[0],v=h[1],_=r,b=0,y=n;"string"==typeof u&&u===p&&(m=u,_=e.find(r,[m,m]),b=e.convert(0,m),y=e.find(n,[m,m]));var x,w,E,M,S=s&&l?[]:void 0,A=[],T=[],C=S?[]:void 0,D=S?[]:void 0,R=[],I=[];for(w=0;w<v;w++){T[w]=A.length;var P=w+1;for(E=o[w],M=o[w+1];E<M;E++)x=a[E],A.push(x),R[x]=P,C&&(C[x]=s[E]);for(E=f[w],M=f[w+1];E<M;E++)R[x=c[E]]!==P&&A.push(x),I[x]=P,D&&(D[x]=l[E]);if(S)for(E=T[w];E<A.length;){var N=R[x=A[E]],k=I[x];if(N===P||k===P){var B=y(N===P?C[x]:b,k===P?D[x]:b);_(B,b)?A.splice(E,1):(S.push(B),E++)}}}return T[v]=A.length,t.createSparseMatrix({values:S,index:A,ptr:T,size:[g,v],datatype:m})}})),ww=Hb("matAlgo11xS0s",["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return function(t,i,n,s){var a=t._values,o=t._index,h=t._ptr,u=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,f=u[0],d=u[1],p=r,m=0,g=n;"string"==typeof l&&(c=l,p=e.find(r,[c,c]),m=e.convert(0,c),i=e.convert(i,c),g=e.find(n,[c,c]));for(var v=[],_=[],b=[],y=0;y<d;y++){b[y]=_.length;for(var x=h[y],w=h[y+1],E=x;E<w;E++){var M=o[E],S=s?g(i,a[E]):g(a[E],i);p(S,m)||(_.push(M),v.push(S))}}return b[d]=_.length,t.createSparseMatrix({values:v,index:_,ptr:b,size:[f,d],datatype:c})}})),Ew=Hb("matAlgo12xSfs",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,i,n,s){var a=t._values,o=t._index,h=t._ptr,u=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,f=u[0],d=u[1],p=n;"string"==typeof l&&(c=l,i=e.convert(i,c),p=e.find(n,[c,c]));for(var m=[],g=[],v=[],_=0;_<d;_++){for(var b=_+1,y=h[_],x=h[_+1],w=y;w<x;w++){var E=o[w];g[E]=a[w],v[E]=b}for(var M=0;M<f;M++)0===_&&(m[M]=[]),v[M]===b?m[M][_]=s?p(i,g[M]):p(g[M],i):m[M][_]=s?p(i,0):p(0,i)}return new r({data:m,size:[f,d],datatype:c})}})),Mw=Hb("matAlgo13xDD",["typed"],(t=>{var{typed:e}=t;return function(t,i,n){var s,a=t._data,o=t._size,h=t._datatype,u=i._data,l=i._size,c=i._datatype,f=[];if(o.length!==l.length)throw new Tb(o.length,l.length);for(var d=0;d<o.length;d++){if(o[d]!==l[d])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");f[d]=o[d]}var p=n;"string"==typeof h&&h===c&&(s=h,p=e.find(n,[s,s]));var m=f.length>0?r(p,0,f,f[0],a,u):[];return t.createDenseMatrix({data:m,size:f,datatype:s})};function r(t,e,i,n,s,a){var o=[];if(e===i.length-1)for(var h=0;h<n;h++)o[h]=t(s[h],a[h]);else for(var u=0;u<n;u++)o[u]=r(t,e+1,i,i[e+1],s[u],a[u]);return o}})),Sw=Hb("matAlgo14xDs",["typed"],(t=>{var{typed:e}=t;return function(t,i,n,s){var a,o=t._data,h=t._size,u=t._datatype,l=n;"string"==typeof u&&(a=u,i=e.convert(i,a),l=e.find(n,[a,a]));var c=h.length>0?r(l,0,h,h[0],o,i,s):[];return t.createDenseMatrix({data:c,size:W_(h),datatype:a})};function r(t,e,i,n,s,a,o){var h=[];if(e===i.length-1)for(var u=0;u<n;u++)h[u]=o?t(a,s[u]):t(s[u],a);else for(var l=0;l<n;l++)h[l]=r(t,e+1,i,i[e+1],s[l],a,o);return h}})),Aw=Hb("matrixAlgorithmSuite",["typed","matrix"],(t=>{var{typed:e,matrix:r}=t,i=Mw({typed:e}),n=Sw({typed:e});return function(t){var s,a=t.elop,o=t.SD||t.DS;a?(s={"DenseMatrix, DenseMatrix":(t,e)=>i(t,e,a),"Array, Array":(t,e)=>i(r(t),r(e),a).valueOf(),"Array, DenseMatrix":(t,e)=>i(r(t),e,a),"DenseMatrix, Array":(t,e)=>i(t,r(e),a)},t.SS&&(s["SparseMatrix, SparseMatrix"]=(e,r)=>t.SS(e,r,a,!1)),t.DS&&(s["DenseMatrix, SparseMatrix"]=(e,r)=>t.DS(e,r,a,!1),s["Array, SparseMatrix"]=(e,i)=>t.DS(r(e),i,a,!1)),o&&(s["SparseMatrix, DenseMatrix"]=(t,e)=>o(e,t,a,!0),s["SparseMatrix, Array"]=(t,e)=>o(r(e),t,a,!0))):(s={"DenseMatrix, DenseMatrix":e.referToSelf((t=>(e,r)=>i(e,r,t))),"Array, Array":e.referToSelf((t=>(e,n)=>i(r(e),r(n),t).valueOf())),"Array, DenseMatrix":e.referToSelf((t=>(e,n)=>i(r(e),n,t))),"DenseMatrix, Array":e.referToSelf((t=>(e,n)=>i(e,r(n),t)))},t.SS&&(s["SparseMatrix, SparseMatrix"]=e.referToSelf((e=>(r,i)=>t.SS(r,i,e,!1)))),t.DS&&(s["DenseMatrix, SparseMatrix"]=e.referToSelf((e=>(r,i)=>t.DS(r,i,e,!1))),s["Array, SparseMatrix"]=e.referToSelf((e=>(i,n)=>t.DS(r(i),n,e,!1)))),o&&(s["SparseMatrix, DenseMatrix"]=e.referToSelf((t=>(e,r)=>o(r,e,t,!0))),s["SparseMatrix, Array"]=e.referToSelf((t=>(e,i)=>o(r(i),e,t,!0)))));var h=t.scalar||"any";(t.Ds||t.Ss)&&(a?(s["DenseMatrix,"+h]=(t,e)=>n(t,e,a,!1),s[h+", DenseMatrix"]=(t,e)=>n(e,t,a,!0),s["Array,"+h]=(t,e)=>n(r(t),e,a,!1).valueOf(),s[h+", Array"]=(t,e)=>n(r(e),t,a,!0).valueOf()):(s["DenseMatrix,"+h]=e.referToSelf((t=>(e,r)=>n(e,r,t,!1))),s[h+", DenseMatrix"]=e.referToSelf((t=>(e,r)=>n(r,e,t,!0))),s["Array,"+h]=e.referToSelf((t=>(e,i)=>n(r(e),i,t,!1).valueOf())),s[h+", Array"]=e.referToSelf((t=>(e,i)=>n(r(i),e,t,!0).valueOf()))));var u=void 0!==t.sS?t.sS:t.Ss;return a?(t.Ss&&(s["SparseMatrix,"+h]=(e,r)=>t.Ss(e,r,a,!1)),u&&(s[h+", SparseMatrix"]=(t,e)=>u(e,t,a,!0))):(t.Ss&&(s["SparseMatrix,"+h]=e.referToSelf((e=>(r,i)=>t.Ss(r,i,e,!1)))),u&&(s[h+", SparseMatrix"]=e.referToSelf((t=>(e,r)=>u(r,e,t,!0))))),a&&a.signatures&&X_(s,a.signatures),s}})),Tw=Hb("matAlgo01xDSid",["typed"],(t=>{var{typed:e}=t;return function(t,r,i,n){var s=t._data,a=t._size,o=t._datatype,h=r._values,u=r._index,l=r._ptr,c=r._size,f=r._datatype;if(a.length!==c.length)throw new Tb(a.length,c.length);if(a[0]!==c[0]||a[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,p,m=a[0],g=a[1],v="string"==typeof o&&o===f?o:void 0,_=v?e.find(i,[v,v]):i,b=[];for(d=0;d<m;d++)b[d]=[];var y=[],x=[];for(p=0;p<g;p++){for(var w=p+1,E=l[p],M=l[p+1],S=E;S<M;S++)y[d=u[S]]=n?_(h[S],s[d][p]):_(s[d][p],h[S]),x[d]=w;for(d=0;d<m;d++)x[d]===w?b[d][p]=y[d]:b[d][p]=s[d][p]}return t.createDenseMatrix({data:b,size:[m,g],datatype:v})}}));function Cw(){throw new Error('No "bignumber" implementation available')}function Dw(){throw new Error('No "fraction" implementation available')}function Rw(){throw new Error('No "matrix" implementation available')}var Iw=Hb("numeric",["number","?bignumber","?fraction"],(t=>{var{number:e,bignumber:r,fraction:i}=t,n={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:t=>e(t),BigNumber:r?t=>r(t):Cw,Fraction:i?t=>i(t):Dw};return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",r=arguments.length>2?arguments[2]:void 0;if(void 0!==r)throw new SyntaxError("numeric() takes one or two arguments");var i=V_(t);if(!(i in n))throw new TypeError("Cannot convert "+t+' of type "'+i+'"; valid input types are '+Object.keys(n).join(", "));if(!(e in s))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(s).join(", "));return e===i?t:s[e](t)}}));function Pw(t,e,r){var i;return-1!==String(t).indexOf("Unexpected type")?(i=arguments.length>2?" (type: "+V_(r)+", value: "+JSON.stringify(r)+")":" (type: "+t.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+i)):-1!==String(t).indexOf("complex numbers")?(i=arguments.length>2?" (type: "+V_(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+i)):t}var Nw="size",kw=Hb(Nw,["typed","config","?matrix"],(t=>{var{typed:e,config:r,matrix:i}=t;return e(Nw,{Matrix:function(t){return t.create(t.size())},Array:Db,string:function(t){return"Array"===r.matrix?[t.length]:i([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===r.matrix?[]:i?i([]):Rw()}})})),Bw=Hb("matAlgo07xSSf",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,n,s){var a=t._size,o=t._datatype,h=n._size,u=n._datatype;if(a.length!==h.length)throw new Tb(a.length,h.length);if(a[0]!==h[0]||a[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+h+")");var l,c,f,d=a[0],p=a[1],m=0,g=s;"string"==typeof o&&o===u&&(l=o,m=e.convert(0,l),g=e.find(s,[l,l]));var v=[];for(c=0;c<d;c++)v[c]=[];var _=[],b=[],y=[],x=[];for(f=0;f<p;f++){var w=f+1;for(i(t,f,y,_,w),i(n,f,x,b,w),c=0;c<d;c++){var E=y[c]===w?_[c]:m,M=x[c]===w?b[c]:m;v[c][f]=g(E,M)}}return new r({data:v,size:[d,p],datatype:l})};function i(t,e,r,i,n){for(var s=t._values,a=t._index,o=t._ptr,h=o[e],u=o[e+1];h<u;h++){var l=a[h];r[l]=n,i[l]=s[h]}}})),Lw="smaller",Ow=Hb(Lw,["typed","config","matrix","DenseMatrix"],(t=>{var{typed:e,config:r,matrix:i,DenseMatrix:n}=t,s=yw({typed:e}),a=Bw({typed:e,DenseMatrix:n}),o=Ew({typed:e,DenseMatrix:n}),h=Aw({typed:e,matrix:i}),u=Xx({typed:e});return e(Lw,Fw({typed:e,config:r}),{"boolean, boolean":(t,e)=>t<e,"BigNumber, BigNumber":function(t,e){return t.lt(e)&&!Wx(t,e,r.epsilon)},"Fraction, Fraction":(t,e)=>-1===t.compare(e),"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")}},u,h({SS:a,DS:s,Ss:o}))})),Fw=Hb(Lw,["typed","config"],(t=>{var{typed:e,config:r}=t;return e(Lw,{"number, number":function(t,e){return t<e&&!mb(t,e,r.epsilon)}})}));var Uw=Hb("matAlgo10xSids",["typed","DenseMatrix"],(t=>{var{typed:e,DenseMatrix:r}=t;return function(t,i,n,s){var a=t._values,o=t._index,h=t._ptr,u=t._size,l=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var c,f=u[0],d=u[1],p=n;"string"==typeof l&&(c=l,i=e.convert(i,c),p=e.find(n,[c,c]));for(var m=[],g=[],v=[],_=0;_<d;_++){for(var b=_+1,y=h[_],x=h[_+1],w=y;w<x;w++){var E=o[w];g[E]=a[w],v[E]=b}for(var M=0;M<f;M++)0===_&&(m[M]=[]),v[M]===b?m[M][_]=s?p(i,g[M]):p(g[M],i):m[M][_]=i}return new r({data:m,size:[f,d],datatype:c})}})),zw="subtract",Gw=Hb(zw,["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],(t=>{var{typed:e,matrix:r,equalScalar:i,addScalar:n,unaryMinus:s,DenseMatrix:a}=t,o=Tw({typed:e}),h=yw({typed:e}),u=xw({typed:e,equalScalar:i}),l=Uw({typed:e,DenseMatrix:a}),c=Ew({typed:e,DenseMatrix:a}),f=Aw({typed:e,matrix:r});return e(zw,{"number, number":(t,e)=>t-e,"Complex, Complex":(t,e)=>t.sub(e),"BigNumber, BigNumber":(t,e)=>t.minus(e),"Fraction, Fraction":(t,e)=>t.sub(e),"Unit, Unit":e.referToSelf((t=>(r,i)=>{if(null===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===i.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var n=r.clone();return n.value=e.find(t,[n.valueType(),i.valueType()])(n.value,i.value),n.fixPrefix=!1,n}))},f({SS:u,DS:o,SD:h,Ss:c,sS:l}))})),Hw="zeros",jw=Hb(Hw,["typed","config","matrix","BigNumber"],(t=>{var{typed:e,config:r,matrix:i,BigNumber:n}=t;return e(Hw,{"":function(){return"Array"===r.matrix?s([]):s([],"default")},"...number | BigNumber | string":function(t){if("string"==typeof t[t.length-1]){var e=t.pop();return s(t,e)}return"Array"===r.matrix?s(t):s(t,"default")},Array:s,Matrix:function(t){var e=t.storage();return s(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return s(t.valueOf(),e)}});function s(t,e){var r=function(t){var e=!1;return t.forEach((function(t,r,i){a_(t)&&(e=!0,i[r]=t.toNumber())})),e}(t),s=r?new n(0):0;if(function(t){t.forEach((function(t){if("number"!=typeof t||!eb(t)||t<0)throw new Error("Parameters in function zeros must be positive integers")}))}(t),e){var a=i(e);return t.length>0?a.resize(t,s):a}var o=[];return t.length>0?Nb(o,t,s):o}}));Ab.signature="any, any";var Vw="divideScalar",Ww=Hb(Vw,["typed","numeric"],(t=>{var{typed:e,numeric:r}=t;return e(Vw,{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":(t,e)=>t.divide(e),"number | Fraction | Complex | BigNumber, Unit":(t,e)=>e.divideInto(t)})})),qw="equal",Xw=Hb(qw,["typed","matrix","equalScalar","DenseMatrix"],(t=>{var{typed:e,matrix:r,equalScalar:i,DenseMatrix:n}=t,s=yw({typed:e}),a=Bw({typed:e,DenseMatrix:n}),o=Ew({typed:e,DenseMatrix:n}),h=Aw({typed:e,matrix:r});return e(qw,Yw({typed:e,equalScalar:i}),h({elop:i,SS:a,DS:s,Ss:o}))})),Yw=Hb(qw,["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return e(qw,{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:r(t,e)}})}));var Zw=Hb("min",["typed","config","numeric","smaller"],(t=>{var{typed:e,config:r,numeric:i,smaller:n}=t;return e("min",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){return Bx(t,e.valueOf(),s)},"...":function(t){if(Px(t))throw new TypeError("Scalar values expected in function min");return a(t)}});function s(t,e){try{return n(t,e)?t:e}catch(t){throw Pw(t,"min",e)}}function a(t){var e;if(Nx(t,(function(t){try{isNaN(t)&&"number"==typeof t?e=NaN:(void 0===e||n(t,e))&&(e=t)}catch(e){throw Pw(e,"min",t)}})),void 0===e)throw new Error("Cannot calculate min of an empty array");return"string"==typeof e&&(e=i(e,r.number)),e}}));function $w(t,e,r,i){if(!(this instanceof $w))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=i,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(null!=i?"-"+i:"")+" expected)",this.stack=(new Error).stack}$w.prototype=new Error,$w.prototype.constructor=Error,$w.prototype.name="ArgumentsError",$w.prototype.isArgumentsError=!0;var Kw="Number of decimals in function round must be an integer",Jw="round",Qw=Hb(Jw,["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(t=>{var{typed:e,matrix:r,equalScalar:i,zeros:n,BigNumber:s,DenseMatrix:a}=t,o=ww({typed:e,equalScalar:i}),h=Ew({typed:e,DenseMatrix:a}),u=Sw({typed:e});return e(Jw,{number:by,"number, number":by,"number, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(Kw);return new s(t).toDecimalPlaces(e.toNumber())},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw new TypeError(Kw);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(Kw);var r=e.toNumber();return t.round(r)},BigNumber:function(t){return t.toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(Kw);return t.toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw new TypeError(Kw);return t.round(e)},"Fraction, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(Kw);return t.round(e.toNumber())},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0))),"SparseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>o(e,r,t,!1))),"DenseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>u(e,r,t,!1))),"Array, number | BigNumber":e.referToSelf((t=>(e,i)=>u(r(e),i,t,!1).valueOf())),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf((t=>(e,r)=>i(e,0)?n(r.size(),r.storage()):h(r,e,t,!0))),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf((t=>(e,r)=>i(e,0)?n(r.size(),r.storage()):u(r,e,t,!0))),"number | Complex | BigNumber | Fraction, Array":e.referToSelf((t=>(e,i)=>u(r(i),e,t,!0).valueOf()))})})),tE="unequal";Hb(tE,["typed","equalScalar"],(t=>{var{typed:e,equalScalar:r}=t;return e(tE,{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:!r(t,e)}})}));var eE=Hb("dot",["typed","addScalar","multiplyScalar","conj","size"],(t=>{var{typed:e,addScalar:r,multiplyScalar:i,conj:n,size:s}=t;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(t,s){var h=a(t,s),u=f_(t)?t._data:t,l=f_(t)?t._datatype:void 0,c=f_(s)?s._data:s,f=f_(s)?s._datatype:void 0,d=2===o(t).length,p=2===o(s).length,m=r,g=i;if(l&&f&&l===f&&"string"==typeof l){var v=l;m=e.find(r,[v,v]),g=e.find(i,[v,v])}if(!d&&!p){for(var _=g(n(u[0]),c[0]),b=1;b<h;b++)_=m(_,g(n(u[b]),c[b]));return _}if(!d&&p){for(var y=g(n(u[0]),c[0][0]),x=1;x<h;x++)y=m(y,g(n(u[x]),c[x][0]));return y}if(d&&!p){for(var w=g(n(u[0][0]),c[0]),E=1;E<h;E++)w=m(w,g(n(u[E][0]),c[E]));return w}if(d&&p){for(var M=g(n(u[0][0]),c[0][0]),S=1;S<h;S++)M=m(M,g(n(u[S][0]),c[S][0]));return M}},"SparseMatrix, SparseMatrix":function(t,e){a(t,e);var n=t._index,s=t._values,o=e._index,h=e._values,u=0,l=r,c=i,f=0,d=0;for(;f<n.length&&d<o.length;){var p=n[f],m=o[d];p<m?f++:p>m?d++:p===m&&(u=l(u,c(s[f],h[d])),f++,d++)}return u}});function a(t,e){var r,i,n=o(t),s=o(e);if(1===n.length)r=n[0];else{if(2!==n.length||1!==n[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+n.join(", ")+")");r=n[0]}if(1===s.length)i=s[0];else{if(2!==s.length||1!==s[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+s.join(", ")+")");i=s[0]}if(r!==i)throw new RangeError("Vectors must have equal length ("+r+" != "+i+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function o(t){return f_(t)?t.size():s(t)}})),rE="floor",iE=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],nE=Hb(rE,["typed","config","round"],(t=>{var{typed:e,config:r,round:i}=t;return e(rE,{number:function(t){return mb(t,i(t),r.epsilon)?i(t):Math.floor(t)},"number, number":function(t,e){if(mb(t,i(t,e),r.epsilon))return i(t,e);var[n,s]="".concat(t,"e").split("e"),a=Math.floor(Number("".concat(n,"e").concat(Number(s)+e)));return[n,s]="".concat(a,"e").split("e"),Number("".concat(n,"e").concat(Number(s)-e))}})})),sE=Hb(rE,iE,(t=>{var{typed:e,config:i,round:n,matrix:s,equalScalar:a,zeros:o,DenseMatrix:h}=t,u=ww({typed:e,equalScalar:a}),l=Ew({typed:e,DenseMatrix:h}),c=Sw({typed:e}),f=nE({typed:e,config:i,round:n});return e("floor",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.floor()},"Complex, number":function(t,e){return t.floor(e)},"Complex, BigNumber":function(t,e){return t.floor(e.toNumber())},BigNumber:function(t){return Wx(t,n(t),i.epsilon)?n(t):t.floor()},"BigNumber, BigNumber":function(t,e){return Wx(t,n(t,e),i.epsilon)?n(t,e):t.toDecimalPlaces(e.toNumber(),r(tb).ROUND_FLOOR)},Fraction:function(t){return t.floor()},"Fraction, number":function(t,e){return t.floor(e)},"Fraction, BigNumber":function(t,e){return t.floor(e.toNumber())},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0))),"Array, number | BigNumber":e.referToSelf((t=>(e,r)=>kx(e,(e=>t(e,r)),!0))),"SparseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>u(e,r,t,!1))),"DenseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>c(e,r,t,!1))),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((t=>(e,r)=>c(s(r),e,t,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((t=>(e,r)=>a(e,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):l(r,e,t,!0)))})})),aE="identity",oE=Hb(aE,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(t=>{var{typed:e,config:r,matrix:i,BigNumber:n,DenseMatrix:s,SparseMatrix:a}=t;return e(aE,{"":function(){return"Matrix"===r.matrix?i([]):[]},string:function(t){return i(t)},"number | BigNumber":function(t){return h(t,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(t,e){return h(t,t,e)},"number | BigNumber, number | BigNumber":function(t,e){return h(t,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,r){return h(t,e,r)},Array:function(t){return o(t)},"Array, string":function(t,e){return o(t,e)},Matrix:function(t){return o(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return o(t.valueOf(),e)}});function o(t,e){switch(t.length){case 0:return e?i(e):[];case 1:return h(t[0],t[0],e);case 2:return h(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function h(t,e,r){var i=a_(t)||a_(e)?n:null;if(a_(t)&&(t=t.toNumber()),a_(e)&&(e=e.toNumber()),!eb(t)||t<1)throw new Error("Parameters in function identity must be positive integers");if(!eb(e)||e<1)throw new Error("Parameters in function identity must be positive integers");var o=i?new n(1):1,h=i?new i(0):0,u=[t,e];if(r){if("sparse"===r)return a.diagonal(u,o,0,h);if("dense"===r)return s.diagonal(u,o,0,h);throw new TypeError('Unknown matrix type "'.concat(r,'"'))}for(var l=Nb([],u,h),c=t<e?t:e,f=0;f<c;f++)l[f][f]=o;return l}})),hE="larger",uE=Hb(hE,["typed","config","matrix","DenseMatrix"],(t=>{var{typed:e,config:r,matrix:i,DenseMatrix:n}=t,s=yw({typed:e}),a=Bw({typed:e,DenseMatrix:n}),o=Ew({typed:e,DenseMatrix:n}),h=Aw({typed:e,matrix:i}),u=Xx({typed:e});return e(hE,lE({typed:e,config:r}),{"boolean, boolean":(t,e)=>t>e,"BigNumber, BigNumber":function(t,e){return t.gt(e)&&!Wx(t,e,r.epsilon)},"Fraction, Fraction":(t,e)=>1===t.compare(e),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},u,h({SS:a,DS:s,Ss:o}))})),lE=Hb(hE,["typed","config"],(t=>{var{typed:e,config:r}=t;return e(hE,{"number, number":function(t,e){return t>e&&!mb(t,e,r.epsilon)}})})),cE=Hb("log",["config","typed","divideScalar","Complex"],(t=>{var{typed:e,config:r,divideScalar:i,Complex:n}=t;return e("log",{number:function(t){return t>=0||r.predictable?cy(t):new n(t,0).log()},Complex:function(t){return t.log()},BigNumber:function(t){return!t.isNegative()||r.predictable?t.ln():new n(t.toNumber(),0).log()},"any, any":e.referToSelf((t=>(e,r)=>i(t(e),t(r))))})})),fE="multiply",dE=Hb(fE,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(t=>{var{typed:e,matrix:r,addScalar:i,multiplyScalar:n,equalScalar:s,dot:a}=t,o=ww({typed:e,equalScalar:s}),h=Sw({typed:e});function u(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}}function l(t,r){if("dense"!==r.storage())throw new Error("Support for SparseMatrix not implemented");return function(t,r){var s,a=t._data,o=t._size,h=t._datatype,u=r._data,l=r._size,c=r._datatype,f=o[0],d=l[1],p=i,m=n;h&&c&&h===c&&"string"==typeof h&&(s=h,p=e.find(i,[s,s]),m=e.find(n,[s,s]));for(var g=[],v=0;v<d;v++){for(var _=m(a[0],u[0][v]),b=1;b<f;b++)_=p(_,m(a[b],u[b][v]));g[v]=_}return t.createDenseMatrix({data:g,size:[d],datatype:s})}(t,r)}var c=e("_multiplyMatrixVector",{"DenseMatrix, any":function(t,r){var s,a=t._data,o=t._size,h=t._datatype,u=r._data,l=r._datatype,c=o[0],f=o[1],d=i,p=n;h&&l&&h===l&&"string"==typeof h&&(s=h,d=e.find(i,[s,s]),p=e.find(n,[s,s]));for(var m=[],g=0;g<c;g++){for(var v=a[g],_=p(v[0],u[0]),b=1;b<f;b++)_=d(_,p(v[b],u[b]));m[g]=_}return t.createDenseMatrix({data:m,size:[c],datatype:s})},"SparseMatrix, any":function(t,r){var a=t._values,o=t._index,h=t._ptr,u=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,c=r._data,f=r._datatype,d=t._size[0],p=r._size[0],m=[],g=[],v=[],_=i,b=n,y=s,x=0;u&&f&&u===f&&"string"==typeof u&&(l=u,_=e.find(i,[l,l]),b=e.find(n,[l,l]),y=e.find(s,[l,l]),x=e.convert(0,l));var w=[],E=[];v[0]=0;for(var M=0;M<p;M++){var S=c[M];if(!y(S,x))for(var A=h[M],T=h[M+1],C=A;C<T;C++){var D=o[C];E[D]?w[D]=_(w[D],b(S,a[C])):(E[D]=!0,g.push(D),w[D]=b(S,a[C]))}}for(var R=g.length,I=0;I<R;I++){var P=g[I];m[I]=w[P]}return v[1]=g.length,t.createSparseMatrix({values:m,index:g,ptr:v,size:[d,1],datatype:l})}}),f=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(t,r){var s,a=t._data,o=t._size,h=t._datatype,u=r._data,l=r._size,c=r._datatype,f=o[0],d=o[1],p=l[1],m=i,g=n;h&&c&&h===c&&"string"==typeof h&&(s=h,m=e.find(i,[s,s]),g=e.find(n,[s,s]));for(var v=[],_=0;_<f;_++){var b=a[_];v[_]=[];for(var y=0;y<p;y++){for(var x=g(b[0],u[0][y]),w=1;w<d;w++)x=m(x,g(b[w],u[w][y]));v[_][y]=x}}return t.createDenseMatrix({data:v,size:[f,p],datatype:s})},"DenseMatrix, SparseMatrix":function(t,r){var a=t._data,o=t._size,h=t._datatype,u=r._values,l=r._index,c=r._ptr,f=r._size,d=r._datatype;if(!u)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,m=o[0],g=f[1],v=i,_=n,b=s,y=0;h&&d&&h===d&&"string"==typeof h&&(p=h,v=e.find(i,[p,p]),_=e.find(n,[p,p]),b=e.find(s,[p,p]),y=e.convert(0,p));for(var x=[],w=[],E=[],M=r.createSparseMatrix({values:x,index:w,ptr:E,size:[m,g],datatype:p}),S=0;S<g;S++){E[S]=w.length;var A=c[S],T=c[S+1];if(T>A)for(var C=0,D=0;D<m;D++){for(var R=D+1,I=void 0,P=A;P<T;P++){var N=l[P];C!==R?(I=_(a[D][N],u[P]),C=R):I=v(I,_(a[D][N],u[P]))}C!==R||b(I,y)||(w.push(D),x.push(I))}}return E[g]=w.length,M},"SparseMatrix, DenseMatrix":function(t,r){var a=t._values,o=t._index,h=t._ptr,u=t._datatype;if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,c=r._data,f=r._datatype,d=t._size[0],p=r._size[0],m=r._size[1],g=i,v=n,_=s,b=0;u&&f&&u===f&&"string"==typeof u&&(l=u,g=e.find(i,[l,l]),v=e.find(n,[l,l]),_=e.find(s,[l,l]),b=e.convert(0,l));for(var y=[],x=[],w=[],E=t.createSparseMatrix({values:y,index:x,ptr:w,size:[d,m],datatype:l}),M=[],S=[],A=0;A<m;A++){w[A]=x.length;for(var T=A+1,C=0;C<p;C++){var D=c[C][A];if(!_(D,b))for(var R=h[C],I=h[C+1],P=R;P<I;P++){var N=o[P];S[N]!==T?(S[N]=T,x.push(N),M[N]=v(D,a[P])):M[N]=g(M[N],v(D,a[P]))}}for(var k=w[A],B=x.length,L=k;L<B;L++){var O=x[L];y[L]=M[O]}}return w[m]=x.length,E},"SparseMatrix, SparseMatrix":function(t,r){var s,a=t._values,o=t._index,h=t._ptr,u=t._datatype,l=r._values,c=r._index,f=r._ptr,d=r._datatype,p=t._size[0],m=r._size[1],g=a&&l,v=i,_=n;u&&d&&u===d&&"string"==typeof u&&(s=u,v=e.find(i,[s,s]),_=e.find(n,[s,s]));for(var b,y,x,w,E,M,S,A,T=g?[]:void 0,C=[],D=[],R=t.createSparseMatrix({values:T,index:C,ptr:D,size:[p,m],datatype:s}),I=g?[]:void 0,P=[],N=0;N<m;N++){D[N]=C.length;var k=N+1;for(E=f[N],M=f[N+1],w=E;w<M;w++)if(A=c[w],g)for(y=h[A],x=h[A+1],b=y;b<x;b++)P[S=o[b]]!==k?(P[S]=k,C.push(S),I[S]=_(l[w],a[b])):I[S]=v(I[S],_(l[w],a[b]));else for(y=h[A],x=h[A+1],b=y;b<x;b++)P[S=o[b]]!==k&&(P[S]=k,C.push(S));if(g)for(var B=D[N],L=C.length,O=B;O<L;O++){var F=C[O];T[O]=I[F]}}return D[m]=C.length,R}});return e(fE,n,{"Array, Array":e.referTo("Matrix, Matrix",(t=>(e,i)=>{u(Db(e),Db(i));var n=t(r(e),r(i));return f_(n)?n.valueOf():n})),"Matrix, Matrix":function(t,e){var r=t.size(),i=e.size();return u(r,i),1===r.length?1===i.length?function(t,e,r){if(0===r)throw new Error("Cannot multiply two empty vectors");return a(t,e)}(t,e,r[0]):l(t,e):1===i.length?c(t,e):f(t,e)},"Matrix, Array":e.referTo("Matrix,Matrix",(t=>(e,i)=>t(e,r(i)))),"Array, Matrix":e.referToSelf((t=>(e,i)=>t(r(e,i.storage()),i))),"SparseMatrix, any":function(t,e){return o(t,e,n,!1)},"DenseMatrix, any":function(t,e){return h(t,e,n,!1)},"any, SparseMatrix":function(t,e){return o(e,t,n,!0)},"any, DenseMatrix":function(t,e){return h(e,t,n,!0)},"Array, any":function(t,e){return h(r(t),e,n,!1).valueOf()},"any, Array":function(t,e){return h(r(e),t,n,!0).valueOf()},"any, any":n,"any, any, ...any":e.referToSelf((t=>(e,r,i)=>{for(var n=t(e,r),s=0;s<i.length;s++)n=t(n,i[s]);return n}))})}));var pE="ceil",mE=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],gE=Hb(pE,["typed","config","round"],(t=>{var{typed:e,config:r,round:i}=t;return e(pE,{number:function(t){return mb(t,i(t),r.epsilon)?i(t):Math.ceil(t)},"number, number":function(t,e){if(mb(t,i(t,e),r.epsilon))return i(t,e);var[n,s]="".concat(t,"e").split("e"),a=Math.ceil(Number("".concat(n,"e").concat(Number(s)+e)));return[n,s]="".concat(a,"e").split("e"),Number("".concat(n,"e").concat(Number(s)-e))}})})),vE=Hb(pE,mE,(t=>{var{typed:e,config:i,round:n,matrix:s,equalScalar:a,zeros:o,DenseMatrix:h}=t,u=ww({typed:e,equalScalar:a}),l=Ew({typed:e,DenseMatrix:h}),c=Sw({typed:e}),f=gE({typed:e,config:i,round:n});return e("ceil",{number:f.signatures.number,"number,number":f.signatures["number,number"],Complex:function(t){return t.ceil()},"Complex, number":function(t,e){return t.ceil(e)},"Complex, BigNumber":function(t,e){return t.ceil(e.toNumber())},BigNumber:function(t){return Wx(t,n(t),i.epsilon)?n(t):t.ceil()},"BigNumber, BigNumber":function(t,e){return Wx(t,n(t,e),i.epsilon)?n(t,e):t.toDecimalPlaces(e.toNumber(),r(tb).ROUND_CEIL)},Fraction:function(t){return t.ceil()},"Fraction, number":function(t,e){return t.ceil(e)},"Fraction, BigNumber":function(t,e){return t.ceil(e.toNumber())},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0))),"Array, number | BigNumber":e.referToSelf((t=>(e,r)=>kx(e,(e=>t(e,r)),!0))),"SparseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>u(e,r,t,!1))),"DenseMatrix, number | BigNumber":e.referToSelf((t=>(e,r)=>c(e,r,t,!1))),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((t=>(e,r)=>c(s(r),e,t,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((t=>(e,r)=>a(e,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,e,t,!0):l(r,e,t,!0)))})})),_E=Hb("det",["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],(t=>{var{typed:e,matrix:r,subtract:i,multiply:n,divideScalar:s,isZero:a,unaryMinus:o}=t;return e("det",{any:function(t){return W_(t)},"Array | Matrix":function(t){var e;switch((e=f_(t)?t.size():Array.isArray(t)?(t=r(t)).size():[]).length){case 0:return W_(t);case 1:if(1===e[0])return W_(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+Mb(e)+")");case 2:var h=e[0],u=e[1];if(h===u)return function(t,e,r){if(1===e)return W_(t[0][0]);if(2===e)return i(n(t[0][0],t[1][1]),n(t[1][0],t[0][1]));for(var h=!1,u=new Array(e).fill(0).map(((t,e)=>e)),l=0;l<e;l++){var c=u[l];if(a(t[c][l])){var f=void 0;for(f=l+1;f<e;f++)if(!a(t[u[f]][l])){c=u[f],u[f]=u[l],u[l]=c,h=!h;break}if(f===e)return t[c][l]}for(var d=t[c][l],p=0===l?1:t[u[l-1]][l-1],m=l+1;m<e;m++)for(var g=u[m],v=l+1;v<e;v++)t[g][v]=s(i(n(t[g][v],d),n(t[g][l],t[c][v])),p)}var _=t[u[e-1]][e-1];return h?o(_):_}(t.clone().valueOf(),h);throw new RangeError("Matrix must be square (size: "+Mb(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Mb(e)+")")}}})})),bE="fix",yE=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],xE=Hb(bE,["typed","ceil","floor"],(t=>{var{typed:e,ceil:r,floor:i}=t;return e(bE,{number:function(t){return t>0?i(t):r(t)},"number, number":function(t,e){return t>0?i(t,e):r(t,e)}})})),wE=Hb(bE,yE,(t=>{var{typed:e,Complex:r,matrix:i,ceil:n,floor:s,equalScalar:a,zeros:o,DenseMatrix:h}=t,u=Ew({typed:e,DenseMatrix:h}),l=Sw({typed:e}),c=xE({typed:e,ceil:n,floor:s});return e("fix",{number:c.signatures.number,"number, number | BigNumber":c.signatures["number,number"],Complex:function(t){return new r(t.re>0?Math.floor(t.re):Math.ceil(t.re),t.im>0?Math.floor(t.im):Math.ceil(t.im))},"Complex, number":function(t,e){return new r(t.re>0?s(t.re,e):n(t.re,e),t.im>0?s(t.im,e):n(t.im,e))},"Complex, BigNumber":function(t,e){var i=e.toNumber();return new r(t.re>0?s(t.re,i):n(t.re,i),t.im>0?s(t.im,i):n(t.im,i))},BigNumber:function(t){return t.isNegative()?n(t):s(t)},"BigNumber, number | BigNumber":function(t,e){return t.isNegative()?n(t,e):s(t,e)},Fraction:function(t){return t.s<0?t.ceil():t.floor()},"Fraction, number | BigNumber":function(t,e){return t.s<0?n(t,e):s(t,e)},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t,!0))),"Array | Matrix, number | BigNumber":e.referToSelf((t=>(e,r)=>kx(e,(e=>t(e,r)),!0))),"number | Complex | Fraction | BigNumber, Array":e.referToSelf((t=>(e,r)=>l(i(r),e,t,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf((t=>(e,r)=>a(e,0)?o(r.size(),r.storage()):"dense"===r.storage()?l(r,e,t,!0):u(r,e,t,!0)))})})),EE=Hb("max",["typed","config","numeric","larger"],(t=>{var{typed:e,config:r,numeric:i,larger:n}=t;return e("max",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){return Bx(t,e.valueOf(),s)},"...":function(t){if(Px(t))throw new TypeError("Scalar values expected in function max");return a(t)}});function s(t,e){try{return n(t,e)?t:e}catch(t){throw Pw(t,"max",e)}}function a(t){var e;if(Nx(t,(function(t){try{isNaN(t)&&"number"==typeof t?e=NaN:(void 0===e||n(t,e))&&(e=t)}catch(e){throw Pw(e,"max",t)}})),void 0===e)throw new Error("Cannot calculate max of an empty array");return"string"==typeof e&&(e=i(e,r.number)),e}})),ME=Hb("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(t=>{var{typed:e,matrix:r,divideScalar:i,addScalar:n,multiply:s,unaryMinus:a,det:o,identity:h,abs:u}=t;return e("inv",{"Array | Matrix":function(t){var e=f_(t)?t.size():Db(t);switch(e.length){case 1:if(1===e[0])return f_(t)?r([i(1,t.valueOf()[0])]):[i(1,t[0])];throw new RangeError("Matrix must be square (size: "+Mb(e)+")");case 2:var n=e[0],s=e[1];if(n===s)return f_(t)?r(l(t.valueOf(),n,s),t.storage()):l(t,n,s);throw new RangeError("Matrix must be square (size: "+Mb(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Mb(e)+")")}},any:function(t){return i(1,t)}});function l(t,e,r){var l,c,f,d,p;if(1===e){if(0===(d=t[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[i(1,d)]]}if(2===e){var m=o(t);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[i(t[1][1],m),i(a(t[0][1]),m)],[i(a(t[1][0]),m),i(t[0][0],m)]]}var g=t.concat();for(l=0;l<e;l++)g[l]=g[l].concat();for(var v=h(e).valueOf(),_=0;_<r;_++){var b=u(g[_][_]),y=_;for(l=_+1;l<e;)u(g[l][_])>b&&(b=u(g[l][_]),y=l),l++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");(l=y)!==_&&(p=g[_],g[_]=g[l],g[l]=p,p=v[_],v[_]=v[l],v[l]=p);var x=g[_],w=v[_];for(l=0;l<e;l++){var E=g[l],M=v[l];if(l!==_){if(0!==E[_]){for(f=i(a(E[_]),x[_]),c=_;c<r;c++)E[c]=n(E[c],s(f,x[c]));for(c=0;c<r;c++)M[c]=n(M[c],s(f,w[c]))}}else{for(f=x[_],c=_;c<r;c++)E[c]=i(E[c],f);for(c=0;c<r;c++)M[c]=i(M[c],f)}}}return v}})),SE=Hb("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(t=>{var{typed:e,config:r,identity:i,multiply:n,matrix:s,inv:a,number:o,fraction:h,Complex:u}=t;return e("pow",{"number, number":l,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(t,e){return e.isInteger()||t>=0||r.predictable?t.pow(e):new u(t.toNumber(),0).pow(e.toNumber(),0)},"Fraction, Fraction":function(t,e){var i=t.pow(e);if(null!=i)return i;if(r.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return l(t.valueOf(),e.valueOf())},"Array, number":c,"Array, BigNumber":function(t,e){return c(t,e.toNumber())},"Matrix, number":f,"Matrix, BigNumber":function(t,e){return f(t,e.toNumber())},"Unit, number | BigNumber":function(t,e){return t.pow(e)}});function l(t,e){if(r.predictable&&!eb(e)&&t<0)try{var i=h(e),n=o(i);if((e===n||Math.abs((e-n)/e)<1e-14)&&i.d%2==1)return(i.n%2==0?1:-1)*Math.pow(-t,e)}catch(t){}return r.predictable&&(t<-1&&e===1/0||t>-1&&t<0&&e===-1/0)?NaN:eb(e)||t>=0||r.predictable?_y(t,e):t*t<1&&e===1/0||t*t>1&&e===-1/0?0:new u(t,0).pow(e,0)}function c(t,e){if(!eb(e))throw new TypeError("For A^b, b must be an integer (value is "+e+")");var r=Db(t);if(2!==r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(e<0)try{return c(a(t),-e)}catch(t){if("Cannot calculate inverse, determinant is zero"===t.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw t}for(var s=i(r[0]).valueOf(),o=t;e>=1;)1==(1&e)&&(s=n(o,s)),e>>=1,o=n(o,o);return s}function f(t,e){return s(c(t.valueOf(),e))}})),AE={},TE={},CE={};function DE(t){return CE=DE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CE.__esModule=!0,CE.default=CE,DE(t)}(CE=DE).__esModule=!0,CE.default=CE;var RE=CE.default,IE={},PE=CE.default;function NE(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function kE(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?NE(Object(i),!0).forEach((function(e){r(AE)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):NE(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}(IE=function(t,e){if("object"!==PE(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==PE(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}).__esModule=!0,IE.default=IE,(TE=function(t){var e=IE(t,"string");return"symbol"===RE(e)?e:String(e)}).__esModule=!0,TE.default=TE,(AE=function(t,e,r){return(e=TE(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}).__esModule=!0,AE.default=AE;var BE=Hb("Unit",["?on","config","addScalar","subtract","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(t=>{var e,i,n,{on:s,config:a,addScalar:o,subtract:h,multiplyScalar:u,divideScalar:l,pow:c,abs:f,fix:d,round:p,equal:m,isNumeric:g,format:v,number:_,Complex:b,BigNumber:y,Fraction:x}=t,w=_;function E(t,e){if(!(this instanceof E))throw new Error("Constructor must be called with the new operator");if(null!=t&&!g(t)&&!o_(t))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===e)this.units=[],this.dimensions=k.map((t=>0));else if("string"==typeof e){var i=E.parse(e);this.units=i.units,this.dimensions=i.dimensions}else{if(!u_(e)||null!==e.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=e.fixPrefix,this.skipAutomaticSimplification=e.skipAutomaticSimplification,this.dimensions=e.dimensions.slice(0),this.units=e.units.map((t=>r(r_)({},t)))}this.value=this._normalize(t)}function M(){for(;" "===n||"\t"===n;)A()}function S(t){return t>="0"&&t<="9"}function A(){i++,n=e.charAt(i)}function T(t){i=t,n=e.charAt(i)}function C(){var t="",e=i;if("+"===n?A():"-"===n&&(t+=n,A()),!function(t){return t>="0"&&t<="9"||"."===t}(n))return T(e),null;if("."===n){if(t+=n,A(),!S(n))return T(e),null}else{for(;S(n);)t+=n,A();"."===n&&(t+=n,A())}for(;S(n);)t+=n,A();if("E"===n||"e"===n){var r="",s=i;if(r+=n,A(),"+"!==n&&"-"!==n||(r+=n,A()),!S(n))return T(s),t;for(t+=r;S(n);)t+=n,A()}return t}function D(){for(var t="";S(n)||E.isValidAlpha(n);)t+=n,A();var e=t.charAt(0);return E.isValidAlpha(e)?t:null}function R(t){return n===t?(A(),t):null}Object.defineProperty(E,"name",{value:"Unit"}),E.prototype.constructor=E,E.prototype.type="Unit",E.prototype.isUnit=!0,E.parse=function(t,r){if(r=r||{},i=-1,n="","string"!=typeof(e=t))throw new TypeError("Invalid argument in Unit.parse, string expected");var s=new E;s.units=[];var o=1,h=!1;A(),M();var u=C(),l=null;if(u){if("BigNumber"===a.number)l=new y(u);else if("Fraction"===a.number)try{l=new x(u)}catch(t){l=parseFloat(u)}else l=parseFloat(u);M(),R("*")?(o=1,h=!0):R("/")&&(o=-1,h=!0)}for(var c=[],f=1;;){for(M();"("===n;)c.push(o),f*=o,o=1,A(),M();var d=void 0;if(!n)break;var p=n;if(null===(d=D()))throw new SyntaxError('Unexpected "'+p+'" in "'+e+'" at index '+i.toString());var m=I(d);if(null===m)throw new SyntaxError('Unit "'+d+'" not found.');var g=o*f;if(M(),R("^")){M();var v=C();if(null===v)throw new SyntaxError('In "'+t+'", "^" must be followed by a floating-point number');g*=v}s.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var _=0;_<k.length;_++)s.dimensions[_]+=(m.unit.dimensions[_]||0)*g;for(M();")"===n;){if(0===c.length)throw new SyntaxError('Unmatched ")" in "'+e+'" at index '+i.toString());f/=c.pop(),A(),M()}if(h=!1,R("*")?(o=1,h=!0):R("/")?(o=-1,h=!0):o=1,m.unit.base){var b=m.unit.base.key;G.auto[b]={unit:m.unit,prefix:m.prefix}}}if(M(),n)throw new SyntaxError('Could not parse: "'+t+'"');if(h)throw new SyntaxError('Trailing characters: "'+t+'"');if(0!==c.length)throw new SyntaxError('Unmatched "(" in "'+e+'"');if(0===s.units.length&&!r.allowNoUnits)throw new SyntaxError('"'+t+'" contains no units');return s.value=void 0!==l?s._normalize(l):null,s},E.prototype.clone=function(){var t=new E;t.fixPrefix=this.fixPrefix,t.skipAutomaticSimplification=this.skipAutomaticSimplification,t.value=W_(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++)for(var r in t.units[e]={},this.units[e])Z_(this.units[e],r)&&(t.units[e][r]=this.units[e][r]);return t},E.prototype.valueType=function(){return V_(this.value)},E.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},E.prototype._normalize=function(t){if(null==t||0===this.units.length)return t;for(var e=t,r=E._getNumberConverter(V_(t)),i=0;i<this.units.length;i++){var n=r(this.units[i].unit.value),s=r(this.units[i].prefix.value),a=r(this.units[i].power);e=u(e,c(u(n,s),a))}return e},E.prototype._denormalize=function(t,e){if(null==t||0===this.units.length)return t;for(var r=t,i=E._getNumberConverter(V_(t)),n=0;n<this.units.length;n++){var s=i(this.units[n].unit.value),a=i(this.units[n].prefix.value),o=i(this.units[n].power);r=l(r,c(u(s,a),o))}return r};var I=Yb((t=>{if(Z_(F,t)){var e=F[t];return{unit:e,prefix:e.prefixes[""]}}for(var r in F)if(Z_(F,r)&&Eb(t,r)){var i=F[r],n=t.length-r.length,s=t.substring(0,n),a=Z_(i.prefixes,s)?i.prefixes[s]:void 0;if(void 0!==a)return{unit:i,prefix:a}}return null}),{hasher:t=>t[0],limit:100});function P(t){return t.equalBase(B.NONE)&&null!==t.value&&!a.predictable?t.value:t}E.isValuelessUnit=function(t){return null!==I(t)},E.prototype.hasBase=function(t){if("string"==typeof t&&(t=B[t]),!t)return!1;for(var e=0;e<k.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},E.prototype.equalBase=function(t){for(var e=0;e<k.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},E.prototype.equals=function(t){return this.equalBase(t)&&m(this.value,t.value)},E.prototype.multiply=function(t){for(var e=this.clone(),r=u_(t)?t:new E(t),i=0;i<k.length;i++)e.dimensions[i]=(this.dimensions[i]||0)+(r.dimensions[i]||0);for(var n=0;n<r.units.length;n++){var s=kE({},r.units[n]);e.units.push(s)}if(null!==this.value||null!==r.value){var a=null===this.value?this._normalize(1):this.value,o=null===r.value?r._normalize(1):r.value;e.value=u(a,o)}else e.value=null;return u_(t)&&(e.skipAutomaticSimplification=!1),P(e)},E.prototype.divideInto=function(t){return new E(t).divide(this)},E.prototype.divide=function(t){for(var e=this.clone(),r=u_(t)?t:new E(t),i=0;i<k.length;i++)e.dimensions[i]=(this.dimensions[i]||0)-(r.dimensions[i]||0);for(var n=0;n<r.units.length;n++){var s=kE(kE({},r.units[n]),{},{power:-r.units[n].power});e.units.push(s)}if(null!==this.value||null!==r.value){var a=null===this.value?this._normalize(1):this.value,o=null===r.value?r._normalize(1):r.value;e.value=l(a,o)}else e.value=null;return u_(t)&&(e.skipAutomaticSimplification=!1),P(e)},E.prototype.pow=function(t){for(var e=this.clone(),r=0;r<k.length;r++)e.dimensions[r]=(this.dimensions[r]||0)*t;for(var i=0;i<e.units.length;i++)e.units[i].power*=t;return null!==e.value?e.value=c(e.value,t):e.value=null,e.skipAutomaticSimplification=!1,P(e)},E.prototype.abs=function(){var t=this.clone();if(null!==t.value)if(t._isDerived()||0===t.units[0].unit.offset)t.value=f(t.value);else{var e=t._numberConverter(),r=e(t.units[0].unit.value),i=e(t.units[0].unit.offset),n=u(r,i);t.value=h(f(o(t.value,n)),n)}for(var s in t.units)"VA"!==t.units[s].unit.name&&"VAR"!==t.units[s].unit.name||(t.units[s].unit=F.W);return t},E.prototype.to=function(t){var e,r=null===this.value?this._normalize(1):this.value;if("string"==typeof t)e=E.parse(t);else{if(!u_(t))throw new Error("String or Unit expected as parameter");e=t.clone()}if(!this.equalBase(e))throw new Error("Units do not match ('".concat(e.toString(),"' != '").concat(this.toString(),"')"));if(null!==e.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||this.units[0].unit.offset===e.units[0].unit.offset)e.value=W_(r);else{var i=E._getNumberConverter(V_(r)),n=i(this.units[0].unit.value),s=i(this.units[0].unit.offset),a=u(n,s),l=i(e.units[0].unit.value),c=i(e.units[0].unit.offset),f=u(l,c);e.value=h(o(r,a),f)}return e.fixPrefix=!0,e.skipAutomaticSimplification=!0,e},E.prototype.toNumber=function(t){return w(this.toNumeric(t))},E.prototype.toNumeric=function(t){var e;return(e=t?this.to(t):this.clone())._isDerived()||0===e.units.length?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},E.prototype.toString=function(){return this.format()},E.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},E.fromJSON=function(t){var e=new E(t.value,t.unit);return e.fixPrefix=t.fixPrefix||!1,e},E.prototype.valueOf=E.prototype.toString,E.prototype.simplify=function(){var t,e,r=this.clone(),i=[];for(var n in H)if(Z_(H,n)&&r.hasBase(B[n])){t=n;break}if("NONE"===t)r.units=[];else if(t&&Z_(H,t)&&(e=H[t]),e)r.units=[{unit:e.unit,prefix:e.prefix,power:1}];else{for(var s=!1,a=0;a<k.length;a++){var o=k[a];Math.abs(r.dimensions[a]||0)>1e-12&&(Z_(H,o)?i.push({unit:H[o].unit,prefix:H[o].prefix,power:r.dimensions[a]||0}):s=!0)}i.length<r.units.length&&!s&&(r.units=i)}return r},E.prototype.toSI=function(){for(var t=this.clone(),e=[],r=0;r<k.length;r++){var i=k[r];if(Math.abs(t.dimensions[r]||0)>1e-12){if(!Z_(G.si,i))throw new Error("Cannot express custom unit "+i+" in SI units");e.push({unit:G.si[i].unit,prefix:G.si[i].prefix,power:t.dimensions[r]||0})}}return t.units=e,t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},E.prototype.formatUnits=function(){for(var t="",e="",r=0,i=0,n=0;n<this.units.length;n++)this.units[n].power>0?(r++,t+=" "+this.units[n].prefix.name+this.units[n].unit.name,Math.abs(this.units[n].power-1)>1e-15&&(t+="^"+this.units[n].power)):this.units[n].power<0&&i++;if(i>0)for(var s=0;s<this.units.length;s++)this.units[s].power<0&&(r>0?(e+=" "+this.units[s].prefix.name+this.units[s].unit.name,Math.abs(this.units[s].power+1)>1e-15&&(e+="^"+-this.units[s].power)):(e+=" "+this.units[s].prefix.name+this.units[s].unit.name,e+="^"+this.units[s].power));t=t.substr(1),e=e.substr(1),r>1&&i>0&&(t="("+t+")"),i>1&&r>0&&(e="("+e+")");var a=t;return r>0&&i>0&&(a+=" / "),a+=e},E.prototype.format=function(t){var e=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),r=!1;for(var i in void 0!==e.value&&null!==e.value&&o_(e.value)&&(r=Math.abs(e.value.re)<1e-14),e.units)Z_(e.units,i)&&e.units[i].unit&&("VA"===e.units[i].unit.name&&r?e.units[i].unit=F.VAR:"VAR"!==e.units[i].unit.name||r||(e.units[i].unit=F.VA));1!==e.units.length||e.fixPrefix||Math.abs(e.units[0].power-Math.round(e.units[0].power))<1e-14&&(e.units[0].prefix=e._bestPrefix());var n=e._denormalize(e.value),s=null!==e.value?v(n,t||{}):"",a=e.formatUnits();return e.value&&o_(e.value)&&(s="("+s+")"),a.length>0&&s.length>0&&(s+=" "),s+=a},E.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=null!==this.value?f(this.value):0,e=f(this.units[0].unit.value),r=this.units[0].prefix;if(0===t)return r;var i=this.units[0].power,n=Math.log(t/Math.pow(r.value*e,i))/Math.LN10-1.2;if(n>-2.200001&&n<1.800001)return r;n=Math.abs(n);var s=this.units[0].unit.prefixes;for(var a in s)if(Z_(s,a)){var o=s[a];if(o.scientific){var h=Math.abs(Math.log(t/Math.pow(o.value*e,i))/Math.LN10-1.2);(h<n||h===n&&o.name.length<r.name.length)&&(r=o,n=h)}}return r},E.prototype.splitUnit=function(t){for(var e=this.clone(),r=[],i=0;i<t.length&&(e=e.to(t[i]),i!==t.length-1);i++){var n=e.toNumeric(),s=p(n),a=new E(m(s,n)?s:d(e.toNumeric()),t[i].toString());r.push(a),e=h(e,a)}for(var u=0,l=0;l<r.length;l++)u=o(u,r[l].value);return m(u,this.value)&&(e.value=0),r.push(e),r};var N={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};N.SHORTLONG=r(r_)({},N.SHORT,N.LONG),N.BINARY_SHORT=r(r_)({},N.BINARY_SHORT_SI,N.BINARY_SHORT_IEC),N.BINARY_LONG=r(r_)({},N.BINARY_LONG_SI,N.BINARY_LONG_IEC);var k=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],B={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var L in B)Z_(B,L)&&(B[L].key=L);var O={name:"",base:{},value:1,offset:0,dimensions:k.map((t=>0))},F={meter:{name:"meter",base:B.LENGTH,prefixes:N.LONG,value:1,offset:0},inch:{name:"inch",base:B.LENGTH,prefixes:N.NONE,value:.0254,offset:0},foot:{name:"foot",base:B.LENGTH,prefixes:N.NONE,value:.3048,offset:0},yard:{name:"yard",base:B.LENGTH,prefixes:N.NONE,value:.9144,offset:0},mile:{name:"mile",base:B.LENGTH,prefixes:N.NONE,value:1609.344,offset:0},link:{name:"link",base:B.LENGTH,prefixes:N.NONE,value:.201168,offset:0},rod:{name:"rod",base:B.LENGTH,prefixes:N.NONE,value:5.0292,offset:0},chain:{name:"chain",base:B.LENGTH,prefixes:N.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:B.LENGTH,prefixes:N.NONE,value:1e-10,offset:0},m:{name:"m",base:B.LENGTH,prefixes:N.SHORT,value:1,offset:0},in:{name:"in",base:B.LENGTH,prefixes:N.NONE,value:.0254,offset:0},ft:{name:"ft",base:B.LENGTH,prefixes:N.NONE,value:.3048,offset:0},yd:{name:"yd",base:B.LENGTH,prefixes:N.NONE,value:.9144,offset:0},mi:{name:"mi",base:B.LENGTH,prefixes:N.NONE,value:1609.344,offset:0},li:{name:"li",base:B.LENGTH,prefixes:N.NONE,value:.201168,offset:0},rd:{name:"rd",base:B.LENGTH,prefixes:N.NONE,value:5.02921,offset:0},ch:{name:"ch",base:B.LENGTH,prefixes:N.NONE,value:20.1168,offset:0},mil:{name:"mil",base:B.LENGTH,prefixes:N.NONE,value:254e-7,offset:0},m2:{name:"m2",base:B.SURFACE,prefixes:N.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:B.SURFACE,prefixes:N.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:B.SURFACE,prefixes:N.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:B.SURFACE,prefixes:N.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:B.SURFACE,prefixes:N.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:B.SURFACE,prefixes:N.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:B.SURFACE,prefixes:N.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:B.SURFACE,prefixes:N.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:B.SURFACE,prefixes:N.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:B.SURFACE,prefixes:N.NONE,value:1e4,offset:0},m3:{name:"m3",base:B.VOLUME,prefixes:N.CUBIC,value:1,offset:0},L:{name:"L",base:B.VOLUME,prefixes:N.SHORT,value:.001,offset:0},l:{name:"l",base:B.VOLUME,prefixes:N.SHORT,value:.001,offset:0},litre:{name:"litre",base:B.VOLUME,prefixes:N.LONG,value:.001,offset:0},cuin:{name:"cuin",base:B.VOLUME,prefixes:N.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:B.VOLUME,prefixes:N.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:B.VOLUME,prefixes:N.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:B.VOLUME,prefixes:N.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:B.VOLUME,prefixes:N.NONE,value:15e-6,offset:0},drop:{name:"drop",base:B.VOLUME,prefixes:N.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:B.VOLUME,prefixes:N.NONE,value:5e-8,offset:0},minim:{name:"minim",base:B.VOLUME,prefixes:N.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:B.VOLUME,prefixes:N.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:B.VOLUME,prefixes:N.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:B.VOLUME,prefixes:N.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:B.VOLUME,prefixes:N.NONE,value:1e-6,offset:0},cup:{name:"cup",base:B.VOLUME,prefixes:N.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:B.VOLUME,prefixes:N.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:B.VOLUME,prefixes:N.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:B.VOLUME,prefixes:N.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:B.VOLUME,prefixes:N.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:B.VOLUME,prefixes:N.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:B.VOLUME,prefixes:N.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:B.VOLUME,prefixes:N.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:B.VOLUME,prefixes:N.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:B.VOLUME,prefixes:N.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:B.VOLUME,prefixes:N.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:B.VOLUME,prefixes:N.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:B.VOLUME,prefixes:N.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:B.VOLUME,prefixes:N.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:B.VOLUME,prefixes:N.NONE,value:.1173478,offset:0},obl:{name:"obl",base:B.VOLUME,prefixes:N.NONE,value:.1589873,offset:0},g:{name:"g",base:B.MASS,prefixes:N.SHORT,value:.001,offset:0},gram:{name:"gram",base:B.MASS,prefixes:N.LONG,value:.001,offset:0},ton:{name:"ton",base:B.MASS,prefixes:N.SHORT,value:907.18474,offset:0},t:{name:"t",base:B.MASS,prefixes:N.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:B.MASS,prefixes:N.LONG,value:1e3,offset:0},grain:{name:"grain",base:B.MASS,prefixes:N.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:B.MASS,prefixes:N.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:B.MASS,prefixes:N.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:B.MASS,prefixes:N.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:B.MASS,prefixes:N.NONE,value:45.359237,offset:0},stick:{name:"stick",base:B.MASS,prefixes:N.NONE,value:.115,offset:0},stone:{name:"stone",base:B.MASS,prefixes:N.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:B.MASS,prefixes:N.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:B.MASS,prefixes:N.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:B.MASS,prefixes:N.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:B.MASS,prefixes:N.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:B.MASS,prefixes:N.NONE,value:45.359237,offset:0},s:{name:"s",base:B.TIME,prefixes:N.SHORT,value:1,offset:0},min:{name:"min",base:B.TIME,prefixes:N.NONE,value:60,offset:0},h:{name:"h",base:B.TIME,prefixes:N.NONE,value:3600,offset:0},second:{name:"second",base:B.TIME,prefixes:N.LONG,value:1,offset:0},sec:{name:"sec",base:B.TIME,prefixes:N.LONG,value:1,offset:0},minute:{name:"minute",base:B.TIME,prefixes:N.NONE,value:60,offset:0},hour:{name:"hour",base:B.TIME,prefixes:N.NONE,value:3600,offset:0},day:{name:"day",base:B.TIME,prefixes:N.NONE,value:86400,offset:0},week:{name:"week",base:B.TIME,prefixes:N.NONE,value:604800,offset:0},month:{name:"month",base:B.TIME,prefixes:N.NONE,value:2629800,offset:0},year:{name:"year",base:B.TIME,prefixes:N.NONE,value:31557600,offset:0},decade:{name:"decade",base:B.TIME,prefixes:N.NONE,value:315576e3,offset:0},century:{name:"century",base:B.TIME,prefixes:N.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:B.TIME,prefixes:N.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:B.FREQUENCY,prefixes:N.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:B.FREQUENCY,prefixes:N.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:B.ANGLE,prefixes:N.SHORT,value:1,offset:0},radian:{name:"radian",base:B.ANGLE,prefixes:N.LONG,value:1,offset:0},deg:{name:"deg",base:B.ANGLE,prefixes:N.SHORT,value:null,offset:0},degree:{name:"degree",base:B.ANGLE,prefixes:N.LONG,value:null,offset:0},grad:{name:"grad",base:B.ANGLE,prefixes:N.SHORT,value:null,offset:0},gradian:{name:"gradian",base:B.ANGLE,prefixes:N.LONG,value:null,offset:0},cycle:{name:"cycle",base:B.ANGLE,prefixes:N.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:B.ANGLE,prefixes:N.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:B.ANGLE,prefixes:N.NONE,value:null,offset:0},A:{name:"A",base:B.CURRENT,prefixes:N.SHORT,value:1,offset:0},ampere:{name:"ampere",base:B.CURRENT,prefixes:N.LONG,value:1,offset:0},K:{name:"K",base:B.TEMPERATURE,prefixes:N.SHORT,value:1,offset:0},degC:{name:"degC",base:B.TEMPERATURE,prefixes:N.SHORT,value:1,offset:273.15},degF:{name:"degF",base:B.TEMPERATURE,prefixes:N.SHORT,value:1/1.8,offset:459.67},degR:{name:"degR",base:B.TEMPERATURE,prefixes:N.SHORT,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:B.TEMPERATURE,prefixes:N.LONG,value:1,offset:0},celsius:{name:"celsius",base:B.TEMPERATURE,prefixes:N.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:B.TEMPERATURE,prefixes:N.LONG,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:B.TEMPERATURE,prefixes:N.LONG,value:1/1.8,offset:0},mol:{name:"mol",base:B.AMOUNT_OF_SUBSTANCE,prefixes:N.SHORT,value:1,offset:0},mole:{name:"mole",base:B.AMOUNT_OF_SUBSTANCE,prefixes:N.LONG,value:1,offset:0},cd:{name:"cd",base:B.LUMINOUS_INTENSITY,prefixes:N.SHORT,value:1,offset:0},candela:{name:"candela",base:B.LUMINOUS_INTENSITY,prefixes:N.LONG,value:1,offset:0},N:{name:"N",base:B.FORCE,prefixes:N.SHORT,value:1,offset:0},newton:{name:"newton",base:B.FORCE,prefixes:N.LONG,value:1,offset:0},dyn:{name:"dyn",base:B.FORCE,prefixes:N.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:B.FORCE,prefixes:N.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:B.FORCE,prefixes:N.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:B.FORCE,prefixes:N.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:B.FORCE,prefixes:N.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:B.FORCE,prefixes:N.NONE,value:9.80665,offset:0},J:{name:"J",base:B.ENERGY,prefixes:N.SHORT,value:1,offset:0},joule:{name:"joule",base:B.ENERGY,prefixes:N.SHORT,value:1,offset:0},erg:{name:"erg",base:B.ENERGY,prefixes:N.NONE,value:1e-7,offset:0},Wh:{name:"Wh",base:B.ENERGY,prefixes:N.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:B.ENERGY,prefixes:N.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:B.ENERGY,prefixes:N.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:B.ENERGY,prefixes:N.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:B.POWER,prefixes:N.SHORT,value:1,offset:0},watt:{name:"watt",base:B.POWER,prefixes:N.LONG,value:1,offset:0},hp:{name:"hp",base:B.POWER,prefixes:N.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:B.POWER,prefixes:N.SHORT,value:b.I,offset:0},VA:{name:"VA",base:B.POWER,prefixes:N.SHORT,value:1,offset:0},Pa:{name:"Pa",base:B.PRESSURE,prefixes:N.SHORT,value:1,offset:0},psi:{name:"psi",base:B.PRESSURE,prefixes:N.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:B.PRESSURE,prefixes:N.NONE,value:101325,offset:0},bar:{name:"bar",base:B.PRESSURE,prefixes:N.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:B.PRESSURE,prefixes:N.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:B.PRESSURE,prefixes:N.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:B.PRESSURE,prefixes:N.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:B.PRESSURE,prefixes:N.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:B.ELECTRIC_CHARGE,prefixes:N.LONG,value:1,offset:0},C:{name:"C",base:B.ELECTRIC_CHARGE,prefixes:N.SHORT,value:1,offset:0},farad:{name:"farad",base:B.ELECTRIC_CAPACITANCE,prefixes:N.LONG,value:1,offset:0},F:{name:"F",base:B.ELECTRIC_CAPACITANCE,prefixes:N.SHORT,value:1,offset:0},volt:{name:"volt",base:B.ELECTRIC_POTENTIAL,prefixes:N.LONG,value:1,offset:0},V:{name:"V",base:B.ELECTRIC_POTENTIAL,prefixes:N.SHORT,value:1,offset:0},ohm:{name:"ohm",base:B.ELECTRIC_RESISTANCE,prefixes:N.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:B.ELECTRIC_INDUCTANCE,prefixes:N.LONG,value:1,offset:0},H:{name:"H",base:B.ELECTRIC_INDUCTANCE,prefixes:N.SHORT,value:1,offset:0},siemens:{name:"siemens",base:B.ELECTRIC_CONDUCTANCE,prefixes:N.LONG,value:1,offset:0},S:{name:"S",base:B.ELECTRIC_CONDUCTANCE,prefixes:N.SHORT,value:1,offset:0},weber:{name:"weber",base:B.MAGNETIC_FLUX,prefixes:N.LONG,value:1,offset:0},Wb:{name:"Wb",base:B.MAGNETIC_FLUX,prefixes:N.SHORT,value:1,offset:0},tesla:{name:"tesla",base:B.MAGNETIC_FLUX_DENSITY,prefixes:N.LONG,value:1,offset:0},T:{name:"T",base:B.MAGNETIC_FLUX_DENSITY,prefixes:N.SHORT,value:1,offset:0},b:{name:"b",base:B.BIT,prefixes:N.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:B.BIT,prefixes:N.BINARY_LONG,value:1,offset:0},B:{name:"B",base:B.BIT,prefixes:N.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:B.BIT,prefixes:N.BINARY_LONG,value:8,offset:0}},U={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function z(t){if("BigNumber"===t.number){var e=$b(y);F.rad.value=new y(1),F.deg.value=e.div(180),F.grad.value=e.div(200),F.cycle.value=e.times(2),F.arcsec.value=e.div(648e3),F.arcmin.value=e.div(10800)}else F.rad.value=1,F.deg.value=Math.PI/180,F.grad.value=Math.PI/200,F.cycle.value=2*Math.PI,F.arcsec.value=Math.PI/648e3,F.arcmin.value=Math.PI/10800;F.radian.value=F.rad.value,F.degree.value=F.deg.value,F.gradian.value=F.grad.value}z(a),s&&s("config",(function(t,e){t.number!==e.number&&z(t)}));var G={si:{NONE:{unit:O,prefix:N.NONE[""]},LENGTH:{unit:F.m,prefix:N.SHORT[""]},MASS:{unit:F.g,prefix:N.SHORT.k},TIME:{unit:F.s,prefix:N.SHORT[""]},CURRENT:{unit:F.A,prefix:N.SHORT[""]},TEMPERATURE:{unit:F.K,prefix:N.SHORT[""]},LUMINOUS_INTENSITY:{unit:F.cd,prefix:N.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:F.mol,prefix:N.SHORT[""]},ANGLE:{unit:F.rad,prefix:N.SHORT[""]},BIT:{unit:F.bits,prefix:N.SHORT[""]},FORCE:{unit:F.N,prefix:N.SHORT[""]},ENERGY:{unit:F.J,prefix:N.SHORT[""]},POWER:{unit:F.W,prefix:N.SHORT[""]},PRESSURE:{unit:F.Pa,prefix:N.SHORT[""]},ELECTRIC_CHARGE:{unit:F.C,prefix:N.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:F.F,prefix:N.SHORT[""]},ELECTRIC_POTENTIAL:{unit:F.V,prefix:N.SHORT[""]},ELECTRIC_RESISTANCE:{unit:F.ohm,prefix:N.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:F.H,prefix:N.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:F.S,prefix:N.SHORT[""]},MAGNETIC_FLUX:{unit:F.Wb,prefix:N.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:F.T,prefix:N.SHORT[""]},FREQUENCY:{unit:F.Hz,prefix:N.SHORT[""]}}};G.cgs=JSON.parse(JSON.stringify(G.si)),G.cgs.LENGTH={unit:F.m,prefix:N.SHORT.c},G.cgs.MASS={unit:F.g,prefix:N.SHORT[""]},G.cgs.FORCE={unit:F.dyn,prefix:N.SHORT[""]},G.cgs.ENERGY={unit:F.erg,prefix:N.NONE[""]},G.us=JSON.parse(JSON.stringify(G.si)),G.us.LENGTH={unit:F.ft,prefix:N.NONE[""]},G.us.MASS={unit:F.lbm,prefix:N.NONE[""]},G.us.TEMPERATURE={unit:F.degF,prefix:N.NONE[""]},G.us.FORCE={unit:F.lbf,prefix:N.NONE[""]},G.us.ENERGY={unit:F.BTU,prefix:N.BTU[""]},G.us.POWER={unit:F.hp,prefix:N.NONE[""]},G.us.PRESSURE={unit:F.psi,prefix:N.NONE[""]},G.auto=JSON.parse(JSON.stringify(G.si));var H=G.auto;for(var j in E.setUnitSystem=function(t){if(!Z_(G,t))throw new Error("Unit system "+t+" does not exist. Choices are: "+Object.keys(G).join(", "));H=G[t]},E.getUnitSystem=function(){for(var t in G)if(Z_(G,t)&&G[t]===H)return t},E.typeConverters={BigNumber:function(t){return new y(t+"")},Fraction:function(t){return new x(t)},Complex:function(t){return t},number:function(t){return t}},E.prototype._numberConverter=function(){var t=E.typeConverters[this.valueType()];if(t)return t;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},E._getNumberConverter=function(t){if(!E.typeConverters[t])throw new TypeError('Unsupported type "'+t+'"');return E.typeConverters[t]},F)if(Z_(F,j)){var V=F[j];V.dimensions=V.base.dimensions}for(var W in U)if(Z_(U,W)){var q=F[U[W]],X={};for(var Y in q)Z_(q,Y)&&(X[Y]=q[Y]);X.name=W,F[W]=X}return E.isValidAlpha=function(t){return/^[a-zA-Z]$/.test(t)},E.createUnit=function(t,e){if("object"!=typeof t)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override)for(var r in t)if(Z_(t,r)&&E.deleteUnit(r),t[r].aliases)for(var i=0;i<t[r].aliases.length;i++)E.deleteUnit(t[r].aliases[i]);var n;for(var s in t)Z_(t,s)&&(n=E.createUnitSingle(s,t[s]));return n},E.createUnitSingle=function(t,e){if(null==e&&(e={}),"string"!=typeof t)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(Z_(F,t))throw new Error('Cannot create unit "'+t+'": a unit with that name already exists');!function(t){for(var e=0;e<t.length;e++){if(n=t.charAt(e),0===e&&!E.isValidAlpha(n))throw new Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!E.isValidAlpha(n)&&!S(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}(t);var r,i,s,a=null,o=[],h=0;if(e&&"Unit"===e.type)a=e.clone();else if("string"==typeof e)""!==e&&(r=e);else{if("object"!=typeof e)throw new TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');r=e.definition,i=e.prefixes,h=e.offset,s=e.baseName,e.aliases&&(o=e.aliases.valueOf())}if(o)for(var u=0;u<o.length;u++)if(Z_(F,o[u]))throw new Error('Cannot create alias "'+o[u]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!a)try{a=E.parse(r,{allowNoUnits:!0})}catch(e){throw e.message='Could not create unit "'+t+'" from "'+r+'": '+e.message,e}else r&&"Unit"===r.type&&(a=r.clone());o=o||[],h=h||0,i=i&&i.toUpperCase&&N[i.toUpperCase()]||N.NONE;var l={};if(a){l={name:t,value:a.value,dimensions:a.dimensions.slice(0),prefixes:i,offset:h};var c=!1;for(var f in B)if(Z_(B,f)){for(var d=!0,p=0;p<k.length;p++)if(Math.abs((l.dimensions[p]||0)-(B[f].dimensions[p]||0))>1e-12){d=!1;break}if(d){c=!0,l.base=B[f];break}}if(!c){s=s||t+"_STUFF";var m={dimensions:a.dimensions.slice(0)};m.key=s,B[s]=m,H[s]={unit:l,prefix:N.NONE[""]},l.base=B[s]}}else{if(s=s||t+"_STUFF",k.indexOf(s)>=0)throw new Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');for(var g in k.push(s),B)Z_(B,g)&&(B[g].dimensions[k.length-1]=0);for(var v={dimensions:[]},_=0;_<k.length;_++)v.dimensions[_]=0;v.dimensions[k.length-1]=1,v.key=s,B[s]=v,l={name:t,value:1,dimensions:B[s].dimensions.slice(0),prefixes:i,offset:h,base:B[s]},H[s]={unit:l,prefix:N.NONE[""]}}E.UNITS[t]=l;for(var b=0;b<o.length;b++){var y=o[b],x={};for(var w in l)Z_(l,w)&&(x[w]=l[w]);x.name=y,E.UNITS[y]=x}return delete I.cache,new E(null,t)},E.deleteUnit=function(t){delete E.UNITS[t]},E.PREFIXES=N,E.BASE_DIMENSIONS=k,E.BASE_UNITS=B,E.UNIT_SYSTEMS=G,E.UNITS=F,E}),{isClass:!0});var LE="unit",OE=Hb(LE,["typed","Unit"],(t=>{var{typed:e,Unit:r}=t;return e(LE,{Unit:function(t){return t.clone()},string:function(t){return r.isValuelessUnit(t)?new r(null,t):r.parse(t,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(t,e){return new r(t,e)},"number | BigNumber | Fraction":function(t){return new r(t)},"Array | Matrix":e.referToSelf((t=>e=>kx(e,t)))})}));var FE=Vb({config:Q_}),UE=qb({}),zE=dx({}),GE=px({}),HE=mx({Matrix:GE}),jE=ux({BigNumber:FE,config:Q_}),VE=Tx({BigNumber:FE,Complex:UE,DenseMatrix:HE,Fraction:zE}),WE=Ox({typed:VE}),qE=Ux({typed:VE}),XE=zx({BigNumber:FE,typed:VE}),YE=jx({typed:VE}),ZE=Zx({config:Q_,typed:VE}),$E=Kx({typed:VE}),KE=Qx({typed:VE}),JE=tw({typed:VE}),QE=ew({typed:VE}),tM=uw({Matrix:GE,equalScalar:ZE,typed:VE}),eM=lw({typed:VE}),rM=cw({typed:VE}),iM=fw({Complex:UE,config:Q_,typed:VE}),nM=pw({typed:VE}),sM=mw({Fraction:zE,typed:VE}),aM=vw({typed:VE}),oM=bw({DenseMatrix:HE,Matrix:GE,SparseMatrix:tM,typed:VE}),hM=Iw({bignumber:XE,fraction:sM,number:QE}),uM=kw({matrix:oM,config:Q_,typed:VE}),lM=Ow({DenseMatrix:HE,config:Q_,matrix:oM,typed:VE}),cM=Gw({DenseMatrix:HE,addScalar:qE,equalScalar:ZE,matrix:oM,typed:VE,unaryMinus:nM}),fM=jw({BigNumber:FE,config:Q_,matrix:oM,typed:VE}),dM=Ww({numeric:hM,typed:VE}),pM=Xw({DenseMatrix:HE,equalScalar:ZE,matrix:oM,typed:VE}),mM=Zw({config:Q_,numeric:hM,smaller:lM,typed:VE}),gM=Qw({BigNumber:FE,DenseMatrix:HE,equalScalar:ZE,matrix:oM,typed:VE,zeros:fM}),vM=eE({addScalar:qE,conj:YE,multiplyScalar:JE,size:uM,typed:VE}),_M=sE({DenseMatrix:HE,config:Q_,equalScalar:ZE,matrix:oM,round:gM,typed:VE,zeros:fM}),bM=oE({BigNumber:FE,DenseMatrix:HE,SparseMatrix:tM,config:Q_,matrix:oM,typed:VE}),yM=uE({DenseMatrix:HE,config:Q_,matrix:oM,typed:VE}),xM=cE({Complex:UE,config:Q_,divideScalar:dM,typed:VE}),wM=dE({addScalar:qE,dot:vM,equalScalar:ZE,matrix:oM,multiplyScalar:JE,typed:VE}),EM=vE({DenseMatrix:HE,config:Q_,equalScalar:ZE,matrix:oM,round:gM,typed:VE,zeros:fM}),MM=_E({divideScalar:dM,isZero:KE,matrix:oM,multiply:wM,subtract:cM,typed:VE,unaryMinus:nM}),SM=wE({Complex:UE,DenseMatrix:HE,ceil:EM,equalScalar:ZE,floor:_M,matrix:oM,typed:VE,zeros:fM}),AM=EE({config:Q_,larger:yM,numeric:hM,typed:VE}),TM=ME({abs:WE,addScalar:qE,det:MM,divideScalar:dM,identity:bM,matrix:oM,multiply:wM,typed:VE,unaryMinus:nM}),CM=SE({Complex:UE,config:Q_,fraction:sM,identity:bM,inv:TM,matrix:oM,multiply:wM,number:QE,typed:VE}),DM=BE({BigNumber:FE,Complex:UE,Fraction:zE,abs:WE,addScalar:qE,config:Q_,divideScalar:dM,equal:pM,fix:SM,format:$E,isNumeric:aM,multiplyScalar:JE,number:QE,pow:CM,round:gM,subtract:cM}),RM=OE({Unit:DM,typed:VE}),IM={},PM=s("awmEs").Buffer;!function(t,e){IM=e()}(self,(()=>(()=>{var t={76:(t,e,r)=>{r(72);const{devDependencies:i}=r(681);t.exports={corePath:`https://unpkg.com/@ffmpeg/core@${i["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}},339:(t,e,r)=>{const i=r(72);t.exports=async t=>{let e=t;if(void 0===t)return new Uint8Array;if("string"==typeof t)if(/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t))e=atob(t.split(",")[1]).split("").map((t=>t.charCodeAt(0)));else{const r=await fetch(i(t));e=await r.arrayBuffer()}else(t instanceof File||t instanceof Blob)&&(e=await(r=t,new Promise(((t,e)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.onerror=({target:{error:{code:t}}})=>{e(Error(`File could not be read! Code=${t}`))},i.readAsArrayBuffer(r)}))));var r;return new Uint8Array(e)}},440:(t,e,r)=>{const i=r(72),{log:n}=r(888),s=async(t,e)=>{n("info",`fetch ${t}`);const r=await(await fetch(t)).arrayBuffer();n("info",`${t} file size = ${r.byteLength} bytes`);const i=new Blob([r],{type:e}),s=URL.createObjectURL(i);return n("info",`${t} blob URL = ${s}`),s};t.exports=async({corePath:t})=>{if("string"!=typeof t)throw Error("corePath should be a string!");const e=i(t),r=await s(e,"application/javascript"),a=await s(e.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),o=await s(e.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return"undefined"==typeof createFFmpegCore?new Promise((t=>{const e=document.createElement("script"),i=()=>{e.removeEventListener("load",i),n("info","ffmpeg-core.js script loaded"),t({createFFmpegCore:createFFmpegCore,corePath:r,wasmPath:a,workerPath:o})};e.src=r,e.type="text/javascript",e.addEventListener("load",i),document.getElementsByTagName("head")[0].appendChild(e)})):(n("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore:createFFmpegCore,corePath:r,wasmPath:a,workerPath:o}))}},451:(t,e,r)=>{const i=r(76),n=r(440),s=r(339);t.exports={defaultOptions:i,getCreateFFmpegCore:n,fetchFile:s}},617:t=>{t.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},648:(t,e,r)=>{const{defaultArgs:i,baseOptions:n}=r(617),{setLogging:s,setCustomLogger:a,log:o}=r(888),h=r(405),u=r(10),{defaultOptions:l,getCreateFFmpegCore:c}=r(451),{version:f}=r(681),d=Error("ffmpeg.wasm is not ready, make sure you have completed load().");t.exports=(t={})=>{const{log:e,logger:r,progress:p,...m}={...n,...l,...t};let g=null,v=null,_=null,b=!1,y=p;const x=({type:t,message:e})=>{o(t,e),h(e,y),(t=>{"FFMPEG_END"===t&&null!==_&&(_(),_=null,b=!1)})(e)};return s(e),a(r),o("info",`use ffmpeg.wasm v${f}`),{setProgress:t=>{y=t},setLogger:t=>{a(t)},setLogging:s,load:async()=>{if(o("info","load ffmpeg-core"),null!==g)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{o("info","loading ffmpeg-core");const{createFFmpegCore:t,corePath:e,workerPath:r,wasmPath:i}=await c(m);g=await t({mainScriptUrlOrBlob:e,printErr:t=>x({type:"fferr",message:t}),print:t=>x({type:"ffout",message:t}),locateFile:(t,e)=>{if("undefined"!=typeof window){if(void 0!==i&&t.endsWith("ffmpeg-core.wasm"))return i;if(void 0!==r&&t.endsWith("ffmpeg-core.worker.js"))return r}return e+t}}),v=g.cwrap("proxy_main","number",["number","number"]),o("info","ffmpeg-core loaded")}},isLoaded:()=>null!==g,run:(...t)=>{if(o("info",`run ffmpeg command: ${t.join(" ")}`),null===g)throw d;if(b)throw Error("ffmpeg.wasm can only run one command at a time");return b=!0,new Promise((e=>{const r=[...i,...t].filter((t=>0!==t.length));_=e,v(...u(g,r))}))},exit:()=>{if(null===g)throw d;b=!1,g.exit(1),g=null,v=null,_=null},FS:(t,...e)=>{if(o("info",`run FS.${t} ${e.map((t=>"string"==typeof t?t:`<${t.length} bytes binary file>`)).join(" ")}`),null===g)throw d;{let r=null;try{r=g.FS[t](...e)}catch(r){throw"readdir"===t?Error(`ffmpeg.FS('readdir', '${e[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`):"readFile"===t?Error(`ffmpeg.FS('readFile', '${e[0]}') error. Check if the path exists`):Error("Oops, something went wrong in FS operation.")}return r}}}}},888:t=>{let e=!1,r=()=>{};t.exports={logging:e,setLogging:t=>{e=t},setCustomLogger:t=>{r=t},log:(t,i)=>{r({type:t,message:i}),e&&console.log(`[${t}] ${i}`)}}},10:t=>{t.exports=(t,e)=>{const r=t._malloc(e.length*Uint32Array.BYTES_PER_ELEMENT);return e.forEach(((e,i)=>{const n=t._malloc(e.length+1);t.writeAsciiToMemory(e,n),t.setValue(r+Uint32Array.BYTES_PER_ELEMENT*i,n,"i32")})),[e.length,r]}},405:t=>{let e=0,r=0;const i=t=>{const[e,r,i]=t.split(":");return 3600*parseFloat(e)+60*parseFloat(r)+parseFloat(i)};t.exports=(t,n)=>{if("string"==typeof t)if(t.startsWith("  Duration")){const s=t.split(", ")[0].split(": ")[1],a=i(s);n({duration:a,ratio:r}),(0===e||e>a)&&(e=a)}else if(t.startsWith("frame")||t.startsWith("size")){const s=t.split("time=")[1].split(" ")[0],a=i(s);r=a/e,n({ratio:r,time:a})}else t.startsWith("video:")&&(n({ratio:1}),e=0)}},809:(t,e)=>{function r(t){var e=-1;i||(i=function(){for(var t=new Int32Array(256),e=0;e<256;e++){for(var r=e,i=0;i<8;i++)r=1&r?3988292384^r>>>1:r>>>1;t[e]=r}return t}());for(var r=0;r<t.length;r++)e=i[255&(e^t[r])]^e>>>8;return-1^e}Object.defineProperty(e,"__esModule",{value:!0}),e.changeDpiBlob=function(t,e){var r=t.slice(0,33);return new Promise((function(i,n){var s=new FileReader;s.onload=function(){var r=new Uint8Array(s.result),n=t.slice(33),a=d(r,e,t.type);i(new Blob([a,n],{type:t.type}))},s.readAsArrayBuffer(r)}))},e.changeDpiDataUrl=function(t,e){var r=t.split(","),i=r[0],u=r[1],l=void 0,c=void 0,f=!1;if(-1!==i.indexOf(n)){l=n;var p=function(t){var e=t.indexOf(a);-1===e&&(e=t.indexOf(o));-1===e&&(e=t.indexOf(h));return e}(u);p>=0?(c=4*Math.ceil((p+28)/3),f=!0):c=44}-1!==i.indexOf(s)&&(l=s,c=24);for(var m=u.substring(0,c),g=u.substring(c),v=atob(m),_=new Uint8Array(v.length),b=0;b<_.length;b++)_[b]=v.charCodeAt(b);var y=d(_,e,l,f),x=btoa(String.fromCharCode.apply(String,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(y)));return[i,",",x,g].join("")};var i=void 0,n="image/png",s="image/jpeg",a="AAlwSFlz",o="AAAJcEhZ",h="AAAACXBI",u="p".charCodeAt(0),l="H".charCodeAt(0),c="Y".charCodeAt(0),f="s".charCodeAt(0);function d(t,e,i,a){if(i===s)return t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t;if(i===n){var o=new Uint8Array(13);e*=39.3701,o[0]=u,o[1]=l,o[2]=c,o[3]=f,o[4]=e>>>24,o[5]=e>>>16,o[6]=e>>>8,o[7]=255&e,o[8]=o[4],o[9]=o[5],o[10]=o[6],o[11]=o[7],o[12]=1;var h=r(o),d=new Uint8Array(4);if(d[0]=h>>>24,d[1]=h>>>16,d[2]=h>>>8,d[3]=255&h,a){var p=function(t){for(var e=t.length-1;e>=4;e--)if(9===t[e-4]&&t[e-3]===u&&t[e-2]===l&&t[e-1]===c&&t[e]===f)return e-3}(t);return t.set(o,p),t.set(d,p+13),t}var m=new Uint8Array(4);m[0]=0,m[1]=0,m[2]=0,m[3]=9;var g=new Uint8Array(54);return g.set(t,0),g.set(m,33),g.set(o,37),g.set(d,50),g}}},162:function(t,e,r){var i,n,s;n=[],i=function(){function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function i(t,e,r){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){h(i.response,e,r)},i.onerror=function(){console.error("could not download file")},i.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r.g&&r.g.global===r.g?r.g:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,e,r){var o=a.URL||a.webkitURL,h=document.createElement("a");e=e||t.name||"download",h.download=e,h.rel="noopener","string"==typeof t?(h.href=t,h.origin===location.origin?s(h):n(h.href)?i(t,e,r):s(h,h.target="_blank")):(h.href=o.createObjectURL(t),setTimeout((function(){o.revokeObjectURL(h.href)}),4e4),setTimeout((function(){s(h)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,r,a){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),r);else if(n(t))i(t,r,a);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){s(o)}))}}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return i(t,e,r);var s="application/octet-stream"===t.type,h=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||s&&h||o)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},l.readAsDataURL(t)}else{var c=a.URL||a.webkitURL,f=c.createObjectURL(t);n?n.location=f:location.href=f,n=null,setTimeout((function(){c.revokeObjectURL(f)}),4e4)}});a.saveAs=h.saveAs=h,t.exports=h},void 0!==(s="function"==typeof i?i.apply(e,n):i)&&(t.exports=s)},733:(t,e,r)=>{
/*!

JSZip v3.7.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/
t.exports=function t(e,r,i){function n(a,o){if(!r[a]){if(!e[a]){if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[a]={exports:{}};e[a][0].call(u.exports,(function(t){return n(e[a][1][t]||t)}),u,u.exports,t,e,r,i)}return r[a].exports}for(var s=void 0,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){var i=t("./utils"),n=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var e,r,n,a,o,h,u,l=[],c=0,f=t.length,d=f,p="string"!==i.getTypeOf(t);c<t.length;)d=f-c,n=p?(e=t[c++],r=c<f?t[c++]:0,c<f?t[c++]:0):(e=t.charCodeAt(c++),r=c<f?t.charCodeAt(c++):0,c<f?t.charCodeAt(c++):0),a=e>>2,o=(3&e)<<4|r>>4,h=1<d?(15&r)<<2|n>>6:64,u=2<d?63&n:64,l.push(s.charAt(a)+s.charAt(o)+s.charAt(h)+s.charAt(u));return l.join("")},r.decode=function(t){var e,r,i,a,o,h,u=0,l=0,c="data:";if(t.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var f,d=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===s.charAt(64)&&d--,t.charAt(t.length-2)===s.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=n.uint8array?new Uint8Array(0|d):new Array(0|d);u<t.length;)e=s.indexOf(t.charAt(u++))<<2|(a=s.indexOf(t.charAt(u++)))>>4,r=(15&a)<<4|(o=s.indexOf(t.charAt(u++)))>>2,i=(3&o)<<6|(h=s.indexOf(t.charAt(u++))),f[l++]=e,64!==o&&(f[l++]=r),64!==h&&(f[l++]=i);return f}},{"./support":30,"./utils":32}],2:[function(t,e,r){var i=t("./external"),n=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),a=t("./stream/DataLengthProbe");function o(t,e,r,i,n){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=i,this.compressedContent=n}o.prototype={getContentWorker:function(){var t=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(t,e,r){return t.pipe(new s).pipe(new a("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",e)},e.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,r){var i=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,r){var i=t("./utils"),n=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,r,i){var s=n,a=i+r;t^=-1;for(var o=i;o<a;o++)t=t>>>8^s[255&(t^e[o])];return-1^t}(0|e,t,t.length,0):function(t,e,r,i){var s=n,a=i+r;t^=-1;for(var o=i;o<a;o++)t=t>>>8^s[255&(t^e.charCodeAt(o))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,e,r){var i=null;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako"),s=t("./utils"),a=t("./stream/GenericWorker"),o=i?"uint8array":"array";function h(t,e){a.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}r.magic="\b\0",s.inherits(h,a),h.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,t.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(t){return new h("Deflate",t)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,r){function i(t,e){var r,i="";for(r=0;r<e;r++)i+=String.fromCharCode(255&t),t>>>=8;return i}function n(t,e,r,n,a,l){var c,f,d=t.file,p=t.compression,m=l!==o.utf8encode,g=s.transformTo("string",l(d.name)),v=s.transformTo("string",o.utf8encode(d.name)),_=d.comment,b=s.transformTo("string",l(_)),y=s.transformTo("string",o.utf8encode(_)),x=v.length!==d.name.length,w=y.length!==_.length,E="",M="",S="",A=d.dir,T=d.date,C={crc32:0,compressedSize:0,uncompressedSize:0};e&&!r||(C.crc32=t.crc32,C.compressedSize=t.compressedSize,C.uncompressedSize=t.uncompressedSize);var D=0;e&&(D|=8),m||!x&&!w||(D|=2048);var R=0,I=0;A&&(R|=16),"UNIX"===a?(I=798,R|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(d.unixPermissions,A)):(I=20,R|=function(t){return 63&(t||0)}(d.dosPermissions)),c=T.getUTCHours(),c<<=6,c|=T.getUTCMinutes(),c<<=5,c|=T.getUTCSeconds()/2,f=T.getUTCFullYear()-1980,f<<=4,f|=T.getUTCMonth()+1,f<<=5,f|=T.getUTCDate(),x&&(M=i(1,1)+i(h(g),4)+v,E+="up"+i(M.length,2)+M),w&&(S=i(1,1)+i(h(b),4)+y,E+="uc"+i(S.length,2)+S);var P="";return P+="\n\0",P+=i(D,2),P+=p.magic,P+=i(c,2),P+=i(f,2),P+=i(C.crc32,4),P+=i(C.compressedSize,4),P+=i(C.uncompressedSize,4),P+=i(g.length,2),P+=i(E.length,2),{fileRecord:u.LOCAL_FILE_HEADER+P+g+E,dirRecord:u.CENTRAL_FILE_HEADER+i(I,2)+P+i(b.length,2)+"\0\0\0\0"+i(R,4)+i(n,4)+g+E+b}}var s=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),h=t("../crc32"),u=t("../signature");function l(t,e,r,i){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(l,a),l.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,a.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-i-1))/r:100}}))},l.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=n(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},l.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=n(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:function(t){return u.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},l.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,n=function(t,e,r,n,a){var o=s.transformTo("string",a(n));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(t,2)+i(t,2)+i(e,4)+i(r,4)+i(o.length,2)+o}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},l.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},l.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},l.prototype.error=function(t){var e=this._sources;if(!a.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch(t){}return!0},l.prototype.lock=function(){a.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=l},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,r){var i=t("../compressions"),n=t("./ZipFileWorker");r.generateWorker=function(t,e,r){var s=new n(e.streamFiles,r,e.platform,e.encodeFileName),a=0;try{t.forEach((function(t,r){a++;var n=function(t,e){var r=t||e,n=i[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,e.compression),o=r.options.compressionOptions||e.compressionOptions||{},h=r.dir,u=r.date;r._compressWorker(n,o).withStreamInfo("file",{name:t,dir:h,date:u,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(s)})),s.entriesCount=a}catch(t){s.error(t)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,r){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.7.1",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,r){var i=t("./utils"),n=t("./external"),s=t("./utf8"),a=t("./zipEntries"),o=t("./stream/Crc32Probe"),h=t("./nodejsUtils");function u(t){return new n.Promise((function(e,r){var i=t.decompressed.getContentWorker().pipe(new o);i.on("error",(function(t){r(t)})).on("end",(function(){i.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var r=this;return e=i.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),h.isNode&&h.isStream(t)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var r=new a(e);return r.load(t),r})).then((function(t){var r=[n.Promise.resolve(t)],i=t.files;if(e.checkCRC32)for(var s=0;s<i.length;s++)r.push(u(i[s]));return n.Promise.all(r)})).then((function(t){for(var i=t.shift(),n=i.files,s=0;s<n.length;s++){var a=n[s];r.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders})}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,r){var i=t("../utils"),n=t("../stream/GenericWorker");function s(t,e){n.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(s,n),s.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,r){var i=t("readable-stream").Readable;function n(t,e,r){i.call(this,e),this._helper=t;var n=this;t.on("data",(function(t,e){n.push(t)||n._helper.pause(),r&&r(e)})).on("error",(function(t){n.emit("error",t)})).on("end",(function(){n.push(null)}))}t("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},e.exports=n},{"../utils":32,"readable-stream":16}],14:[function(t,e,r){e.exports={isNode:void 0!==PM,newBufferFrom:function(t,e){if(PM.from&&PM.from!==Uint8Array.from)return PM.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new PM(t,e)},allocBuffer:function(t){if(PM.alloc)return PM.alloc(t);var e=new PM(t);return e.fill(0),e},isBuffer:function(t){return PM.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,r){function i(t,e,r){var i,n=s.getTypeOf(e),o=s.extend(r||{},h);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(t=m(t)),o.createFolders&&(i=p(t))&&g.call(this,i,!0);var c="string"===n&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!c),(e instanceof u&&0===e.uncompressedSize||o.dir||!e||0===e.length)&&(o.base64=!1,o.binary=!0,e="",o.compression="STORE",n="string");var v=null;v=e instanceof u||e instanceof a?e:f.isNode&&f.isStream(e)?new d(t,e):s.prepareContent(t,e,o.binary,o.optimizedBinaryString,o.base64);var _=new l(t,v,o);this.files[t]=_}var n=t("./utf8"),s=t("./utils"),a=t("./stream/GenericWorker"),o=t("./stream/StreamHelper"),h=t("./defaults"),u=t("./compressedObject"),l=t("./zipObject"),c=t("./generate"),f=t("./nodejsUtils"),d=t("./nodejs/NodejsStreamInputAdapter"),p=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},m=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},g=function(t,e){return e=void 0!==e?e:h.createFolders,t=m(t),this.files[t]||i.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function v(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,i;for(e in this.files)i=this.files[e],(r=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(r,i)},filter:function(t){var e=[];return this.forEach((function(r,i){t(r,i)&&e.push(i)})),e},file:function(t,e,r){if(1!==arguments.length)return t=this.root+t,i.call(this,t,e,r),this;if(v(t)){var n=t;return this.filter((function(t,e){return!e.dir&&n.test(t)}))}var s=this.files[this.root+t];return s&&!s.dir?s:null},folder:function(t){if(!t)return this;if(v(t))return this.filter((function(e,r){return r.dir&&t.test(e)}));var e=this.root+t,r=g.call(this,e),i=this.clone();return i.root=r.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter((function(e,r){return r.name.slice(0,t.length)===t})),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if((r=s.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");s.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var i=r.comment||this.comment||"";e=c.generateWorker(this,r,i)}catch(t){(e=new a("error")).error(t)}return new o(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,r){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,r){var i=t("./DataReader");function n(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data[this.zero+t]},n.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return-1},n.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&i===s[2]&&n===s[3]},n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],18:[function(t,e,r){var i=t("../utils");function n(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=n},{"../utils":32}],19:[function(t,e,r){var i=t("./Uint8ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,r){var i=t("./DataReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},n.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},n.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./DataReader":18}],21:[function(t,e,r){var i=t("./ArrayReader");function n(t){i.call(this,t)}t("../utils").inherits(n,i),n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,r){var i=t("../utils"),n=t("../support"),s=t("./ArrayReader"),a=t("./StringReader"),o=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||n.uint8array?"nodebuffer"===e?new o(t):n.uint8array?new h(i.transformTo("uint8array",t)):new s(i.transformTo("array",t)):new a(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,r){var i=t("./GenericWorker"),n=t("../utils");function s(t){i.call(this,"ConvertWorker to "+t),this.destType=t}n.inherits(s,i),s.prototype.processChunk=function(t){this.push({data:n.transformTo(this.destType,t.data),meta:t.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,r){var i=t("./GenericWorker"),n=t("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,i),s.prototype.processChunk=function(t){this.streamInfo.crc32=n(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,r){var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(s,n),s.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}n.prototype.processChunk.call(this,t)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,r){var i=t("../utils"),n=t("./GenericWorker");function s(t){n.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}i.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,r){function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,r){var i=t("../utils"),n=t("./ConvertWorker"),s=t("./GenericWorker"),a=t("../base64"),o=t("../support"),h=t("../external"),u=null;if(o.nodestream)try{u=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function l(t,e){return new h.Promise((function(r,n){var s=[],o=t._internalType,h=t._outputType,u=t._mimeType;t.on("data",(function(t,r){s.push(t),e&&e(r)})).on("error",(function(t){s=[],n(t)})).on("end",(function(){try{var t=function(t,e,r){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),r);case"base64":return a.encode(e);default:return i.transformTo(t,e)}}(h,function(t,e){var r,i=0,n=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(n=new Uint8Array(s),r=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;return n;case"nodebuffer":return PM.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(o,s),u);r(t)}catch(t){n(t)}s=[]})).resume()}))}function c(t,e,r){var a=e;switch(e){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=e,this._mimeType=r,i.checkSupport(a),this._worker=t.pipe(new n(a)),t.lock()}catch(t){this._worker=new s("error"),this._worker.error(t)}}c.prototype={accumulate:function(t){return l(this,t)},on:function(t,e){var r=this;return"data"===t?this._worker.on(t,(function(t){e.call(r,t.data,t.meta)})):this._worker.on(t,(function(){i.delay(e,arguments,r)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==PM,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),r.blob=0===n.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,r){for(var i=t("./utils"),n=t("./support"),s=t("./nodejsUtils"),a=t("./stream/GenericWorker"),o=new Array(256),h=0;h<256;h++)o[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function u(){a.call(this,"utf-8 decode"),this.leftOver=null}function l(){a.call(this,"utf-8 encode")}o[254]=o[254]=1,r.utf8encode=function(t){return n.nodebuffer?s.newBufferFrom(t,"utf-8"):function(t){var e,r,i,s,a,o=t.length,h=0;for(s=0;s<o;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),h+=r<128?1:r<2048?2:r<65536?3:4;for(e=n.uint8array?new Uint8Array(h):new Array(h),s=a=0;a<h;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(i=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?e[a++]=r:(r<2048?e[a++]=192|r>>>6:(r<65536?e[a++]=224|r>>>12:(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63),e[a++]=128|r>>>6&63),e[a++]=128|63&r);return e}(t)},r.utf8decode=function(t){return n.nodebuffer?i.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,r,n,s,a=t.length,h=new Array(2*a);for(e=r=0;e<a;)if((n=t[e++])<128)h[r++]=n;else if(4<(s=o[n]))h[r++]=65533,e+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&e<a;)n=n<<6|63&t[e++],s--;1<s?h[r++]=65533:n<65536?h[r++]=n:(n-=65536,h[r++]=55296|n>>10&1023,h[r++]=56320|1023&n)}return h.length!==r&&(h.subarray?h=h.subarray(0,r):h.length=r),i.applyFromCharCode(h)}(t=i.transformTo(n.uint8array?"uint8array":"array",t))},i.inherits(u,a),u.prototype.processChunk=function(t){var e=i.transformTo(n.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var s=e;(e=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),e.set(s,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var a=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0||0===r?e:r+o[t[r]]>e?r:e}(e),h=e;a!==e.length&&(n.uint8array?(h=e.subarray(0,a),this.leftOver=e.subarray(a,e.length)):(h=e.slice(0,a),this.leftOver=e.slice(a,e.length))),this.push({data:r.utf8decode(h),meta:t.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=u,i.inherits(l,a),l.prototype.processChunk=function(t){this.push({data:r.utf8encode(t.data),meta:t.meta})},r.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,r){var i=t("./support"),n=t("./base64"),s=t("./nodejsUtils"),a=t("set-immediate-shim"),o=t("./external");function h(t){return t}function u(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}r.newBlob=function(t,e){r.checkSupport("blob");try{return new Blob([t],{type:e})}catch(r){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(t),i.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var l={stringifyByChunk:function(t,e,r){var i=[],n=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;n<s;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(t){return!1}}()}};function c(t){var e=65536,i=r.getTypeOf(t),n=!0;if("uint8array"===i?n=l.applyCanBeUsed.uint8array:"nodebuffer"===i&&(n=l.applyCanBeUsed.nodebuffer),n)for(;1<e;)try{return l.stringifyByChunk(t,i,e)}catch(t){e=Math.floor(e/2)}return l.stringifyByChar(t)}function f(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}r.applyFromCharCode=c;var d={};d.string={string:h,array:function(t){return u(t,new Array(t.length))},arraybuffer:function(t){return d.string.uint8array(t).buffer},uint8array:function(t){return u(t,new Uint8Array(t.length))},nodebuffer:function(t){return u(t,s.allocBuffer(t.length))}},d.array={string:c,array:h,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(t)}},d.arraybuffer={string:function(t){return c(new Uint8Array(t))},array:function(t){return f(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:h,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(new Uint8Array(t))}},d.uint8array={string:c,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:h,nodebuffer:function(t){return s.newBufferFrom(t)}},d.nodebuffer={string:c,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return d.nodebuffer.uint8array(t).buffer},uint8array:function(t){return f(t,new Uint8Array(t.length))},nodebuffer:h},r.transformTo=function(t,e){if(e=e||"",!t)return e;r.checkSupport(t);var i=r.getTypeOf(e);return d[i][t](e)},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":i.nodebuffer&&s.isBuffer(t)?"nodebuffer":i.uint8array&&t instanceof Uint8Array?"uint8array":i.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){if(!i[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var e,r,i="";for(r=0;r<(t||"").length;r++)i+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return i},r.delay=function(t,e,r){a((function(){t.apply(r||null,e||[])}))},r.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r},r.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r},r.prepareContent=function(t,e,s,a,h){return o.Promise.resolve(e).then((function(t){return i.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new o.Promise((function(e,r){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(t){r(t.target.error)},i.readAsArrayBuffer(t)})):t})).then((function(e){var l=r.getTypeOf(e);return l?("arraybuffer"===l?e=r.transformTo("uint8array",e):"string"===l&&(h?e=n.decode(e):s&&!0!==a&&(e=function(t){return u(t,i.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):o.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,r){var i=t("./reader/readerFor"),n=t("./utils"),s=t("./signature"),a=t("./zipEntry"),o=(t("./utf8"),t("./support"));function h(t){this.files=[],this.loadOptions=t}h.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(e)+", expected "+n.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=o.uint8array?"uint8array":"array",r=n.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(t=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=e-r;if(0<i)this.isSignature(e,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,r){var i=t("./reader/readerFor"),n=t("./utils"),s=t("./compressedObject"),a=t("./crc32"),o=t("./utf8"),h=t("./compressions"),u=t("./support");function l(t,e){this.options=t,this.loadOptions=e}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in h)if(h.hasOwnProperty(e)&&h[e].magic===t)return h[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,r,i,n=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<n;)e=t.readInt(2),r=t.readInt(2),i=t.readData(r),this.extraFields[e]={id:e,length:r,value:i};t.setIndex(n)},handleUTF8:function(){var t=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=n.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var s=n.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)||a(this.fileName)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)||a(this.fileComment)!==e.readInt(4)?null:o.utf8decode(e.readData(t.length-5))}return null}},e.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,r){function i(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var n=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),a=t("./utf8"),o=t("./compressedObject"),h=t("./stream/GenericWorker");i.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");var i="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),e=this._decompressWorker();var s=!this._dataBinary;s&&!i&&(e=e.pipe(new a.Utf8EncodeWorker)),!s&&i&&(e=e.pipe(new a.Utf8DecodeWorker))}catch(t){(e=new h("error")).error(t)}return new n(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof o&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof h?this._data:new s(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<u.length;c++)i.prototype[u[c]]=l;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,i){(function(t){var r,i,n=t.MutationObserver||t.WebKitMutationObserver;if(n){var s=0,a=new n(l),o=t.document.createTextNode("");a.observe(o,{characterData:!0}),r=function(){o.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var h=new t.MessageChannel;h.port1.onmessage=l,r=function(){h.port2.postMessage(0)}}var u=[];function l(){var t,e;i=!0;for(var r=u.length;r;){for(e=u,u=[],t=-1;++t<r;)e[t]();r=u.length}i=!1}e.exports=function(t){1!==u.push(t)||i||r()}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,r){var i=t("immediate");function n(){}var s={},a=["REJECTED"],o=["FULFILLED"],h=["PENDING"];function u(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,t!==n&&d(this,t)}function l(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function c(t,e,r){i((function(){var i;try{i=e(r)}catch(e){return s.reject(t,e)}i===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,i)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var r=!1;function i(e){r||(r=!0,s.reject(t,e))}function n(e){r||(r=!0,s.resolve(t,e))}var a=p((function(){e(n,i)}));"error"===a.status&&i(a.value)}function p(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}(e.exports=u).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){throw r}))}))},u.prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,e){if("function"!=typeof t&&this.state===o||"function"!=typeof e&&this.state===a)return this;var r=new this.constructor(n);return this.state!==h?c(r,this.state===o?t:e,this.outcome):this.queue.push(new l(r,t,e)),r},l.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){c(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){s.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){c(this.promise,this.onRejected,t)},s.resolve=function(t,e){var r=p(f,e);if("error"===r.status)return s.reject(t,r.value);var i=r.value;if(i)d(t,i);else{t.state=o,t.outcome=e;for(var n=-1,a=t.queue.length;++n<a;)t.queue[n].callFulfilled(e)}return t},s.reject=function(t,e){t.state=a,t.outcome=e;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callRejected(e);return t},u.resolve=function(t){return t instanceof this?t:s.resolve(new this(n),t)},u.reject=function(t){var e=new this(n);return s.reject(e,t)},u.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var a=new Array(r),o=0,h=-1,u=new this(n);++h<r;)l(t[h],h);return u;function l(t,n){e.resolve(t).then((function(t){a[n]=t,++o!==r||i||(i=!0,s.resolve(u,a))}),(function(t){i||(i=!0,s.reject(u,t))}))}},u.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var a,o=-1,h=new this(n);++o<r;)a=t[o],e.resolve(a).then((function(t){i||(i=!0,s.resolve(h,t))}),(function(t){i||(i=!0,s.reject(h,t))}));return h}},{immediate:36}],38:[function(t,e,r){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,r){var i=t("./zlib/deflate"),n=t("./utils/common"),s=t("./utils/strings"),a=t("./zlib/messages"),o=t("./zlib/zstream"),h=Object.prototype.toString,u=0,l=-1,c=0,f=8;function d(t){if(!(this instanceof d))return new d(t);this.options=n.assign({level:l,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==u)throw new Error(a[r]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var p;if(p="string"==typeof e.dictionary?s.string2buf(e.dictionary):"[object ArrayBuffer]"===h.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=i.deflateSetDictionary(this.strm,p))!==u)throw new Error(a[r]);this._dict_set=!0}}function p(t,e){var r=new d(e);if(r.push(t,!0),r.err)throw r.msg||a[r.err];return r.result}d.prototype.push=function(t,e){var r,a,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=s.string2buf(t):"[object ArrayBuffer]"===h.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(l),o.next_out=0,o.avail_out=l),1!==(r=i.deflate(o,a))&&r!==u)return this.onEnd(r),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(s.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==r);return 4===a?(r=i.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===u):2!==a||(this.onEnd(u),o.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=d,r.deflate=p,r.deflateRaw=function(t,e){return(e=e||{}).raw=!0,p(t,e)},r.gzip=function(t,e){return(e=e||{}).gzip=!0,p(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,r){var i=t("./zlib/inflate"),n=t("./utils/common"),s=t("./utils/strings"),a=t("./zlib/constants"),o=t("./zlib/messages"),h=t("./zlib/zstream"),u=t("./zlib/gzheader"),l=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,e.windowBits);if(r!==a.Z_OK)throw new Error(o[r]);this.header=new u,i.inflateGetHeader(this.strm,this.header)}function f(t,e){var r=new c(e);if(r.push(t,!0),r.err)throw r.msg||o[r.err];return r.result}c.prototype.push=function(t,e){var r,o,h,u,c,f,d=this.strm,p=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?d.input=s.binstring2buf(t):"[object ArrayBuffer]"===l.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new n.Buf8(p),d.next_out=0,d.avail_out=p),(r=i.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(f="string"==typeof m?s.string2buf(m):"[object ArrayBuffer]"===l.call(m)?new Uint8Array(m):m,r=i.inflateSetDictionary(this.strm,f)),r===a.Z_BUF_ERROR&&!0===g&&(r=a.Z_OK,g=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==a.Z_STREAM_END&&(0!==d.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(h=s.utf8border(d.output,d.next_out),u=d.next_out-h,c=s.buf2string(d.output,h),d.next_out=u,d.avail_out=p-u,u&&n.arraySet(d.output,d.output,h,u,0),this.onData(c)):this.onData(n.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((0<d.avail_in||0===d.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=c,r.inflate=f,r.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},r.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+i),n);else for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,a;for(e=i=0,r=t.length;e<r;e++)i+=t[e].length;for(a=new Uint8Array(i),e=n=0,r=t.length;e<r;e++)s=t[e],a.set(s,n),n+=s.length;return a}},s={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],42:[function(t,e,r){var i=t("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var a=new i.Buf8(256),o=0;o<256;o++)a[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function h(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var r="",a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r}a[254]=a[254]=1,r.string2buf=function(t){var e,r,n,s,a,o=t.length,h=0;for(s=0;s<o;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),h+=r<128?1:r<2048?2:r<65536?3:4;for(e=new i.Buf8(h),s=a=0;a<h;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?e[a++]=r:(r<2048?e[a++]=192|r>>>6:(r<65536?e[a++]=224|r>>>12:(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63),e[a++]=128|r>>>6&63),e[a++]=128|63&r);return e},r.buf2binstring=function(t){return h(t,t.length)},r.binstring2buf=function(t){for(var e=new i.Buf8(t.length),r=0,n=e.length;r<n;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,i,n,s,o=e||t.length,u=new Array(2*o);for(r=i=0;r<o;)if((n=t[r++])<128)u[i++]=n;else if(4<(s=a[n]))u[i++]=65533,r+=s-1;else{for(n&=2===s?31:3===s?15:7;1<s&&r<o;)n=n<<6|63&t[r++],s--;1<s?u[i++]=65533:n<65536?u[i++]=n:(n-=65536,u[i++]=55296|n>>10&1023,u[i++]=56320|1023&n)}return h(u,i)},r.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0||0===r?e:r+a[t[r]]>e?r:e}},{"./common":41}],43:[function(t,e,r){e.exports=function(t,e,r,i){for(var n=65535&t|0,s=t>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(n=n+e[i++]|0)|0,--a;);n%=65521,s%=65521}return n|s<<16|0}},{}],44:[function(t,e,r){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,r){var i=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e,r,n){var s=i,a=n+r;t^=-1;for(var o=n;o<a;o++)t=t>>>8^s[255&(t^e[o])];return-1^t}},{}],46:[function(t,e,r){var i,n=t("../utils/common"),s=t("./trees"),a=t("./adler32"),o=t("./crc32"),h=t("./messages"),u=0,l=4,c=0,f=-2,d=-1,p=4,m=2,g=8,v=9,_=286,b=30,y=19,x=2*_+1,w=15,E=3,M=258,S=M+E+1,A=42,T=113,C=1,D=2,R=3,I=4;function P(t,e){return t.msg=h[e],e}function N(t){return(t<<1)-(4<t?9:0)}function k(t){for(var e=t.length;0<=--e;)t[e]=0}function B(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(n.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function L(t,e){s._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,B(t.strm)}function O(t,e){t.pending_buf[t.pending++]=e}function F(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function U(t,e){var r,i,n=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,h=t.strstart>t.w_size-S?t.strstart-(t.w_size-S):0,u=t.window,l=t.w_mask,c=t.prev,f=t.strstart+M,d=u[s+a-1],p=u[s+a];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(r=e)+a]===p&&u[r+a-1]===d&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<f);if(i=M-(f-s),s=f-M,a<i){if(t.match_start=e,o<=(a=i))break;d=u[s+a-1],p=u[s+a]}}}while((e=c[e&l])>h&&0!=--n);return a<=t.lookahead?a:t.lookahead}function z(t){var e,r,i,s,h,u,l,c,f,d,p=t.w_size;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-S)){for(n.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=r=t.hash_size;i=t.head[--e],t.head[e]=p<=i?i-p:0,--r;);for(e=r=p;i=t.prev[--e],t.prev[e]=p<=i?i-p:0,--r;);s+=p}if(0===t.strm.avail_in)break;if(u=t.strm,l=t.window,c=t.strstart+t.lookahead,d=void 0,(f=s)<(d=u.avail_in)&&(d=f),r=0===d?0:(u.avail_in-=d,n.arraySet(l,u.input,u.next_in,d,c),1===u.state.wrap?u.adler=a(u.adler,l,d,c):2===u.state.wrap&&(u.adler=o(u.adler,l,d,c)),u.next_in+=d,u.total_in+=d,d),t.lookahead+=r,t.lookahead+t.insert>=E)for(h=t.strstart-t.insert,t.ins_h=t.window[h],t.ins_h=(t.ins_h<<t.hash_shift^t.window[h+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[h+E-1])&t.hash_mask,t.prev[h&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=h,h++,t.insert--,!(t.lookahead+t.insert<E)););}while(t.lookahead<S&&0!==t.strm.avail_in)}function G(t,e){for(var r,i;;){if(t.lookahead<S){if(z(t),t.lookahead<S&&e===u)return C;if(0===t.lookahead)break}if(r=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-S&&(t.match_length=U(t,r)),t.match_length>=E)if(i=s._tr_tally(t,t.strstart-t.match_start,t.match_length-E),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=E){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(L(t,!1),0===t.strm.avail_out))return C}return t.insert=t.strstart<E-1?t.strstart:E-1,e===l?(L(t,!0),0===t.strm.avail_out?R:I):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?C:D}function H(t,e){for(var r,i,n;;){if(t.lookahead<S){if(z(t),t.lookahead<S&&e===u)return C;if(0===t.lookahead)break}if(r=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=E-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-S&&(t.match_length=U(t,r),t.match_length<=5&&(1===t.strategy||t.match_length===E&&4096<t.strstart-t.match_start)&&(t.match_length=E-1)),t.prev_length>=E&&t.match_length<=t.prev_length){for(n=t.strstart+t.lookahead-E,i=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-E),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=E-1,t.strstart++,i&&(L(t,!1),0===t.strm.avail_out))return C}else if(t.match_available){if((i=s._tr_tally(t,0,t.window[t.strstart-1]))&&L(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return C}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<E-1?t.strstart:E-1,e===l?(L(t,!0),0===t.strm.avail_out?R:I):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?C:D}function j(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}function V(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*x),this.dyn_dtree=new n.Buf16(2*(2*b+1)),this.bl_tree=new n.Buf16(2*(2*y+1)),k(this.dyn_ltree),k(this.dyn_dtree),k(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(w+1),this.heap=new n.Buf16(2*_+1),k(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*_+1),k(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=m,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?A:T,t.adler=2===e.wrap?0:1,e.last_flush=u,s._tr_init(e),c):P(t,f)}function q(t){var e=W(t);return e===c&&function(t){t.window_size=2*t.w_size,k(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=E-1,t.match_available=0,t.ins_h=0}(t.state),e}function X(t,e,r,i,s,a){if(!t)return f;var o=1;if(e===d&&(e=6),i<0?(o=0,i=-i):15<i&&(o=2,i-=16),s<1||v<s||r!==g||i<8||15<i||e<0||9<e||a<0||p<a)return P(t,f);8===i&&(i=9);var h=new V;return(t.state=h).strm=t,h.wrap=o,h.gzhead=null,h.w_bits=i,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=s+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+E-1)/E),h.window=new n.Buf8(2*h.w_size),h.head=new n.Buf16(h.hash_size),h.prev=new n.Buf16(h.w_size),h.lit_bufsize=1<<s+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new n.Buf8(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=e,h.strategy=a,h.method=r,q(t)}i=[new j(0,0,0,0,(function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(z(t),0===t.lookahead&&e===u)return C;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,L(t,!1),0===t.strm.avail_out))return C;if(t.strstart-t.block_start>=t.w_size-S&&(L(t,!1),0===t.strm.avail_out))return C}return t.insert=0,e===l?(L(t,!0),0===t.strm.avail_out?R:I):(t.strstart>t.block_start&&(L(t,!1),t.strm.avail_out),C)})),new j(4,4,8,4,G),new j(4,5,16,8,G),new j(4,6,32,32,G),new j(4,4,16,16,H),new j(8,16,32,32,H),new j(8,16,128,128,H),new j(8,32,128,256,H),new j(32,128,258,1024,H),new j(32,258,258,4096,H)],r.deflateInit=function(t,e){return X(t,e,g,15,8,0)},r.deflateInit2=X,r.deflateReset=q,r.deflateResetKeep=W,r.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?f:(t.state.gzhead=e,c):f},r.deflate=function(t,e){var r,n,a,h;if(!t||!t.state||5<e||e<0)return t?P(t,f):f;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||666===n.status&&e!==l)return P(t,0===t.avail_out?-5:f);if(n.strm=t,r=n.last_flush,n.last_flush=e,n.status===A)if(2===n.wrap)t.adler=0,O(n,31),O(n,139),O(n,8),n.gzhead?(O(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),O(n,255&n.gzhead.time),O(n,n.gzhead.time>>8&255),O(n,n.gzhead.time>>16&255),O(n,n.gzhead.time>>24&255),O(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),O(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(O(n,255&n.gzhead.extra.length),O(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=o(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(O(n,0),O(n,0),O(n,0),O(n,0),O(n,0),O(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),O(n,3),n.status=T);else{var d=g+(n.w_bits-8<<4)<<8;d|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(d|=32),d+=31-d%31,n.status=T,F(n,d),0!==n.strstart&&(F(n,t.adler>>>16),F(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),B(t),a=n.pending,n.pending!==n.pending_buf_size));)O(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),B(t),a=n.pending,n.pending===n.pending_buf_size)){h=1;break}h=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,O(n,h)}while(0!==h);n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),0===h&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),B(t),a=n.pending,n.pending===n.pending_buf_size)){h=1;break}h=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,O(n,h)}while(0!==h);n.gzhead.hcrc&&n.pending>a&&(t.adler=o(t.adler,n.pending_buf,n.pending-a,a)),0===h&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&B(t),n.pending+2<=n.pending_buf_size&&(O(n,255&t.adler),O(n,t.adler>>8&255),t.adler=0,n.status=T)):n.status=T),0!==n.pending){if(B(t),0===t.avail_out)return n.last_flush=-1,c}else if(0===t.avail_in&&N(e)<=N(r)&&e!==l)return P(t,-5);if(666===n.status&&0!==t.avail_in)return P(t,-5);if(0!==t.avail_in||0!==n.lookahead||e!==u&&666!==n.status){var p=2===n.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(z(t),0===t.lookahead)){if(e===u)return C;break}if(t.match_length=0,r=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(L(t,!1),0===t.strm.avail_out))return C}return t.insert=0,e===l?(L(t,!0),0===t.strm.avail_out?R:I):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?C:D}(n,e):3===n.strategy?function(t,e){for(var r,i,n,a,o=t.window;;){if(t.lookahead<=M){if(z(t),t.lookahead<=M&&e===u)return C;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=E&&0<t.strstart&&(i=o[n=t.strstart-1])===o[++n]&&i===o[++n]&&i===o[++n]){a=t.strstart+M;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<a);t.match_length=M-(a-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=E?(r=s._tr_tally(t,1,t.match_length-E),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(L(t,!1),0===t.strm.avail_out))return C}return t.insert=0,e===l?(L(t,!0),0===t.strm.avail_out?R:I):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?C:D}(n,e):i[n.level].func(n,e);if(p!==R&&p!==I||(n.status=666),p===C||p===R)return 0===t.avail_out&&(n.last_flush=-1),c;if(p===D&&(1===e?s._tr_align(n):5!==e&&(s._tr_stored_block(n,0,0,!1),3===e&&(k(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),B(t),0===t.avail_out))return n.last_flush=-1,c}return e!==l?c:n.wrap<=0?1:(2===n.wrap?(O(n,255&t.adler),O(n,t.adler>>8&255),O(n,t.adler>>16&255),O(n,t.adler>>24&255),O(n,255&t.total_in),O(n,t.total_in>>8&255),O(n,t.total_in>>16&255),O(n,t.total_in>>24&255)):(F(n,t.adler>>>16),F(n,65535&t.adler)),B(t),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?c:1)},r.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==A&&69!==e&&73!==e&&91!==e&&103!==e&&e!==T&&666!==e?P(t,f):(t.state=null,e===T?P(t,-3):c):f},r.deflateSetDictionary=function(t,e){var r,i,s,o,h,u,l,d,p=e.length;if(!t||!t.state)return f;if(2===(o=(r=t.state).wrap)||1===o&&r.status!==A||r.lookahead)return f;for(1===o&&(t.adler=a(t.adler,e,p,0)),r.wrap=0,p>=r.w_size&&(0===o&&(k(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new n.Buf8(r.w_size),n.arraySet(d,e,p-r.w_size,r.w_size,0),e=d,p=r.w_size),h=t.avail_in,u=t.next_in,l=t.input,t.avail_in=p,t.next_in=0,t.input=e,z(r);r.lookahead>=E;){for(i=r.strstart,s=r.lookahead-(E-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+E-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,--s;);r.strstart=i,r.lookahead=E-1,z(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=E-1,r.match_available=0,t.next_in=u,t.input=l,t.avail_in=h,r.wrap=o,c},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,r){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,r){e.exports=function(t,e){var r,i,n,s,a,o,h,u,l,c,f,d,p,m,g,v,_,b,y,x,w,E,M,S,A;r=t.state,i=t.next_in,S=t.input,n=i+(t.avail_in-5),s=t.next_out,A=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),h=r.dmax,u=r.wsize,l=r.whave,c=r.wnext,f=r.window,d=r.hold,p=r.bits,m=r.lencode,g=r.distcode,v=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;t:do{p<15&&(d+=S[i++]<<p,p+=8,d+=S[i++]<<p,p+=8),b=m[d&v];e:for(;;){if(d>>>=y=b>>>24,p-=y,0==(y=b>>>16&255))A[s++]=65535&b;else{if(!(16&y)){if(0==(64&y)){b=m[(65535&b)+(d&(1<<y)-1)];continue e}if(32&y){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}x=65535&b,(y&=15)&&(p<y&&(d+=S[i++]<<p,p+=8),x+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=S[i++]<<p,p+=8,d+=S[i++]<<p,p+=8),b=g[d&_];r:for(;;){if(d>>>=y=b>>>24,p-=y,!(16&(y=b>>>16&255))){if(0==(64&y)){b=g[(65535&b)+(d&(1<<y)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(w=65535&b,p<(y&=15)&&(d+=S[i++]<<p,(p+=8)<y&&(d+=S[i++]<<p,p+=8)),h<(w+=d&(1<<y)-1)){t.msg="invalid distance too far back",r.mode=30;break t}if(d>>>=y,p-=y,(y=s-a)<w){if(l<(y=w-y)&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(M=f,(E=0)===c){if(E+=u-y,y<x){for(x-=y;A[s++]=f[E++],--y;);E=s-w,M=A}}else if(c<y){if(E+=u+c-y,(y-=c)<x){for(x-=y;A[s++]=f[E++],--y;);if(E=0,c<x){for(x-=y=c;A[s++]=f[E++],--y;);E=s-w,M=A}}}else if(E+=c-y,y<x){for(x-=y;A[s++]=f[E++],--y;);E=s-w,M=A}for(;2<x;)A[s++]=M[E++],A[s++]=M[E++],A[s++]=M[E++],x-=3;x&&(A[s++]=M[E++],1<x&&(A[s++]=M[E++]))}else{for(E=s-w;A[s++]=A[E++],A[s++]=A[E++],A[s++]=A[E++],2<(x-=3););x&&(A[s++]=A[E++],1<x&&(A[s++]=A[E++]))}break}}break}}while(i<n&&s<o);i-=x=p>>3,d&=(1<<(p-=x<<3))-1,t.next_in=i,t.next_out=s,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=s<o?o-s+257:257-(s-o),r.hold=d,r.bits=p}},{}],49:[function(t,e,r){var i=t("../utils/common"),n=t("./adler32"),s=t("./crc32"),a=t("./inffast"),o=t("./inftrees"),h=1,u=2,l=0,c=-2,f=1,d=852,p=592;function m(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=f,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(d),e.distcode=e.distdyn=new i.Buf32(p),e.sane=1,e.back=-1,l):c}function _(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,v(t)):c}function b(t,e){var r,i;return t&&t.state?(i=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?c:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,_(t))):c}function y(t,e){var r,i;return t?(i=new g,(t.state=i).window=null,(r=b(t,e))!==l&&(t.state=null),r):c}var x,w,E=!0;function M(t){if(E){var e;for(x=new i.Buf32(512),w=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(h,t.lens,0,288,x,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(u,t.lens,0,32,w,0,t.work,{bits:5}),E=!1}t.lencode=x,t.lenbits=9,t.distcode=w,t.distbits=5}function S(t,e,r,n){var s,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),n>=a.wsize?(i.arraySet(a.window,e,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(n<(s=a.wsize-a.wnext)&&(s=n),i.arraySet(a.window,e,r-n,s,a.wnext),(n-=s)?(i.arraySet(a.window,e,r-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}r.inflateReset=_,r.inflateReset2=b,r.inflateResetKeep=v,r.inflateInit=function(t){return y(t,15)},r.inflateInit2=y,r.inflate=function(t,e){var r,d,p,g,v,_,b,y,x,w,E,A,T,C,D,R,I,P,N,k,B,L,O,F,U=0,z=new i.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return c;12===(r=t.state).mode&&(r.mode=13),v=t.next_out,p=t.output,b=t.avail_out,g=t.next_in,d=t.input,_=t.avail_in,y=r.hold,x=r.bits,w=_,E=b,L=l;t:for(;;)switch(r.mode){case f:if(0===r.wrap){r.mode=13;break}for(;x<16;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(2&r.wrap&&35615===y){z[r.check=0]=255&y,z[1]=y>>>8&255,r.check=s(r.check,z,2,0),x=y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&y)<<8)+(y>>8))%31){t.msg="incorrect header check",r.mode=30;break}if(8!=(15&y)){t.msg="unknown compression method",r.mode=30;break}if(x-=4,B=8+(15&(y>>>=4)),0===r.wbits)r.wbits=B;else if(B>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<B,t.adler=r.check=1,r.mode=512&y?10:12,x=y=0;break;case 2:for(;x<16;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(r.flags=y,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=y>>8&1),512&r.flags&&(z[0]=255&y,z[1]=y>>>8&255,r.check=s(r.check,z,2,0)),x=y=0,r.mode=3;case 3:for(;x<32;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.head&&(r.head.time=y),512&r.flags&&(z[0]=255&y,z[1]=y>>>8&255,z[2]=y>>>16&255,z[3]=y>>>24&255,r.check=s(r.check,z,4,0)),x=y=0,r.mode=4;case 4:for(;x<16;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.head&&(r.head.xflags=255&y,r.head.os=y>>8),512&r.flags&&(z[0]=255&y,z[1]=y>>>8&255,r.check=s(r.check,z,2,0)),x=y=0,r.mode=5;case 5:if(1024&r.flags){for(;x<16;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.length=y,r.head&&(r.head.extra_len=y),512&r.flags&&(z[0]=255&y,z[1]=y>>>8&255,r.check=s(r.check,z,2,0)),x=y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(_<(A=r.length)&&(A=_),A&&(r.head&&(B=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),i.arraySet(r.head.extra,d,g,A,B)),512&r.flags&&(r.check=s(r.check,d,A,g)),_-=A,g+=A,r.length-=A),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===_)break t;for(A=0;B=d[g+A++],r.head&&B&&r.length<65536&&(r.head.name+=String.fromCharCode(B)),B&&A<_;);if(512&r.flags&&(r.check=s(r.check,d,A,g)),_-=A,g+=A,B)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===_)break t;for(A=0;B=d[g+A++],r.head&&B&&r.length<65536&&(r.head.comment+=String.fromCharCode(B)),B&&A<_;);if(512&r.flags&&(r.check=s(r.check,d,A,g)),_-=A,g+=A,B)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;x<16;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(y!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}x=y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;x<32;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}t.adler=r.check=m(y),x=y=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=v,t.avail_out=b,t.next_in=g,t.avail_in=_,r.hold=y,r.bits=x,2;t.adler=r.check=1,r.mode=12;case 12:if(5===e||6===e)break t;case 13:if(r.last){y>>>=7&x,x-=7&x,r.mode=27;break}for(;x<3;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}switch(r.last=1&y,x-=1,3&(y>>>=1)){case 0:r.mode=14;break;case 1:if(M(r),r.mode=20,6!==e)break;y>>>=2,x-=2;break t;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}y>>>=2,x-=2;break;case 14:for(y>>>=7&x,x-=7&x;x<32;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if((65535&y)!=(y>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&y,x=y=0,r.mode=15,6===e)break t;case 15:r.mode=16;case 16:if(A=r.length){if(_<A&&(A=_),b<A&&(A=b),0===A)break t;i.arraySet(p,d,g,A,v),_-=A,g+=A,b-=A,v+=A,r.length-=A;break}r.mode=12;break;case 17:for(;x<14;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(r.nlen=257+(31&y),y>>>=5,x-=5,r.ndist=1+(31&y),y>>>=5,x-=5,r.ncode=4+(15&y),y>>>=4,x-=4,286<r.nlen||30<r.ndist){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;x<3;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.lens[G[r.have++]]=7&y,y>>>=3,x-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},L=o(0,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,L){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;R=(U=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,I=65535&U,!((D=U>>>24)<=x);){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(I<16)y>>>=D,x-=D,r.lens[r.have++]=I;else{if(16===I){for(F=D+2;x<F;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(y>>>=D,x-=D,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}B=r.lens[r.have-1],A=3+(3&y),y>>>=2,x-=2}else if(17===I){for(F=D+3;x<F;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}x-=D,B=0,A=3+(7&(y>>>=D)),y>>>=3,x-=3}else{for(F=D+7;x<F;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}x-=D,B=0,A=11+(127&(y>>>=D)),y>>>=7,x-=7}if(r.have+A>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;A--;)r.lens[r.have++]=B}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,O={bits:r.lenbits},L=o(h,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,L){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},L=o(u,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,L){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===e)break t;case 20:r.mode=21;case 21:if(6<=_&&258<=b){t.next_out=v,t.avail_out=b,t.next_in=g,t.avail_in=_,r.hold=y,r.bits=x,a(t,E),v=t.next_out,p=t.output,b=t.avail_out,g=t.next_in,d=t.input,_=t.avail_in,y=r.hold,x=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;R=(U=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,I=65535&U,!((D=U>>>24)<=x);){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(R&&0==(240&R)){for(P=D,N=R,k=I;R=(U=r.lencode[k+((y&(1<<P+N)-1)>>P)])>>>16&255,I=65535&U,!(P+(D=U>>>24)<=x);){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}y>>>=P,x-=P,r.back+=P}if(y>>>=D,x-=D,r.back+=D,r.length=I,0===R){r.mode=26;break}if(32&R){r.back=-1,r.mode=12;break}if(64&R){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&R,r.mode=22;case 22:if(r.extra){for(F=r.extra;x<F;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.length+=y&(1<<r.extra)-1,y>>>=r.extra,x-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;R=(U=r.distcode[y&(1<<r.distbits)-1])>>>16&255,I=65535&U,!((D=U>>>24)<=x);){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(0==(240&R)){for(P=D,N=R,k=I;R=(U=r.distcode[k+((y&(1<<P+N)-1)>>P)])>>>16&255,I=65535&U,!(P+(D=U>>>24)<=x);){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}y>>>=P,x-=P,r.back+=P}if(y>>>=D,x-=D,r.back+=D,64&R){t.msg="invalid distance code",r.mode=30;break}r.offset=I,r.extra=15&R,r.mode=24;case 24:if(r.extra){for(F=r.extra;x<F;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}r.offset+=y&(1<<r.extra)-1,y>>>=r.extra,x-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===b)break t;if(A=E-b,r.offset>A){if((A=r.offset-A)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}T=A>r.wnext?(A-=r.wnext,r.wsize-A):r.wnext-A,A>r.length&&(A=r.length),C=r.window}else C=p,T=v-r.offset,A=r.length;for(b<A&&(A=b),b-=A,r.length-=A;p[v++]=C[T++],--A;);0===r.length&&(r.mode=21);break;case 26:if(0===b)break t;p[v++]=r.length,b--,r.mode=21;break;case 27:if(r.wrap){for(;x<32;){if(0===_)break t;_--,y|=d[g++]<<x,x+=8}if(E-=b,t.total_out+=E,r.total+=E,E&&(t.adler=r.check=r.flags?s(r.check,p,E,v-E):n(r.check,p,E,v-E)),E=b,(r.flags?y:m(y))!==r.check){t.msg="incorrect data check",r.mode=30;break}x=y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;x<32;){if(0===_)break t;_--,y+=d[g++]<<x,x+=8}if(y!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}x=y=0}r.mode=29;case 29:L=1;break t;case 30:L=-3;break t;case 31:return-4;default:return c}return t.next_out=v,t.avail_out=b,t.next_in=g,t.avail_in=_,r.hold=y,r.bits=x,(r.wsize||E!==t.avail_out&&r.mode<30&&(r.mode<27||4!==e))&&S(t,t.output,t.next_out,E-t.avail_out)?(r.mode=31,-4):(w-=t.avail_in,E-=t.avail_out,t.total_in+=w,t.total_out+=E,r.total+=E,r.wrap&&E&&(t.adler=r.check=r.flags?s(r.check,p,E,t.next_out-E):n(r.check,p,E,t.next_out-E)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==w&&0===E||4===e)&&L===l&&(L=-5),L)},r.inflateEnd=function(t){if(!t||!t.state)return c;var e=t.state;return e.window&&(e.window=null),t.state=null,l},r.inflateGetHeader=function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?c:((r.head=e).done=!1,l):c},r.inflateSetDictionary=function(t,e){var r,i=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?c:11===r.mode&&n(1,e,i,0)!==r.check?-3:S(t,e,i,i)?(r.mode=31,-4):(r.havedict=1,l):c},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,r){var i=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,h,u,l,c,f){var d,p,m,g,v,_,b,y,x,w=f.bits,E=0,M=0,S=0,A=0,T=0,C=0,D=0,R=0,I=0,P=0,N=null,k=0,B=new i.Buf16(16),L=new i.Buf16(16),O=null,F=0;for(E=0;E<=15;E++)B[E]=0;for(M=0;M<h;M++)B[e[r+M]]++;for(T=w,A=15;1<=A&&0===B[A];A--);if(A<T&&(T=A),0===A)return u[l++]=20971520,u[l++]=20971520,f.bits=1,0;for(S=1;S<A&&0===B[S];S++);for(T<S&&(T=S),E=R=1;E<=15;E++)if(R<<=1,(R-=B[E])<0)return-1;if(0<R&&(0===t||1!==A))return-1;for(L[1]=0,E=1;E<15;E++)L[E+1]=L[E]+B[E];for(M=0;M<h;M++)0!==e[r+M]&&(c[L[e[r+M]]++]=M);if(_=0===t?(N=O=c,19):1===t?(N=n,k-=257,O=s,F-=257,256):(N=a,O=o,-1),E=S,v=l,D=M=P=0,m=-1,g=(I=1<<(C=T))-1,1===t&&852<I||2===t&&592<I)return 1;for(;;){for(b=E-D,x=c[M]<_?(y=0,c[M]):c[M]>_?(y=O[F+c[M]],N[k+c[M]]):(y=96,0),d=1<<E-D,S=p=1<<C;u[v+(P>>D)+(p-=d)]=b<<24|y<<16|x|0,0!==p;);for(d=1<<E-1;P&d;)d>>=1;if(0!==d?(P&=d-1,P+=d):P=0,M++,0==--B[E]){if(E===A)break;E=e[r+c[M]]}if(T<E&&(P&g)!==m){for(0===D&&(D=T),v+=S,R=1<<(C=E-D);C+D<A&&!((R-=B[C+D])<=0);)C++,R<<=1;if(I+=1<<C,1===t&&852<I||2===t&&592<I)return 1;u[m=P&g]=T<<24|C<<16|v-l|0}}return 0!==P&&(u[v+P]=E-D<<24|4194304),f.bits=T,0}},{"../utils/common":41}],51:[function(t,e,r){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,r){var i=t("../utils/common"),n=0,s=1;function a(t){for(var e=t.length;0<=--e;)t[e]=0}var o=0,h=29,u=256,l=u+1+h,c=30,f=19,d=2*l+1,p=15,m=16,g=7,v=256,_=16,b=17,y=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(2*(l+2));a(S);var A=new Array(2*c);a(A);var T=new Array(512);a(T);var C=new Array(256);a(C);var D=new Array(h);a(D);var R,I,P,N=new Array(c);function k(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}function B(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function L(t){return t<256?T[t]:T[256+(t>>>7)]}function O(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function F(t,e,r){t.bi_valid>m-r?(t.bi_buf|=e<<t.bi_valid&65535,O(t,t.bi_buf),t.bi_buf=e>>m-t.bi_valid,t.bi_valid+=r-m):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function U(t,e,r){F(t,r[2*e],r[2*e+1])}function z(t,e){for(var r=0;r|=1&t,t>>>=1,r<<=1,0<--e;);return r>>>1}function G(t,e,r){var i,n,s=new Array(p+1),a=0;for(i=1;i<=p;i++)s[i]=a=a+r[i-1]<<1;for(n=0;n<=e;n++){var o=t[2*n+1];0!==o&&(t[2*n]=z(s[o]++,o))}}function H(t){var e;for(e=0;e<l;e++)t.dyn_ltree[2*e]=0;for(e=0;e<c;e++)t.dyn_dtree[2*e]=0;for(e=0;e<f;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*v]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function j(t){8<t.bi_valid?O(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function V(t,e,r,i){var n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function W(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&V(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!V(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function q(t,e,r){var i,n,s,a,o=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],n=t.pending_buf[t.l_buf+o],o++,0===i?U(t,n,e):(U(t,(s=C[n])+u+1,e),0!==(a=x[s])&&F(t,n-=D[s],a),U(t,s=L(--i),r),0!==(a=w[s])&&F(t,i-=N[s],a)),o<t.last_lit;);U(t,v,e)}function X(t,e){var r,i,n,s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,h=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=d,r=0;r<h;r++)0!==s[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):s[2*r+1]=0;for(;t.heap_len<2;)s[2*(n=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[n]=0,t.opt_len--,o&&(t.static_len-=a[2*n+1]);for(e.max_code=u,r=t.heap_len>>1;1<=r;r--)W(t,s,r);for(n=h;r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],W(t,s,1),i=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=i,s[2*n]=s[2*r]+s[2*i],t.depth[n]=(t.depth[r]>=t.depth[i]?t.depth[r]:t.depth[i])+1,s[2*r+1]=s[2*i+1]=n,t.heap[1]=n++,W(t,s,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,i,n,s,a,o,h=e.dyn_tree,u=e.max_code,l=e.stat_desc.static_tree,c=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,m=e.stat_desc.extra_base,g=e.stat_desc.max_length,v=0;for(s=0;s<=p;s++)t.bl_count[s]=0;for(h[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<d;r++)g<(s=h[2*h[2*(i=t.heap[r])+1]+1]+1)&&(s=g,v++),h[2*i+1]=s,u<i||(t.bl_count[s]++,a=0,m<=i&&(a=f[i-m]),o=h[2*i],t.opt_len+=o*(s+a),c&&(t.static_len+=o*(l[2*i+1]+a)));if(0!==v){do{for(s=g-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[g]--,v-=2}while(0<v);for(s=g;0!==s;s--)for(i=t.bl_count[s];0!==i;)u<(n=t.heap[--r])||(h[2*n+1]!==s&&(t.opt_len+=(s-h[2*n+1])*h[2*n],h[2*n+1]=s),i--)}}(t,e),G(s,u,t.bl_count)}function Y(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=a,a=e[2*(i+1)+1],++o<h&&n===a||(o<u?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*_]++):o<=10?t.bl_tree[2*b]++:t.bl_tree[2*y]++,s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4))}function Z(t,e,r){var i,n,s=-1,a=e[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),i=0;i<=r;i++)if(n=a,a=e[2*(i+1)+1],!(++o<h&&n===a)){if(o<u)for(;U(t,n,t.bl_tree),0!=--o;);else 0!==n?(n!==s&&(U(t,n,t.bl_tree),o--),U(t,_,t.bl_tree),F(t,o-3,2)):o<=10?(U(t,b,t.bl_tree),F(t,o-3,3)):(U(t,y,t.bl_tree),F(t,o-11,7));s=n,u=(o=0)===a?(h=138,3):n===a?(h=6,3):(h=7,4)}}a(N);var $=!1;function K(t,e,r,n){F(t,(o<<1)+(n?1:0),3),function(t,e,r,n){j(t),n&&(O(t,r),O(t,~r)),i.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}r._tr_init=function(t){$||(function(){var t,e,r,i,n,s=new Array(p+1);for(i=r=0;i<h-1;i++)for(D[i]=r,t=0;t<1<<x[i];t++)C[r++]=i;for(C[r-1]=i,i=n=0;i<16;i++)for(N[i]=n,t=0;t<1<<w[i];t++)T[n++]=i;for(n>>=7;i<c;i++)for(N[i]=n<<7,t=0;t<1<<w[i]-7;t++)T[256+n++]=i;for(e=0;e<=p;e++)s[e]=0;for(t=0;t<=143;)S[2*t+1]=8,t++,s[8]++;for(;t<=255;)S[2*t+1]=9,t++,s[9]++;for(;t<=279;)S[2*t+1]=7,t++,s[7]++;for(;t<=287;)S[2*t+1]=8,t++,s[8]++;for(G(S,l+1,s),t=0;t<c;t++)A[2*t+1]=5,A[2*t]=z(t,5);R=new k(S,x,u+1,l,p),I=new k(A,w,0,c,p),P=new k(new Array(0),E,0,f,g)}(),$=!0),t.l_desc=new B(t.dyn_ltree,R),t.d_desc=new B(t.dyn_dtree,I),t.bl_desc=new B(t.bl_tree,P),t.bi_buf=0,t.bi_valid=0,H(t)},r._tr_stored_block=K,r._tr_flush_block=function(t,e,r,i){var a,o,h=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return n;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<u;e++)if(0!==t.dyn_ltree[2*e])return s;return n}(t)),X(t,t.l_desc),X(t,t.d_desc),h=function(t){var e;for(Y(t,t.dyn_ltree,t.l_desc.max_code),Y(t,t.dyn_dtree,t.d_desc.max_code),X(t,t.bl_desc),e=f-1;3<=e&&0===t.bl_tree[2*M[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),a=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=a&&(a=o)):a=o=r+5,r+4<=a&&-1!==e?K(t,e,r,i):4===t.strategy||o===a?(F(t,2+(i?1:0),3),q(t,S,A)):(F(t,4+(i?1:0),3),function(t,e,r,i){var n;for(F(t,e-257,5),F(t,r-1,5),F(t,i-4,4),n=0;n<i;n++)F(t,t.bl_tree[2*M[n]+1],3);Z(t,t.dyn_ltree,e-1),Z(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),q(t,t.dyn_ltree,t.dyn_dtree)),H(t),i&&j(t)},r._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(C[r]+u+1)]++,t.dyn_dtree[2*L(e)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){F(t,2,3),U(t,v,S),function(t){16===t.bi_valid?(O(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,r){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,r){e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)},560:()=>{HTMLCanvasElement.prototype.toBlob||(HTMLCanvasElement.prototype.toBlob=function(t,e,r){var i=this.toDataURL(e,r).split(",")[1];setTimeout((function(){for(var r=atob(i),n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);t(new Blob([s],{type:e||"image/png"}))}))})},650:(t,e,r)=>{function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}r.r(e),r.d(e,{default:()=>f});var a,o,h,u,l,c=(a=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],o=function(){function t(e){var r=e.targetModal,i=e.triggers,s=void 0===i?[]:i,a=e.onShow,o=void 0===a?function(){}:a,h=e.onClose,u=void 0===h?function(){}:h,l=e.openTrigger,c=void 0===l?"data-micromodal-trigger":l,f=e.closeTrigger,d=void 0===f?"data-micromodal-close":f,p=e.openClass,m=void 0===p?"is-open":p,g=e.disableScroll,v=void 0!==g&&g,_=e.disableFocus,b=void 0!==_&&_,y=e.awaitCloseAnimation,x=void 0!==y&&y,w=e.awaitOpenAnimation,E=void 0!==w&&w,M=e.debugMode,S=void 0!==M&&M;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.modal=document.getElementById(r),this.config={debugMode:S,disableScroll:v,openTrigger:c,closeTrigger:d,openClass:m,onShow:o,onClose:u,awaitCloseAnimation:x,awaitOpenAnimation:E,disableFocus:b},s.length>0&&this.registerTriggers.apply(this,n(s)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var e,r,s;return e=t,r=[{key:"registerTriggers",value:function(){for(var t=this,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];r.filter(Boolean).forEach((function(e){e.addEventListener("click",(function(e){return t.showModal(e)}))}))}},{key:"showModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var r=function e(){t.modal.removeEventListener("animationend",e,!1),t.setFocusToFirstNode()};this.modal.addEventListener("animationend",r,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,e)}},{key:"closeModal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,t),this.config.awaitCloseAnimation){var r=this.config.openClass;this.modal.addEventListener("animationend",(function t(){e.classList.remove(r),e.removeEventListener("animationend",t,!1)}),!1)}else e.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(t){this.modal=document.getElementById(t),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(t){if(this.config.disableScroll){var e=document.querySelector("body");switch(t){case"enable":Object.assign(e.style,{overflow:""});break;case"disable":Object.assign(e.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(t){t.target.hasAttribute(this.config.closeTrigger)&&this.closeModal(t)}},{key:"onKeydown",value:function(t){27===t.keyCode&&this.closeModal(t),9===t.keyCode&&this.retainFocus(t)}},{key:"getFocusableNodes",value:function(){var t=this.modal.querySelectorAll(a);return Array.apply(void 0,n(t))}},{key:"setFocusToFirstNode",value:function(){var t=this;if(!this.config.disableFocus){var e=this.getFocusableNodes();if(0!==e.length){var r=e.filter((function(e){return!e.hasAttribute(t.config.closeTrigger)}));r.length>0&&r[0].focus(),0===r.length&&e[0].focus()}}}},{key:"retainFocus",value:function(t){var e=this.getFocusableNodes();if(0!==e.length)if(e=e.filter((function(t){return null!==t.offsetParent})),this.modal.contains(document.activeElement)){var r=e.indexOf(document.activeElement);t.shiftKey&&0===r&&(e[e.length-1].focus(),t.preventDefault()),!t.shiftKey&&e.length>0&&r===e.length-1&&(e[0].focus(),t.preventDefault())}else e[0].focus()}}],r&&i(e.prototype,r),s&&i(e,s),t}(),h=null,u=function(t){if(!document.getElementById(t))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(t,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(t,'"></div>')),!1},l=function(t,e){if(function(t){t.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(t),!e)return!0;for(var r in e)u(r);return!0},{init:function(t){var e=Object.assign({},{openTrigger:"data-micromodal-trigger"},t),r=n(document.querySelectorAll("[".concat(e.openTrigger,"]"))),i=function(t,e){var r=[];return t.forEach((function(t){var i=t.attributes[e].value;void 0===r[i]&&(r[i]=[]),r[i].push(t)})),r}(r,e.openTrigger);if(!0!==e.debugMode||!1!==l(r,i))for(var s in i){var a=i[s];e.targetModal=s,e.triggers=n(a),h=new o(e)}},show:function(t,e){var r=e||{};r.targetModal=t,!0===r.debugMode&&!1===u(t)||(h&&h.removeEventListeners(),(h=new o(r)).showModal())},close:function(t){t?h.closeModalById(t):h.closeModal()}});window.MicroModal=c;const f=c},57:(t,e,r)=>{r.r(e),r.d(e,{default:()=>i});const i="(function(b){function a(b,d){if({}.hasOwnProperty.call(a.cache,b))return a.cache[b];var e=a.resolve(b);if(!e)throw new Error('Failed to resolve module '+b);var c={id:b,require:a,filename:b,exports:{},loaded:!1,parent:d,children:[]};d&&d.children.push(c);var f=b.slice(0,b.lastIndexOf('/')+1);return a.cache[b]=c.exports,e.call(c.exports,c,c.exports,f,b),c.loaded=!0,a.cache[b]=c.exports}a.modules={},a.cache={},a.resolve=function(b){return{}.hasOwnProperty.call(a.modules,b)?a.modules[b]:void 0},a.define=function(b,c){a.modules[b]=c},a.define('/gif.worker.coffee',function(d,e,f,g){var b,c;b=a('/GIFEncoder.js',d),c=function(a){var c,e,d,f;return c=new b(a.width,a.height),a.index===0?c.writeHeader():c.firstFrame=!1,c.setTransparent(a.transparent),c.setRepeat(a.repeat),c.setDelay(a.delay),c.setQuality(a.quality),c.addFrame(a.data),a.last&&c.finish(),d=c.stream(),a.data=d.pages,a.cursor=d.cursor,a.pageSize=d.constructor.pageSize,a.canTransfer?(f=function(c){for(var b=0,d=a.data.length;b<d;++b)e=a.data[b],c.push(e.buffer);return c}.call(this,[]),self.postMessage(a,f)):self.postMessage(a)},self.onmessage=function(a){return c(a.data)}}),a.define('/GIFEncoder.js',function(e,h,i,j){function c(){this.page=-1,this.pages=[],this.newPage()}function b(a,b){this.width=~~a,this.height=~~b,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.out=new c}var f=a('/TypedNeuQuant.js',e),g=a('/LZWEncoder.js',e);c.pageSize=4096,c.charMap={};for(var d=0;d<256;d++)c.charMap[d]=String.fromCharCode(d);c.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(c.pageSize),this.cursor=0},c.prototype.getData=function(){var d='';for(var a=0;a<this.pages.length;a++)for(var b=0;b<c.pageSize;b++)d+=c.charMap[this.pages[a][b]];return d},c.prototype.writeByte=function(a){this.cursor>=c.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a},c.prototype.writeUTFBytes=function(b){for(var c=b.length,a=0;a<c;a++)this.writeByte(b.charCodeAt(a))},c.prototype.writeBytes=function(b,d,e){for(var c=e||b.length,a=d||0;a<c;a++)this.writeByte(b[a])},b.prototype.setDelay=function(a){this.delay=Math.round(a/10)},b.prototype.setFrameRate=function(a){this.delay=Math.round(100/a)},b.prototype.setDispose=function(a){a>=0&&(this.dispose=a)},b.prototype.setRepeat=function(a){this.repeat=a},b.prototype.setTransparent=function(a){this.transparent=a},b.prototype.addFrame=function(a){this.image=a,this.getImagePixels(),this.analyzePixels(),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.writePixels(),this.firstFrame=!1},b.prototype.finish=function(){this.out.writeByte(59)},b.prototype.setQuality=function(a){a<1&&(a=1),this.sample=a},b.prototype.writeHeader=function(){this.out.writeUTFBytes('GIF89a')},b.prototype.analyzePixels=function(){var g=this.pixels.length,d=g/3;this.indexedPixels=new Uint8Array(d);var a=new f(this.pixels,this.sample);a.buildColormap(),this.colorTab=a.getColormap();var b=0;for(var c=0;c<d;c++){var e=a.lookupRGB(this.pixels[b++]&255,this.pixels[b++]&255,this.pixels[b++]&255);this.usedEntry[e]=!0,this.indexedPixels[c]=e}this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent))},b.prototype.findClosest=function(e){if(this.colorTab===null)return-1;var k=(e&16711680)>>16,l=(e&65280)>>8,m=e&255,c=0,d=16777216,j=this.colorTab.length;for(var a=0;a<j;){var f=k-(this.colorTab[a++]&255),g=l-(this.colorTab[a++]&255),h=m-(this.colorTab[a]&255),i=f*f+g*g+h*h,b=parseInt(a/3);this.usedEntry[b]&&i<d&&(d=i,c=b),a++}return c},b.prototype.getImagePixels=function(){var a=this.width,g=this.height;this.pixels=new Uint8Array(a*g*3);var b=this.image,c=0;for(var d=0;d<g;d++)for(var e=0;e<a;e++){var f=d*a*4+e*4;this.pixels[c++]=b[f],this.pixels[c++]=b[f+1],this.pixels[c++]=b[f+2]}},b.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var b,a;this.transparent===null?(b=0,a=0):(b=1,a=2),this.dispose>=0&&(a=dispose&7),a<<=2,this.out.writeByte(0|a|0|b),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},b.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},b.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},b.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes('NETSCAPE2.0'),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},b.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);var b=768-this.colorTab.length;for(var a=0;a<b;a++)this.out.writeByte(0)},b.prototype.writeShort=function(a){this.out.writeByte(a&255),this.out.writeByte(a>>8&255)},b.prototype.writePixels=function(){var a=new g(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)},b.prototype.stream=function(){return this.out},e.exports=b}),a.define('/LZWEncoder.js',function(e,g,h,i){function f(y,D,C,B){function w(a,b){r[f++]=a,f>=254&&t(b)}function x(b){u(a),k=i+2,j=!0,l(i,b)}function u(b){for(var a=0;a<b;++a)h[a]=-1}function A(z,r){var g,t,d,e,y,w,s;for(q=z,j=!1,n_bits=q,m=p(n_bits),i=1<<z-1,o=i+1,k=i+2,f=0,e=v(),s=0,g=a;g<65536;g*=2)++s;s=8-s,w=a,u(w),l(i,r);a:while((t=v())!=c){if(g=(t<<b)+e,d=t<<s^e,h[d]===g){e=n[d];continue}if(h[d]>=0){y=w-d,d===0&&(y=1);do if((d-=y)<0&&(d+=w),h[d]===g){e=n[d];continue a}while(h[d]>=0)}l(e,r),e=t,k<1<<b?(n[d]=k++,h[d]=g):x(r)}l(e,r),l(o,r)}function z(a){a.writeByte(s),remaining=y*D,curPixel=0,A(s+1,a),a.writeByte(0)}function t(a){f>0&&(a.writeByte(f),a.writeBytes(r,0,f),f=0)}function p(a){return(1<<a)-1}function v(){if(remaining===0)return c;--remaining;var a=C[curPixel++];return a&255}function l(a,c){g&=d[e],e>0?g|=a<<e:g=a,e+=n_bits;while(e>=8)w(g&255,c),g>>=8,e-=8;if((k>m||j)&&(j?(m=p(n_bits=q),j=!1):(++n_bits,n_bits==b?m=1<<b:m=p(n_bits))),a==o){while(e>0)w(g&255,c),g>>=8,e-=8;t(c)}}var s=Math.max(2,B),r=new Uint8Array(256),h=new Int32Array(a),n=new Int32Array(a),g,e=0,f,k=0,m,j=!1,q,i,o;this.encode=z}var c=-1,b=12,a=5003,d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=f}),a.define('/TypedNeuQuant.js',function(A,F,E,D){function C(A,B){function I(){o=[],q=new Int32Array(256),t=new Int32Array(a),y=new Int32Array(a),z=new Int32Array(a>>3);var c,d;for(c=0;c<a;c++)d=(c<<b+8)/a,o[c]=new Float64Array([d,d,d,0]),y[c]=e/a,t[c]=0}function J(){for(var c=0;c<a;c++)o[c][0]>>=b,o[c][1]>>=b,o[c][2]>>=b,o[c][3]=c}function K(b,a,c,e,f){o[a][0]-=b*(o[a][0]-c)/d,o[a][1]-=b*(o[a][1]-e)/d,o[a][2]-=b*(o[a][2]-f)/d}function L(j,e,n,l,k){var h=Math.abs(e-j),i=Math.min(e+j,a),g=e+1,f=e-1,m=1,b,d;while(g<i||f>h)d=z[m++],g<i&&(b=o[g++],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c),f>h&&(b=o[f--],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c)}function C(p,s,q){var h=2147483647,k=h,d=-1,m=d,c,j,e,n,l;for(c=0;c<a;c++)j=o[c],e=Math.abs(j[0]-p)+Math.abs(j[1]-s)+Math.abs(j[2]-q),e<h&&(h=e,d=c),n=e-(t[c]>>i-b),n<k&&(k=n,m=c),l=y[c]>>g,y[c]-=l,t[c]+=l<<f;return y[d]+=x,t[d]-=r,m}function D(){var d,b,e,c,h,g,f=0,i=0;for(d=0;d<a;d++){for(e=o[d],h=d,g=e[1],b=d+1;b<a;b++)c=o[b],c[1]<g&&(h=b,g=c[1]);if(c=o[h],d!=h&&(b=c[0],c[0]=e[0],e[0]=b,b=c[1],c[1]=e[1],e[1]=b,b=c[2],c[2]=e[2],e[2]=b,b=c[3],c[3]=e[3],e[3]=b),g!=f){for(q[f]=i+d>>1,b=f+1;b<g;b++)q[b]=d;f=g,i=d}}for(q[f]=i+n>>1,b=f+1;b<256;b++)q[b]=n}function E(j,i,k){var b,d,c,e=1e3,h=-1,f=q[i],g=f-1;while(f<a||g>=0)f<a&&(d=o[f],c=d[1]-i,c>=e?f=a:(f++,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3])))),g>=0&&(d=o[g],c=i-d[1],c>=e?g=-1:(g--,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3]))));return h}function F(){var c,f=A.length,D=30+(B-1)/3,y=f/(3*B),q=~~(y/w),n=d,o=u,a=o>>h;for(a<=1&&(a=0),c=0;c<a;c++)z[c]=n*((a*a-c*c)*m/(a*a));var i;f<s?(B=1,i=3):f%l!==0?i=3*l:f%k!==0?i=3*k:f%p!==0?i=3*p:i=3*j;var r,t,x,e,g=0;c=0;while(c<y)if(r=(A[g]&255)<<b,t=(A[g+1]&255)<<b,x=(A[g+2]&255)<<b,e=C(r,t,x),K(n,e,r,t,x),a!==0&&L(a,e,r,t,x),g+=i,g>=f&&(g-=f),c++,q===0&&(q=1),c%q===0)for(n-=n/D,o-=o/v,a=o>>h,a<=1&&(a=0),e=0;e<a;e++)z[e]=n*((a*a-e*e)*m/(a*a))}function G(){I(),F(),J(),D()}function H(){var b=[],g=[];for(var c=0;c<a;c++)g[o[c][3]]=c;var d=0;for(var e=0;e<a;e++){var f=g[e];b[d++]=o[f][0],b[d++]=o[f][1],b[d++]=o[f][2]}return b}var o,q,t,y,z;this.buildColormap=G,this.getColormap=H,this.lookupRGB=E}var w=100,a=256,n=a-1,b=4,i=16,e=1<<i,f=10,B=1<<f,g=10,x=e>>g,r=e<<f-g,z=a>>3,h=6,t=1<<h,u=z*t,v=30,o=10,d=1<<o,q=8,m=1<<q,y=o+q,c=1<<y,l=499,k=491,p=487,j=503,s=3*j;A.exports=C}),a('/gif.worker.coffee')}.call(this,this))\r\n//# sourceMappingURL=gif.worker.js.map\r\n// gif.worker.js 0.1.6 - https://github.com/jnordberg/gif.js"},72:function(t,e,r){var i,n;i=function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(e,r.firstChild);for(var i,n=document.createElement("a"),s=1;s<t;s++)n.href=arguments[s],i=n.href,e.href=i;return r.removeChild(e),i}return t},void 0!==(n="function"==typeof i?i.call(e,r,e,t):i)&&(t.exports=n)},914:function(t,e,r){var i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},i.apply(this,arguments)},n=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(n,s){function a(t){try{h(i.next(t))}catch(t){s(t)}}function o(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,o)}h((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var r,i,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var i,n=0,s=e.length;n<s;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.browserSupportsGIF=e.browserSupportsMP4=e.browserSupportsWEBM=e.checkHotkeys=e.isRecording=e.stopRecord=e.recordFrame=e.takeJPEGSnapshot=e.takePNGSnapshot=e.beginJPEGFramesRecord=e.beginPNGFramesRecord=e.beginGIFRecord=e.beginVideoRecord=e.bindKeyToJPEGSnapshot=e.bindKeyToPNGSnapshot=e.bindKeyToJPEGFramesRecord=e.bindKeyToPNGFramesRecord=e.bindKeyToGIFRecord=e.bindKeyToVideoRecord=e.setVerbose=e.dispose=e.init=e.MP4=e.WEBM=e.showDialog=void 0;var o=r(886),h=r(162);r(560);var u,l=r(809),c=r(848),f=r(330),d=r(57),p=r(733),m=URL.createObjectURL(new Blob([d.default])),g=void 0,v=r(330);Object.defineProperty(e,"showDialog",{enumerable:!0,get:function(){return v.showDialog}});var _="gif";e.WEBM="webm",e.MP4="mp4";var b="jpegzip",y="pngzip",x="jpeg",w="png",E=[],M=(o.default,[]),S={},A={},T=null;function C(t){M.push({key:t.key}),c.PARAMS.IS_MANUALLY_CHECKING_HOTKEYS||N()}function D(){if(E.length){(0,f.showWarning)("Don't resize while recording canvas!")}}function R(t){c.PARAMS.VERBOSE=!!t,g&&g.setLogging(c.PARAMS.VERBOSE)}function I(){if(null===T)throw new Error("No canvas supplied, please call CanvasCapture.init() and pass in canvas element.")}function P(t,e){Object.keys(A).forEach((function(e){A[e]===t&&delete A[e]})),A[e]=t}function N(){for(var t,r,i=0;i<M.length;i++){var n=M[i].key;if(A.mp4&&n===A[e.MP4]){var s=q(e.MP4);if(s.length)W(s);else{if(!Q()){var a="This browser does not support MP4 video recording, please try again in Chrome.";(h=null===(t=S[e.MP4])||void 0===t?void 0:t.onError)&&h(new Error(a)),(0,f.showWarning)(a)}B(S[e.MP4])}}if(A.webm&&n===A[e.WEBM]){var o=q(e.WEBM);if(o.length)W(o);else{if(!J()){var h;a="This browser does not support WEBM video recording, please try again in Chrome.";(h=null===(r=S[e.WEBM])||void 0===r?void 0:r.onError)&&h(new Error(a)),(0,f.showWarning)(a)}B(S[e.WEBM])}}if(A.gif&&n===A[_]){var u=q(_);u.length?W(u):L(S[_])}if(A.pngzip&&n===A[y]){var l=q(y);l.length?W(l):O(S[y])}if(A.jpegzip&&n===A[b]){var c=q(b);c.length?W(c):F(S[b])}A.png&&n===A[w]&&G(S[w]),A.jpeg&&n===A[x]&&H(S[x])}M.length=0}function k(t){E.push(t),t.type!==y&&t.type!==b&&t.capturer.start(),(0,f.showDot)(Y())}function B(t){try{var r=(null==t?void 0:t.format)||e.MP4;if(r===e.MP4){if(!Q()){var i="This browser does not support MP4 video recording, please try again in Chrome.";throw(0,f.showWarning)(i),new Error(i)}}else{if(r!==e.WEBM)throw new Error("invalid video format ".concat(r,"."));if(!J()){i="This browser does not support WEBM video recording, please try again in Chrome.";throw(0,f.showWarning)(i),new Error(i)}}if(X().length){i="CCapture.js only supports one video/gif capture at a time.";throw(0,f.showWarning)(i),new Error(i)}var n=1;t&&t.quality&&(n=t.quality);var s=(null==t?void 0:t.name)||"Video_Capture",a={name:s,capturer:new window.CCapture({format:e.WEBM,name:s,framerate:(null==t?void 0:t.fps)||60,quality:100*n,verbose:c.PARAMS.VERBOSE}),numFrames:0,type:r,ffmpegOptions:null==t?void 0:t.ffmpegOptions,onExportProgress:null==t?void 0:t.onExportProgress,onExport:null==t?void 0:t.onExport,onExportFinish:null==t?void 0:t.onExportFinish,onError:null==t?void 0:t.onError};return k(a),a}catch(e){if(!(null==t?void 0:t.onError))throw e;t.onError(e)}}function L(t){try{if(X().length){var e="CCapture.js only supports one video/gif capture at a time.";throw(0,f.showWarning)(e),new Error(e)}var r=100;t&&t.quality&&(r=100*t.quality);var i=(null==t?void 0:t.name)||"GIF_Capture",n={name:i,capturer:new window.CCapture({format:_,name:i,framerate:(null==t?void 0:t.fps)||60,workersPath:m,quality:r,verbose:c.PARAMS.VERBOSE,onProgress:null==t?void 0:t.onExportProgress}),numFrames:0,type:_,onExport:null==t?void 0:t.onExport,onExportFinish:null==t?void 0:t.onExportFinish,onError:null==t?void 0:t.onError};return k(n),n}catch(e){if(!(null==t?void 0:t.onError))throw e;t.onError(e)}}function O(t){try{var e={name:(null==t?void 0:t.name)||"PNG_Frames_Capture",zipOptions:{dpi:null==t?void 0:t.dpi},zipPromises:[],capturer:new p,numFrames:0,type:y,onExportProgress:null==t?void 0:t.onExportProgress,onExport:null==t?void 0:t.onExport,onExportFinish:null==t?void 0:t.onExportFinish,onError:null==t?void 0:t.onError};return k(e),e}catch(e){if(!(null==t?void 0:t.onError))throw e;t.onError(e)}}function F(t){try{var e={name:(null==t?void 0:t.name)||"JPEG_Frames_Capture",zipOptions:{dpi:null==t?void 0:t.dpi,quality:null==t?void 0:t.quality},zipPromises:[],capturer:new p,numFrames:0,type:b,onExportProgress:null==t?void 0:t.onExportProgress,onExport:null==t?void 0:t.onExport,onExportFinish:null==t?void 0:t.onExportFinish,onError:null==t?void 0:t.onError};return k(e),e}catch(e){if(!(null==t?void 0:t.onError))throw e;t.onError(e)}}function U(t,e,r){return n(this,void 0,void 0,(function(){return s(this,(function(i){return[2,new Promise((function(i){t.toBlob((function(t){i(t)}),"image/".concat(e),r)}))]}))}))}function z(t,e,r,i){return n(this,void 0,void 0,(function(){var n,a,o,u;return s(this,(function(s){switch(s.label){case 0:return I(),n=null==i?void 0:i.onExportFinish,[4,U(T,e,r)];case 1:if(!(a=s.sent()))throw o="Problem saving ".concat(e.toUpperCase(),", please try again!"),(0,f.showWarning)(o),new Error(o);return u=(null==i?void 0:i.onExport)||h.saveAs,(null==i?void 0:i.dpi)?[4,(0,l.changeDpiBlob)(a,null==i?void 0:i.dpi).then((function(e){u(e,t),n&&n()}))]:[3,3];case 2:return s.sent(),[3,4];case 3:u(a,t),n&&n(),s.label=4;case 4:return[2]}}))}))}function G(t){return n(this,void 0,void 0,(function(){var e,r;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=(null==t?void 0:t.name)||"PNG_Capture",[4,z("".concat(e,".png"),w,void 0,t)];case 1:return i.sent(),[3,3];case 2:if(r=i.sent(),!(null==t?void 0:t.onError))throw r;return t.onError(r),[3,3];case 3:return[2]}}))}))}function H(t){return n(this,void 0,void 0,(function(){var e,r;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=(null==t?void 0:t.name)||"JPEG_Capture",[4,z("".concat(e,".jpg"),x,(null==t?void 0:t.quality)||1,t)];case 1:return i.sent(),[3,3];case 2:if(r=i.sent(),!(null==t?void 0:t.onError))throw r;return t.onError(r),[3,3];case 3:return[2]}}))}))}function j(t){return n(this,void 0,void 0,(function(){return s(this,(function(e){return[2,new Promise((function(e){t.save((function(t){e(t)}))}))]}))}))}function V(t){return n(this,void 0,void 0,(function(){var r,i,n,a,o,u,l,c,d,p,m,g,v;return s(this,(function(s){switch(s.label){case 0:if(r=E[t],i=r.name,n=r.capturer,a=r.numFrames,o=r.type,u=r.zipPromises,l=r.onExportProgress,c=r.onExport,d=r.onExportFinish,r.onError,p=r.ffmpegOptions,E.splice(t,1),o!==y&&o!==b&&n.stop(),0===a)throw m="No frames recorded, call CanvasCapture.recordFrame().",(0,f.showWarning)(m),new Error(m);switch(o){case e.MP4:return[3,1];case e.WEBM:return[3,4];case _:return[3,6];case y:case b:return[3,8]}return[3,11];case 1:return[4,j(n)];case 2:return g=s.sent(),(0,f.showDialog)("Processing...","MP4 is processing and may take a minute to save.  You can close this dialog in the meantime.",{autoCloseDelay:7e3}),[4,$({name:i,blob:g,onExportProgress:l,onExport:c,onExportFinish:d,ffmpegOptions:p})];case 3:case 10:return s.sent(),[3,12];case 4:return l&&l(0),[4,j(n)];case 5:return g=s.sent(),l&&l(1),v="".concat(i,".webm"),c?c(g,v):(0,h.saveAs)(g,v),d&&d(),[3,12];case 6:return(0,f.showDialog)("Processing...","GIF is processing and may take a minute to save.  You can close this dialog in the meantime.",{autoCloseDelay:7e3}),[4,j(n)];case 7:return g=s.sent(),v="".concat(i,".gif"),c?c(g,v):(0,h.saveAs)(g,v),d&&d(),[3,12];case 8:return[4,Promise.all(u)];case 9:return s.sent(),(0,f.showDialog)("Processing...","Frames are being zipped and may take a minute to save.  You can close this dialog in the meantime.",{autoCloseDelay:7e3}),[4,n.generateAsync({type:"blob"},(function(t){l&&l(t.percent/100)})).then((function(t){var e="".concat(i,".zip");c?c(t,e):(0,h.saveAs)(t,e),d&&d()}))];case 11:throw new Error("Need to handle saving type ".concat(o,"."));case 12:return[2]}}))}))}function W(t){return n(this,void 0,void 0,(function(){var e,r,i,n,a,o,h,u;return s(this,(function(s){switch(s.label){case 0:t&&!Array.isArray(t)&&(t=[t]),e=t||E,s.label=1;case 1:if(s.trys.push([1,3,,4]),0===E.length)throw r="No valid capturer inited, please call CanvasCapture.beginVideoRecord(), CanvasCapture.beginGIFRecord(), CanvasCapture.beginPNGFramesRecord(), or CanvasCapture.beginJPEGFramesRecord() first.",(0,f.showWarning)(r),new Error(r);for(i=[],h=0;h<e.length;h++){if((n=E.indexOf(e[h]))<0)throw new Error("Invalid capture ".concat(e[h]," – may have already been stopped."));i.push(V(n))}return(0,f.showDot)(Y()),[4,Promise.all(i)];case 2:return s.sent(),[3,4];case 3:for(a=s.sent(),o=!0,h=0;h<e.length;h++)(u=e[h]).onError?u.onError(a):o=!1;if(!e.length||!o)throw a;return[3,4];case 4:return[2]}}))}))}function q(t){for(var e=[],r=0;r<E.length;r++)E[r].type===t&&e.push(E[r]);return e}function X(){return q(e.WEBM).concat(q(e.MP4)).concat(q(_))}function Y(){return E.length>0}e.init=function(t,e){T=t,u=(null==e?void 0:e.ffmpegCorePath)||"https://unpkg.com/@ffmpeg/core@0.10.0/dist/ffmpeg-core.js",e&&void 0!==e.verbose&&R(e.verbose),e&&void 0!==e.showAlerts&&(c.PARAMS.SHOW_ALERTS=e.showAlerts),e&&void 0!==e.showDialogs&&(c.PARAMS.SHOW_DIALOGS=e.showDialogs),e&&void 0!==e.showRecDot&&(c.PARAMS.SHOW_REC_DOT=e.showRecDot),c.PARAMS.SHOW_REC_DOT&&(0,f.initDotWithCSS)(null==e?void 0:e.recDotCSS),T.addEventListener("resize",D),window.addEventListener("keydown",C)},e.dispose=function(){null==T||T.removeEventListener("resize",D),T=null,window.removeEventListener("keydown",C)},e.setVerbose=R,e.bindKeyToVideoRecord=function(t,r){(null==r?void 0:r.format)===e.WEBM?(S.webm=r,P(t,e.WEBM)):(S.mp4=r,P(t,e.MP4))},e.bindKeyToGIFRecord=function(t,e){S.gif=e,P(t,_)},e.bindKeyToPNGFramesRecord=function(t,e){S.pngzip=e,P(t,y)},e.bindKeyToJPEGFramesRecord=function(t,e){S.jpegzip=e,P(t,b)},e.bindKeyToPNGSnapshot=function(t,e){S.png=e,P(t,w)},e.bindKeyToJPEGSnapshot=function(t,e){S.jpeg=e,P(t,x)},e.beginVideoRecord=B,e.beginGIFRecord=L,e.beginPNGFramesRecord=O,e.beginJPEGFramesRecord=F,e.takePNGSnapshot=G,e.takeJPEGSnapshot=H,e.recordFrame=function(t){var e=E;t&&(e=Array.isArray(t)?t:[t]);try{if(I(),0===e.length){var r="No valid capturer inited, please call CanvasCapture.beginVideoRecord(), CanvasCapture.beginGIFRecord(), CanvasCapture.beginPNGFramesRecord(), or CanvasCapture.beginJPEGFramesRecord() first.";throw(0,f.showWarning)(r),new Error(r)}for(var i=function(t){var r=e[t],i=r.capturer,n=r.type,s=r.zipOptions,a=r.zipPromises,o=r.numFrames;if(n===b||n===y){var h="frame_".concat(o+1),u=new Promise((function(t,e){var r={dpi:null==s?void 0:s.dpi,quality:s.quality,name:h,onExport:function(t,e){i.file(e,t)},onExportFinish:t,onError:e};n===b?H(r):G(r)}));a.push(u)}else i.capture(T);e[t].numFrames=o+1},n=0;n<e.length;n++)i(n)}catch(t){var s=!0;for(n=0;n<e.length;n++){var a=e[n];a.onError?a.onError(t):s=!1}if(!e.length||!s)throw t}},e.stopRecord=W,e.isRecording=Y,e.checkHotkeys=function(){c.PARAMS.IS_MANUALLY_CHECKING_HOTKEYS=!0,N()};var Z=!1;function $(t){return n(this,void 0,void 0,(function(){var e,n,o,l,c,d,p,m,v,_,b,y,x,w,E;return s(this,(function(s){switch(s.label){case 0:return g||(e=r(648),g=e({corePath:u})),Z?[3,2]:[4,g.load().catch((function(){var t="MP4 export not supported in this browser, try again in the latest version of Chrome.";throw(0,f.showWarning)(t),new Error(t)}))];case 1:s.sent(),Z=!0,s.label=2;case 2:return n=t.name,o=t.blob,l=t.onExportProgress,c=t.onExport,d=t.onExportFinish,p=t.ffmpegOptions,[4,o.arrayBuffer()];case 3:return m=s.sent(),v=new Uint8Array(m),g.FS("writeFile","".concat(n,".webm"),v),l&&g.setProgress((function(t){l(Math.max(0,Math.min(t.ratio,1)))})),_=i(i({},{"-c:v":"libx264","-preset":"slow","-crf":"22","-pix_fmt":"yuv420p"}),p||{}),b=[],Object.keys(_).forEach((function(t){b.push(t,_[t])})),y="".concat(n,".mp4"),[4,(E=g).run.apply(E,a(a(["-i","".concat(n,".webm")],b,!1),["-vf","crop=trunc(iw/2)*2:trunc(ih/2)*2","-an",y],!1))];case 4:return s.sent(),[4,g.FS("readFile",y)];case 5:return x=s.sent(),w=new Blob([x],{type:"video/mp4"}),c?c(w,y):(0,h.saveAs)(w,y),g.FS("unlink","".concat(n,".webm")),g.FS("unlink",y),d&&d(),[2]}}))}))}function K(){var t=document.createElement("canvas").toDataURL("image/webp",{quality:1});return!("string"!=typeof t||!t.match(/^data:image\/webp;base64,/i))}function J(){return K()}function Q(){return K()&&function(){try{new SharedArrayBuffer(1024)}catch(t){return!1}return!0}()}e.browserSupportsWEBM=J,e.browserSupportsMP4=Q,e.browserSupportsGIF=function(){return!!window.Worker}},713:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.css=void 0,e.css='\n/**************************  Basic Modal Styles\n**************************/\n\n.modal {\n  font-family: -apple-system,BlinkMacSystemFont,avenir next,avenir,helvetica neue,helvetica,ubuntu,roboto,noto,segoe ui,arial,sans-serif;\n}\n\n.modal__overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0,0,0,0.6);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.modal__container {\n  background-color: #fff;\n  padding: 30px;\n  max-width: 500px;\n  max-height: 100vh;\n  overflow-y: auto;\n  box-sizing: border-box;\n}\n\n.modal__header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.modal__title {\n  margin-top: 0;\n  margin-bottom: 0;\n  font-weight: 600;\n  font-size: 1.25rem;\n  line-height: 1.25;\n  color: #222;\n  box-sizing: border-box;\n}\n\n.modal__footer {\n  text-align: right;\n}\n\n.modal__footer>.modal__btn {\n  margin-right: 8px;\n}\n\n.modal__close {\n  background: transparent;\n  border: 0;\n}\n\n.modal__header .modal__close:before { content: "✕"; }\n\n.modal__content {\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n  line-height: 1.5;\n  color: rgba(0,0,0,.8);\n}\n\n.modal__btn {\n  font-size: .875rem;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  padding-top: .5rem;\n  padding-bottom: .5rem;\n  background-color: #e6e6e6;\n  color: rgba(0,0,0,.8);\n  border-radius: .25rem;\n  border-style: none;\n  border-width: 0;\n  cursor: pointer;\n  -webkit-appearance: button;\n  text-transform: none;\n  overflow: visible;\n  line-height: 1.15;\n  margin: 0;\n  will-change: transform;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-backface-visibility: hidden;\n  backface-visibility: hidden;\n  -webkit-transform: translateZ(0);\n  transform: translateZ(0);\n  transition: -webkit-transform .25s ease-out;\n  transition: transform .25s ease-out;\n  transition: transform .25s ease-out,-webkit-transform .25s ease-out;\n}\n\n.modal__btn:focus, .modal__btn:hover {\n  -webkit-transform: scale(1.05);\n  transform: scale(1.05);\n}\n\n.modal__btn-primary {\n  background-color: #333;\n  color: #fff;\n}\n\n\n\n/**************************  Demo Animation Style\n**************************/\n@keyframes mmfadeIn {\n    from { opacity: 0; }\n      to { opacity: 1; }\n}\n\n@keyframes mmfadeOut {\n    from { opacity: 1; }\n      to { opacity: 0; }\n}\n\n@keyframes mmslideIn {\n  from { transform: translateY(15%); }\n    to { transform: translateY(0); }\n}\n\n@keyframes mmslideOut {\n    from { transform: translateY(0); }\n    to { transform: translateY(-10%); }\n}\n\n.micromodal-slide {\n  display: none;\n}\n\n.micromodal-slide.is-open {\n  display: block;\n}\n\n.micromodal-slide[aria-hidden="false"] .modal__overlay {\n  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);\n}\n\n.micromodal-slide[aria-hidden="false"] .modal__container {\n  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);\n}\n\n.micromodal-slide[aria-hidden="true"] .modal__overlay {\n  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);\n}\n\n.micromodal-slide[aria-hidden="true"] .modal__container {\n  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);\n}\n\n.micromodal-slide .modal__container,\n.micromodal-slide .modal__overlay {\n  will-change: transform;\n}\n'},330:function(t,e,r){var i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.showDot=e.initDotWithCSS=e.showDialog=e.showWarning=void 0;var n=r(650),s=r(713),a=r(848),o=document.createElement("style");function h(t,e,r){void 0===r&&(r="");var i='<div class="modal micromodal-slide" id="modal-'.concat(t,'" aria-hidden="true">\n\t\t<div class="modal__overlay" tabindex="-1" data-micromodal-close>\n\t\t<div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-').concat(t,'-title">\n\t\t\t<header class="modal__header">\n\t\t\t\t<h2 class="modal__title" id="modal-').concat(t,'-title">\n\t\t\t\t\t').concat(e,'\n\t\t\t\t</h2>\n\t\t\t\t<button class="modal__close" aria-label="Close modal" data-micromodal-close></button>\n\t\t\t</header>\n\t\t\t<main class="modal__content">\n\t\t\t\t<p id="modal-').concat(t,'-content">\n\t\t\t\t\t').concat(r,"\n\t\t\t\t</p>\n\t\t\t</main>\n\t\t</div>\n\t\t</div>\n\t</div>"),n=document.createElement("div");return n.innerHTML=i,n.firstChild}o.textContent=s.css,document.head.append(o);var u=!1,l=!1,c="alert",f=h(c,"Warning"),d="dialog",p=h(d,"Saving...");e.showWarning=function(t){console.warn(t),a.PARAMS.SHOW_ALERTS&&(u||(u=!0,document.getElementsByTagName("body")[0].appendChild(f)),document.getElementById("modal-".concat(c,"-content")).innerHTML=t,n.default.show("modal-".concat(c)))},e.showDialog=function(t,e,r){if(a.PARAMS.VERBOSE&&console.log(t,e),a.PARAMS.SHOW_DIALOGS){l||(l=!0,document.getElementsByTagName("body")[0].appendChild(p)),document.getElementById("modal-".concat(d,"-title")).innerHTML=t,document.getElementById("modal-".concat(d,"-content")).innerHTML=e,n.default.show("modal-".concat(d));var i=void 0!==(null==r?void 0:r.autoCloseDelay)?r.autoCloseDelay:-1;i>0&&setTimeout((function(){n.default.close("modal-".concat(d))}),i)}};var m=document.createElement("div");e.initDotWithCSS=function(t){m.id="recordingDot";var e=i({background:"red",width:"20px",height:"20px","border-radius":"50%",display:"none",position:"absolute",top:"0",right:"0","z-index":"10",margin:"20px"},t);Object.assign(m.style,e),document.getElementsByTagName("body")[0].appendChild(m)},e.showDot=function(t){a.PARAMS.SHOW_REC_DOT&&(m.style.display=t?"inline-block":"none")}},848:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PARAMS=void 0,e.PARAMS={VERBOSE:!1,SHOW_ALERTS:!1,SHOW_DIALOGS:!1,SHOW_REC_DOT:!1,IS_MANUALLY_CHECKING_HOTKEYS:!1}},886:(t,e,r)=>{var i;t=r.nmd(t),function(){if(void 0!==t.exports)var n=r(846),s=r(173),a=r(769),o=r(166);var h={function:!0,object:!0};function u(t){return t&&t.Object===Object?t:null}parseFloat,parseInt;var l=h[typeof e]&&e&&!e.nodeType?e:void 0,c=h.object&&t&&!t.nodeType?t:void 0,f=(c&&c.exports,u(l&&c&&"object"==typeof r.g&&r.g)),d=u(h[typeof self]&&self),p=u(h[typeof window]&&window),m=u(h[typeof this]&&this);f||p!==(m&&m.window)&&p||d||m||Function("return this")();function g(t){return String("0000000"+t).slice(-7)}"gc"in window||(window.gc=function(){}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,r){for(var i=atob(this.toDataURL(e,r).split(",")[1]),n=i.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=i.charCodeAt(a);t(new Blob([s],{type:e||"image/png"}))}}),
// @license http://opensource.org/licenses/MIT
function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}();var v=window.Date.now();function _(t){var e={};this.settings=t,this.on=function(t,r){e[t]=r},this.emit=function(t){var r=e[t];r&&r.apply(null,Array.prototype.slice.call(arguments,1))},this.filename=t.name||function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}(),this.extension="",this.mimeType=""}function b(t){_.call(this,t),this.extension=".tar",this.mimeType="application/x-tar",this.fileExtension="",this.tape=null,this.count=0}function y(t){b.call(this,t),this.type="image/png",this.fileExtension=".png"}function x(t){b.call(this,t),this.type="image/jpeg",this.fileExtension=".jpg",this.quality=t.quality/100||.8}function w(t){"image/webp"!==document.createElement("canvas").toDataURL("image/webp").substr(5,10)&&console.log("WebP not supported - try another export format"),_.call(this,t),this.quality=t.quality/100||.8,this.extension=".webm",this.mimeType="video/webm",this.baseFilename=this.filename,this.frames=[],this.part=1,this.videoWriter=new o({quality:this.quality,fileWriter:null,fd:null,frameRate:t.framerate})}function E(t){_.call(this,t),t.quality=t.quality/100||.8,this.encoder=new FFMpegServer.Video(t),this.encoder.on("process",function(){this.emit("process")}.bind(this)),this.encoder.on("finished",function(t,e){var r=this.callback;r&&(this.callback=void 0,r(t,e))}.bind(this)),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("error",function(t){alert(JSON.stringify(t,null,2))}.bind(this))}function M(t){_.call(this,t),this.framerate=this.settings.framerate,this.type="video/webm",this.extension=".webm",this.stream=null,this.mediaRecorder=null,this.chunks=[]}function S(t){_.call(this,t),t.quality=31-(30*t.quality/100||10),t.workers=t.workers||4,this.extension=".gif",this.mimeType="image/gif",this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.sizeSet=!1,this.encoder=new a({workers:t.workers,quality:t.quality,workerScript:t.workersPath}),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("finished",function(t){var e=this.callback;e&&(this.callback=void 0,e(t))}.bind(this))}function A(t){var e,r,i,n,a,o,h,u=t||{},l=(new Date,[]),c=[],f=0,d=0,p=[],m=!1,g={};u.framerate=u.framerate||60,u.motionBlurFrames=2*(u.motionBlurFrames||1),e=u.verbose||!1,u.display,u.step=1e3/u.framerate,u.timeLimit=u.timeLimit||0,u.frameLimit=u.frameLimit||0,u.startTime=u.startTime||0;var _=document.createElement("div");_.style.position="absolute",_.style.left=_.style.top=0,_.style.backgroundColor="black",_.style.fontFamily="monospace",_.style.fontSize="11px",_.style.padding="5px",_.style.color="red",_.style.zIndex=1e5,u.display&&document.body.appendChild(_);var b,A,T=document.createElement("canvas"),C=T.getContext("2d");W("Step is set to "+u.step+"ms");var D={gif:S,webm:w,ffmpegserver:E,png:y,jpg:x,"webm-mediarecorder":M},R=D[u.format];if(!R)throw"Error: Incorrect or missing format: Valid formats are "+Object.keys(D).join(", ");if((h=new R(u)).step=o,h.on("process",j),h.on("progress",(function(t){!function(t){var e=g[t];e&&e.apply(null,Array.prototype.slice.call(arguments,1))}("progress",t)})),"performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var I=Date.now();performance.timing&&performance.timing.navigationStart&&(I=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-I}}var P=window.setTimeout,N=window.setInterval,k=window.clearInterval,B=window.clearTimeout,L=window.requestAnimationFrame,O=window.Date.now,F=window.performance.now,U=window.Date.prototype.getTime,z=[];function G(){m=!1,h.stop(),W("Capturer stop"),window.setTimeout=P,window.setInterval=N,window.clearInterval=k,window.clearTimeout=B,window.requestAnimationFrame=L,window.Date.prototype.getTime=U,window.Date.now=O,window.performance.now=F}function H(t,e){P(t,0,e)}function o(){H(j)}function j(){var t=1e3/u.framerate,e=(f+d/u.motionBlurFrames)*t;r=i+e,n=a+e,z.forEach((function(t){t._hookedTime=e/1e3})),function(){var t=f/u.framerate;(u.frameLimit&&f>=u.frameLimit||u.timeLimit&&t>=u.timeLimit)&&(G(),V());var e=new Date(null);e.setSeconds(t),u.motionBlurFrames>2?_.textContent="CCapture "+u.format+" | "+f+" frames ("+d+" inter) | "+e.toISOString().substr(11,8):_.textContent="CCapture "+u.format+" | "+f+" frames | "+e.toISOString().substr(11,8)}(),W("Frame: "+f+" "+d);for(var s=0;s<l.length;s++)if(r>=l[s].triggerTime){H(l[s].callback),l.splice(s,1);continue}for(s=0;s<c.length;s++)if(r>=c[s].triggerTime){H(c[s].callback),c[s].triggerTime+=c[s].time;continue}p.forEach((function(t){H(t,r-v)})),p=[]}function V(t){t||(t=function(t){return s(t,h.filename+h.extension,h.mimeType),!1}),h.save(t)}function W(t){e&&console.log(t)}return{start:function(){!function(){function t(){return this._hooked||(this._hooked=!0,this._hookedTime=this.currentTime||0,this.pause(),z.push(this)),this._hookedTime+u.startTime}W("Capturer start"),i=window.Date.now(),r=i+u.startTime,a=window.performance.now(),n=a+u.startTime,window.Date.prototype.getTime=function(){return r},window.Date.now=function(){return r},window.setTimeout=function(t,e){var i={callback:t,time:e,triggerTime:r+e};return l.push(i),W("Timeout set to "+i.time),i},window.clearTimeout=function(t){for(var e=0;e<l.length;e++)if(l[e]==t){l.splice(e,1),W("Timeout cleared");continue}},window.setInterval=function(t,e){var i={callback:t,time:e,triggerTime:r+e};return c.push(i),W("Interval set to "+i.time),i},window.clearInterval=function(t){return W("clear Interval"),null},window.requestAnimationFrame=function(t){p.push(t)},window.performance.now=function(){return n};try{Object.defineProperty(HTMLVideoElement.prototype,"currentTime",{get:t}),Object.defineProperty(HTMLAudioElement.prototype,"currentTime",{get:t})}catch(t){W(t)}}(),h.start(),m=!0},capture:function(t){m&&(u.motionBlurFrames>2?(function(t){T.width===t.width&&T.height===t.height||(T.width=t.width,T.height=t.height,b=new Uint16Array(T.height*T.width*4),C.fillStyle="#0",C.fillRect(0,0,T.width,T.height))}(t),function(t){C.drawImage(t,0,0),A=C.getImageData(0,0,T.width,T.height);for(var e=0;e<b.length;e+=4)b[e]+=A.data[e],b[e+1]+=A.data[e+1],b[e+2]+=A.data[e+2];d++}(t),d>=.5*u.motionBlurFrames?function(){for(var t=A.data,e=0;e<b.length;e+=4)t[e]=2*b[e]/u.motionBlurFrames,t[e+1]=2*b[e+1]/u.motionBlurFrames,t[e+2]=2*b[e+2]/u.motionBlurFrames;for(C.putImageData(A,0,0),h.add(T),f++,d=0,W("Full MB Frame! "+f+" "+r),e=0;e<b.length;e+=4)b[e]=0,b[e+1]=0,b[e+2]=0;gc()}():o()):(h.add(t),W("Full Frame! "+ ++f)))},stop:G,save:V,on:function(t,e){g[t]=e}}}_.prototype.start=function(){},_.prototype.stop=function(){},_.prototype.add=function(){},_.prototype.save=function(){},_.prototype.dispose=function(){},_.prototype.safeToProceed=function(){return!0},_.prototype.step=function(){console.log("Step not set!")},b.prototype=Object.create(_.prototype),b.prototype.start=function(){this.dispose()},b.prototype.add=function(t){var e=new FileReader;e.onload=function(){this.tape.append(g(this.count)+this.fileExtension,new Uint8Array(e.result)),this.count++,this.step()}.bind(this),e.readAsArrayBuffer(t)},b.prototype.save=function(t){t(this.tape.save())},b.prototype.dispose=function(){this.tape=new n,this.count=0},y.prototype=Object.create(b.prototype),y.prototype.add=function(t){t.toBlob(function(t){b.prototype.add.call(this,t)}.bind(this),this.type)},x.prototype=Object.create(b.prototype),x.prototype.add=function(t){t.toBlob(function(t){b.prototype.add.call(this,t)}.bind(this),this.type,this.quality)},w.prototype=Object.create(_.prototype),w.prototype.start=function(t){this.dispose()},w.prototype.add=function(t){this.videoWriter.addFrame(t),this.settings.autoSaveTime>0&&this.frames.length/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(t){this.filename=this.baseFilename+"-part-"+g(this.part),s(t,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+"-part-"+g(this.part),this.step()}.bind(this)):this.step()},w.prototype.save=function(t){this.videoWriter.complete().then(t)},w.prototype.dispose=function(t){this.frames=[]},E.prototype=Object.create(_.prototype),E.prototype.start=function(){this.encoder.start(this.settings)},E.prototype.add=function(t){this.encoder.add(t)},E.prototype.save=function(t){this.callback=t,this.encoder.end()},E.prototype.safeToProceed=function(){return this.encoder.safeToProceed()},M.prototype=Object.create(_.prototype),M.prototype.add=function(t){this.stream||(this.stream=t.captureStream(this.framerate),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(t){this.chunks.push(t.data)}.bind(this)),this.step()},M.prototype.save=function(t){this.mediaRecorder.onstop=function(e){var r=new Blob(this.chunks,{type:"video/webm"});this.chunks=[],t(r)}.bind(this),this.mediaRecorder.stop()},S.prototype=Object.create(_.prototype),S.prototype.add=function(t){this.sizeSet||(this.encoder.setOption("width",t.width),this.encoder.setOption("height",t.height),this.sizeSet=!0),this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t,0,0),this.encoder.addFrame(this.ctx,{copy:!0,delay:this.settings.step}),this.step()},S.prototype.save=function(t){this.callback=t,this.encoder.render()},(p||d||{}).CCapture=A,void 0!==(i=function(){return A}.call(e,r,e,t))&&(t.exports=i)}()},173:t=>{void 0!==t.exports&&(t.exports=function(t,e,r){var i,n,s,a=window,o="application/octet-stream",h=r||o,u=t,l=document,c=l.createElement("a"),f=function(t){return String(t)},d=a.Blob||a.MozBlob||a.WebKitBlob||f,p=a.MSBlobBuilder||a.WebKitBlobBuilder||a.BlobBuilder,m=e||"download";if("true"===String(this)&&(h=(u=[u,h])[0],u=u[1]),String(u).match(/^data\:[\w+\-]+\/[\w+\-]+[,;]/))return navigator.msSaveBlob?navigator.msSaveBlob(function(t){var e=t.split(/[:;,]/),r=e[1],i=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),n=i.length,s=0,a=new Uint8Array(n);for(;s<n;++s)a[s]=i.charCodeAt(s);return new d([a],{type:r})}(u),m):g(u);try{i=u instanceof d?u:new d([u],{type:h})}catch(t){p&&((n=new p).append([u]),i=n.getBlob(h))}function g(t,e){if("download"in c)return c.href=t,c.setAttribute("download",m),c.innerHTML="downloading...",c.style.display="none",l.body.appendChild(c),setTimeout((function(){c.click(),l.body.removeChild(c),!0===e&&setTimeout((function(){a.URL.revokeObjectURL(c.href)}),250)}),66),!0;var r=l.createElement("iframe");l.body.appendChild(r),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,o)),r.src=t,setTimeout((function(){l.body.removeChild(r)}),333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(i,m);if(a.URL)g(a.URL.createObjectURL(i),!0);else{if("string"==typeof i||i.constructor===f)try{return g("data:"+h+";base64,"+a.btoa(i))}catch(t){return g("data:"+h+","+encodeURIComponent(i))}(s=new FileReader).onload=function(t){g(this.result)},s.readAsDataURL(i)}return!0})},769:t=>{t.exports=function(){function t(e,r,i){function n(a,o){if(!r[a]){if(!e[a]){if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[a]={exports:{}};e[a][0].call(u.exports,(function(t){var r=e[a][1][t];return n(r||t)}),u,u.exports,t,e,r,i)}return r[a].exports}for(var s=void 0,a=0;a<i.length;a++)n(i[a]);return n}return t}()({1:[function(t,e,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function s(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!s(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,r,i,s,h,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(o(r=this._events[t]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),i=(u=r.slice()).length,h=0;h<i;h++)u[h].apply(this,s);return!0},i.prototype.addListener=function(t,e){var r;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(r=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var r,i,s,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(r=this._events[t]).length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(r)){for(o=s;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){i=o;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[t]))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,r){var i=t("./TypedNeuQuant.js"),n=t("./LZWEncoder.js");function s(){this.page=-1,this.pages=[],this.newPage()}s.pageSize=4096,s.charMap={};for(var a=0;a<256;a++)s.charMap[a]=String.fromCharCode(a);function o(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new s}s.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(s.pageSize),this.cursor=0},s.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var r=0;r<s.pageSize;r++)t+=s.charMap[this.pages[e][r]];return t},s.prototype.writeByte=function(t){this.cursor>=s.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},s.prototype.writeUTFBytes=function(t){for(var e=t.length,r=0;r<e;r++)this.writeByte(t.charCodeAt(r))},s.prototype.writeBytes=function(t,e,r){for(var i=r||t.length,n=e||0;n<i;n++)this.writeByte(t[n])},o.prototype.setDelay=function(t){this.delay=Math.round(t/10)},o.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},o.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},o.prototype.setRepeat=function(t){this.repeat=t},o.prototype.setTransparent=function(t){this.transparent=t},o.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},o.prototype.finish=function(){this.out.writeByte(59)},o.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},o.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},o.prototype.setGlobalPalette=function(t){this.globalPalette=t},o.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},o.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},o.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new i(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},o.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var r=0,i=0;i<e;i++){var n=this.findClosestRGB(255&this.pixels[r++],255&this.pixels[r++],255&this.pixels[r++]);this.usedEntry[n]=!0,this.indexedPixels[i]=n}},o.prototype.ditherPixels=function(t,e){var r={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!r[t])throw"Unknown dithering kernel: "+t;var i=r[t],n=0,s=this.height,a=this.width,o=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var u=0;u<s;u++){e&&(h*=-1);for(var l=1==h?0:a-1,c=1==h?a:0;l!==c;l+=h){var f=3*(n=u*a+l),d=o[f],p=o[f+1],m=o[f+2];f=this.findClosestRGB(d,p,m),this.usedEntry[f]=!0,this.indexedPixels[n]=f,f*=3;for(var g=d-this.colorTab[f],v=p-this.colorTab[f+1],_=m-this.colorTab[f+2],b=1==h?0:i.length-1,y=1==h?i.length:0;b!==y;b+=h){var x=i[b][1],w=i[b][2];if(x+l>=0&&x+l<a&&w+u>=0&&w+u<s){var E=i[b][0];f=n+x+w*a,o[f*=3]=Math.max(0,Math.min(255,o[f]+g*E)),o[f+1]=Math.max(0,Math.min(255,o[f+1]+v*E)),o[f+2]=Math.max(0,Math.min(255,o[f+2]+_*E))}}}}},o.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},o.prototype.findClosestRGB=function(t,e,r,i){if(null===this.colorTab)return-1;if(this.neuQuant&&!i)return this.neuQuant.lookupRGB(t,e,r);for(var n=0,s=16777216,a=this.colorTab.length,o=0,h=0;o<a;h++){var u=t-(255&this.colorTab[o++]),l=e-(255&this.colorTab[o++]),c=r-(255&this.colorTab[o++]),f=u*u+l*l+c*c;(!i||this.usedEntry[h])&&f<s&&(s=f,n=h)}return n},o.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var r=this.image,i=0,n=0,s=0;s<e;s++)for(var a=0;a<t;a++)this.pixels[n++]=r[i++],this.pixels[n++]=r[i++],this.pixels[n++]=r[i++],i++},o.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&this.dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},o.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},o.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},o.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},o.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},o.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},o.prototype.writePixels=function(){new n(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},o.prototype.stream=function(){return this.out},e.exports=o},{"./LZWEncoder.js":3,"./TypedNeuQuant.js":4}],3:[function(t,e,r){var i=-1,n=12,s=5003,a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function o(t,e,r,o){var h,u,l,c,f,d,p=Math.max(2,o),m=new Uint8Array(256),g=new Int32Array(s),v=new Int32Array(s),_=0,b=0,y=!1;function x(t,e){m[u++]=t,u>=254&&A(e)}function w(t){E(s),b=f+2,y=!0,D(f,t)}function E(t){for(var e=0;e<t;++e)g[e]=-1}function M(t,e){var r,a,o,h,p,m,_;for(c=t,y=!1,n_bits=c,l=T(n_bits),d=1+(f=1<<t-1),b=f+2,u=0,h=C(),_=0,r=s;r<65536;r*=2)++_;_=8-_,E(m=s),D(f,e);t:for(;(a=C())!=i;)if(r=(a<<n)+h,g[o=a<<_^h]!==r){if(g[o]>=0){p=m-o,0===o&&(p=1);do{if((o-=p)<0&&(o+=m),g[o]===r){h=v[o];continue t}}while(g[o]>=0)}D(h,e),h=a,b<1<<n?(v[o]=b++,g[o]=r):w(e)}else h=v[o];D(h,e),D(d,e)}function S(r){r.writeByte(p),remaining=t*e,curPixel=0,M(p+1,r),r.writeByte(0)}function A(t){u>0&&(t.writeByte(u),t.writeBytes(m,0,u),u=0)}function T(t){return(1<<t)-1}function C(){return 0===remaining?i:(--remaining,255&r[curPixel++])}function D(t,e){for(h&=a[_],_>0?h|=t<<_:h=t,_+=n_bits;_>=8;)x(255&h,e),h>>=8,_-=8;if((b>l||y)&&(y?(l=T(n_bits=c),y=!1):(++n_bits,l=n_bits==n?1<<n:T(n_bits))),t==d){for(;_>0;)x(255&h,e),h>>=8,_-=8;A(e)}}this.encode=S}e.exports=o},{}],4:[function(t,e,r){var i=100,n=256,s=n-1,a=4,o=16,h=1<<o,u=10,l=10,c=h>>l,f=h<<u-l,d=6,p=(n>>3)*(1<<d),m=30,g=10,v=1<<g,_=8,b=1<<_,y=1<<g+_,x=499,w=491,E=487,M=503,S=3*M;function A(t,e){var r,g,_,A,T;function C(){var t,e;for(r=[],g=new Int32Array(256),_=new Int32Array(n),A=new Int32Array(n),T=new Int32Array(n>>3),t=0;t<n;t++)e=(t<<a+8)/n,r[t]=new Float64Array([e,e,e,0]),A[t]=h/n,_[t]=0}function D(){for(var t=0;t<n;t++)r[t][0]>>=a,r[t][1]>>=a,r[t][2]>>=a,r[t][3]=t}function R(t,e,i,n,s){r[e][0]-=t*(r[e][0]-i)/v,r[e][1]-=t*(r[e][1]-n)/v,r[e][2]-=t*(r[e][2]-s)/v}function I(t,e,i,s,a){for(var o,h,u=Math.abs(e-t),l=Math.min(e+t,n),c=e+1,f=e-1,d=1;c<l||f>u;)h=T[d++],c<l&&((o=r[c++])[0]-=h*(o[0]-i)/y,o[1]-=h*(o[1]-s)/y,o[2]-=h*(o[2]-a)/y),f>u&&((o=r[f--])[0]-=h*(o[0]-i)/y,o[1]-=h*(o[1]-s)/y,o[2]-=h*(o[2]-a)/y)}function P(t,e,i){var s,h,d,p,m,g=2147483647,v=g,b=-1,y=b;for(s=0;s<n;s++)h=r[s],(d=Math.abs(h[0]-t)+Math.abs(h[1]-e)+Math.abs(h[2]-i))<g&&(g=d,b=s),(p=d-(_[s]>>o-a))<v&&(v=p,y=s),m=A[s]>>l,A[s]-=m,_[s]+=m<<u;return A[b]+=c,_[b]-=f,y}function N(){var t,e,i,a,o,h,u=0,l=0;for(t=0;t<n;t++){for(o=t,h=(i=r[t])[1],e=t+1;e<n;e++)(a=r[e])[1]<h&&(o=e,h=a[1]);if(a=r[o],t!=o&&(e=a[0],a[0]=i[0],i[0]=e,e=a[1],a[1]=i[1],i[1]=e,e=a[2],a[2]=i[2],i[2]=e,e=a[3],a[3]=i[3],i[3]=e),h!=u){for(g[u]=l+t>>1,e=u+1;e<h;e++)g[e]=t;u=h,l=t}}for(g[u]=l+s>>1,e=u+1;e<256;e++)g[e]=s}function k(t,e,i){for(var s,a,o,h=1e3,u=-1,l=g[e],c=l-1;l<n||c>=0;)l<n&&((o=(a=r[l])[1]-e)>=h?l=n:(l++,o<0&&(o=-o),(s=a[0]-t)<0&&(s=-s),(o+=s)<h&&((s=a[2]-i)<0&&(s=-s),(o+=s)<h&&(h=o,u=a[3])))),c>=0&&((o=e-(a=r[c])[1])>=h?c=-1:(c--,o<0&&(o=-o),(s=a[0]-t)<0&&(s=-s),(o+=s)<h&&((s=a[2]-i)<0&&(s=-s),(o+=s)<h&&(h=o,u=a[3]))));return u}function B(){var r,n,s,o,h,u,l=t.length,c=30+(e-1)/3,f=l/(3*e),g=~~(f/i),_=v,y=p,A=y>>d;for(A<=1&&(A=0),r=0;r<A;r++)T[r]=_*((A*A-r*r)*b/(A*A));l<S?(e=1,n=3):n=l%x!=0?3*x:l%w!=0?3*w:l%E!=0?3*E:3*M;var C=0;for(r=0;r<f;)if(R(_,u=P(s=(255&t[C])<<a,o=(255&t[C+1])<<a,h=(255&t[C+2])<<a),s,o,h),0!==A&&I(A,u,s,o,h),(C+=n)>=l&&(C-=l),0===g&&(g=1),++r%g==0)for(_-=_/c,(A=(y-=y/m)>>d)<=1&&(A=0),u=0;u<A;u++)T[u]=_*((A*A-u*u)*b/(A*A))}function L(){C(),B(),D(),N()}function O(){for(var t=[],e=[],i=0;i<n;i++)e[r[i][3]]=i;for(var s=0,a=0;a<n;a++){var o=e[a];t[s++]=r[o][0],t[s++]=r[o][1],t[s++]=r[o][2]}return t}this.buildColormap=L,this.getColormap=O,this.lookupRGB=k}e.exports=A},{}],5:[function(t,e,r){var i,n,s,a,o;o=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),s="ie"===(i=o.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&document.documentMode,(n={name:"version"===i[1]?i[3]:i[1],version:s||parseFloat("opera"===i[1]&&i[4]?i[4]:i[2]),platform:{name:o.match(/ip(?:ad|od|hone)/)?"ios":(o.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]}})[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.platform[n.platform.name]=!0,e.exports=n},{}],6:[function(t,e,r){var i,n,s=function(t,e){for(var r in e)a.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1},h=[].slice;i=t("events").EventEmitter,n=t("./browser.coffee"),t("./GIFEncoder.js"),t("./gif.worker.coffee"),e.exports=function(t){var e,r;function i(t){var r,i,n;for(i in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)n=e[i],null==(r=this.options)[i]&&(r[i]=n)}return s(i,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},r={delay:500,copy:!1,dispose:-1},i.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},i.prototype.setOptions=function(t){var e,r,i;for(e in r=[],t)a.call(t,e)&&(i=t[e],r.push(this.setOption(e,i)));return r},i.prototype.addFrame=function(t,e){var i,n;for(n in null==e&&(e={}),(i={}).transparent=this.options.transparent,r)i[n]=e[n]||r[n];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!==ImageData&&t instanceof ImageData)i.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?i.data=this.getContextData(t):i.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?i.data=this.getImageData(t):i.image=t}return this.frames.push(i)},i.prototype.render=function(){var t,e,r;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,r;for(r=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)r.push(null);return r}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,r=e;0<=r?t<r:t>r;0<=r?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},i.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},i.prototype.spawnWorkers=function(){var t,e,r,i;return t=Math.min(this.options.workers,this.frames.length),function(){r=[];for(var i=e=this.freeWorkers.length;e<=t?i<t:i>t;e<=t?i++:i--)r.push(i);return r}.apply(this).forEach((i=this,function(t){var e;return i.log("spawning worker "+t),(e=new Worker(i.options.workerScript)).onmessage=function(t){return i.activeWorkers.splice(i.activeWorkers.indexOf(e),1),i.freeWorkers.push(e),i.frameFinished(t.data)},i.freeWorkers.push(e)})),t},i.prototype.frameFinished=function(t){var e,r;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,r=this.freeWorkers.length;1<=r?e<r:e>r;1<=r?++e:--e)this.renderNextFrame();return o.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},i.prototype.finishRendering=function(){var t,e,r,i,n,s,a,o,h,u,l,c,f,d,p,m;for(o=0,n=0,h=(d=this.imageParts).length;n<h;n++)o+=((e=d[n]).data.length-1)*e.pageSize+e.cursor;for(o+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(o/1e3)+"kb"),t=new Uint8Array(o),c=0,s=0,u=(p=this.imageParts).length;s<u;s++)for(r=a=0,l=(m=(e=p[s]).data).length;a<l;r=++a)f=m[r],t.set(f,c),r===e.data.length-1?c+=e.cursor:c+=e.pageSize;return i=new Blob([t],{type:"image/gif"}),this.emit("finished",i,t)},i.prototype.renderNextFrame=function(){var t,e,r;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],r=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(r),r.postMessage(e)},i.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},i.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},i.prototype.getTask=function(t){var e,r;if(r={index:e=this.frames.indexOf(t),last:e===this.frames.length-1,delay:t.delay,dispose:t.dispose,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===n.name},null!=t.data)r.data=t.data;else if(null!=t.context)r.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");r.data=this.getImageData(t.image)}return r},i.prototype.log=function(){var t;if(t=1<=arguments.length?h.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},i}(i)},{"./GIFEncoder.js":2,"./browser.coffee":5,"./gif.worker.coffee":7,events:1}],7:[function(t,e,r){var i,n;i=t("./GIFEncoder.js"),n=function(t){var e,r,n,s;return e=new i(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setDispose(t.dispose),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),n=e.stream(),t.data=n.pages,t.cursor=n.cursor,t.pageSize=n.constructor.pageSize,t.canTransfer?(s=function(){var e,i,n,s;for(s=[],e=0,i=(n=t.data).length;e<i;e++)r=n[e],s.push(r.buffer);return s}(),self.postMessage(t,s)):self.postMessage(t)},self.onmessage=function(t){return n(t.data)}},{"./GIFEncoder.js":2}]},{},[6])(6)},846:t=>{var e,r;!function(){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];function e(t){var e,r=new Uint8Array(t);for(e=0;e<t;e+=1)r[e]=0;return r}window.utils={},window.utils.clean=e,window.utils.pad=function(t,e,r){return t=t.toString(r||8),"000000000000".substr(t.length+12-e)+t},window.utils.extend=function(t,r,i,n){var s=e((parseInt((r+i)/n)+1)*n);return s.set(t),s},window.utils.stringToUint8=function(t,r,i){var n,s;for(r=r||e(t.length),i=i||0,n=0,s=t.length;n<s;n+=1)r[i]=t.charCodeAt(n),i+=1;return r},window.utils.uint8ToBase64=function(e){var r,i,n,s,a=e.length%3,o="";for(r=0,n=e.length-a;r<n;r+=3)i=(e[r]<<16)+(e[r+1]<<8)+e[r+2],o+=t[(s=i)>>18&63]+t[s>>12&63]+t[s>>6&63]+t[63&s];switch(o.length%4){case 1:o+="=";break;case 2:o+="=="}return o}}(),r=window.utils,e=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}],window.header={},window.header.structure=e,window.header.format=function(t,i){var n=r.clean(512),s=0;return e.forEach((function(e){var r,i,a=t[e.field]||"";for(r=0,i=a.length;r<i;r+=1)n[s]=a.charCodeAt(r),s+=1;s+=e.length-r})),"function"==typeof i?i(n,s):n},function(){var e,r=window.header,i=window.utils,n=512;function s(t){this.written=0,e=(t||20)*n,this.out=i.clean(e),this.blocks=[],this.length=0}s.prototype.append=function(t,e,s,a){var o,h,u,l,c,f,d;if("string"==typeof e)e=i.stringToUint8(e);else if(e.constructor!==Uint8Array.prototype.constructor)throw"Invalid input type. You gave me: "+e.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)[1];"function"==typeof s&&(s,s={}),u=(s=s||{}).mode||4095&parseInt("777",8),l=s.mtime||Math.floor(+new Date/1e3),c=s.uid||0,f=s.gid||0,o={fileName:t,fileMode:i.pad(u,7),uid:i.pad(c,7),gid:i.pad(f,7),fileSize:i.pad(e.length,11),mtime:i.pad(l,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:s.owner||"",group:s.group||""},h=0,Object.keys(o).forEach((function(t){var e,r,i=o[t];for(e=0,r=i.length;e<r;e+=1)h+=i.charCodeAt(e)})),o.checksum=i.pad(h,6)+"\0 ",d=r.format(o);var p=Math.ceil(d.length/n)*n,m=Math.ceil(e.length/n)*n;this.blocks.push({header:d,input:e,headerLength:p,inputLength:m})},s.prototype.save=function(){var t=[],e=[],r=0,i=Math.pow(2,20),n=[];return this.blocks.forEach((function(t){r+t.headerLength+t.inputLength>i&&(e.push({blocks:n,length:r}),n=[],r=0),n.push(t),r+=t.headerLength+t.inputLength})),e.push({blocks:n,length:r}),e.forEach((function(e){var r=new Uint8Array(e.length),i=0;e.blocks.forEach((function(t){r.set(t.header,i),i+=t.headerLength,r.set(t.input,i),i+=t.inputLength})),t.push(r)})),t.push(new Uint8Array(1024)),new Blob(t,{type:"octet/stream"})},s.prototype.clear=function(){this.written=0,this.out=i.clean(e)},void 0!==t.exports?t.exports=s:window.Tar=s}()},166:t=>{var e=function(t){this.data=new Uint8Array(t),this.pos=0};e.prototype.seek=function(t){this.pos=t},e.prototype.writeBytes=function(t){for(var e=0;e<t.length;e++)this.data[this.pos++]=t[e]},e.prototype.writeByte=function(t){this.data[this.pos++]=t},e.prototype.writeU8=e.prototype.writeByte,e.prototype.writeU16BE=function(t){this.data[this.pos++]=t>>8,this.data[this.pos++]=t},e.prototype.writeDoubleBE=function(t){for(var e=new Uint8Array(new Float64Array([t]).buffer),r=e.length-1;r>=0;r--)this.writeByte(e[r])},e.prototype.writeFloatBE=function(t){for(var e=new Uint8Array(new Float32Array([t]).buffer),r=e.length-1;r>=0;r--)this.writeByte(e[r])},e.prototype.writeString=function(t){for(var e=0;e<t.length;e++)this.data[this.pos++]=t.charCodeAt(e)},e.prototype.writeEBMLVarIntWidth=function(t,e){switch(e){case 1:this.writeU8(128|t);break;case 2:this.writeU8(64|t>>8),this.writeU8(t);break;case 3:this.writeU8(32|t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 4:this.writeU8(16|t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;case 5:this.writeU8(8|t/4294967296&7),this.writeU8(t>>24),this.writeU8(t>>16),this.writeU8(t>>8),this.writeU8(t);break;default:throw new RuntimeException("Bad EBML VINT size "+e)}},e.prototype.measureEBMLVarInt=function(t){if(t<127)return 1;if(t<16383)return 2;if(t<2097151)return 3;if(t<268435455)return 4;if(t<34359738367)return 5;throw new RuntimeException("EBML VINT size not supported "+t)},e.prototype.writeEBMLVarInt=function(t){this.writeEBMLVarIntWidth(t,this.measureEBMLVarInt(t))},e.prototype.writeUnsignedIntBE=function(t,e){switch(void 0===e&&(e=this.measureUnsignedInt(t)),e){case 5:this.writeU8(Math.floor(t/4294967296));case 4:this.writeU8(t>>24);case 3:this.writeU8(t>>16);case 2:this.writeU8(t>>8);case 1:this.writeU8(t);break;default:throw new RuntimeException("Bad UINT size "+e)}},e.prototype.measureUnsignedInt=function(t){return t<256?1:t<65536?2:t<16777216?3:t<4294967296?4:5},e.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw"ArrayBufferDataStream's pos lies beyond end of buffer"};var r,i,n=(r=null,function(t){var e=[],i=Promise.resolve(),n=null,s=null;function a(t){return new Promise((function(e,r){var i=new FileReader;i.addEventListener("loadend",(function(){e(i.result)})),i.readAsArrayBuffer(t)}))}function o(t){return new Promise((function(e,r){t instanceof Uint8Array?e(t):t instanceof ArrayBuffer||ArrayBuffer.isView(t)?e(new Uint8Array(t)):t instanceof Blob?e(a(t).then((function(t){return new Uint8Array(t)}))):e(a(new Blob([t])).then((function(t){return new Uint8Array(t)})))}))}function h(t){var e=t.byteLength||t.length||t.size;if(!Number.isInteger(e))throw"Failed to determine size of element";return e}"undefined"!=typeof FileWriter&&t instanceof FileWriter&&(n=t),this.pos=0,this.length=0,this.seek=function(t){if(t<0)throw"Offset may not be negative";if(isNaN(t))throw"Offset may not be NaN";if(t>this.length)throw"Seeking beyond the end of file is not allowed";this.pos=t},this.write=function(t){var a={offset:this.pos,data:t,length:h(t)},u=a.offset>=this.length;this.pos+=a.length,this.length=Math.max(this.length,this.pos),i=i.then((function(){if(s)return new Promise((function(t,e){o(a.data).then((function(e){var i=0,n=PM.from(e.buffer),o=function(e,n,h){(i+=n)>=h.length?t():r.write(s,h,i,h.length-i,a.offset+i,o)};r.write(s,n,0,n.length,a.offset,o)}))}));if(n)return new Promise((function(t,e){n.onwriteend=t,n.seek(a.offset),n.write(new Blob([a.data]))}));if(!u)for(var t=0;t<e.length;t++){var i=e[t];if(!(a.offset+a.length<=i.offset||a.offset>=i.offset+i.length)){if(a.offset<i.offset||a.offset+a.length>i.offset+i.length)throw new Error("Overwrite crosses blob boundaries");return a.offset==i.offset&&a.length==i.length?void(i.data=a.data):o(i.data).then((function(t){return i.data=t,o(a.data)})).then((function(t){a.data=t,i.data.set(a.data,a.offset-i.offset)}))}}e.push(a)}))},this.complete=function(t){return i=s||n?i.then((function(){return null})):i.then((function(){for(var r=[],i=0;i<e.length;i++)r.push(e[i].data);return new Blob(r,{mimeType:t})}))}});i=function(t,e){function r(t,e){var r,i=t.toDataURL("image/webp",{quality:e});return!("string"!=typeof(r=i)||!r.match(/^data:image\/webp;base64,/i))&&window.atob(r.substring(23))}function i(t){var e=t.indexOf("VP8 ");if(-1==e)throw"Failed to identify beginning of keyframe in WebP image";return e+=8,t.substring(e)}function n(t){this.value=t}function s(t){this.value=t}function a(t,e,r){if(Array.isArray(r))for(var i=0;i<r.length;i++)a(t,e,r[i]);else if("string"==typeof r)t.writeString(r);else if(r instanceof Uint8Array)t.writeBytes(r);else{if(!r.id)throw"Bad EBML datatype "+typeof r.data;var o,h,u;if(r.offset=t.pos+e,t.writeUnsignedIntBE(r.id),Array.isArray(r.data))-1===r.size?t.writeByte(255):(o=t.pos,t.writeBytes([0,0,0,0])),h=t.pos,r.dataOffset=h+e,a(t,e,r.data),-1!==r.size&&(u=t.pos,r.size=u-h,t.seek(o),t.writeEBMLVarIntWidth(r.size,4),t.seek(u));else if("string"==typeof r.data)t.writeEBMLVarInt(r.data.length),r.dataOffset=t.pos+e,t.writeString(r.data);else if("number"==typeof r.data)r.size||(r.size=t.measureUnsignedInt(r.data)),t.writeEBMLVarInt(r.size),r.dataOffset=t.pos+e,t.writeUnsignedIntBE(r.data,r.size);else if(r.data instanceof s)t.writeEBMLVarInt(8),r.dataOffset=t.pos+e,t.writeDoubleBE(r.data.value);else if(r.data instanceof n)t.writeEBMLVarInt(4),r.dataOffset=t.pos+e,t.writeFloatBE(r.data.value);else{if(!(r.data instanceof Uint8Array))throw"Bad EBML datatype "+typeof r.data;t.writeEBMLVarInt(r.data.byteLength),r.dataOffset=t.pos+e,t.writeBytes(r.data)}}}return function(n){var o,h,u,l,c,f=!1,d=[],p=0,m=0,g={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},v={id:17545,data:new s(0)},_=[],b=new e(n.fileWriter||n.fd);function y(t){return t-u.dataOffset}function x(){l=function(){var t={id:21420,size:5,data:0},e={id:290298740,data:[]};for(var r in g){var i=g[r];i.positionEBML=Object.create(t),e.data.push({id:19899,data:[{id:21419,data:i.id},i.positionEBML]})}return e}();var e={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},v]},r={id:374648427,data:[{id:174,data:[{id:215,data:1},{id:29637,data:1},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:[{id:176,data:o},{id:186,data:h}]}]}]};u={id:408125543,size:-1,data:[l,e,r]};var i=new t(256);a(i,b.pos,[{id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},u]),b.write(i.getAsDataArray()),g.SegmentInfo.positionEBML.data=y(e.offset),g.Tracks.positionEBML.data=y(r.offset)}function w(e){var r=new t(4);if(!(e.trackNumber>0&&e.trackNumber<127))throw"TrackNumber must be > 0 and < 127";return r.writeEBMLVarInt(e.trackNumber),r.writeU16BE(e.timecode),r.writeByte(128),{id:163,data:[r.getAsDataArray(),e.frame]}}function E(){if(0!=d.length){for(var e=0,r=0;r<d.length;r++)e+=d[r].frame.length;var i,n,s,o=new t(e+32*d.length),h=function(t){return{id:524531317,data:[{id:231,data:Math.round(t.timecode)}]}}({timecode:Math.round(p)});for(r=0;r<d.length;r++)h.data.push(w(d[r]));a(o,b.pos,h),b.write(o.getAsDataArray()),i=1,n=Math.round(p),s=h.offset,_.push({id:187,data:[{id:179,data:n},{id:183,data:[{id:247,data:i},{id:241,data:y(s)}]}]}),d=[],p+=m,m=0}}this.addFrame=function(t){if(f){if(t.width!=o||t.height!=h)throw"Frame size differs from previous frames"}else o=t.width,h=t.height,x(),f=!0;var e,s=r(t,{quality:n.quality});if(!s)throw"Couldn't decode WebP frame, does the browser support WebP?";(e={frame:i(s),duration:n.frameDuration}).trackNumber=1,e.timecode=Math.round(m),d.push(e),(m+=e.duration)>=5e3&&E()},this.complete=function(){var e,r,i,n;return E(),e={id:475249515,data:_},a(r=new t(16+32*_.length),b.pos,e),b.write(r.getAsDataArray()),g.Cues.positionEBML.data=y(e.offset),i=new t(l.size),n=b.pos,a(i,l.dataOffset,l.data),b.seek(l.dataOffset),b.write(i.getAsDataArray()),b.seek(n),function(){var e=new t(8),r=b.pos;e.writeDoubleBE(p),b.seek(v.dataOffset),b.write(e.getAsDataArray()),b.seek(r)}(),b.complete("video/webm")},this.getWrittenSize=function(){return b.length},c={},[{quality:.95,fileWriter:null,fd:null,frameDuration:null,frameRate:null},n||{}].forEach((function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(c[e]=t[e])})),n=c,function(){if(!n.frameDuration){if(!n.frameRate)throw"Missing required frameDuration or frameRate setting";n.frameDuration=1e3/n.frameRate}}()}},void 0!==t.exports?t.exports=i(e,n):window.WebMWriter=i(e,n)},681:t=>{t.exports=JSON.parse('{"_from":"@ffmpeg/ffmpeg","_id":"@ffmpeg/ffmpeg@0.10.1","_inBundle":false,"_integrity":"sha512-ChQkH7Rh57hmVo1LhfQFibWX/xqneolJKSwItwZdKPcLZuKigtYAYDIvB55pDfP17VtR1R77SxgkB2/UApB+Og==","_location":"/@ffmpeg/ffmpeg","_phantomChildren":{},"_requested":{"type":"tag","registry":true,"raw":"@ffmpeg/ffmpeg","name":"@ffmpeg/ffmpeg","escapedName":"@ffmpeg%2fffmpeg","scope":"@ffmpeg","rawSpec":"","saveSpec":null,"fetchSpec":"latest"},"_requiredBy":["#USER","/"],"_resolved":"https://registry.npmjs.org/@ffmpeg/ffmpeg/-/ffmpeg-0.10.1.tgz","_shasum":"3dacf3985de9c83a95fbf79fe709920cc009b00a","_spec":"@ffmpeg/ffmpeg","_where":"/Users/amandaghassaei/Projects/canvas-capture","author":{"name":"Jerome Wu","email":"jeromewus@gmail.com"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"bundleDependencies":false,"dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"deprecated":false,"description":"FFmpeg WebAssembly version","devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"},"directories":{"example":"examples"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","keywords":["ffmpeg","WebAssembly","video"],"license":"MIT","main":"src/index.js","name":"@ffmpeg/ffmpeg","repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"scripts":{"build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","lint":"eslint src","prepublishOnly":"npm run build","start":"node scripts/server.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js"},"types":"src/index.d.ts","version":"0.10.1"}')}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var i={};return(()=>{var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasCapture=void 0;var e=r(914);t.CanvasCapture=e,t.default=e})(),i})()));var NM=s("kLMlV");r(NM).setup([1,1]);const kM=r(NM).Point,BM=r(NM).Rectangle,LM=r(NM).Path,OM=r(NM).CompoundPath,FM=(r(NM).Color,r(NM).Matrix,r(NM).Path.Line);r(NM).Path.Ellipse;kM.prototype.toVec=function(){return[this.x,this.y]},LM.prototype.toPoints=function(t=1){const e=[],r=this.length;for(let i=0;i<r;i+=t)e.push(this.getPointAt(i));return e},OM.prototype.childPaths=function(){return this.children},OM.prototype.toPoints=function(t=1){return this.childPaths().flatMap((e=>e.toPoints(t)))},BM.prototype.toPath=function(){return new LM.Rectangle(this)};function UM(t){return{debug:!1,resolution:1,...{width:window.innerWidth,height:window.innerHeight},...t}}const zM=9007199254740992,GM=9007199254740991,HM=4294967295,jM=4294967296,VM=2147483648,WM=2147483647,qM=2097152,XM=2097151;function YM(t){return 0|t.next()}function ZM(t,e){return 0===e?t:r=>t(r)+e}function $M(t){const e=0|t.next(),r=t.next()>>>0;return(e&XM)*jM+r+(e&qM?-9007199254740992:0)}function KM(t){for(;;){const e=0|t.next();if(!(4194304&e)){const r=t.next()>>>0;return(e&XM)*jM+r+(e&qM?-9007199254740992:0)}if(4194304==(8388607&e)&&0==(0|t.next()))return zM}}function JM(t){return t.next()>>>0}function QM(t){const e=t.next()&XM,r=t.next()>>>0;return e*jM+r}function tS(t){for(;;){const e=0|t.next();if(!(e&qM)){const r=t.next()>>>0;return(e&XM)*jM+r}if(0==(e&XM)&&0==(0|t.next()))return zM}}function eS(t){return 0==(t+1&t)}function rS(t){return eS(t)?(e=t,t=>t.next()&e):function(t){const e=t+1,r=e*Math.floor(jM/e);return t=>{let i=0;do{i=t.next()>>>0}while(i>=r);return i%e}}(t);var e}function iS(t){const e=t+1;if(0==(0|e)){const t=(e/jM|0)-1;if(eS(t))return r=t,t=>{const e=t.next()&r,i=t.next()>>>0;return e*jM+i}}var r;return function(t){const e=t*Math.floor(zM/t);return r=>{let i=0;do{const t=r.next()&XM,e=r.next()>>>0;i=t*jM+e}while(i>=e);return i%t}}(e)}function nS(t,e){return r=>{let i=0;do{const t=0|r.next(),e=r.next()>>>0;i=(t&XM)*jM+e+(t&qM?-9007199254740992:0)}while(i<t||i>e);return i}}function sS(t,e){if(t=Math.floor(t),e=Math.floor(e),t<-9007199254740992||!isFinite(t))throw new RangeError("Expected min to be at least -9007199254740992");if(e>zM||!isFinite(e))throw new RangeError("Expected max to be at most 9007199254740992");const r=e-t;return r<=0||!isFinite(r)?()=>t:r===HM?0===t?JM:ZM(YM,t+VM):r<HM?ZM(rS(r),t):r===GM?ZM(QM,t):r<GM?ZM(iS(r),t):e-1-t===GM?ZM(tS,t):-9007199254740992===t&&e===zM?KM:-9007199254740992===t&&e===GM?$M:-9007199254740991===t&&e===zM?ZM($M,1):e===zM?ZM(nS(t-1,e-1),1):nS(t,e)}function aS(t){return 1==(1&t.next())}function oS(t,e){return r=>t(r)<e}function hS(t,e){return null==e?null==t?aS:function(t){if(t<=0)return()=>!1;if(t>=1)return()=>!0;{const e=t*jM;return e%1==0?oS(YM,e-VM|0):oS(QM,Math.round(t*zM))}}(t):t<=0?()=>!1:t>=e?()=>!0:oS(sS(0,e-1),t)}function uS(t){return sS(1,t)}function lS(t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-"){const e=t.length;if(!e)throw new Error("Expected pool not to be an empty string");const r=sS(0,e-1);return(e,i)=>{let n="";for(let s=0;s<i;++s){const i=r(e);n+=t.charAt(i)}return n}}const cS="0123456789abcdef",fS=lS(cS),dS=lS(cS.toUpperCase());function pS(t,e){return t<0?Math.max(t+e,0):Math.min(t,e)}function mS(t){const e=+t;return e<0?Math.ceil(e):Math.floor(e)}function gS(t){return QM(t)/zM}function vS(t){return tS(t)/zM}const _S=Array.prototype.slice;function bS(t,e,r=0){const i=e.length;if(i)for(let n=i-1>>>0;n>r;--n){const r=sS(0,n)(t);if(n!==r){const t=e[n];e[n]=e[r],e[r]=t}}return e}const yS=(()=>{try{if("xxx"==="x".repeat(3))return(t,e)=>t.repeat(e)}catch(t){}return(t,e)=>{let r="";for(;e>0;)1&e&&(r+=t),e>>=1,t+=t;return r}})();function xS(t,e){return yS("0",e-t.length)+t}const wS={next:()=>Math.random()*jM|0};class ES{constructor(t=wS){this.engine=t}int32(){return YM(this.engine)}uint32(){return JM(this.engine)}uint53(){return QM(this.engine)}uint53Full(){return tS(this.engine)}int53(){return $M(this.engine)}int53Full(){return KM(this.engine)}integer(t,e){return sS(t,e)(this.engine)}realZeroToOneInclusive(){return vS(this.engine)}realZeroToOneExclusive(){return gS(this.engine)}real(t,e,r=!1){return function(t,e,r=!1){if(!isFinite(t))throw new RangeError("Expected min to be a finite number");if(!isFinite(e))throw new RangeError("Expected max to be a finite number");return ZM((i=r?vS:gS,1==(n=e-t)?i:0===n?()=>0:t=>i(t)*n),t);var i,n}(t,e,r)(this.engine)}bool(t,e){return hS(t,e)(this.engine)}pick(t,e,r){return function(t,e,r,i){const n=e.length;if(0===n)throw new RangeError("Cannot pick from an empty array");const s=null==r?0:pS(mS(r),n),a=void 0===i?n:pS(mS(i),n);if(s>=a)throw new RangeError(`Cannot pick between bounds ${s} and ${a}`);return e[sS(s,a-1)(t)]}(this.engine,t,e,r)}shuffle(t){return bS(this.engine,t)}sample(t,e){return function(t,e,r){if(r<0||r>e.length||!isFinite(r))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(0===r)return[];const i=_S.call(e),n=i.length;if(n===r)return bS(t,i,0);const s=n-r;return bS(t,i,s-1).slice(s)}(this.engine,t,e)}die(t){return uS(t)(this.engine)}dice(t,e){return function(t,e){const r=uS(t);return t=>{const i=[];for(let n=0;n<e;++n)i.push(r(t));return i}}(t,e)(this.engine)}uuid4(){return function(t){const e=t.next()>>>0,r=0|t.next(),i=0|t.next(),n=t.next()>>>0;return xS(e.toString(16),8)+"-"+xS((65535&r).toString(16),4)+"-"+xS((r>>4&4095|16384).toString(16),4)+"-"+xS((16383&i|32768).toString(16),4)+"-"+xS((i>>4&65535).toString(16),4)+xS(n.toString(16),8)}(this.engine)}string(t,e){return lS(e)(this.engine,t)}hex(t,e){return function(t){return t?dS:fS}(e)(this.engine,t)}date(t,e){return function(t,e){const r=sS(+t,+e);return t=>new Date(r(t))}(t,e)(this.engine)}}const MS=(()=>{try{const t=new ArrayBuffer(4),e=new Int32Array(t);if(e[0]=VM,-2147483648===e[0])return Int32Array}catch(t){}return Array})();const SS=(()=>{try{if(-5===Math.imul(HM,5))return Math.imul}catch(t){}const t=65535;return(e,r)=>{const i=e&t,n=r&t;return i*n+((e>>>16&t)*n+i*(r>>>16&t)<<16>>>0)|0}})(),AS=624,TS=623,CS=2567483615;class DS{constructor(){this.data=new MS(AS),this.index=0,this.uses=0}static seed(t){return(new DS).seed(t)}static seedWithArray(t){return(new DS).seedWithArray(t)}static autoSeed(){return DS.seedWithArray(function(t=wS,e=16){const r=[];r.push(0|(new Date).getTime());for(let i=1;i<e;++i)r[i]=0|t.next();return r}())}next(){(0|this.index)>=AS&&(RS(this.data),this.index=0);const t=this.data[this.index];return this.index=this.index+1|0,this.uses+=1,0|function(t){return t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,t^t>>>18}(t)}getUseCount(){return this.uses}discard(t){if(t<=0)return this;for(this.uses+=t,(0|this.index)>=AS&&(RS(this.data),this.index=0);t+this.index>AS;)t-=AS-this.index,RS(this.data),this.index=0;return this.index=this.index+t|0,this}seed(t){let e=0;this.data[0]=e=0|t;for(let t=1;t<AS;t=t+1|0)this.data[t]=e=SS(e^e>>>30,1812433253)+t|0;return this.index=AS,this.uses=0,this}seedWithArray(t){return this.seed(19650218),function(t,e){let r=1,i=0;const n=e.length;let s=0|Math.max(n,AS),a=0|t[0];for(;(0|s)>0;--s)t[r]=a=(t[r]^SS(a^a>>>30,1664525))+(0|e[i])+(0|i)|0,r=r+1|0,++i,(0|r)>TS&&(t[0]=t[623],r=1),i>=n&&(i=0);for(s=TS;(0|s)>0;--s)t[r]=a=(t[r]^SS(a^a>>>30,1566083941))-r|0,r=r+1|0,(0|r)>TS&&(t[0]=t[623],r=1);t[0]=VM}(this.data,t),this}}function RS(t){let e=0,r=0;for(;(0|e)<227;e=e+1|0)r=t[e]&VM|t[e+1|0]&WM,t[e]=t[e+397|0]^r>>>1^(1&r?CS:0);for(;(0|e)<TS;e=e+1|0)r=t[e]&VM|t[e+1|0]&WM,t[e]=t[e-227|0]^r>>>1^(1&r?CS:0);r=t[623]&VM|t[0]&WM,t[623]=t[396]^r>>>1^(1&r?CS:0)}const IS=.5*(Math.sqrt(3)-1),PS=(3-Math.sqrt(3))/6,NS=1/6,kS=(Math.sqrt(5)-1)/4,BS=(5-Math.sqrt(5))/20,LS=t=>0|Math.floor(t),OS=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),FS=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),US=new Float64Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);function zS(t){const e=512,r=new Uint8Array(e);for(let t=0;t<256;t++)r[t]=t;for(let e=0;e<255;e++){const i=e+~~(t()*(256-e)),n=r[e];r[e]=r[i],r[i]=n}for(let t=256;t<e;t++)r[t]=r[t-256];return r}const GS=new ES(DS.autoSeed()),HS=(function(t=Math.random){const e=zS(t),r=new Float64Array(e).map((t=>OS[t%12*2])),i=new Float64Array(e).map((t=>OS[t%12*2+1]))}((()=>GS.realZeroToOneExclusive())),function(t=Math.random){const e=zS(t),r=new Float64Array(e).map((t=>FS[t%12*3])),i=new Float64Array(e).map((t=>FS[t%12*3+1])),n=new Float64Array(e).map((t=>FS[t%12*3+2]));return function(t,s,a){let o,h,u,l;const c=.3333333333333333*(t+s+a),f=LS(t+c),d=LS(s+c),p=LS(a+c),m=(f+d+p)*NS,g=t-(f-m),v=s-(d-m),_=a-(p-m);let b,y,x,w,E,M;g>=v?v>=_?(b=1,y=0,x=0,w=1,E=1,M=0):g>=_?(b=1,y=0,x=0,w=1,E=0,M=1):(b=0,y=0,x=1,w=1,E=0,M=1):v<_?(b=0,y=0,x=1,w=0,E=1,M=1):g<_?(b=0,y=1,x=0,w=0,E=1,M=1):(b=0,y=1,x=0,w=1,E=1,M=0);const S=g-b+NS,A=v-y+NS,T=_-x+NS,C=g-w+.3333333333333333,D=v-E+.3333333333333333,R=_-M+.3333333333333333,I=g-1+.5,P=v-1+.5,N=_-1+.5,k=255&f,B=255&d,L=255&p;let O=.6-g*g-v*v-_*_;if(O<0)o=0;else{const t=k+e[B+e[L]];O*=O,o=O*O*(r[t]*g+i[t]*v+n[t]*_)}let F=.6-S*S-A*A-T*T;if(F<0)h=0;else{const t=k+b+e[B+y+e[L+x]];F*=F,h=F*F*(r[t]*S+i[t]*A+n[t]*T)}let U=.6-C*C-D*D-R*R;if(U<0)u=0;else{const t=k+w+e[B+E+e[L+M]];U*=U,u=U*U*(r[t]*C+i[t]*D+n[t]*R)}let z=.6-I*I-P*P-N*N;if(z<0)l=0;else{const t=k+1+e[B+1+e[L+1]];z*=z,l=z*z*(r[t]*I+i[t]*P+n[t]*N)}return 32*(o+h+u+l)}}((()=>GS.realZeroToOneExclusive())));!function(t=Math.random){const e=zS(t),r=new Float64Array(e).map((t=>US[t%32*4])),i=new Float64Array(e).map((t=>US[t%32*4+1])),n=new Float64Array(e).map((t=>US[t%32*4+2])),s=new Float64Array(e).map((t=>US[t%32*4+3]))}((()=>GS.realZeroToOneExclusive()));ES.prototype.sign=function(){return this.bool()?1:-1},ES.prototype.normal=function(t=0,e=1){const r=1-this.realZeroToOneExclusive(),i=this.realZeroToOneExclusive();return iM(-2*xM(r))*rM(2*jE*i)*e+t};var jS,VS,WS;WS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const qS={};for(const t of Object.keys(WS))qS[WS[t]]=t;const XS={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};VS=XS;for(const t of Object.keys(XS)){if(!("channels"in XS[t]))throw new Error("missing channels property: "+t);if(!("labels"in XS[t]))throw new Error("missing channel labels property: "+t);if(XS[t].labels.length!==XS[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:r}=XS[t];delete XS[t].channels,delete XS[t].labels,Object.defineProperty(XS[t],"channels",{value:e}),Object.defineProperty(XS[t],"labels",{value:r})}XS.rgb.hsl=function(t){const e=t[0]/255,r=t[1]/255,i=t[2]/255,n=Math.min(e,r,i),s=Math.max(e,r,i),a=s-n;let o,h;s===n?o=0:e===s?o=(r-i)/a:r===s?o=2+(i-e)/a:i===s&&(o=4+(e-r)/a),o=Math.min(60*o,360),o<0&&(o+=360);const u=(n+s)/2;return h=s===n?0:u<=.5?a/(s+n):a/(2-s-n),[o,100*h,100*u]},XS.rgb.hsv=function(t){let e,r,i,n,s;const a=t[0]/255,o=t[1]/255,h=t[2]/255,u=Math.max(a,o,h),l=u-Math.min(a,o,h),c=function(t){return(u-t)/6/l+.5};return 0===l?(n=0,s=0):(s=l/u,e=c(a),r=c(o),i=c(h),a===u?n=i-r:o===u?n=1/3+e-i:h===u&&(n=2/3+r-e),n<0?n+=1:n>1&&(n-=1)),[360*n,100*s,100*u]},XS.rgb.hwb=function(t){const e=t[0],r=t[1];let i=t[2];const n=XS.rgb.hsl(t)[0],s=1/255*Math.min(e,Math.min(r,i));return i=1-1/255*Math.max(e,Math.max(r,i)),[n,100*s,100*i]},XS.rgb.cmyk=function(t){const e=t[0]/255,r=t[1]/255,i=t[2]/255,n=Math.min(1-e,1-r,1-i);return[100*((1-e-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-i-n)/(1-n)||0),100*n]},XS.rgb.keyword=function(t){const e=qS[t];if(e)return e;let r,i=1/0;for(const e of Object.keys(WS)){const a=(s=WS[e],((n=t)[0]-s[0])**2+(n[1]-s[1])**2+(n[2]-s[2])**2);a<i&&(i=a,r=e)}var n,s;return r},XS.keyword.rgb=function(t){return WS[t]},XS.rgb.xyz=function(t){let e=t[0]/255,r=t[1]/255,i=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;return[100*(.4124*e+.3576*r+.1805*i),100*(.2126*e+.7152*r+.0722*i),100*(.0193*e+.1192*r+.9505*i)]},XS.rgb.lab=function(t){const e=XS.rgb.xyz(t);let r=e[0],i=e[1],n=e[2];r/=95.047,i/=100,n/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;return[116*i-16,500*(r-i),200*(i-n)]},XS.hsl.rgb=function(t){const e=t[0]/360,r=t[1]/100,i=t[2]/100;let n,s,a;if(0===r)return a=255*i,[a,a,a];n=i<.5?i*(1+r):i+r-i*r;const o=2*i-n,h=[0,0,0];for(let t=0;t<3;t++)s=e+1/3*-(t-1),s<0&&s++,s>1&&s--,a=6*s<1?o+6*(n-o)*s:2*s<1?n:3*s<2?o+(n-o)*(2/3-s)*6:o,h[t]=255*a;return h},XS.hsl.hsv=function(t){const e=t[0];let r=t[1]/100,i=t[2]/100,n=r;const s=Math.max(i,.01);i*=2,r*=i<=1?i:2-i,n*=s<=1?s:2-s;return[e,100*(0===i?2*n/(s+n):2*r/(i+r)),100*((i+r)/2)]},XS.hsv.rgb=function(t){const e=t[0]/60,r=t[1]/100;let i=t[2]/100;const n=Math.floor(e)%6,s=e-Math.floor(e),a=255*i*(1-r),o=255*i*(1-r*s),h=255*i*(1-r*(1-s));switch(i*=255,n){case 0:return[i,h,a];case 1:return[o,i,a];case 2:return[a,i,h];case 3:return[a,o,i];case 4:return[h,a,i];case 5:return[i,a,o]}},XS.hsv.hsl=function(t){const e=t[0],r=t[1]/100,i=t[2]/100,n=Math.max(i,.01);let s,a;a=(2-r)*i;const o=(2-r)*n;return s=r*n,s/=o<=1?o:2-o,s=s||0,a/=2,[e,100*s,100*a]},XS.hwb.rgb=function(t){const e=t[0]/360;let r=t[1]/100,i=t[2]/100;const n=r+i;let s;n>1&&(r/=n,i/=n);const a=Math.floor(6*e),o=1-i;s=6*e-a,0!=(1&a)&&(s=1-s);const h=r+s*(o-r);let u,l,c;switch(a){default:case 6:case 0:u=o,l=h,c=r;break;case 1:u=h,l=o,c=r;break;case 2:u=r,l=o,c=h;break;case 3:u=r,l=h,c=o;break;case 4:u=h,l=r,c=o;break;case 5:u=o,l=r,c=h}return[255*u,255*l,255*c]},XS.cmyk.rgb=function(t){const e=t[0]/100,r=t[1]/100,i=t[2]/100,n=t[3]/100;return[255*(1-Math.min(1,e*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},XS.xyz.rgb=function(t){const e=t[0]/100,r=t[1]/100,i=t[2]/100;let n,s,a;return n=3.2406*e+-1.5372*r+-.4986*i,s=-.9689*e+1.8758*r+.0415*i,a=.0557*e+-.204*r+1.057*i,n=n>.0031308?1.055*n**(1/2.4)-.055:12.92*n,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,n=Math.min(Math.max(0,n),1),s=Math.min(Math.max(0,s),1),a=Math.min(Math.max(0,a),1),[255*n,255*s,255*a]},XS.xyz.lab=function(t){let e=t[0],r=t[1],i=t[2];e/=95.047,r/=100,i/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;return[116*r-16,500*(e-r),200*(r-i)]},XS.lab.xyz=function(t){let e,r,i;r=(t[0]+16)/116,e=t[1]/500+r,i=r-t[2]/200;const n=r**3,s=e**3,a=i**3;return r=n>.008856?n:(r-16/116)/7.787,e=s>.008856?s:(e-16/116)/7.787,i=a>.008856?a:(i-16/116)/7.787,e*=95.047,r*=100,i*=108.883,[e,r,i]},XS.lab.lch=function(t){const e=t[0],r=t[1],i=t[2];let n;n=360*Math.atan2(i,r)/2/Math.PI,n<0&&(n+=360);return[e,Math.sqrt(r*r+i*i),n]},XS.lch.lab=function(t){const e=t[0],r=t[1],i=t[2]/360*2*Math.PI;return[e,r*Math.cos(i),r*Math.sin(i)]},XS.rgb.ansi16=function(t,e=null){const[r,i,n]=t;let s=null===e?XS.rgb.hsv(t)[2]:e;if(s=Math.round(s/50),0===s)return 30;let a=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(r/255));return 2===s&&(a+=60),a},XS.hsv.ansi16=function(t){return XS.rgb.ansi16(XS.hsv.rgb(t),t[2])},XS.rgb.ansi256=function(t){const e=t[0],r=t[1],i=t[2];if(e===r&&r===i)return e<8?16:e>248?231:Math.round((e-8)/247*24)+232;return 16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},XS.ansi16.rgb=function(t){let e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const r=.5*(1+~~(t>50));return[(1&e)*r*255,(e>>1&1)*r*255,(e>>2&1)*r*255]},XS.ansi256.rgb=function(t){if(t>=232){const e=10*(t-232)+8;return[e,e,e]}let e;t-=16;return[Math.floor(t/36)/5*255,Math.floor((e=t%36)/6)/5*255,e%6/5*255]},XS.rgb.hex=function(t){const e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},XS.hex.rgb=function(t){const e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let r=e[0];3===e[0].length&&(r=r.split("").map((t=>t+t)).join(""));const i=parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},XS.rgb.hcg=function(t){const e=t[0]/255,r=t[1]/255,i=t[2]/255,n=Math.max(Math.max(e,r),i),s=Math.min(Math.min(e,r),i),a=n-s;let o,h;return o=a<1?s/(1-a):0,h=a<=0?0:n===e?(r-i)/a%6:n===r?2+(i-e)/a:4+(e-r)/a,h/=6,h%=1,[360*h,100*a,100*o]},XS.hsl.hcg=function(t){const e=t[1]/100,r=t[2]/100,i=r<.5?2*e*r:2*e*(1-r);let n=0;return i<1&&(n=(r-.5*i)/(1-i)),[t[0],100*i,100*n]},XS.hsv.hcg=function(t){const e=t[1]/100,r=t[2]/100,i=e*r;let n=0;return i<1&&(n=(r-i)/(1-i)),[t[0],100*i,100*n]},XS.hcg.rgb=function(t){const e=t[0]/360,r=t[1]/100,i=t[2]/100;if(0===r)return[255*i,255*i,255*i];const n=[0,0,0],s=e%1*6,a=s%1,o=1-a;let h=0;switch(Math.floor(s)){case 0:n[0]=1,n[1]=a,n[2]=0;break;case 1:n[0]=o,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=a;break;case 3:n[0]=0,n[1]=o,n[2]=1;break;case 4:n[0]=a,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=o}return h=(1-r)*i,[255*(r*n[0]+h),255*(r*n[1]+h),255*(r*n[2]+h)]},XS.hcg.hsv=function(t){const e=t[1]/100,r=e+t[2]/100*(1-e);let i=0;return r>0&&(i=e/r),[t[0],100*i,100*r]},XS.hcg.hsl=function(t){const e=t[1]/100,r=t[2]/100*(1-e)+.5*e;let i=0;return r>0&&r<.5?i=e/(2*r):r>=.5&&r<1&&(i=e/(2*(1-r))),[t[0],100*i,100*r]},XS.hcg.hwb=function(t){const e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},XS.hwb.hcg=function(t){const e=t[1]/100,r=1-t[2]/100,i=r-e;let n=0;return i<1&&(n=(r-i)/(1-i)),[t[0],100*i,100*n]},XS.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},XS.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},XS.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},XS.gray.hsl=function(t){return[0,0,t[0]]},XS.gray.hsv=XS.gray.hsl,XS.gray.hwb=function(t){return[0,100,t[0]]},XS.gray.cmyk=function(t){return[0,0,0,t[0]]},XS.gray.lab=function(t){return[t[0],0,0]},XS.gray.hex=function(t){const e=255&Math.round(t[0]/100*255),r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r},XS.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};var YS;function ZS(t){const e=function(){const t={},e=Object.keys(VS);for(let r=e.length,i=0;i<r;i++)t[e[i]]={distance:-1,parent:null};return t}(),r=[t];for(e[t].distance=0;r.length;){const t=r.pop(),i=Object.keys(VS[t]);for(let n=i.length,s=0;s<n;s++){const n=i[s],a=e[n];-1===a.distance&&(a.distance=e[t].distance+1,a.parent=t,r.unshift(n))}}return e}function $S(t,e){return function(r){return e(t(r))}}function KS(t,e){const r=[e[t].parent,t];let i=VS[e[t].parent][t],n=e[t].parent;for(;e[n].parent;)r.unshift(e[n].parent),i=$S(VS[e[n].parent][n],i),n=e[n].parent;return i.conversion=r,i}YS=function(t){const e=ZS(t),r={},i=Object.keys(e);for(let t=i.length,n=0;n<t;n++){const t=i[n];null!==e[t].parent&&(r[t]=KS(t,e))}return r};const JS={};function QS(t){return RM(t,"deg")}Object.keys(VS).forEach((t=>{JS[t]={},Object.defineProperty(JS[t],"channels",{value:VS[t].channels}),Object.defineProperty(JS[t],"labels",{value:VS[t].labels});const e=YS(t);Object.keys(e).forEach((r=>{const i=e[r];JS[t][r]=function(t){const e=function(...e){const r=e[0];if(null==r)return r;r.length>1&&(e=r);const i=t(e);if("object"==typeof i)for(let t=i.length,e=0;e<t;e++)i[e]=Math.round(i[e]);return i};return"conversion"in t&&(e.conversion=t.conversion),e}(i),JS[t][r].raw=function(t){const e=function(...e){const r=e[0];return null==r?r:(r.length>1&&(e=r),t(e))};return"conversion"in t&&(e.conversion=t.conversion),e}(i)}))})),jS=JS,function(t,e){const r=void 0,i=UM(e),n=t(i),s=function(t,e,r){const i=function(t){return void 0!==t.container}(t)?function(t){const e=new pa({antialias:!0,autoDensity:!0,preserveDrawingBuffer:!0,powerPreference:"high-performance"});return e.stage.scale.set(1,-1),{context:e,canvas:e.view,resize(t){e.renderer.resolution=t.resolution,e.renderer.resize(t.width,t.height),e.stage.position={x:t.width/2,y:t.height/2}},run(r){e.stage.removeChildren().forEach((t=>t.destroy(!0))),e.stage.addChild(r.container),t.debug&&e.stage.addChild(Qv(t))},render(){e.renderer.render(e.stage)}}}(e):function(t,e){const r=new Xm({antialias:!0,preserveDrawingBuffer:!0,powerPreference:"high-performance"}),i=e?.addPanel(new(0,e_.Panel)("DrawCalls","#ff8","#221"));let n,s,a=0;return{context:r,canvas:r.domElement,resize(t){r.setPixelRatio(t.resolution),r.setSize(t.width,t.height)},run(e){({scene:n,camera:s}=e),t.debug&&n.add(new Cg,new Tg)},render(){r.render(n,s);const t=r.info.render.calls;a=AM(t,a),i?.update(t,a)}}}(e,r),n=i.canvas;return n.id="sketch",document.body.appendChild(n),IM.CanvasCapture.init(n,{showRecDot:!0}),IM.CanvasCapture.bindKeyToPNGSnapshot("p"),IM.CanvasCapture.bindKeyToVideoRecord("v",{onExportProgress:t=>console.log(`Processing recording, ${gM(100*t)}%...`)}),i.resize(e),i}(n,i,r);s.run(n);let a=0,o=0,h=!0,u=0,l=n.update;const c=t=>{r?.begin();let e=(t-u)/1e3;if(u=t,l){for(;e>0;){const t=mM(e,.001);a+=t,e-=t,l(t,a)}h=!0}h&&s.render(),h=!1,IM.CanvasCapture.checkHotkeys(),IM.CanvasCapture.isRecording()&&(IM.CanvasCapture.recordFrame(),o++,o%60==0&&console.log(`Recorded ${o/60} seconds`)),r?.end(),requestAnimationFrame(c)};requestAnimationFrame(c),s.canvas.onclick=()=>{const e=t(i);s.run(e),a=0,l=e.update},addEventListener("resize",(()=>{const r=UM(e),i=t(r);s.resize(r),s.run(i),a=0,l=i.update}))}((t=>{const e=GS.real(0,360),r=jS.hsl.hex([e,GS.real(20,30),GS.real(80,90)]),i=GS.integer(2,4),n=GS.real(0,360),s=new BM(-t.width/2,t.height/2,t.width,-t.height).toPath(),a=new Us,o=(new vh).beginFill(parseInt(r,16)).drawRect(-t.width/2,-t.height/2,t.width,t.height);o.filters=[new Ks(GS.real(.1,.2))],a.addChild(o);for(let t=0;t<i;t++)a.addChild(h(t));return{container:a};function h(r){const s=new Us,a=n+r*(180/i*GS.real(.8,1.2)),o=function(e){const r=GS.real(.001,.01),i=GS.real(.25,.5),n=new OffscreenCanvas(t.width,t.height),s=n.getContext("2d"),a=s.getImageData(0,0,t.width,t.height),o=a.data;let h=0;for(let n=0;n<t.height;n++)for(let s=0;s<t.width;s++){const t=HS(s*r,n*r,1e3*e);o[h++]=o[h++]=o[h++]=t>i?255:0,o[h++]=255}s.putImageData(a,0,0);const u=Hs.from(n);return u.anchor.set(.5,.5),u}(r);s.mask=o,s.addChild(o);const h=function(r){const i=GS.real(5,15),n=i/5,s=GS.real(50,100),a=GS.real(10,30),o=jS.hsl.hex([(e+180)%360,s,a]),h=eM(QS(r)),l=AM(t.width,t.height),c=90==r?new FM([0,-l],[0,l]):new FM([-l,-l*h],[l,l*h]),f=90==r?t.width/2:t.height/2+t.width/2*WE(h),d=90==r?i:i*iM(1+h*h),p=new Us;u(c,o,n,p);for(let t=d;t<f;t+=d)c.position=90==r?new kM(t,0):new kM(0,t),u(c,o,n,p),c.position=90==r?new kM(-t,0):new kM(0,-t),u(c,o,n,p);return p}(a%180);return s.addChild(h),s}function u(t,e,r,i){const n=new vh,a=GS.real(.001,.003)*t.length,o=t.getIntersections(s).map((t=>t.offset));if(0==o.length)return;const[h,u]=[mM(o),AM(o)],l=t.getPointAt(h);n.moveTo(l.x,l.y);for(let i=h;i<u+a;i+=a){const s=GS.real(.6,1),a=t.getPointAt(i),o=GS.real(-.5,.5)*iM(2);n.lineStyle(GS.real(2,2+r),e,s).lineTo(a.x-o,a.y+o)}i.addChild(n)}}));